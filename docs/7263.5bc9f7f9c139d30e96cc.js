"use strict";(self.webpackChunkreact_redux_arcgis_boilerplate=self.webpackChunkreact_redux_arcgis_boilerplate||[]).push([[7263],{74274:function(e,t,i){i.d(t,{fs:function(){return o},i0:function(){return a}});var n=i(50189),r=i(46227),s=(i(83911),i(6183),i(23375));new Set(["integer","small-integer"]);function o(e){return(0,r.vE)(e)||(0,r.zD)(e)||(0,r.Ah)(e)}function a(e,t){const{format:i,timeZoneOptions:r,fieldType:o}=t??{};let a,l;if(r&&({timeZone:a,timeZoneName:l}=(0,s.hv)(r.layerTimeZone,r.datesInUnknownTimezone,r.viewTimeZone,(0,n.J2)(i||"short-date-short-time"),o)),"string"==typeof e&&isNaN(Date.parse("time-only"===o?`1970-01-01T${e}Z`:e)))return e;switch(o){case"date-only":{const t=(0,n.J2)(i||"short-date");return"string"==typeof e?(0,n.iS)(e,{...t}):(0,n.Yq)(e,{...t,timeZone:s.n$})}case"time-only":{const t=(0,n.J2)(i||"short-time");return"string"==typeof e?(0,n.F8)(e,t):(0,n.Yq)(e,{...t,timeZone:s.n$})}case"timestamp-offset":{if(!a&&"string"==typeof e&&new Date(e).toISOString()!==e)return e;const t=i||r?(0,n.J2)(i||"short-date-short-time"):void 0,s=t?{...t,timeZone:a,timeZoneName:l}:void 0;return"string"==typeof e?(0,n.Ey)(e,s):(0,n.Yq)(e,s)}default:{const t=i||r?(0,n.J2)(i||"short-date-short-time"):void 0;return(0,n.Yq)("string"==typeof e?new Date(e):e,t?{...t,timeZone:a,timeZoneName:l}:void 0)}}}},27263:function(e,t,i){i.r(t),i.d(t,{default:function(){return O}});var n=i(82392),r=(i(3438),i(57888)),s=i(15565),o=i(61985),a=i(81482),l=(i(6273),i(80861),i(26325)),c=i(11682),h=i(19264),u=i(34243),p=i(1277);class f{constructor(e,t,i,n,r){this.graphic=e,this.index=t,this.x=i,this.y=n,this.viewEvent=r,this.type="graphic-click"}}class d{constructor(e,t,i,n,r){this.graphic=e,this.index=t,this.x=i,this.y=n,this.viewEvent=r,this.type="graphic-double-click"}}class y{constructor(e,t,i,n,r,s,o,a,l,c){this.graphic=e,this.allGraphics=t,this.index=i,this.x=n,this.y=r,this.dx=s,this.dy=o,this.totalDx=a,this.totalDy=l,this.viewEvent=c,this.defaultPrevented=!1,this.type="graphic-move-start"}preventDefault(){this.defaultPrevented=!0}}class m{constructor(e,t,i,n,r,s,o,a,l,c){this.graphic=e,this.allGraphics=t,this.index=i,this.x=n,this.y=r,this.dx=s,this.dy=o,this.totalDx=a,this.totalDy=l,this.viewEvent=c,this.defaultPrevented=!1,this.type="graphic-move"}preventDefault(){this.defaultPrevented=!0}}class g{constructor(e,t,i,n,r,s,o,a,l,c){this.graphic=e,this.allGraphics=t,this.index=i,this.x=n,this.y=r,this.dx=s,this.dy=o,this.totalDx=a,this.totalDy=l,this.viewEvent=c,this.defaultPrevented=!1,this.type="graphic-move-stop"}preventDefault(){this.defaultPrevented=!0}}class v{constructor(e,t,i,n,r){this.graphic=e,this.index=t,this.x=i,this.y=n,this.viewEvent=r,this.type="graphic-pointer-over"}}class w{constructor(e,t,i,n,r){this.graphic=e,this.index=t,this.x=i,this.y=n,this.viewEvent=r,this.type="graphic-pointer-out"}}class _{constructor(e,t,i,n,r){this.graphic=e,this.index=t,this.x=i,this.y=n,this.viewEvent=r,this.type="graphic-pointer-down"}}class x{constructor(e,t,i,n,r){this.graphic=e,this.index=t,this.x=i,this.y=n,this.viewEvent=r,this.type="graphic-pointer-up"}}var b=i(82795),G=i(83423),I=i(20405),k=i(68231),T=i(24826),M=i(55736);const E="indicator-symbols";let Z=class extends r.A.EventedAccessor{constructor(e){super(e),this._activeGraphic=null,this._dragEvent=null,this._hoverGraphic=null,this._indicators=[],this._initialDragGeometry=null,this._manipulators=[],this._layerViews=null,this.type="graphic-mover",this.callbacks={onGraphicClick(){},onGraphicDoubleClick(){},onGraphicMoveStart(){},onGraphicMove(){},onGraphicMoveStop(){},onGraphicPointerOver(){},onGraphicPointerOut(){},onGraphicPointerDown(){},onGraphicPointerUp(){}},this.enableMoveAllGraphics=!1,this.graphics=[],this.indicatorsEnabled=!1,this.layer=new c.A({listMode:"hide",internal:!0,title:"GraphicMover highlight layer"}),this.view=null}initialize(){(0,p.Y)(this.view,this.layer),this._highlightHelper=new u.A({view:this.view}),this.refresh(),this.addHandles([(0,o.wB)((()=>this.graphics.length),(()=>this.refresh())),(0,o.z7)((()=>this.view?.ready),(()=>{this.addHandles([this.view.on("immediate-click",(e=>this._clickHandler(e)),b.o.TOOL),this.view.on("double-click",(e=>this._doubleClickHandler(e)),b.o.TOOL),this.view.on("pointer-down",(e=>this._pointerDownHandler(e)),b.o.TOOL),this.view.on("pointer-move",(e=>this._pointerMoveHandler(e)),b.o.TOOL),this.view.on("pointer-up",(e=>this._pointerUpHandler(e)),b.o.TOOL),this.view.on("drag",(e=>this._dragHandler(e)),b.o.TOOL),this.view.on("key-down",(e=>this._keyDownHandler(e)),b.o.TOOL)])}),{once:!0,initial:!0}),(0,o.wB)((()=>this.view),(e=>{this._highlightHelper.removeAll(),this._highlightHelper.view=e}))])}destroy(){this._removeIndicators(),this.view.map?.remove(this.layer),this.layer.destroy(),this.reset(),this._manipulators.forEach((e=>e.destroy())),this._manipulators=null}set highlightsEnabled(e){this._highlightHelper?.removeAll(),this._set("highlightsEnabled",e),e&&this._highlightHelper?.add(this.graphics)}get state(){const e=this.view.ready,t=this.graphics.length>0,i=this._activeGraphic;return e&&t?i?"moving":"active":e?"ready":"disabled"}refresh(){this.reset(),this._setup()}reset(){this._activeGraphic=null,this._hoverGraphic=null,this._dragEvent=null,this._highlightHelper.removeAll()}updateGeometry(e,t){const i=this.graphics[e];i&&(i.set("geometry",t),this._setUpIndicators())}_setup(){this._setUpHighlights(),this._setUpIndicators(),this._setUpManipulators(),this._syncLayerViews()}_clickHandler(e){const t=this._findTargetGraphic((0,I.ZV)(e));if(t){const i=new f(t,this.graphics.indexOf(t),e.x,e.y,e);this.emit("graphic-click",i),this.callbacks.onGraphicClick&&this.callbacks.onGraphicClick(i)}}_doubleClickHandler(e){const t=this._findTargetGraphic((0,I.ZV)(e));if(t){const i=new d(t,this.graphics.indexOf(t),e.x,e.y,e);this.emit("graphic-double-click",i),this.callbacks.onGraphicDoubleClick&&this.callbacks.onGraphicDoubleClick(i)}}_pointerDownHandler(e){const t=this._findTargetGraphic((0,I.ZV)(e));if(t){this._activeGraphic=t;const{x:i,y:n}=e,r=new _(t,this.graphics.indexOf(t),i,n,e);this.emit("graphic-pointer-down",r),this.callbacks.onGraphicPointerDown&&this.callbacks.onGraphicPointerDown(r)}else this._activeGraphic=null}_pointerUpHandler(e){if(this._activeGraphic){const{x:t,y:i}=e,n=this.graphics.indexOf(this._activeGraphic),r=new x(this._activeGraphic,n,t,i,e);this.emit("graphic-pointer-up",r),this.callbacks.onGraphicPointerUp&&this.callbacks.onGraphicPointerUp(r)}}_pointerMoveHandler(e){if(this._dragEvent)return;const t=this._findTargetGraphic((0,I.ZV)(e));if(t){const{x:i,y:n}=e;if(this._hoverGraphic){if(this._hoverGraphic===t)return;const r=this.graphics.indexOf(this._hoverGraphic),s=new w(this.graphics[r],r,i,n,e);this._hoverGraphic=null,this.emit("graphic-pointer-out",s),this.callbacks.onGraphicPointerOut&&this.callbacks.onGraphicPointerOut(s)}const r=this.graphics.indexOf(t),s=new v(t,r,i,n,e);return this._hoverGraphic=t,this.emit("graphic-pointer-over",s),void(this.callbacks.onGraphicPointerOver&&this.callbacks.onGraphicPointerOver(s))}if(this._hoverGraphic){const{x:t,y:i}=e,n=this.graphics.indexOf(this._hoverGraphic),r=new w(this.graphics[n],n,t,i,e);this._hoverGraphic=null,this.emit("graphic-pointer-out",r),this.callbacks.onGraphicPointerOut&&this.callbacks.onGraphicPointerOut(r)}}_dragHandler(e){if("start"!==e.action&&!this._dragEvent||!this._activeGraphic?.geometry)return;"start"===e.action&&this._removeIndicators(),e.stopPropagation();const{action:t,x:i,y:n}=e,r=this.graphics.indexOf(this._activeGraphic),o=this._dragEvent?i-this._dragEvent.x:0,a=this._dragEvent?n-this._dragEvent.y:0,l=i-e.origin.x,c=n-e.origin.y,u="start"===t?this._activeGraphic.geometry:this._initialDragGeometry,p=(0,h.lR)(u,l,c,this.view);if(this._activeGraphic.geometry=p,this.enableMoveAllGraphics&&this.graphics.forEach((e=>{e!==this._activeGraphic&&(e.geometry=(0,h.lR)(e.geometry,o,a,this.view))})),this._dragEvent=e,"start"===t){this._initialDragGeometry=(0,s.o8)(u);const t=new y(this._activeGraphic,this.graphics,r,i,n,o,a,l,c,e);this.emit("graphic-move-start",t),this.callbacks.onGraphicMoveStart&&this.callbacks.onGraphicMoveStart(t),t.defaultPrevented&&this._activeGraphic.set("geometry",u)}else if("update"===t){const t=new m(this._activeGraphic,this.graphics,r,i,n,o,a,l,c,e);this.emit("graphic-move",t),this.callbacks.onGraphicMove&&this.callbacks.onGraphicMove(t),t.defaultPrevented&&(this._activeGraphic.geometry=u)}else{const t=new g(this._activeGraphic,this.graphics,r,i,n,o,a,l,c,e);this._dragEvent=null,this._activeGraphic=null,this._setUpIndicators(),this.emit("graphic-move-stop",t),this.callbacks.onGraphicMoveStop&&this.callbacks.onGraphicMoveStop(t),t.defaultPrevented&&(this.graphics[r].set("geometry",this._initialDragGeometry),this._setUpIndicators()),this._initialDragGeometry=null}}_keyDownHandler(e){"a"!==e.key&&"d"!==e.key&&"n"!==e.key||"moving"!==this.state||e.stopPropagation()}_findTargetGraphic(e){const t=this.view.toMap(e),i=this.graphics;let n=null,r=Number.MAX_VALUE;this._syncLayerViews();const s=this._layerViews.flatMap((e=>"graphicsViews"in e?Array.from(e.graphicsViews(),(e=>e.hitTest(t))).flat():e.graphicsView.hitTest(t))).filter((e=>i.includes(e))).sort(((e,t)=>i.indexOf(e)-i.indexOf(t)));return s.length?s[0]:(this._manipulators.forEach((t=>{const i=t.intersectionDistance(e);null!=i&&i<r&&(r=i,n=t.graphic)})),n)}_syncLayerViews(){this._layerViews=[];const e=new Set;for(const t of this.graphics){const i=(0,p.i)(this.view,t.layer);i&&e.add(i)}this._layerViews=[...e]}_setUpManipulators(){const{graphics:e,view:t}=this;this._manipulators.forEach((e=>e.destroy())),this._manipulators=e.length?e.map((e=>new G.l({graphic:e,view:t}))):[]}_setUpHighlights(){this.highlightsEnabled&&this._highlightHelper.add(this.graphics)}_setUpIndicators(){if(this._removeIndicators(),this.indicatorsEnabled){for(const e of this.graphics){const t=e.clone();t.symbol=A(e),this._indicators.push(t),this.addHandles((0,o.wB)((()=>e.symbol),(()=>this._setUpIndicators())),E)}this.layer.addMany(this._indicators)}}_removeIndicators(){this.removeHandles(E),this._indicators.length&&(this.layer.removeMany(this._indicators),this._indicators.forEach((e=>e.destroy())),this._indicators=[])}};function A(e){if(null==e.symbol)return null;switch(e.symbol.type){case"cim":return new k.A({style:"circle",size:12,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}});case"picture-marker":{const{xoffset:t,yoffset:i,height:n,width:r}=e.symbol,s=n===r?r:Math.max(n,r);return new k.A({xoffset:t,yoffset:i,size:s,style:"square",color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}case"simple-marker":{const{xoffset:t,yoffset:i,size:n,style:r}=e.symbol;return new k.A({xoffset:t,yoffset:i,style:"circle"===r?"circle":"square",size:n+2,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}case"simple-fill":return new M.A({color:[0,0,0,0],outline:{style:"dash",color:[255,127,0,1],width:1}});case"simple-line":return new T.A({color:[255,127,0,1],style:"dash",width:1});case"text":{const{xoffset:t,yoffset:i}=e.symbol;return new k.A({xoffset:t,yoffset:i,size:12,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}default:return null}}(0,n._)([(0,a.MZ)()],Z.prototype,"_activeGraphic",void 0),(0,n._)([(0,a.MZ)({readOnly:!0})],Z.prototype,"type",void 0),(0,n._)([(0,a.MZ)()],Z.prototype,"callbacks",void 0),(0,n._)([(0,a.MZ)()],Z.prototype,"enableMoveAllGraphics",void 0),(0,n._)([(0,a.MZ)()],Z.prototype,"graphics",void 0),(0,n._)([(0,a.MZ)({value:!1})],Z.prototype,"highlightsEnabled",null),(0,n._)([(0,a.MZ)()],Z.prototype,"indicatorsEnabled",void 0),(0,n._)([(0,a.MZ)()],Z.prototype,"layer",void 0),(0,n._)([(0,a.MZ)({readOnly:!0})],Z.prototype,"state",null),(0,n._)([(0,a.MZ)()],Z.prototype,"view",void 0),Z=(0,n._)([(0,l.$)("esri.views.draw.support.GraphicMover")],Z);const O=Z},34243:function(e,t,i){i.d(t,{A:function(){return u}});var n=i(82392),r=i(73783),s=i(81482),o=(i(6273),i(80861),i(67498),i(26325)),a=i(1277),l=i(96383),c=i(79687);let h=class extends r.A{constructor(e){super(e),this.view=null}add(e){const t=!e||Array.isArray(e)?e:[e];t?.length&&t.forEach((e=>this._highlight(e)))}remove(e){const t=!e||Array.isArray(e)?e:[e];t?.length&&t.forEach((e=>this._removeHighlight(e)))}removeAll(){this.removeAllHandles()}_highlight(e){const t=(0,a.i)(this.view,e.layer);(0,l.Of)(t)&&this.addHandles(t.highlight(e),(0,c.Fr)(e))}_removeHighlight(e){e&&this.removeHandles((0,c.Fr)(e))}};(0,n._)([(0,s.MZ)()],h.prototype,"view",void 0),h=(0,n._)([(0,o.$)("esri.views.draw.support.HighlightHelper")],h);const u=h},19264:function(e,t,i){i.d(t,{UT:function(){return u},hs:function(){return c},lR:function(){return l},wW:function(){return h}});var n=i(4506),r=i(2532),s=i(70040),o=i(11021);function a(e,t,i,n){if(null==n||e.hasZ||(n=void 0),"point"===e.type)return e.x+=t,e.y+=i,e.hasZ&&null!=n&&(e.z+=n),e;if("multipoint"===e.type){const r=e.points;for(let e=0;e<r.length;e++)r[e]=p(r[e],t,i,n);return e}if("extent"===e.type)return e.xmin+=t,e.xmax+=t,e.ymin+=i,e.ymax+=i,null!=n&&(e.zmin??=0,e.zmin+=n,e.zmax??=0,e.zmax+=n),e;const r=(0,o.$K)(e),s="polyline"===e.type?e.paths:e.rings;for(let e=0;e<r.length;e++){const s=r[e];for(let e=0;e<s.length;e++)s[e]=p(s[e],t,i,n)}return"paths"in e?e.paths=s:e.rings=s,e}function l(e,t,i,n,r){const s=e.clone(),l=n.resolution;if("point"===s.type){if(r)a(s,t*l,-i*l);else{const e=n.state.transform,r=n.state.inverseTransform,o=e[0]*s.x+e[2]*s.y+e[4],a=e[1]*s.x+e[3]*s.y+e[5];s.x=r[0]*(o+t)+r[2]*(a+i)+r[4],s.y=r[1]*(o+t)+r[3]*(a+i)+r[5]}return s}if("multipoint"===s.type){if(r)a(s,t*l,-i*l);else{const e=s.points,r=n.state.transform,o=n.state.inverseTransform;for(let n=0;n<e.length;n++){const s=e[n],a=r[0]*s[0]+r[2]*s[1]+r[4],l=r[1]*s[0]+r[3]*s[1]+r[5],c=o[0]*(a+t)+o[2]*(l+i)+o[4],h=o[1]*(a+t)+o[3]*(l+i)+o[5];e[n]=f(s,c,h,void 0)}}return s}if("extent"===s.type){if(r)a(s,t*l,-i*l);else{const e=n.state.transform,r=n.state.inverseTransform,o=e[0]*s.xmin+e[2]*s.ymin+e[4],a=e[1]*s.xmin+e[3]*s.ymin+e[5],l=e[0]*s.xmax+e[2]*s.ymax+e[4],c=e[1]*s.xmax+e[3]*s.ymax+e[5];s.xmin=r[0]*(o+t)+r[2]*(a+i)+r[4],s.ymin=r[1]*(o+t)+r[3]*(a+i)+r[5],s.xmax=r[0]*(l+t)+r[2]*(c+i)+r[4],s.ymax=r[1]*(l+t)+r[3]*(c+i)+r[5]}return s}if(r)a(s,t*l,-i*l);else{const e=(0,o.$K)(s),r="polyline"===s.type?s.paths:s.rings,a=n.state.transform,l=n.state.inverseTransform;for(let n=0;n<e.length;n++){const r=e[n];for(let e=0;e<r.length;e++){const n=r[e],s=a[0]*n[0]+a[2]*n[1]+a[4],o=a[1]*n[0]+a[3]*n[1]+a[5],c=l[0]*(s+t)+l[2]*(o+i)+l[4],h=l[1]*(s+t)+l[3]*(o+i)+l[5];r[e]=f(n,c,h,void 0)}}"paths"in s?s.paths=r:s.rings=r}return s}function c(e,t,i,n){if("point"===e.type){const{x:r,y:s}=e,o=n?n[0]:r,a=n?n[1]:s,l=e.clone(),c=(r-o)*t+o,h=(s-a)*i+a;return l.x=c,l.y=h,l}if("multipoint"===e.type){const a=(0,o.$K)(e),l=(0,r.vt)(),[c,h,u,p]=(0,s.Yz)(l,[a]),d=n?n[0]:(c+u)/2,y=n?n[1]:(p+h)/2,m=e.clone(),g=m.points;for(let e=0;e<g.length;e++){const n=g[e],[r,s]=n,o=(r-d)*t+d,a=(s-y)*i+y;g[e]=f(n,o,a,void 0)}return m}if("extent"===e.type){const{xmin:r,xmax:s,ymin:o,ymax:a}=e,l=n?n[0]:(r+s)/2,c=n?n[1]:(a+o)/2,h=e.clone();if(h.xmin=(r-l)*t+l,h.ymax=(a-c)*i+c,h.xmax=(s-l)*t+l,h.ymin=(o-c)*i+c,h.xmin>h.xmax){const e=h.xmin,t=h.xmax;h.xmin=t,h.xmax=e}if(h.ymin>h.ymax){const e=h.ymin,t=h.ymax;h.ymin=t,h.ymax=e}return h}const a=(0,o.$K)(e),l=(0,r.vt)(),[c,h,u,p]=(0,s.Yz)(l,a),d=n?n[0]:(c+u)/2,y=n?n[1]:(p+h)/2,m=e.clone(),g="polyline"===m.type?m.paths:m.rings;for(let e=0;e<a.length;e++){const n=a[e];for(let r=0;r<n.length;r++){const s=n[r],[o,a]=s,l=(o-d)*t+d,c=(a-y)*i+y;g[e][r]=f(s,l,c,void 0)}}return"paths"in m?m.paths=g:m.rings=g,m}function h(e,t,i,n,r,s){const o=Math.sqrt((i-e)*(i-e)+(n-t)*(n-t));return Math.sqrt((r-e)*(r-e)+(s-t)*(s-t))/o}function u(e,t,i,r=!1){const s=Math.atan2(t.y-i.y,t.x-i.x)-Math.atan2(e.y-i.y,e.x-i.x),o=Math.atan2(Math.sin(s),Math.cos(s));return r?o:(0,n.KJ)(o)}function p(e,t,i,n){return f(e,e[0]+t,e[1]+i,null!=e[2]&&null!=n?e[2]+n:void 0)}function f(e,t,i,n){const r=[t,i];return e.length>2&&r.push(null!=n?n:e[2]),e.length>3&&r.push(e[3]),r}},79687:function(e,t,i){i.d(t,{A4:function(){return Z},AB:function(){return k},Ao:function(){return ne},CS:function(){return P},DU:function(){return Q},Fr:function(){return ce},JF:function(){return I},MK:function(){return L},Tt:function(){return M},Uu:function(){return Y},a$:function(){return S},bG:function(){return J},bV:function(){return E},c3:function(){return X},cS:function(){return se},gd:function(){return H},kX:function(){return T},ld:function(){return j},lm:function(){return R},n_:function(){return V},q6:function(){return re},s$:function(){return W},sS:function(){return q},u2:function(){return D},x1:function(){return B},xL:function(){return A},yY:function(){return oe}});var n=i(6273),r=i(80861),s=i(21332),o=i(50189),a=i(18632),l=i(46227),c=i(65452),h=i(74274),u=i(83911),p=i(23375);const f=()=>r.A.getLogger("esri.widgets.Feature.support.featureUtils"),d=/href=(""|'')/gi,y=/(\{([^{\r\n]+)\})/g,m=/'/g,g=/^\s*expression\//i,v=/(\n)/gi,w=/[\u00A0-\u9999<>&]/gim,_=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,x=/^(?:mailto:|tel:)/,b="relationships/",G=(0,o.J2)("short-date-short-time");function I(e){if(null!=e)return(e.sourceLayer||e.layer)??void 0}async function k({type:e,value:t,event:i}){try{return"function"==typeof t?t(i):await t}catch(n){return void f().error("error",`An error occurred when calling the "${e}" function`,{error:n,graphic:i.graphic,value:t})}}function T(e=""){if(e)return!x.test(e.trim().toLowerCase())}function M(e){return!!e&&g.test(e)}function E(e,t){const i=function(e,t){if(!t||!M(t)||!e)return;const i=t.replace(g,"").toLowerCase();return e.find((({name:e})=>e.toLowerCase()===i))}(t,e?.fieldName);return i?i.title||null:e?e.label||e.fieldName:null}function Z(e,t){const i=O(t,e);return i?i.name:e}function A(e,t){return e&&e.map((e=>Z(e,t)))}function O(e,t){return e&&"function"==typeof e.getField&&t?e.getField(t)??null:null}function F(e){return`${e}`.trim()}function D({attributes:e,globalAttributes:t,layer:i,text:n,expressionAttributes:r,fieldInfoMap:s}){return n?H({formattedAttributes:t,template:N(n,{...t,...r,...e},i),fieldInfoMap:s}):""}function H({formattedAttributes:e,template:t,fieldInfoMap:i}){return F(function(e){return e.replaceAll(d,"")}((0,s.HC)((0,s.HC)(t,(e=>function(e,t){const i=t.get(e.toLowerCase());return`{${i?.fieldName||e}}`}(e,i))),e)))}function U(e,t=!1){const i={...e};return Object.keys(i).forEach((e=>function(e,t,i=!1){const n=t[e];if("string"==typeof n){const r="%27",s=(i?encodeURIComponent(n):n).replaceAll(m,r);t[e]=s}}(e,i,t))),i}function L(e,t){return e.replaceAll(y,((e,i,n)=>{const r=O(t,n);return r?`{${r.name}}`:i}))}function N(e,t,i){const n=L(e,i);return n?n.replaceAll(_,((e,i,n)=>function(e,t,i){const n=(t=F(t))&&"{"!==t[0];return(0,s.HC)(e,U(i,n||!1))}(e,i||n,t))):n}function C(e){return null!=e&&"object"==typeof e&&"fieldsIndex"in e&&"geometryType"in e&&"getField"in e&&"load"in e&&"loaded"in e&&"objectIdField"in e&&"spatialReference"in e&&"type"in e&&("feature"===e.type||"scene"===e.type||"subtype-sublayer"===e.type||"sublayer"===e.type)&&"when"in e}function q(e){return C(e)&&function(e){return null!=e&&"object"==typeof e&&"createQuery"in e&&"queryFeatureCount"in e&&"queryObjectIds"in e&&"queryRelatedFeatures"in e&&"queryRelatedFeaturesCount"in e&&"relationships"in e}(e)}function P(e){return C(e)&&function(e){return!!(e&&"object"==typeof e&&"createQuery"in e&&"queryFeatureCount"in e&&"type"in e)&&("subtype-sublayer"===e.type&&"parent"in e&&e.parent&&"object"==typeof e.parent?"globalIdField"in e.parent:"globalIdField"in e)}(e)}function $(e,t){const{fieldInfos:i,fieldName:n,preventPlacesFormatting:r,layer:s,timeZone:o}=t,c=R(i,n),u=O(s,n);if(c&&!(0,l.JL)(n)){const t=u?.type,i=c.format?.dateFormat;if("date"===t||"date-only"===t||"time-only"===t||"timestamp-offset"===t||i)return(0,h.i0)(e,{format:i,fieldType:t,timeZoneOptions:{layerTimeZone:s&&"preferredTimeZone"in s?s.preferredTimeZone:null,viewTimeZone:o,datesInUnknownTimezone:!(!s||!("datesInUnknownTimezone"in s)||!s.datesInUnknownTimezone)}})}const p=c?.format;return"string"==typeof e&&(0,l.JL)(n)&&p?function(e,t){return e=e.trim(),/\d{2}-\d{2}/.test(e)?e:e.includes(",")?z(e,",",", ",t):e.includes(";")?z(e,";","; ",t):e.includes(" ")?z(e," "," ",t):(0,a.ZV)(Number(e),(0,a.yx)(t))}(e,p):"string"==typeof(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){const t=Number(e);if(!isNaN(t))return t}return e}(e,p))||null==e||null==p?Y(e):(0,a.ZV)(e,r?{...(0,a.yx)(p),minimumFractionDigits:0,maximumFractionDigits:20}:(0,a.yx)(p))}function z(e,t,i,n){return e.trim().split(t).map((e=>(0,a.ZV)(Number(e),(0,a.yx)(n)))).join(i)}function R(e,t){if(e?.length&&t)return e.find((e=>e.fieldName?.toLowerCase()===t.toLowerCase()))}function S(e,t,i,n){const{creatorField:r,creationDateField:s,editorField:a,editDateField:l}=e;if(!t)return;const c=(0,p.hv)(n&&"preferredTimeZone"in n?n.preferredTimeZone:null,!(!n||!("datesInUnknownTimezone"in n)||!n.datesInUnknownTimezone),i,G,"date"),h={...G,...c},u=t[l];if("number"==typeof u){const e=t[a];return{type:"edit",date:(0,o.Yq)(u,h),user:e}}const f=t[s];if("number"==typeof f){const e=t[r];return{type:"create",date:(0,o.Yq)(f,h),user:e}}return null}function V(e,t){const i=new Map;if(!e)return i;for(const n of e){if(!n.fieldName)continue;const e=Z(n.fieldName,t);n.fieldName=e,i.set(e.toLowerCase(),n)}return i}function j(e){const t=[];if(!e)return t;const{fieldInfos:i,content:n}=e;return i&&t.push(...i),n&&Array.isArray(n)?(n.forEach((e=>{if("fields"===e.type){const i=e?.fieldInfos;i&&t.push(...i)}})),t):t}function J(e){return e.replaceAll(w,(e=>`&#${e.charCodeAt(0)};`))}function Y(e){return"string"==typeof e?e.replaceAll(v,'<br class="esri-text-new-line" />'):e}function K(e){const{value:t,fieldName:i,fieldInfos:r,fieldInfoMap:s,layer:o,graphic:a,timeZone:c}=e;if(null==t)return"";const u=function({fieldName:e,value:t,graphic:i,layer:r}){if(W(e))return null;if(!r||"function"!=typeof r.getFieldDomain)return null;const s=i&&r.getFieldDomain(e,{feature:i,excludeImpliedDomains:(0,n.A)("esri-widget-legacy-field-domain-calculation")});return s&&"coded-value"===s.type?s.getName(t):null}({fieldName:i,value:t,graphic:a,layer:o});if(u)return u;const p=function({fieldName:e,graphic:t,layer:i}){if(W(e))return null;if(!i||"function"!=typeof i.getFeatureType)return null;const{typeIdField:n}=i;if(!n||e!==n)return null;const r=i.getFeatureType(t);return r?r.name:null}({fieldName:i,graphic:a,layer:o});if(p)return p;if(s.get(i.toLowerCase()))return $(t,{fieldInfos:r||Array.from(s.values()),fieldName:i,layer:o,timeZone:c});const f=o?.fieldsIndex?.get(i);return f&&((0,h.fs)(f)||(0,l.OH)(f))?(0,h.i0)(t,{fieldType:f.type,timeZoneOptions:{layerTimeZone:o&&"preferredTimeZone"in o?o.preferredTimeZone:null,viewTimeZone:c,datesInUnknownTimezone:!(!o||!("datesInUnknownTimezone"in o)||!o.datesInUnknownTimezone)}}):Y(t)}function B({fieldInfos:e,attributes:t,layer:i,graphic:n,fieldInfoMap:r,relatedInfos:s,timeZone:o}){const a={};return s?.forEach((t=>function({attributes:e,relatedInfo:t,fieldInfoMap:i,fieldInfos:n,layer:r,timeZone:s}){e&&t&&(t.relatedFeatures?.forEach((o=>ee({attributes:e,graphic:o,relatedInfo:t,fieldInfoMap:i,fieldInfos:n,layer:r,timeZone:s}))),t.relatedStatsFeatures?.forEach((o=>ee({attributes:e,graphic:o,relatedInfo:t,fieldInfoMap:i,fieldInfos:n,layer:r,timeZone:s}))))}({attributes:a,relatedInfo:t,fieldInfoMap:r,fieldInfos:e,layer:i,timeZone:o}))),t&&Object.keys(t).forEach((s=>{const l=t[s];a[s]=K({fieldName:s,fieldInfos:e,fieldInfoMap:r,layer:i,value:l,graphic:n,timeZone:o})})),a}async function Q(e,t){const{layer:i,graphic:n,outFields:r,objectIds:s,returnGeometry:o,spatialReference:a}=e,l=s[0];if("number"!=typeof l&&"string"!=typeof l){const e="Could not query required fields for the specified feature. The feature's ID is invalid.",t={layer:i,graphic:n,objectId:l,requiredFields:r};return f().warn(e,t),null}if(!(0,c.BR)(i)?.operations?.supportsQuery){const e="The specified layer cannot be queried. The following fields will not be available.",t={layer:i,graphic:n,requiredFields:r,returnGeometry:o};return f().warn(e,t),null}const h=i.createQuery();return h.objectIds=s,h.outFields=r?.length?r:[i.objectIdField],h.returnGeometry=!!o,h.returnZ=!!o,h.returnM=!!o,h.outSpatialReference=a,(await i.queryFeatures(h,t)).features[0]}async function X({graphic:e,popupTemplate:t,layer:i,spatialReference:n},r){if(!i||!t)return;if("function"==typeof i.load&&await i.load(r),!e.attributes)return;const s=i.objectIdField,o=e.attributes[s];if(null==o)return;const a=[o],c=await t.getRequiredFields(i.fieldsIndex),h=(0,l.Kl)(c,e),p=h?[]:c.includes(s)?c:[...c,s],f=t.returnGeometry||await async function(e){if(!e.expressionInfos?.length)return!1;const t=await(0,u.lw)(),{arcadeUtils:{hasGeometryFunctions:i}}=t;return i(e)}(t);if(h&&!f)return;const d=await Q({layer:i,graphic:e,outFields:p,objectIds:a,returnGeometry:f,spatialReference:n},r);d&&(d.geometry&&(e.geometry=d.geometry),d.attributes&&(e.attributes={...e.attributes,...d.attributes}))}function W(e=""){return!!e&&e.includes(b)}function ee({attributes:e,graphic:t,relatedInfo:i,fieldInfos:n,fieldInfoMap:r,layer:s,timeZone:o}){e&&t&&i&&Object.keys(t.attributes).forEach((a=>{const l=function(e){return e?`${b}${e.layerId}/${e.fieldName}`:""}({layerId:i.relation.id.toString(),fieldName:a}),c=t.attributes[a];e[l]=K({fieldName:l,fieldInfos:n,fieldInfoMap:r,layer:s,value:c,graphic:t,timeZone:o})}))}const te=e=>{if(!e)return!1;const t=e.toUpperCase();return t.includes("CURRENT_TIMESTAMP")||t.includes("CURRENT_DATE")||t.includes("CURRENT_TIME")},ie=({layer:e,method:t,query:i,definitionExpression:n})=>{if(!e.capabilities?.query?.supportsCacheHint||"attachments"===t)return;const r=null!=i.where?i.where:null,s=null!=i.geometry?i.geometry:null;te(n)||te(r)||"extent"===s?.type||"tile"===i.resultType||(i.cacheHint=!0)},ne=({query:e,layer:t,method:i})=>{ie({layer:t,method:i,query:e,definitionExpression:`${t.definitionExpression} ${t.serviceDefinitionExpression??""}`})},re=({queryPayload:e,layer:t,method:i})=>{ie({layer:t,method:i,query:e,definitionExpression:`${t.definitionExpression} ${t.serviceDefinitionExpression??""}`})};function se(e,t,i){return e&&t&&i?"sublayer"===t.type?le({layers:t.layer?.sublayers,map:e,relatedLayer:t,relationship:i})||le({layers:t.layer?.subtables,map:e,relatedLayer:t,relationship:i}):le({layers:e.allLayers,map:e,relatedLayer:t,relationship:i})||le({layers:e.allTables,map:e,relatedLayer:t,relationship:i}):null}function oe(e,t){return e&&"utilityNetworks"in e&&t?e.utilityNetworks?.find((e=>e.isUtilityLayer(t))):null}function ae(e,t){return e?.allTables.find((e=>"feature"===e.type&&e.layerId===t.id&&e.url===t.layer?.url))}function le({map:e,relationship:t,relationship:{relatedTableId:i},relatedLayer:n,layers:r}){if(!r)return null;for(const s of r){if("map-image"===s.type){const i=le({layers:s.sublayers,map:e,relatedLayer:n,relationship:t})||le({layers:s.subtables,map:e,relatedLayer:n,relationship:t});if(i)return i;continue}if(!q(s))continue;if("sublayer"===n.type){if(s!==n&&s.id===i)return s.isTable?ae(e,s):s;continue}const r="scene"===n.type&&n.associatedLayer?n.associatedLayer.url:n.url;if(!r)return null;if("sublayer"!==s.type){if(s!==n&&s.url===r&&s.layerId===i)return s}else if(s!==n&&s.layer?.url===r&&s.id===i)return s.isTable?ae(e,s):s}return null}function ce(e){const t=e.getObjectId();return null!=t?`oid:${t}`:`uid:${e.uid}`}}}]);
//# sourceMappingURL=7263.5bc9f7f9c139d30e96cc.js.map