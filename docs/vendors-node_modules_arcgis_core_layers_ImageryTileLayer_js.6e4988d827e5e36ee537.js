"use strict";
(self["webpackChunkreact_redux_arcgis_boilerplate"] = self["webpackChunkreact_redux_arcgis_boilerplate"] || []).push([["vendors-node_modules_arcgis_core_layers_ImageryTileLayer_js"],{

/***/ "./node_modules/@arcgis/core/core/ByteSizeUnit.js":
/*!********************************************************!*\
  !*** ./node_modules/@arcgis/core/core/ByteSizeUnit.js ***!
  \********************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ByteSizeUnit: function() { return /* binding */ E; }
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
var E;!function(E){E[E.KILOBYTES=1024]="KILOBYTES",E[E.MEGABYTES=1048576]="MEGABYTES",E[E.GIGABYTES=1073741824]="GIGABYTES"}(E||(E={}));


/***/ }),

/***/ "./node_modules/@arcgis/core/geometry/support/UintArray.js":
/*!*****************************************************************!*\
  !*** ./node_modules/@arcgis/core/geometry/support/UintArray.js ***!
  \*****************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   newUintArray: function() { return /* binding */ n; },
/* harmony export */   uintSubArray: function() { return /* binding */ e; }
/* harmony export */ });
/* harmony import */ var _core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/typedArrayUtil.js */ "./node_modules/@arcgis/core/core/typedArrayUtil.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
function n(n,e=!1){return n<=_core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_0__.nativeArrayMaxSize?e?new Array(n).fill(0):new Array(n):new Uint32Array(n)}function e(r,n,e){return Array.isArray(r)?r.slice(n,n+e):r.subarray(n,n+e)}


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/ImageryTileLayer.js":
/*!**************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/ImageryTileLayer.js ***!
  \**************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ J; }
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _PopupTemplate_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../PopupTemplate.js */ "./node_modules/@arcgis/core/PopupTemplate.js");
/* harmony import */ var _core_Clonable_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../core/Clonable.js */ "./node_modules/@arcgis/core/core/Clonable.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_MultiOriginJSONSupport_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../core/MultiOriginJSONSupport.js */ "./node_modules/@arcgis/core/core/MultiOriginJSONSupport.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../core/reactiveUtils.js */ "./node_modules/@arcgis/core/core/reactiveUtils.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../core/accessorSupport/ensureType.js */ "./node_modules/@arcgis/core/core/accessorSupport/ensureType.js");
/* harmony import */ var _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../core/RandomLCG.js */ "./node_modules/@arcgis/core/core/RandomLCG.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _Layer_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./Layer.js */ "./node_modules/@arcgis/core/layers/Layer.js");
/* harmony import */ var _mixins_ArcGISService_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./mixins/ArcGISService.js */ "./node_modules/@arcgis/core/layers/mixins/ArcGISService.js");
/* harmony import */ var _mixins_BlendLayer_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./mixins/BlendLayer.js */ "./node_modules/@arcgis/core/layers/mixins/BlendLayer.js");
/* harmony import */ var _mixins_CustomParametersMixin_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./mixins/CustomParametersMixin.js */ "./node_modules/@arcgis/core/layers/mixins/CustomParametersMixin.js");
/* harmony import */ var _mixins_ImageryTileMixin_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./mixins/ImageryTileMixin.js */ "./node_modules/@arcgis/core/layers/mixins/ImageryTileMixin.js");
/* harmony import */ var _mixins_OperationalLayer_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./mixins/OperationalLayer.js */ "./node_modules/@arcgis/core/layers/mixins/OperationalLayer.js");
/* harmony import */ var _mixins_PortalLayer_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./mixins/PortalLayer.js */ "./node_modules/@arcgis/core/layers/mixins/PortalLayer.js");
/* harmony import */ var _mixins_RasterPresetRendererMixin_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./mixins/RasterPresetRendererMixin.js */ "./node_modules/@arcgis/core/layers/mixins/RasterPresetRendererMixin.js");
/* harmony import */ var _mixins_RefreshableLayer_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./mixins/RefreshableLayer.js */ "./node_modules/@arcgis/core/layers/mixins/RefreshableLayer.js");
/* harmony import */ var _mixins_ScaleRangeLayer_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./mixins/ScaleRangeLayer.js */ "./node_modules/@arcgis/core/layers/mixins/ScaleRangeLayer.js");
/* harmony import */ var _mixins_TemporalLayer_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./mixins/TemporalLayer.js */ "./node_modules/@arcgis/core/layers/mixins/TemporalLayer.js");
/* harmony import */ var _support_commonProperties_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./support/commonProperties.js */ "./node_modules/@arcgis/core/layers/support/commonProperties.js");
/* harmony import */ var _support_Field_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./support/Field.js */ "./node_modules/@arcgis/core/layers/support/Field.js");
/* harmony import */ var _support_RasterFunction_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./support/RasterFunction.js */ "./node_modules/@arcgis/core/layers/support/RasterFunction.js");
/* harmony import */ var _support_rasterDatasets_FunctionRaster_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./support/rasterDatasets/FunctionRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/FunctionRaster.js");
/* harmony import */ var _support_rasterDatasets_RasterFactory_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./support/rasterDatasets/RasterFactory.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/RasterFactory.js");
/* harmony import */ var _support_rasterFunctions_rasterFunctionHelper_js__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./support/rasterFunctions/rasterFunctionHelper.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/rasterFunctionHelper.js");
/* harmony import */ var _support_popupUtils_js__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../support/popupUtils.js */ "./node_modules/@arcgis/core/support/popupUtils.js");
/* harmony import */ var _webdoc_interfaces_js__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../webdoc/interfaces.js */ "./node_modules/@arcgis/core/webdoc/interfaces.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
let L=class extends((0,_mixins_BlendLayer_js__WEBPACK_IMPORTED_MODULE_15__.BlendLayer)((0,_mixins_ScaleRangeLayer_js__WEBPACK_IMPORTED_MODULE_22__.ScaleRangeLayer)((0,_mixins_OperationalLayer_js__WEBPACK_IMPORTED_MODULE_18__.OperationalLayer)((0,_mixins_PortalLayer_js__WEBPACK_IMPORTED_MODULE_19__.PortalLayer)((0,_mixins_RasterPresetRendererMixin_js__WEBPACK_IMPORTED_MODULE_20__.RasterPresetRendererMixin)((0,_mixins_CustomParametersMixin_js__WEBPACK_IMPORTED_MODULE_16__.CustomParametersMixin)((0,_mixins_ImageryTileMixin_js__WEBPACK_IMPORTED_MODULE_17__.ImageryTileMixin)((0,_mixins_TemporalLayer_js__WEBPACK_IMPORTED_MODULE_23__.TemporalLayer)((0,_mixins_ArcGISService_js__WEBPACK_IMPORTED_MODULE_14__.ArcGISService)((0,_mixins_RefreshableLayer_js__WEBPACK_IMPORTED_MODULE_21__.RefreshableLayer)((0,_core_MultiOriginJSONSupport_js__WEBPACK_IMPORTED_MODULE_5__.MultiOriginJSONMixin)((0,_core_Clonable_js__WEBPACK_IMPORTED_MODULE_2__.ClonableMixin)(_Layer_js__WEBPACK_IMPORTED_MODULE_13__["default"]))))))))))))){constructor(...e){super(...e),this._primaryRasters=[],this.legendEnabled=!0,this.isReference=null,this.listMode="show",this.sourceJSON=null,this.version=null,this.type="imagery-tile",this.operationalLayerType="ArcGISTiledImageServiceLayer",this.popupEnabled=!0,this.popupTemplate=null,this.fields=null,this.source=void 0,this._debouncedSaveOperations=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.debounce)((async(e,t,r)=>{const{save:s,saveAs:i}=await __webpack_require__.e(/*! import() */ "node_modules_arcgis_core_layers_save_imageryUtils_js").then(__webpack_require__.bind(__webpack_require__, /*! ./save/imageryUtils.js */ "./node_modules/@arcgis/core/layers/save/imageryUtils.js"));switch(e){case _webdoc_interfaces_js__WEBPACK_IMPORTED_MODULE_31__.SaveOperationType.SAVE:return s(this,t);case _webdoc_interfaces_js__WEBPACK_IMPORTED_MODULE_31__.SaveOperationType.SAVE_AS:return i(this,r,t)}}))}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}load(e){const t=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},e).catch(_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.throwIfAbortError).then((()=>this._openRaster(t)))),Promise.resolve(this)}get defaultPopupTemplate(){return this.createPopupTemplate()}get rasterFields(){const e=[new _support_Field_js__WEBPACK_IMPORTED_MODULE_25__["default"]({name:"Raster.ServicePixelValue",alias:"Pixel Value",domain:null,editable:!1,length:50,type:"string"}),new _support_Field_js__WEBPACK_IMPORTED_MODULE_25__["default"]({name:"Raster.ServicePixelValue.Raw",alias:"Raw Pixel Value",domain:null,editable:!1,length:50,type:"string"})],t=this.raster?.rasterInfo??this.serviceRasterInfo,r=t?.attributeTable,s=null!=r?r.fields:null,i="Raster.";if(s){const t=s.filter((e=>"oid"!==e.type&&"value"!==e.name.toLowerCase())).map((e=>{const t=e.clone();return t.name=i+e.name,t}));e.push(...t)}const o=t?.dataType,a=t?.multidimensionalInfo;if(("vector-magdir"===o||"vector-uv"===o)&&null!=a){const t=a.variables[0].unit?.trim(),r="Magnitude"+(t?` (${t})`:"");e.push(new _support_Field_js__WEBPACK_IMPORTED_MODULE_25__["default"]({name:"Raster.Magnitude",alias:r,domain:null,editable:!1,type:"double"})),e.push(new _support_Field_js__WEBPACK_IMPORTED_MODULE_25__["default"]({name:"Raster.Direction",alias:"Direction (°)",domain:null,editable:!1,type:"double"}))}return e}createPopupTemplate(e){const{rasterFields:t}=this,r=e?.visibleFieldNames??new Set(t.map((({name:e})=>e)).filter((e=>"raster.servicepixelvalue.raw"!==e.toLowerCase()))),s=(0,_support_popupUtils_js__WEBPACK_IMPORTED_MODULE_30__.createPopupTemplate)({fields:t,title:this.title},{...e,visibleFieldNames:r}),{rasterInfo:i}=this.raster;return s?.fieldInfos&&i?.pixelType.startsWith("f")&&s.fieldInfos.forEach((({format:e,fieldName:t})=>{e&&t&&/^raster\.(item|service)pixelvalue/i.test(t)&&(e.places=2)})),s}async generateRasterInfo(e,t){if(e=(0,_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_9__.ensureClass)(_support_RasterFunction_js__WEBPACK_IMPORTED_MODULE_26__["default"],e),await this.load(),!e||"none"===e.functionName?.toLowerCase())return this.serviceRasterInfo;try{const{rasterInfo:r}=await this._openFunctionRaster(e,t);return r}catch(r){if(r instanceof _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"])throw r;throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"]("imagery-tile-layer","the given raster function is not supported")}}async save(e){return this._debouncedSaveOperations(_webdoc_interfaces_js__WEBPACK_IMPORTED_MODULE_31__.SaveOperationType.SAVE,e)}async saveAs(e,t){return this._debouncedSaveOperations(_webdoc_interfaces_js__WEBPACK_IMPORTED_MODULE_31__.SaveOperationType.SAVE_AS,t,e)}write(e,t){const r=this._primaryRasters[0]??this.raster;if(this.loaded?"RasterTileServer"===r.datasetFormat&&("Raster"===r.tileType||"Map"===r.tileType):this.url&&/\/ImageServer(\/|\/?$)/i.test(this.url))return super.write(e,t);if(t?.messages){const e=`${t.origin}/${t.layerContainerType||"operational-layers"}`;t.messages.push(new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"]("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${e}'`,{layer:this}))}return null}async _openRaster(e){let t=!1;if(this.raster)await this._openFromRaster(this.raster,e),t="Function"===this.raster.datasetFormat,!t&&this.rasterFunction&&(this._primaryRasters=[this.raster],await this._initializeWithFunctionRaster(this.rasterFunction));else{const{url:t,rasterFunction:r,source:i}=this;if(!t&&!i)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"]("imagery-tile-layer:open","missing url or source parameter");i?await this._openFromSource(i,e):r?await this._openFromUrlWithRasterFunction(t,r,e):await this._openFromUrl(t,e)}const r=this.raster.rasterInfo;if(!r)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"]("imagery-tile-layer:load","cannot load resources on "+this.url);if(this._set("serviceRasterInfo",t?r:this._primaryRasters[0].rasterInfo),this._set("spatialReference",r.spatialReference),this.sourceJSON=this.sourceJSON||this.raster.sourceJSON,null!=this.sourceJSON){const e="Map"===this.raster.tileType&&null!=this.sourceJSON.minLOD&&null!=this.sourceJSON.maxLOD?this.sourceJSON:{...this.sourceJSON,minScale:0,maxScale:0};this.read(e,{origin:"service"})}else this.read({tileInfo:this.serviceRasterInfo?.storageInfo.tileInfo.toJSON()},{origin:"service"});this.title||(this.title=this.raster.datasetName),"Map"===this.raster.tileType&&(this.popupEnabled=!1),this._configDefaultSettings(),this.addHandles((0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_7__.watch)((()=>this.customParameters),(e=>{this.raster&&(this.raster.ioConfig.customFetchParameters=e)})))}async _openFromRaster(e,t){e.rasterInfo||await e.open({signal:t}),this._primaryRasters="Function"===e.datasetFormat?e.primaryRasters.rasters:[e],this.url||(this.url=this._primaryRasters[0].url)}async _openFromUrlWithRasterFunction(e,t,r){const i=[e];t&&(0,_support_rasterFunctions_rasterFunctionHelper_js__WEBPACK_IMPORTED_MODULE_29__.getPrimaryRasterUrls)(t.toJSON(),i);const o=await Promise.all(i.map((e=>_support_rasterDatasets_RasterFactory_js__WEBPACK_IMPORTED_MODULE_28__["default"].open({url:e,sourceJSON:this.sourceJSON,ioConfig:{sampling:"closest",...this.ioConfig,customFetchParameters:this.customParameters},signal:r})))),a=o.findIndex((e=>null==e));if(a>-1)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"]("imagery-tile-layer:open",`cannot open raster: ${i[a]}`);return this._primaryRasters=o,this._initializeWithFunctionRaster(t)}async _openFromUrl(e,t){const r=await _support_rasterDatasets_RasterFactory_js__WEBPACK_IMPORTED_MODULE_28__["default"].open({url:e,sourceJSON:this.sourceJSON,ioConfig:{sampling:"closest",...this.ioConfig,customFetchParameters:this.customParameters},signal:t});if(null==r)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"]("imagery-tile-layer:open",`cannot open raster: ${e}`);this._primaryRasters=[r],this.raster=r}async _openFromSource(e,t){const r="the tiled imagery data source is not supported",i="coverage"===e.type?.toLowerCase()?"CovJSON":e.extent&&e.pixelBlock?"MEMORY":null;if(!i)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"]("imagery-tile-layer:open",r);"MEMORY"===i&&(e={...e,pixelBlock:void 0,pixelBlocks:[e.pixelBlock]});const o=await _support_rasterDatasets_RasterFactory_js__WEBPACK_IMPORTED_MODULE_28__["default"].open({url:"",source:e,datasetFormat:i,ioConfig:{sampling:"closest",...this.ioConfig,customFetchParameters:this.customParameters},signal:t});if(null==o)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"]("imagery-tile-layer:open",r);this._primaryRasters=[o],this.rasterFunction?await this._initializeWithFunctionRaster(this.rasterFunction):this.raster=o}async _openFunctionRaster(e,t){const r={raster:this._primaryRasters[0]};this._primaryRasters.length>1&&this._primaryRasters.forEach((e=>r[e.url]=e));const s=(0,_support_rasterFunctions_rasterFunctionHelper_js__WEBPACK_IMPORTED_MODULE_29__.create)(e.functionDefinition?.toJSON()??e.toJSON(),r),i=new _support_rasterDatasets_FunctionRaster_js__WEBPACK_IMPORTED_MODULE_27__["default"]({rasterFunction:s});return await i.open(t),i}async _initializeWithFunctionRaster(e,t){try{this.raster=await this._openFunctionRaster(e,t)}catch(r){r instanceof _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"]&&_core_Logger_js__WEBPACK_IMPORTED_MODULE_4__["default"].getLogger(this).error("imagery-tile-layer:open",r.message),_core_Logger_js__WEBPACK_IMPORTED_MODULE_4__["default"].getLogger(this).warn("imagery-tile-layer:open","the raster function cannot be applied and is removed"),this._set("rasterFunction",null),this.raster=this._primaryRasters[0]}}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_8__.property)({clonable:!1})],L.prototype,"_primaryRasters",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_8__.property)(_support_commonProperties_js__WEBPACK_IMPORTED_MODULE_24__.legendEnabled)],L.prototype,"legendEnabled",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_8__.property)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],L.prototype,"isReference",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_8__.property)({type:["show","hide"]})],L.prototype,"listMode",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_8__.property)({json:{read:!0,write:!0}})],L.prototype,"blendMode",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_8__.property)()],L.prototype,"sourceJSON",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_8__.property)({readOnly:!0,json:{origins:{service:{read:{source:"currentVersion"}}}}})],L.prototype,"version",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_8__.property)({readOnly:!0,json:{read:!1}})],L.prototype,"type",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_8__.property)({type:["ArcGISTiledImageServiceLayer"]})],L.prototype,"operationalLayerType",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_8__.property)({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader:(e,t)=>!t.disablePopup},write:{target:"disablePopup",overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}},writer(e,t,r){t[r]=!e}}}})],L.prototype,"popupEnabled",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_8__.property)({type:_PopupTemplate_js__WEBPACK_IMPORTED_MODULE_1__["default"],json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}}}}})],L.prototype,"popupTemplate",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_8__.property)({readOnly:!0})],L.prototype,"defaultPopupTemplate",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_8__.property)({readOnly:!0,type:[_support_Field_js__WEBPACK_IMPORTED_MODULE_25__["default"]]})],L.prototype,"fields",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_8__.property)({readOnly:!0,type:[_support_Field_js__WEBPACK_IMPORTED_MODULE_25__["default"]]})],L.prototype,"rasterFields",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_8__.property)({constructOnly:!0})],L.prototype,"source",void 0),L=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_12__.subclass)("esri.layers.ImageryTileLayer")],L);const J=L;


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/mixins/ImageryTileMixin.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/mixins/ImageryTileMixin.js ***!
  \*********************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ImageryTileMixin: function() { return /* binding */ K; }
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _geometry_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../geometry.js */ "./node_modules/@arcgis/core/geometry.js");
/* harmony import */ var _rasterRenderers_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../rasterRenderers.js */ "./node_modules/@arcgis/core/rasterRenderers.js");
/* harmony import */ var _request_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../request.js */ "./node_modules/@arcgis/core/request.js");
/* harmony import */ var _core_deprecate_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/deprecate.js */ "./node_modules/@arcgis/core/core/deprecate.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/accessorSupport/ensureType.js */ "./node_modules/@arcgis/core/core/accessorSupport/ensureType.js");
/* harmony import */ var _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../core/RandomLCG.js */ "./node_modules/@arcgis/core/core/RandomLCG.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_accessorSupport_decorators_enumeration_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../core/accessorSupport/decorators/enumeration.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/enumeration.js");
/* harmony import */ var _core_accessorSupport_decorators_reader_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../core/accessorSupport/decorators/reader.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/reader.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../geometry/support/spatialReferenceUtils.js */ "./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js");
/* harmony import */ var _support_arcgisLayerUrl_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../support/arcgisLayerUrl.js */ "./node_modules/@arcgis/core/layers/support/arcgisLayerUrl.js");
/* harmony import */ var _support_commonProperties_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../support/commonProperties.js */ "./node_modules/@arcgis/core/layers/support/commonProperties.js");
/* harmony import */ var _support_DimensionalDefinition_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../support/DimensionalDefinition.js */ "./node_modules/@arcgis/core/layers/support/DimensionalDefinition.js");
/* harmony import */ var _support_MultidimensionalSubset_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../support/MultidimensionalSubset.js */ "./node_modules/@arcgis/core/layers/support/MultidimensionalSubset.js");
/* harmony import */ var _support_rasterEnums_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../support/rasterEnums.js */ "./node_modules/@arcgis/core/layers/support/rasterEnums.js");
/* harmony import */ var _support_RasterFunction_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../support/RasterFunction.js */ "./node_modules/@arcgis/core/layers/support/RasterFunction.js");
/* harmony import */ var _support_RasterJobHandler_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../support/RasterJobHandler.js */ "./node_modules/@arcgis/core/layers/support/RasterJobHandler.js");
/* harmony import */ var _support_TileInfo_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../support/TileInfo.js */ "./node_modules/@arcgis/core/layers/support/TileInfo.js");
/* harmony import */ var _support_rasterDatasets_FunctionRaster_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../support/rasterDatasets/FunctionRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/FunctionRaster.js");
/* harmony import */ var _support_rasterDatasets_multidimensionalUtils_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../support/rasterDatasets/multidimensionalUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/multidimensionalUtils.js");
/* harmony import */ var _support_rasterFunctions_clipUtils_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../support/rasterFunctions/clipUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/clipUtils.js");
/* harmony import */ var _support_rasterFunctions_rasterFunctionHelper_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../support/rasterFunctions/rasterFunctionHelper.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/rasterFunctionHelper.js");
/* harmony import */ var _support_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../support/rasterFunctions/rasterProjectionHelper.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/rasterProjectionHelper.js");
/* harmony import */ var _support_rasterFunctions_stretchUtils_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../support/rasterFunctions/stretchUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/stretchUtils.js");
/* harmony import */ var _support_rasterFunctions_vectorFieldUtils_js__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ../support/rasterFunctions/vectorFieldUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/vectorFieldUtils.js");
/* harmony import */ var _renderers_support_rasterRendererHelper_js__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../../renderers/support/rasterRendererHelper.js */ "./node_modules/@arcgis/core/renderers/support/rasterRendererHelper.js");
/* harmony import */ var _renderers_support_RasterSymbolizer_js__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../../renderers/support/RasterSymbolizer.js */ "./node_modules/@arcgis/core/renderers/support/RasterSymbolizer.js");
/* harmony import */ var _rest_support_ImageHistogramParameters_js__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ../../rest/support/ImageHistogramParameters.js */ "./node_modules/@arcgis/core/rest/support/ImageHistogramParameters.js");
/* harmony import */ var _views_2d_engine_flow_dataUtils_js__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ../../views/2d/engine/flow/dataUtils.js */ "./node_modules/@arcgis/core/views/2d/engine/flow/dataUtils.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/* harmony import */ var _geometry_Point_js__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ../../geometry/Point.js */ "./node_modules/@arcgis/core/geometry/Point.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const K=K=>{let Q=class extends K{constructor(...e){super(...e),this._isConstructedFromFunctionRaster=!1,this._rasterJobHandler={instance:null,refCount:0,connectionPromise:null},this.bandIds=null,this.copyright=null,this.interpolation=null,this.multidimensionalSubset=null,this.raster=null,this.serviceRasterInfo=null,this.sourceJSON=null,this.spatialReference=null,this.symbolizer=null,this._isConstructedFromFunctionRaster="Function"===e[0]?.raster?.datasetFormat}get fullExtent(){return this.serviceRasterInfo?.extent}set multidimensionalDefinition(e){this._set("multidimensionalDefinition",e),this.updateRenderer()}set rasterFunction(e){"none"===e?.functionName?.toLowerCase()&&(e=void 0),this._set("rasterFunction",e),this.updateRasterFunction()}get rasterInfo(){return (0,_core_deprecate_js__WEBPACK_IMPORTED_MODULE_4__.deprecatedProperty)(_core_Logger_js__WEBPACK_IMPORTED_MODULE_6__["default"].getLogger(this),"rasterInfo",{replacement:"serviceRasterInfo",version:"4.29",warnOnce:!0}),this._get("serviceRasterInfo")}set url(e){this._set("url",(0,_support_arcgisLayerUrl_js__WEBPACK_IMPORTED_MODULE_15__.sanitizeUrl)(e,_core_Logger_js__WEBPACK_IMPORTED_MODULE_6__["default"].getLogger(this)))}get renderer(){if("imagery-tile"!==this.type)return this.internalRenderer;const{activePresetRendererName:e,presetRenderers:t}=this;if(e){const r=t?.find((({name:t})=>t===e));return r?.renderer.clone()}return this.internalRenderer}set renderer(e){"imagery-tile"===this.type&&(this.activePresetRendererName=null),this.internalRenderer=e}set internalRenderer(e){null==e&&null==this.rasterFunction?this._configDefaultRenderer("override"):(this._set("internalRenderer",e),this.updateRenderer())}readRenderer(e,t,r){const n=t?.layerDefinition?.drawingInfo?.renderer;return (0,_rasterRenderers_js__WEBPACK_IMPORTED_MODULE_2__.read)(n,r)||void 0}async convertVectorFieldData(e,t){const{serviceRasterInfo:r}=this;if(null==e||!r)return null;const i=this._rasterJobHandler.instance,n=r.dataType;return i?i.convertVectorFieldData({pixelBlock:e,dataType:n},t):(0,_support_rasterFunctions_vectorFieldUtils_js__WEBPACK_IMPORTED_MODULE_29__.convertVectorFieldData)(e,n)}async computeStatisticsHistograms(e,t){await this.load(t),e=(0,_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_8__.ensureClass)(_rest_support_ImageHistogramParameters_js__WEBPACK_IMPORTED_MODULE_32__["default"],e).clone();const{serviceRasterInfo:r}=this;if(null==r)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_5__["default"]("imagery-tile-mixin:compute-statistics-histograms","serviceRasterInfo must be specified");const{geometry:i}=e;if(null==i)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_5__["default"]("imagery-tile-mixin:compute-statistics-histograms","geometry must be specified");let n=i;const{spatialReference:s}=r;i.spatialReference.equals(s)||(await (0,_support_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_27__.load)(),n="extent"===i.type?(0,_support_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_27__.projectExtent)(i,s):(0,_support_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_27__.projectPolygon)(i,s));const a=e.pixelSize??new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_35__["default"]({x:r.pixelSize.x,y:r.pixelSize.y,spatialReference:s}),{extent:l,width:u,height:d}=(0,_support_rasterFunctions_clipUtils_js__WEBPACK_IMPORTED_MODULE_25__.snapToRaster)(r,n,a),m=await this.fetchPixels(l,u,d,{...t,interpolation:"nearest"});if(null==m.pixelBlock)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_5__["default"]("imagery-tile-mixin:compute-statistics-histograms","failed to fetch pixels");const h=await (0,_support_rasterFunctions_clipUtils_js__WEBPACK_IMPORTED_MODULE_25__.clip)(m.pixelBlock,l,n),p=this._rasterJobHandler.instance;return p?p.computeStatisticsHistograms({pixelBlock:h},t):(0,_support_rasterFunctions_stretchUtils_js__WEBPACK_IMPORTED_MODULE_28__.computeStatisticsHistograms)(h)}async createFlowMesh(e,t){const r=this._rasterJobHandler.instance;return r?r.createFlowMesh(e,t):(0,_views_2d_engine_flow_dataUtils_js__WEBPACK_IMPORTED_MODULE_33__.createFlowMesh)(e.meshType,e.simulationSettings,e.flowData,null!=t.signal?t.signal:(new AbortController).signal)}normalizeRasterFetchOptions(e){const{multidimensionalInfo:t}=this.serviceRasterInfo??{};if(null==t)return e;let r=e.multidimensionalDefinition||this.multidimensionalDefinition;r?.length||(r=(0,_support_rasterDatasets_multidimensionalUtils_js__WEBPACK_IMPORTED_MODULE_24__.getDefaultMultidimensionalDefinition)(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset}));const i=e.timeExtent||this.timeExtent;if(null!=r&&null!=i&&(null!=i.start||null!=i.end)){r=r.map((e=>e.clone()));const n=t.variables.find((({name:e})=>e===r[0].variableName))?.dimensions?.find((({name:e})=>"StdTime"===e)),s=r.find((({dimensionName:e})=>"StdTime"===e));if(!n||!s)return{...e,multidimensionalDefinition:null};const{start:o,end:a}=i,l=null==o?null:o.getTime(),u=null==a?null:a.getTime(),c=l??u,d=u??l;if(null!=n.values){const e=n.values.filter((e=>{if(Array.isArray(e)){if(c===d)return e[0]<=c&&e[1]>=c;const t=e[0]<=c&&e[1]>c||e[0]<d&&e[1]>=d,r=e[0]>=c&&e[1]<=d||e[0]<c&&e[1]>d;return t||r}return c===d?e===c:e>=c&&e<=d}));if(e.length){const t=e.sort(((e,t)=>{const r=Array.isArray(e)?e[0]:e,i=Array.isArray(e)?e[1]:e,n=Array.isArray(t)?t[0]:t,s=Array.isArray(t)?t[1]:t;if(c===d)return r-n;return Math.abs(i-d)-Math.abs(s-d)}))[0];s.values=[t]}else r=null}else if(n.hasRegularIntervals&&n.extent){const[e,t]=n.extent;c>t||d<e?r=null:s.values=c===d?[c]:[Math.max(e,c),Math.min(t,d)]}}return null!=r&&(0,_support_rasterDatasets_multidimensionalUtils_js__WEBPACK_IMPORTED_MODULE_24__.hasExcludedVariableOrDimension)(r,this.multidimensionalSubset)?{...e,multidimensionalDefinition:null}:{...e,multidimensionalDefinition:r}}async updateRasterFunction(){if(!this.loaded||"imagery-tile"!==this.type||!this.rasterFunction&&!this._cachedRasterFunctionJson||JSON.stringify(this.rasterFunction)===JSON.stringify(this._cachedRasterFunctionJson))return;if(this._isConstructedFromFunctionRaster&&"Function"===this.raster.datasetFormat){const e=this.raster.rasterFunction.toJSON();return!this.rasterFunction&&e&&this._set("rasterFunction",_support_RasterFunction_js__WEBPACK_IMPORTED_MODULE_20__["default"].fromJSON(e)),void(this._cachedRasterFunctionJson=this.rasterFunction?.toJSON())}let e,t=this.raster,r=!1;"Function"===t.datasetFormat?(e=t.primaryRasters.rasters,t=e[0],r=!0):e=[t];const{rasterFunction:i}=this;if(i){const r={raster:t};e.length>1&&e.forEach((e=>r[e.url]=e));const n=(0,_support_rasterFunctions_rasterFunctionHelper_js__WEBPACK_IMPORTED_MODULE_26__.create)(i.functionDefinition?.toJSON()??i.toJSON(),r),s=new _support_rasterDatasets_FunctionRaster_js__WEBPACK_IMPORTED_MODULE_23__["default"]({rasterFunction:n});s.rasterJobHandler=this._rasterJobHandler.instance,await s.open(),this._cachedRasterFunctionJson=this.rasterFunction?.toJSON(),this.raster=s}else this.raster=t,this._cachedRasterFunctionJson=null,await t.open();if(this._cachedRendererJson=null,!r&&!i)return;const{bandIds:n}=this,{bandCount:s}=this.raster.rasterInfo,o=n?.length?n.some((e=>e>=s)):s>=3;n&&(o||this.renderer&&"raster-stretch"!==this.renderer.type)&&this._set("bandIds",null),this._configDefaultRenderer("auto")}async updateRenderer(){const{loaded:e,symbolizer:t}=this;if(!e||!t||!this.renderer)return;const{rasterInfo:r}=this.raster,i=(0,_support_rasterDatasets_multidimensionalUtils_js__WEBPACK_IMPORTED_MODULE_24__.getDefaultVariableInfo)(r,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset}),n=i?.name,s=(0,_renderers_support_rasterRendererHelper_js__WEBPACK_IMPORTED_MODULE_30__.normalizeRendererJSON)({...this.renderer.toJSON(),variableName:n});if(JSON.stringify(this._cachedRendererJson)===JSON.stringify(s))return;const o=this._rasterJobHandler.instance;o&&(t.rasterInfo=(0,_renderers_support_rasterRendererHelper_js__WEBPACK_IMPORTED_MODULE_30__.getVariableRasterInfo)(r,n),t.rendererJSON=s,t.bind(),await o.updateSymbolizer(t),this._cachedRendererJson=s)}async applyRenderer(e,t){const r=e?.pixelBlock;if(!(null!=r&&r.pixels&&r.pixels.length>0))return null;let i;await this.updateRenderer();const n=this._rasterJobHandler.instance,s=this.bandIds??[];return i=n?await n.symbolize({...e,simpleStretchParams:t,bandIds:s}):this.symbolizer.symbolize({...e,simpleStretchParams:t,bandIds:s}),i}getTileUrl(e,t,r){return"RasterTileServer"===this.raster.datasetFormat?`${this.url}/tile/${e}/${t}/${r}`:""}getCompatibleTileInfo(e,t,r=!1){if(!this.loaded||null==t)return null;if(r&&e.equals(this.spatialReference))return this.tileInfo;const i=(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_14__.getInfo)(e);return _support_TileInfo_js__WEBPACK_IMPORTED_MODULE_22__["default"].create({size:256,spatialReference:e,origin:i?{x:i.origin[0],y:i.origin[1]}:{x:t.xmin,y:t.ymax}})}getCompatibleFullExtent(e){return this.loaded?(this._compatibleFullExtent?.spatialReference.equals(e)||(this._compatibleFullExtent=this.raster.computeExtent(e)),this._compatibleFullExtent):null}async fetchTile(e,t,r,i={}){if(X(this),i.requestAsImageElement){const s=this.getTileUrl(e,t,r);return (0,_request_js__WEBPACK_IMPORTED_MODULE_3__["default"])(s,{responseType:"image",query:{...this.refreshParameters,...this.raster.ioConfig.customFetchParameters},signal:i.signal}).then((e=>e.data))}const{serviceRasterInfo:s}=this;if(null!=s.multidimensionalInfo&&null==(i=this.normalizeRasterFetchOptions(i)).multidimensionalDefinition){const n=i.tileInfo||s.storageInfo.tileInfo;return{extent:this.raster.getTileExtentFromTileInfo(e,t,r,n),pixelBlock:null}}return await this._initJobHandler(),await this.updateRasterFunction(),"raster-shaded-relief"===this.renderer?.type&&(i={...i,buffer:{cols:1,rows:1}}),this.raster.fetchTile(e,t,r,i)}async fetchPixels(e,t,r,i={}){return null!=this.serviceRasterInfo.multidimensionalInfo&&null==(i=this.normalizeRasterFetchOptions(i)).multidimensionalDefinition?{extent:e,pixelBlock:null}:(await this._initJobHandler(),await this.updateRasterFunction(),t=Math.round(t),r=Math.round(r),this.raster.fetchPixels(e,t,r,i))}async identify(e,t={}){await this.load();const{raster:r,serviceRasterInfo:i}=this;if(null!=i?.multidimensionalInfo){if(!(i.hasMultidimensionalTranspose&&!!((0,_support_rasterDatasets_multidimensionalUtils_js__WEBPACK_IMPORTED_MODULE_24__.isMultiSliceOrRangeDefinition)(t.multidimensionalDefinition)||t.transposedVariableName||t.timeExtent))&&null==(t=this.normalizeRasterFetchOptions(t)).multidimensionalDefinition)return{location:e,value:null}}const n=this.multidimensionalSubset?.areaOfInterest;if(n&&!n.contains(e))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_5__["default"]("imagery-tile-mixin:identify","the request cannot be fulfilled when falling outside of the multidimensional subset");return r.identify(e,t)}increaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount++}decreaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount--,this._rasterJobHandler.refCount<=0&&this._shutdownJobHandler()}hasStandardTime(){const e=this.serviceRasterInfo?.multidimensionalInfo;if(null==e||"standard-time"!==this.serviceRasterInfo?.dataType)return!1;const t=this.multidimensionalDefinition,r=t?.[0]?.variableName;return e.variables.some((e=>e.name===r&&(!t?.[0].dimensionName||e.dimensions.some((e=>"StdTime"===e.name)))))}getStandardTimeValue(e){return new Date(24*(e-25569)*3600*1e3).toString()}getMultidimensionalSubsetVariables(e){const t=e??this.serviceRasterInfo?.multidimensionalInfo;return (0,_support_rasterDatasets_multidimensionalUtils_js__WEBPACK_IMPORTED_MODULE_24__.getSubsetVariablesFromMdInfo)(this.multidimensionalSubset,t)}_configDefaultSettings(){this._configDefaultInterpolation(),this.multidimensionalDefinition||(this.multidimensionalDefinition=(0,_support_rasterDatasets_multidimensionalUtils_js__WEBPACK_IMPORTED_MODULE_24__.getDefaultMultidimensionalDefinition)(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset})),this.rasterFunction&&"Function"===this.raster.datasetFormat&&(this._cachedRasterFunctionJson=this.rasterFunction.toJSON()),this._configDefaultRenderer()}_initJobHandler(){if(null!=this._rasterJobHandler.connectionPromise)return this._rasterJobHandler.connectionPromise;const e=new _support_RasterJobHandler_js__WEBPACK_IMPORTED_MODULE_21__["default"];return this._rasterJobHandler.connectionPromise=e.initialize().then((async()=>{X(this),this._rasterJobHandler.instance=e,this.raster.rasterJobHandler=e,"Function"===this.raster.datasetFormat&&this.raster.syncJobHandler(),this.rasterFunction&&await this.updateRasterFunction().catch((()=>{})),this.renderer&&this.updateRenderer()})).catch((()=>{})),this._rasterJobHandler.connectionPromise}_shutdownJobHandler(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy(),this._rasterJobHandler.instance=null,this._rasterJobHandler.connectionPromise=null,this._rasterJobHandler.refCount=0,this._cachedRendererJson=null,this.raster&&(this.raster.rasterJobHandler=null)}_configDefaultInterpolation(){if(null==this.interpolation){X(this);const{raster:e}=this,t=(0,_renderers_support_rasterRendererHelper_js__WEBPACK_IMPORTED_MODULE_30__.getDefaultInterpolation)(e.rasterInfo,e.tileType,this.sourceJSON?.defaultResamplingMethod);this._set("interpolation",t)}}_configDefaultRenderer(e="no"){X(this);const{rasterInfo:t}=this.raster,r=(0,_support_rasterDatasets_multidimensionalUtils_js__WEBPACK_IMPORTED_MODULE_24__.getDefaultVariableInfo)(t,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset}),i=r?.name,n=(0,_renderers_support_rasterRendererHelper_js__WEBPACK_IMPORTED_MODULE_30__.matchPresetRenderer)({variableName:i,rasterFunctionName:this.rasterFunction?.functionName,presetRenderers:this.presetRenderers});if(!this.bandIds&&t.bandCount>1&&(this.bandIds=n?.bandIds??(0,_renderers_support_rasterRendererHelper_js__WEBPACK_IMPORTED_MODULE_30__.getDefaultBandCombination)(t)),!this.renderer||"override"===e){const e=(0,_renderers_support_rasterRendererHelper_js__WEBPACK_IMPORTED_MODULE_30__.getFunctionColorRamp)(this.raster),r=n?.renderer??(0,_renderers_support_rasterRendererHelper_js__WEBPACK_IMPORTED_MODULE_30__.createDefaultRenderer)(t,{bandIds:this.bandIds,variableName:i,rasterFunctionColorRamp:e}),s=t.statistics,o=s&&s.length>0?s[0]:null,a=o?.max??0,l=o?.min??0;"WCSServer"===this.raster.datasetFormat&&"raster-stretch"===r.type&&(a>1e24||l<-1e24)&&(r.dynamicRangeAdjustment=!0,r.customStatistics=null,"none"===r.stretchType&&(r.stretchType="min-max")),this.renderer=r}const s=(0,_renderers_support_rasterRendererHelper_js__WEBPACK_IMPORTED_MODULE_30__.normalizeRendererJSON)({...this.renderer.toJSON(),variableName:i}),o=(0,_renderers_support_rasterRendererHelper_js__WEBPACK_IMPORTED_MODULE_30__.getVariableRasterInfo)(t,i);this.symbolizer?(this.symbolizer.rendererJSON=s,this.symbolizer.rasterInfo=o):this.symbolizer=new _renderers_support_RasterSymbolizer_js__WEBPACK_IMPORTED_MODULE_31__["default"]({rendererJSON:s,rasterInfo:o});const l=this.symbolizer.bind();if(l.success){if("auto"===e){const{colormap:e}=this.raster.rasterInfo,t=this.renderer;if(null!=e&&"raster-colormap"===t.type){const e=(0,_renderers_support_rasterRendererHelper_js__WEBPACK_IMPORTED_MODULE_30__.createDefaultRenderer)(this.raster.rasterInfo);JSON.stringify(e)!==JSON.stringify(t)&&this._configDefaultRenderer("override")}else if("raster-stretch"===t.type){const e=this.bandIds?.length,r=t.customStatistics?.length;!t.dynamicRangeAdjustment&&r&&e&&r!==e&&this._configDefaultRenderer("override")}}}else _core_Logger_js__WEBPACK_IMPORTED_MODULE_6__["default"].getLogger(this).warn("imagery-tile-mixin",l.error||"The given renderer is not supported by the layer."),"auto"===e&&this._configDefaultRenderer("override")}};function X(e){if(!e.raster||!e.serviceRasterInfo)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_5__["default"]("imagery-tile","no raster")}return (0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({clonable:!1})],Q.prototype,"_cachedRendererJson",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({clonable:!1})],Q.prototype,"_cachedRasterFunctionJson",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({clonable:!1})],Q.prototype,"_compatibleFullExtent",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({clonable:!1})],Q.prototype,"_isConstructedFromFunctionRaster",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({clonable:!1})],Q.prototype,"_rasterJobHandler",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({type:[_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_8__.Integer],json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"0,1,2"!==this.bandIds?.join(",")}}}}})],Q.prototype,"bandIds",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({json:{origins:{service:{read:{source:"copyrightText"}}}}})],Q.prototype,"copyright",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({json:{read:!1}})],Q.prototype,"fullExtent",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"bilinear"!==this.interpolation}}}}}),(0,_core_accessorSupport_decorators_enumeration_js__WEBPACK_IMPORTED_MODULE_11__.enumeration)(_support_rasterEnums_js__WEBPACK_IMPORTED_MODULE_19__.interpolationKebab)],Q.prototype,"interpolation",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)()],Q.prototype,"ioConfig",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({type:[_support_DimensionalDefinition_js__WEBPACK_IMPORTED_MODULE_17__["default"]],json:{write:!0}})],Q.prototype,"multidimensionalDefinition",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({type:_support_MultidimensionalSubset_js__WEBPACK_IMPORTED_MODULE_18__["default"],json:{write:!0}})],Q.prototype,"multidimensionalSubset",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)()],Q.prototype,"raster",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({type:_support_RasterFunction_js__WEBPACK_IMPORTED_MODULE_20__["default"],json:{name:"renderingRule",write:!0}})],Q.prototype,"rasterFunction",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({readOnly:!0})],Q.prototype,"rasterInfo",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)()],Q.prototype,"serviceRasterInfo",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)()],Q.prototype,"sourceJSON",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({readOnly:!0,type:_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_34__["default"],json:{read:!1}})],Q.prototype,"spatialReference",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({type:_support_TileInfo_js__WEBPACK_IMPORTED_MODULE_22__["default"]})],Q.prototype,"tileInfo",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)(_support_commonProperties_js__WEBPACK_IMPORTED_MODULE_16__.url)],Q.prototype,"url",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)()],Q.prototype,"renderer",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({types:_rasterRenderers_js__WEBPACK_IMPORTED_MODULE_2__.rasterRendererTypes,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(){const e="raster-stretch"===this.renderer?.type&&"none"===this.renderer.stretchType&&!this.renderer.useGamma;return{enabled:!this.loaded||"Raster"===this.raster.tileType||!e}}},origins:{"web-scene":{types:_rasterRenderers_js__WEBPACK_IMPORTED_MODULE_2__.websceneRasterRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:e=>({enabled:e&&"vector-field"!==e.type&&"flow"!==e.type})}}}}})],Q.prototype,"internalRenderer",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_reader_js__WEBPACK_IMPORTED_MODULE_12__.reader)("internalRenderer")],Q.prototype,"readRenderer",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({clonable:!1})],Q.prototype,"symbolizer",void 0),Q=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_13__.subclass)("esri.layers.mixins.ImageryTileMixin")],Q),Q};


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/Tilemap.js":
/*!*************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/Tilemap.js ***!
  \*************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Tilemap: function() { return /* binding */ l; },
/* harmony export */   tilemapDefinitionId: function() { return /* binding */ r; }
/* harmony export */ });
/* harmony import */ var _request_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../request.js */ "./node_modules/@arcgis/core/request.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_lang_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/lang.js */ "./node_modules/@arcgis/core/core/lang.js");
/* harmony import */ var _core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/typedArrayUtil.js */ "./node_modules/@arcgis/core/core/typedArrayUtil.js");
/* harmony import */ var _geometry_support_UintArray_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../geometry/support/UintArray.js */ "./node_modules/@arcgis/core/geometry/support/UintArray.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class l{constructor(t){s(t);const{location:i,data:l}=t;this.location=Object.freeze((0,_core_lang_js__WEBPACK_IMPORTED_MODULE_2__.clone)(i));const r=this.location.width,n=this.location.height;let h=!0,c=!0;const m=Math.ceil(r*n/32),f=(0,_geometry_support_UintArray_js__WEBPACK_IMPORTED_MODULE_4__.newUintArray)(m);let w=0;for(let e=0;e<l.length;e++){const t=e%32;l[e]?(c=!1,f[w]|=1<<t):h=!1,31===t&&++w}c?(this._availability="unavailable",this.byteSize=40):h?(this._availability="available",this.byteSize=40):(this._availability=f,this.byteSize=40+(0,_core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_3__.estimateSize)(f))}getAvailability(t,i){if("unavailable"===this._availability||"available"===this._availability)return this._availability;const e=(t-this.location.top)*this.location.width+(i-this.location.left),a=e%32,o=e>>5,l=this._availability;return o<0||o>l.length?"unknown":l[o]&1<<a?"available":"unavailable"}static fromDefinition(e,a){const o=e.service.request||_request_js__WEBPACK_IMPORTED_MODULE_0__["default"],{row:r,col:s,width:h,height:c}=e,m={query:{f:"json"}};return a=a?{...m,...a}:m,o(n(e),a).then((t=>t.data)).catch((t=>{if(422===t?.details?.httpStatus)return{location:{top:r,left:s,width:h,height:c},valid:!0,data:new Array(h*c).fill(0)};throw t})).then((t=>{if(t.location&&(t.location.top!==r||t.location.left!==s||t.location.width!==h||t.location.height!==c))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("tilemap:location-mismatch","Tilemap response for different location than requested",{response:t,definition:{top:r,left:s,width:h,height:c}});return l.fromJSON(t)}))}static fromJSON(t){return Object.freeze(new l(t))}}function r(t){return`${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}function n(t){let i;if(t.service.tileServers?.length){const e=t.service.tileServers;i=`${e&&e.length?e[t.row%e.length]:t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}else i=`${t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`;const e=t.service.query;return e&&(i=`${i}?${e}`),i}function s(t){if(!t?.location)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("tilemap:missing-location","Location missing from tilemap response");if(!1===t.valid)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("tilemap:invalid","Tilemap response was marked as invalid");if(!t.data)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(t.data))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("tilemap:data-mismatch","Data must be an array of numbers");if(t.data.length!==t.location.width*t.location.height)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/TilemapCache.js":
/*!******************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/TilemapCache.js ***!
  \******************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   TilemapCache: function() { return /* binding */ T; }
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _request_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../request.js */ "./node_modules/@arcgis/core/request.js");
/* harmony import */ var _core_Accessor_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/Accessor.js */ "./node_modules/@arcgis/core/core/Accessor.js");
/* harmony import */ var _core_ByteSizeUnit_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/ByteSizeUnit.js */ "./node_modules/@arcgis/core/core/ByteSizeUnit.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_handleUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/handleUtils.js */ "./node_modules/@arcgis/core/core/handleUtils.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_LRUCache_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/LRUCache.js */ "./node_modules/@arcgis/core/core/LRUCache.js");
/* harmony import */ var _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/PooledArray.js */ "./node_modules/@arcgis/core/core/PooledArray.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../core/reactiveUtils.js */ "./node_modules/@arcgis/core/core/reactiveUtils.js");
/* harmony import */ var _core_scheduling_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../core/scheduling.js */ "./node_modules/@arcgis/core/core/scheduling.js");
/* harmony import */ var _core_urlUtils_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../core/urlUtils.js */ "./node_modules/@arcgis/core/core/urlUtils.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../core/RandomLCG.js */ "./node_modules/@arcgis/core/core/RandomLCG.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _TileKey_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./TileKey.js */ "./node_modules/@arcgis/core/layers/support/TileKey.js");
/* harmony import */ var _Tilemap_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./Tilemap.js */ "./node_modules/@arcgis/core/layers/support/Tilemap.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
var j;function w(e,t,i){return new _core_Error_js__WEBPACK_IMPORTED_MODULE_4__["default"]("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:i})}let T=j=class extends _core_Accessor_js__WEBPACK_IMPORTED_MODULE_2__["default"]{constructor(e){super(e),this._pendingTilemapRequests={},this.request=_request_js__WEBPACK_IMPORTED_MODULE_1__["default"],this.size=32,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new _core_LRUCache_js__WEBPACK_IMPORTED_MODULE_7__.LRUCache(2*_core_ByteSizeUnit_js__WEBPACK_IMPORTED_MODULE_3__.ByteSizeUnit.MEGABYTES),this.addHandles((0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_10__.watch)((()=>{const{layer:e}=this;return[e?.parsedUrl,e?.tileServers,e?.apiKey,e?.customParameters]}),(()=>this._initializeTilemapDefinition()),_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_10__.initial))}get effectiveMinLOD(){return this.minLOD??this.layer.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.layer.tileInfo.lods[this.layer.tileInfo.lods.length-1].level}getAvailability(e,t,i){if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return"unavailable";const r=this._tilemapFromCache(e,t,i,this._tmpTilemapDefinition);return r?r.getAvailability(t,i):"unknown"}fetchAvailability(e,t,i,r){return!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD?Promise.reject(w(e,t,i)):this._fetchTilemap(e,t,i,r).catch((e=>e)).then((r=>{if(r instanceof _Tilemap_js__WEBPACK_IMPORTED_MODULE_18__.Tilemap){const s=r.getAvailability(t,i);if("unavailable"===s)throw w(e,t,i);return s}if((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_9__.isAbortError)(r))throw r;return"unknown"}))}fetchAvailabilityUpsample(e,t,i,r,s){r.level=e,r.row=t,r.col=i;const l=this.layer.tileInfo;l.updateTileInfo(r);const o=this.fetchAvailability(e,t,i,s).catch((e=>{if((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_9__.isAbortError)(e))throw e;if(l.upsampleTile(r))return this.fetchAvailabilityUpsample(r.level,r.row,r.col,r,s);throw e}));return this._fetchAvailabilityUpsamplePrefetch(r.id,e,t,i,s,o),o}async _fetchAvailabilityUpsamplePrefetch(e,t,i,r,s,o){if(!this._prefetchingEnabled||null==e)return;const a=`prefetch-${e}`;if(this.hasHandles(a))return;const n=new AbortController;o.then((()=>n.abort()),(()=>n.abort()));let h=!1;const p=(0,_core_handleUtils_js__WEBPACK_IMPORTED_MODULE_5__.makeHandle)((()=>{h||(h=!0,n.abort())}));if(this.addHandles(p,a),await (0,_core_scheduling_js__WEBPACK_IMPORTED_MODULE_11__.waitTicks)(10,n.signal).catch((()=>{})),h||(h=!0,this.removeHandles(a)),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_9__.isAborted)(n))return;const m=new _TileKey_js__WEBPACK_IMPORTED_MODULE_17__.TileKey(e,t,i,r),f={...s,signal:n.signal},v=this.layer.tileInfo;for(let l=0;j._prefetches.length<j._maxPrefetch&&v.upsampleTile(m);++l){const e=this.fetchAvailability(m.level,m.row,m.col,f);j._prefetches.push(e);const t=()=>{j._prefetches.removeUnordered(e)};e.then(t,t)}}_fetchTilemap(e,t,i,r){if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return Promise.reject(new _core_Error_js__WEBPACK_IMPORTED_MODULE_4__["default"]("tilemap-cache:level-unavailable",`Level ${e} is unavailable in the service`));const l=this._tmpTilemapDefinition,o=this._tilemapFromCache(e,t,i,l);if(o)return Promise.resolve(o);const a=r?.signal;return r={...r,signal:null},new Promise(((e,t)=>{(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_9__.onAbort)(a,(()=>t((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_9__.createAbortError)())));const i=(0,_Tilemap_js__WEBPACK_IMPORTED_MODULE_18__.tilemapDefinitionId)(l);let s=this._pendingTilemapRequests[i];if(!s){s=_Tilemap_js__WEBPACK_IMPORTED_MODULE_18__.Tilemap.fromDefinition(l,r).then((e=>(this._tilemapCache.put(i,e,e.byteSize),e)));const e=()=>{delete this._pendingTilemapRequests[i]};this._pendingTilemapRequests[i]=s,s.then(e,e)}s.then(e,t)}))}_initializeTilemapDefinition(){if(!this.layer.parsedUrl)return;const{parsedUrl:e,apiKey:t,customParameters:i}=this.layer;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_12__.objectToQuery)({...e.query,...i,token:t??e.query?.token}),tileServers:this.layer.tileServers,request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(e,t,i,r){r.level=e,r.row=t-t%this.size,r.col=i-i%this.size;const s=(0,_Tilemap_js__WEBPACK_IMPORTED_MODULE_18__.tilemapDefinitionId)(r);return this._tilemapCache.get(s)}get test(){}};T._maxPrefetch=4,T._prefetches=new _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_8__["default"]({initialSize:j._maxPrefetch}),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_13__.property)({constructOnly:!0})],T.prototype,"layer",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_13__.property)({constructOnly:!0})],T.prototype,"minLOD",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_13__.property)({constructOnly:!0})],T.prototype,"maxLOD",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_13__.property)({constructOnly:!0})],T.prototype,"request",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_13__.property)({constructOnly:!0})],T.prototype,"size",void 0),T=j=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_16__.subclass)("esri.layers.support.TilemapCache")],T);


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/rasterDatasets/BaseRaster.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/rasterDatasets/BaseRaster.js ***!
  \*******************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ X; }
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _geometry_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../geometry.js */ "./node_modules/@arcgis/core/geometry.js");
/* harmony import */ var _request_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../request.js */ "./node_modules/@arcgis/core/request.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_JSONSupport_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/JSONSupport.js */ "./node_modules/@arcgis/core/core/JSONSupport.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../core/accessorSupport/ensureType.js */ "./node_modules/@arcgis/core/core/accessorSupport/ensureType.js");
/* harmony import */ var _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../core/RandomLCG.js */ "./node_modules/@arcgis/core/core/RandomLCG.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _arcgisLayerUrl_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../arcgisLayerUrl.js */ "./node_modules/@arcgis/core/layers/support/arcgisLayerUrl.js");
/* harmony import */ var _commonProperties_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../commonProperties.js */ "./node_modules/@arcgis/core/layers/support/commonProperties.js");
/* harmony import */ var _DimensionalDefinition_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../DimensionalDefinition.js */ "./node_modules/@arcgis/core/layers/support/DimensionalDefinition.js");
/* harmony import */ var _LOD_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../LOD.js */ "./node_modules/@arcgis/core/layers/support/LOD.js");
/* harmony import */ var _RasterStorageInfo_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../RasterStorageInfo.js */ "./node_modules/@arcgis/core/layers/support/RasterStorageInfo.js");
/* harmony import */ var _TileInfo_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../TileInfo.js */ "./node_modules/@arcgis/core/layers/support/TileInfo.js");
/* harmony import */ var _multidimensionalUtils_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./multidimensionalUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/multidimensionalUtils.js");
/* harmony import */ var _RawBlockCache_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./RawBlockCache.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/RawBlockCache.js");
/* harmony import */ var _rasterFormats_pixelRangeUtils_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../rasterFormats/pixelRangeUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterFormats/pixelRangeUtils.js");
/* harmony import */ var _rasterFormats_RasterCodec_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../rasterFormats/RasterCodec.js */ "./node_modules/@arcgis/core/layers/support/rasterFormats/RasterCodec.js");
/* harmony import */ var _rasterFunctions_pixelUtils_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../rasterFunctions/pixelUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/pixelUtils.js");
/* harmony import */ var _rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../rasterFunctions/rasterProjectionHelper.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/rasterProjectionHelper.js");
/* harmony import */ var _rasterFunctions_vectorFieldUtils_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../rasterFunctions/vectorFieldUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/vectorFieldUtils.js");
/* harmony import */ var _views_support_QueueProcessor_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../../../views/support/QueueProcessor.js */ "./node_modules/@arcgis/core/views/support/QueueProcessor.js");
/* harmony import */ var _geometry_Point_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../../../geometry/Point.js */ "./node_modules/@arcgis/core/geometry/Point.js");
/* harmony import */ var _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../../../geometry/Extent.js */ "./node_modules/@arcgis/core/geometry/Extent.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const N=8,V=256;let U=0,$=class extends _core_JSONSupport_js__WEBPACK_IMPORTED_MODULE_4__.JSONSupport{constructor(){super(...arguments),this._tileFetchQueue=new _views_support_QueueProcessor_js__WEBPACK_IMPORTED_MODULE_25__.QueueProcessor({concurrency:32,process:(e,t)=>this._fetchRawTile(e.pyramidLevel,e.row,e.col,{...e.options,signal:t})}),this.datasetName=null,this.datasetFormat=null,this.hasUniqueSourceStorageInfo=!0,this.rasterInfo=null,this.ioConfig={sampling:"closest"}}normalizeCtorArgs(e){return e?.ioConfig&&(e={...e,ioConfig:{resolution:null,bandIds:null,sampling:"closest",tileInfo:_TileInfo_js__WEBPACK_IMPORTED_MODULE_17__["default"].create(),...e.ioConfig}}),e}get _isGlobalWrappableSource(){const{rasterInfo:e}=this,t=(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.getWorldWidth)(e.spatialReference);return null!=t&&e.extent.width>=t/2}get _hasNoneOrGCSShiftTransform(){const{transform:e}=this.rasterInfo;return null==e||"gcs-shift"===e.type}set rasterJobHandler(e){this._set("rasterJobHandler",e),"Function"===this.datasetFormat&&this.primaryRasters?.rasters?.forEach((t=>t.rasterJobHandler=e))}get rasterId(){return this.url||"rasterId-"+U++}set url(e){this._set("url",(0,_arcgisLayerUrl_js__WEBPACK_IMPORTED_MODULE_12__.sanitizeUrl)(e,_core_Logger_js__WEBPACK_IMPORTED_MODULE_5__["default"].getLogger(this)))}async open(e){return this._openPromise??=(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.load)().then((()=>this._open(e))),this._openPromise}async fetchTile(e,t,i,o={}){const r=o.tileInfo||this.rasterInfo.storageInfo.tileInfo,n=this.getTileExtentFromTileInfo(e,t,i,r);return o={noClip:!0,...o},this.fetchPixels(n,r.size[0],r.size[1],o)}async identify(e,t={}){e=(0,_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_8__.ensureClass)(_geometry_Point_js__WEBPACK_IMPORTED_MODULE_26__["default"],e).clone().normalize();const{multidimensionalDefinition:i,timeExtent:o}=t,{rasterInfo:r}=this,{hasMultidimensionalTranspose:n,multidimensionalInfo:s}=r;let{transposedVariableName:a}=t;const c=null!=s&&n&&(null!=o||(0,_multidimensionalUtils_js__WEBPACK_IMPORTED_MODULE_18__.isMultiSliceOrRangeDefinition)(i));if(c&&!a){a=null!=i&&i.length>0?i[0].variableName??void 0:s.variables[0].name,t={...t,transposedVariableName:a}}t=this._getRequestOptionsWithSliceId(t);const{spatialReference:f,extent:m}=r,{datumTransformation:u}=t;let h=(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.projectPoint)(e,f,u);if(!m.intersects(h))return{location:h,value:null};if(null!=r.transform){const e=r.transform.inverseTransform(h);if(!r.nativeExtent.intersects(e))return{location:e,value:null};h=e}let p=0;const x=null!=a&&null!=s&&r.hasMultidimensionalTranspose;if("Function"===this.datasetFormat){const e=this.primaryRasters.rasters[0];if(x)return e.identify(h,t);const{pixelSize:o}=r,n=3,s=o.x*n/2,l=o.y*n/2,a=new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_27__["default"]({xmin:h.x-s,xmax:h.x+s,ymin:h.y-l,ymax:h.y+l,spatialReference:f}),c={interpolation:"nearest",multidimensionalDefinition:i,sliceId:t.sliceId},{pixelBlock:m}=await e.fetchPixels(a,n,n,c),{pixelBlock:u}=await this.fetchPixels(a,n,n,c);if(null==m)return{location:h,value:null};const p=Math.floor(n*n*.5),d=!m.mask||m.mask[p]?m.pixels.map((e=>e[p])):null;let y;return null!=u&&(y=!u.mask||u.mask[p]?u.pixels.map((e=>e[p])):void 0),{location:h,value:d,processedValue:y,pyramidLevel:0}}if(!x)if(t.srcResolution){p=(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.snapPyramid)(t.srcResolution,r,this.ioConfig.sampling).pyramidLevel}else if(p=await this.computeBestPyramidLevelForLocation(e,t),null==p)return{location:h,value:null};const y=this.identifyPixelLocation(h,p,null,x);if(null===y)return{location:h,value:null};const{row:g,col:S,rowOffset:k,colOffset:v,blockWidth:T}=y,b=a??t.sliceId,P=(0,_RawBlockCache_js__WEBPACK_IMPORTED_MODULE_19__.getRasterId)(this.rasterId,b),B=`${p}/${g}/${S}`;let _=(0,_RawBlockCache_js__WEBPACK_IMPORTED_MODULE_19__.getBlock)(P,null,B);null==_&&(_=this.fetchRawTile(p,g,S,t),(0,_RawBlockCache_js__WEBPACK_IMPORTED_MODULE_19__.putBlock)(P,null,B,_));const M=await _;if(!M?.pixels?.length)return{location:h,value:null};const j=k*T+v;return this._processIdentifyResult(M,{srcLocation:h,position:j,pyramidLevel:p,useTransposedTile:!!x,requestSomeSlices:c,identifyOptions:t})}async fetchPixels(e,t,i,o={}){e=(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.shiftExtent)(e),o=this._getRequestOptionsWithSliceId(o);const{_hasNoneOrGCSShiftTransform:r}=this;if(o.requestRawData&&r)return this._fetchPixels(e,t,i,o);const n=(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.getWorldWidth)(e.spatialReference),s=(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.getWorldWrapCount)(e);if(null==n||0===s||1===s&&this._isGlobalWrappableSource&&r)return this._fetchPixels(e,t,i,o);if(s>=3)return{extent:e,pixelBlock:null};const l=[],{xmin:a,xmax:c}=e,f=Math.round(n/(c-a)*t),m=f-Math.round((n/2-a)/(c-a)*t);let u=0;const h=[];for(let y=0;y<=s;y++){const r=new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_27__["default"]({xmin:0===y?a:-n/2,xmax:y===s?c-n*y:n/2,ymin:e.ymin,ymax:e.ymax,spatialReference:e.spatialReference}),p=0===y?f-m:y===s?t-u:f;u+=p,h.push(p);const d=o.disableWrapAround&&y>0?null:this._fetchPixels(r,p,i,o);l.push(d)}const p=(await Promise.all(l)).map((e=>e?.pixelBlock));let d=null;const x={width:t,height:i};if(this.rasterJobHandler){d=(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:p,srcMosaicSize:x,destDimension:null,coefs:null,sampleSpacing:null,interpolation:"nearest",alignmentInfo:null,blockWidths:h},o)).pixelBlock}else d=(0,_rasterFunctions_pixelUtils_js__WEBPACK_IMPORTED_MODULE_22__.mosaic)(p,x,{blockWidths:h});return{extent:e,srcExtent:(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.projectExtent)(e,this.rasterInfo.spatialReference,o.datumTransformation),pixelBlock:d}}async fetchRawPixels(e,t,i,o={}){t={x:Math.floor(t.x),y:Math.floor(t.y)};const r=await this._fetchRawTiles(e,t,i,o),{nativeExtent:n,nativePixelSize:s,storageInfo:l}=this.rasterInfo,a=2**e,c=s.x*a,f=s.y*a,m=new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_27__["default"]({xmin:n.xmin+c*t.x,xmax:n.xmin+c*(t.x+i.width-1),ymin:n.ymax-f*(t.y+i.height-1),ymax:n.ymax-f*t.y,spatialReference:n.spatialReference});if(!r)return{extent:m,srcExtent:m,pixelBlock:null};const{pixelBlocks:u,mosaicSize:h}=r;if(1===u.length&&null!=u[0]&&u[0].width===i.width&&u[0].height===i.height)return{extent:m,srcExtent:m,pixelBlock:r.pixelBlocks[0]};const p=e>0?l.pyramidBlockWidth:l.blockWidth,d=e>0?l.pyramidBlockHeight:l.blockHeight,x={x:t.x%p,y:t.y%d};let y;if(this.rasterJobHandler){y=(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:u,srcMosaicSize:h,destDimension:i,clipOffset:x,clipSize:i,coefs:null,sampleSpacing:null,interpolation:o.interpolation,alignmentInfo:null,blockWidths:null},o)).pixelBlock}else y=(0,_rasterFunctions_pixelUtils_js__WEBPACK_IMPORTED_MODULE_22__.mosaic)(u,h,{clipOffset:x,clipSize:i});return{extent:m,srcExtent:m,pixelBlock:y}}fetchRawTile(e,t,o,r){throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"]("BaseRaster:read-not-implemented","fetchRawTile() is not implemented")}computeExtent(e){return (0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.projectExtent)(this.rasterInfo.extent,e)}decodePixelBlock(e,t){return!this.rasterJobHandler||t.useCanvas?(0,_rasterFormats_RasterCodec_js__WEBPACK_IMPORTED_MODULE_21__.decode)(e,t):this.rasterJobHandler.decode({data:e,options:t})}async request(e,i,o=0){const{customFetchParameters:r}=this.ioConfig,{range:n,query:s,headers:l}=i;o=o??i.retryCount??this.ioConfig.retryCount;const a=n?{Range:`bytes=${n.from}-${n.to}`}:null;try{return await (0,_request_js__WEBPACK_IMPORTED_MODULE_2__["default"])(e,{...i,query:{...s,...r},headers:{...l,...a}})}catch(c){if(o>0)return o--,this.request(e,i,o);throw c}}getSliceIndex(e){const{multidimensionalInfo:t}=this.rasterInfo;return null==t||null==e||0===e.length?null:(0,_multidimensionalUtils_js__WEBPACK_IMPORTED_MODULE_18__.getSliceIndex)(e,t)}getTileExtentFromTileInfo(e,t,i,o){const r=o.lodAt(e);return this.getTileExtent({x:r.resolution,y:r.resolution},t,i,o.origin,o.spatialReference,o.size)}updateTileInfo(){const{storageInfo:e,spatialReference:t,extent:i,pixelSize:o}=this.rasterInfo,{pyramidResolutions:r}=e;if(!e.tileInfo){const n=[],s=e.maximumPyramidLevel||0;let l=(o.x+o.y)/2,a=1/.0254*96*l;for(let e=0;e<=s&&(n.unshift(new _LOD_js__WEBPACK_IMPORTED_MODULE_15__["default"]({level:s-e,resolution:l,scale:a})),e!==s);e++)if(r){const t=(r[e].x+r[e].y)/2;a*=t/l,l=t}else l*=2,a*=2;const c=new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_26__["default"]({x:i.xmin,y:i.ymax,spatialReference:t});e.tileInfo=new _TileInfo_js__WEBPACK_IMPORTED_MODULE_17__["default"]({origin:c,size:[e.blockWidth,e.blockHeight],spatialReference:t,lods:n}),e.isVirtualTileInfo=!0}}createRemoteDatasetStorageInfo(e,t=512,i=512,o){const{width:r,height:n,nativeExtent:s,pixelSize:l,spatialReference:a}=e,c=new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_26__["default"]({x:s.xmin,y:s.ymax,spatialReference:a});null==o&&(o=Math.max(0,Math.round(Math.log(Math.max(r,n))/Math.LN2-8)));const f=this.computeBlockBoundary(s,512,512,{x:s.xmin,y:s.ymax},[l],o);e.storageInfo=new _RasterStorageInfo_js__WEBPACK_IMPORTED_MODULE_16__["default"]({blockWidth:t,blockHeight:i,pyramidBlockWidth:t,pyramidBlockHeight:i,origin:c,firstPyramidLevel:1,maximumPyramidLevel:o,blockBoundary:f})}async computeBestPyramidLevelForLocation(e,t={}){return 0}computeBlockBoundary(e,t,i,o,r,n=0,s=2){if(1===r.length&&n>0){r=[...r];let{x:e,y:t}=r[0];for(let i=0;i<n;i++)e*=s,t*=s,r.push({x:e,y:t})}const l=[],{x:a,y:c}=o;for(let f=0;f<r.length;f++){const{x:o,y:n}=r[f];l.push({minCol:Math.floor((e.xmin-a+.1*o)/t/o),maxCol:Math.floor((e.xmax-a-.1*o)/t/o),minRow:Math.floor((c-e.ymax+.1*n)/i/n),maxRow:Math.floor((c-e.ymin-.1*n)/i/n)})}return l}getPyramidPixelSize(e){const{nativePixelSize:t}=this.rasterInfo,{pyramidResolutions:i,pyramidScalingFactor:o}=this.rasterInfo.storageInfo;if(0===e)return t;if(null!=i&&i.length)return i[e-1];const r=o**e;return{x:t.x*r,y:t.y*r}}identifyPixelLocation(e,t,i,o){const{spatialReference:r,nativeExtent:n,storageInfo:s}=this.rasterInfo,{maximumPyramidLevel:l,origin:a,transposeInfo:c}=s,f=o&&null!=c?c.tileSize[0]:s.blockWidth,m=o&&null!=c?c.tileSize[1]:s.blockHeight,u=(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.projectPoint)(e,r,i);if(!n.intersects(u))return null;if(t<0||t>l)return null;const h=this.getPyramidPixelSize(t),{x:p,y:d}=h,x=(a.y-u.y)/d/m,y=(u.x-a.x)/p/f,g=Math.min(m-1,Math.floor((x-Math.floor(x))*m)),I=Math.min(f-1,Math.floor((y-Math.floor(y))*f));return{pyramidLevel:t,row:Math.floor(x),col:Math.floor(y),rowOffset:g,colOffset:I,blockWidth:f,srcLocation:u}}getTileExtent(e,t,i,o,r,n){const[s,l]=n,a=o.x+i*s*e.x,c=a+s*e.x,f=o.y-t*l*e.y,m=f-l*e.y;return new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_27__["default"]({xmin:a,xmax:c,ymin:m,ymax:f,spatialReference:r})}getBlockWidthHeight(e){return{blockWidth:e>0?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth,blockHeight:e>0?this.rasterInfo.storageInfo.pyramidBlockHeight:this.rasterInfo.storageInfo.blockHeight}}isBlockOutside(e,t,i){const o=this.rasterInfo.storageInfo.blockBoundary[e];return!o||o.maxRow<t||o.maxCol<i||o.minRow>t||o.minCol>i}updateImageSpaceRasterInfo(e){const{pixelSize:t}=e,{width:i,height:o}=e,r=_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_28__["default"].WebMercator;e.spatialReference=r,e.extent=e.nativeExtent=new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_27__["default"]({xmin:-.5,ymax:.5,xmax:i-.5,ymin:.5-o,spatialReference:r}),e.isPseudoSpatialReference=!0,e.transform=null,e.pixelSize=new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_26__["default"]({x:1,y:1,spatialReference:r});const{extent:n,storageInfo:s}=e;if(s){s.origin=new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_26__["default"]({x:n.xmin,y:n.ymax,spatialReference:r});const{pyramidResolutions:i,tileInfo:o}=s;if(i&&i.forEach((e=>{e.x/=t.x,e.y/=t.y})),o){o.origin=s.origin;const t=(e.nativePixelSize.x+e.nativePixelSize.y)/2;o.lods.forEach(((e,i)=>{e.resolution=t*2**i,e.scale=96*e.resolution/.0254}))}}}async _fetchPixels(e,t,i,o={}){let r=(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.getWorldWrapCount)(e);if(r>=2)return{extent:e,pixelBlock:null};const n=this._getSourceDataInfo(e,t,i,o),{pyramidLevel:s,srcResolution:l,srcExtent:a,srcWidth:c,srcHeight:f,ul:m}=n;if(0===c||0===f)return{extent:e,srcExtent:a,pixelBlock:null};const{rasterInfo:u}=this,h=u.transform,p="gcs-shift"===h?.type,d=null!=(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.getWorldWidth)(e.spatialReference);!p&&d||(r=(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.getWorldWrapCount)(n.srcExtent,p));const x=await this._fetchRawTiles(s,m,{width:c,height:f,wrapCount:r},o);if(!x)return{extent:e,srcExtent:a,pixelBlock:null};const y=u.storageInfo,g=s>0?y.pyramidBlockWidth:y.blockWidth,I=s>0?y.pyramidBlockHeight:y.blockHeight;let{x:R,y:w}=u.pixelSize;if(s>0){const{pyramidResolutions:e,pyramidScalingFactor:t}=y;if(null!=e&&e[s-1])({x:R,y:w}=e[s-1]);else{const e=t**s;R*=e,w*=e}}const S=u.spatialReference,k=new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_26__["default"]({x:R,y:w,spatialReference:S}),v=g===c&&I===f&&m.x%g==0&&m.y%I==0,T=new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_26__["default"]({x:(e.xmax-e.xmin)/t,y:(e.ymax-e.ymin)/i,spatialReference:e.spatialReference}),C=!e.spatialReference.equals(S),W=S.isGeographic?1e-9:1e-4,{datumTransformation:j}=o;if(!C&&v&&1===x.pixelBlocks.length&&g===t&&I===i&&Q(l,T,W))return{extent:e,srcExtent:a,srcTilePixelSize:k,pixelBlock:x.pixelBlocks[0]};const H=d&&null!=(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.getWorldWidth)(a.spatialReference)&&this._hasNoneOrGCSShiftTransform,E=o.requestProjectedLocalDirections&&this.rasterInfo.dataType.startsWith("vector");E&&!this.rasterJobHandler&&await (0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.load)();const D=this.rasterJobHandler?await this.rasterJobHandler.getProjectionOffsetGrid({projectedExtent:e,srcBufferExtent:x.extent,pixelSize:T.toJSON(),datumTransformation:j,rasterTransform:h,hasWrapAround:r>0||H,isAdaptive:!1!==this.ioConfig.optimizeProjectionAccuracy,includeGCSGrid:E},o):(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.getProjectionOffsetGrid)({projectedExtent:e,srcBufferExtent:x.extent,pixelSize:T,datumTransformation:j,rasterTransform:h,hasWrapAround:r>0||H,isAdaptive:!1,includeGCSGrid:E});let O;const A=!o.requestRawData,q={rows:D.spacing[0],cols:D.spacing[1]},J=this._hasNoneOrGCSShiftTransform?this._getRasterTileAlignmentInfo(s,x.extent.xmin):void 0,{pixelBlocks:N,mosaicSize:V,isPartiallyFilled:U}=x;let $=null;if(this.rasterJobHandler){const e=await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:N,srcMosaicSize:V,destDimension:A?{width:t,height:i}:null,coefs:A?D.coefficients:null,sampleSpacing:A?q:null,projectDirections:E,gcsGrid:E?D.gcsGrid:null,isUV:"vector-uv"===this.rasterInfo.dataType,interpolation:o.interpolation,alignmentInfo:J,blockWidths:null},o);({pixelBlock:O,localNorthDirections:$}=e)}else{const e=(0,_rasterFunctions_pixelUtils_js__WEBPACK_IMPORTED_MODULE_22__.mosaic)(N,V,{alignmentInfo:J});O=A?(0,_rasterFunctions_pixelUtils_js__WEBPACK_IMPORTED_MODULE_22__.approximateTransform)(e,{width:t,height:i},D.coefficients,q,o.interpolation):e,E&&D.gcsGrid&&($=(0,_rasterFunctions_pixelUtils_js__WEBPACK_IMPORTED_MODULE_22__.getLocalArithmeticNorthRotations)({width:t,height:i},D.gcsGrid),O=(0,_rasterFunctions_vectorFieldUtils_js__WEBPACK_IMPORTED_MODULE_24__.convertToLocalDirections)(O,this.rasterInfo.dataType,$))}return o.requestRawData||E?{extent:e,srcExtent:a,srcTilePixelSize:k,pixelBlock:O,transformGrid:D,localNorthDirections:$,isPartiallyFilled:U}:{extent:e,srcExtent:a,srcTilePixelSize:k,pixelBlock:O}}async _fetchRawTiles(e,t,i,o){const{origin:r,blockBoundary:n}=this.rasterInfo.storageInfo,{blockWidth:s,blockHeight:l}=this.getBlockWidthHeight(e);let{x:a,y:c}=t,{width:f,height:m,wrapCount:u}=i;const h=this._getRasterTileAlignmentInfo(e,0);o.buffer&&(a-=o.buffer.cols,c-=o.buffer.rows,f+=2*o.buffer.cols,m+=2*o.buffer.rows);let p=0,d=0,x=0;if(u&&null!=h){({worldColumnCountFromOrigin:d,originColumnOffset:x,rightPadding:p}=h);d*h.blockWidth-p>=a+f&&(p=0)}const y=Math.floor(a/s),g=Math.floor(c/l),I=Math.floor((a+f+p-1)/s),R=Math.floor((c+m+p-1)/l),w=n[e];if(!w)return null;const{minRow:S,minCol:k,maxCol:v,maxRow:T}=w;if(0===u&&(R<S||I<k||g>T||y>v))return null;const b=new Array;let P=!1;const B=null==this.ioConfig.allowPartialFill?o.allowPartialFill:this.ioConfig.allowPartialFill;for(let H=g;H<=R;H++)for(let t=y;t<=I;t++){let i=t;if(!o.disableWrapAround&&u&&null!=h&&d<=t&&(i=t-d-x),H>=S&&i>=k&&T>=H&&v>=i){const t=this._tileFetchQueue.push({pyramidLevel:e,row:H,col:i,options:o},{signal:o.signal});B?b.push(new Promise((e=>{t.then((t=>e(t))).catch((()=>{P=!0,e(null)}))}))):b.push(t)}else b.push(Promise.resolve(null))}if(0===b.length)return null;const _=await Promise.all(b),M={height:(R-g+1)*l,width:(I-y+1)*s},{spatialReference:C}=this.rasterInfo,W=this.getPyramidPixelSize(e),{x:j,y:z}=W;return{extent:new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_27__["default"]({xmin:r.x+y*s*j,xmax:r.x+(I+1)*s*j,ymin:r.y-(R+1)*l*z,ymax:r.y-g*l*z,spatialReference:C}),pixelBlocks:_,mosaicSize:M,isPartiallyFilled:P}}_fetchRawTile(e,t,i,o){const r=this.rasterInfo.storageInfo.blockBoundary[e];if(!r)return Promise.resolve(null);const{minRow:s,minCol:l,maxCol:a,maxRow:c}=r;if(t<s||i<l||t>c||i>a)return Promise.resolve(null);const f=(0,_RawBlockCache_js__WEBPACK_IMPORTED_MODULE_19__.getRasterId)(this.rasterId,o.sliceId),m=`${e}/${t}/${i}`;let u=(0,_RawBlockCache_js__WEBPACK_IMPORTED_MODULE_19__.getBlock)(f,o.registryId,m);if(null==u){const r=new AbortController;u=this.fetchRawTile(e,t,i,{...o,signal:r.signal}),(0,_RawBlockCache_js__WEBPACK_IMPORTED_MODULE_19__.putBlock)(f,o.registryId,m,u,r),u.catch((()=>(0,_RawBlockCache_js__WEBPACK_IMPORTED_MODULE_19__.deleteBlock)(f,o.registryId,m)))}return o.signal&&(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.onAbort)(o,(()=>{(0,_RawBlockCache_js__WEBPACK_IMPORTED_MODULE_19__.decreaseRefCount)(f,o.registryId,m)})),u}_computeMagDirValues(e){const{bandCount:t,dataType:i}=this.rasterInfo;if(!(2===t&&"vector-magdir"===i||"vector-uv"===i)||2!==e?.length||!e[0]?.length)return null;const o=e[0].length;if("vector-magdir"===i){const t=e[1].map((e=>(e+360)%360));return[e[0],t]}const[r,n]=e,s=[],l=[];for(let a=0;a<o;a++){const[e,t]=(0,_rasterFunctions_vectorFieldUtils_js__WEBPACK_IMPORTED_MODULE_24__.uvComponentToVector)([r[a],n[a]]);s.push(e),l.push(t)}return[s,l]}_getRasterTileAlignmentInfo(e,t){return null==this._rasterTileAlignmentInfo&&(this._rasterTileAlignmentInfo=(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.getRasterDatasetAlignmentInfo)(this.rasterInfo)),null==this._rasterTileAlignmentInfo.pyramidsInfo?null:{startX:t,halfWorldWidth:this._rasterTileAlignmentInfo.halfWorldWidth,hasGCSSShiftTransform:this._rasterTileAlignmentInfo.hasGCSSShiftTransform,...this._rasterTileAlignmentInfo.pyramidsInfo[e]}}_getSourceDataInfo(e,t,i,o={}){const r={datumTransformation:o.datumTransformation,pyramidLevel:0,pyramidResolution:null,srcExtent:null,srcHeight:0,srcResolution:null,srcWidth:0,ul:{x:0,y:0}};o.srcResolution&&(r.srcResolution=o.srcResolution,this._updateSourceDataInfo(e,r));const n=this.rasterInfo.storageInfo.maximumPyramidLevel||0,{srcWidth:s,srcHeight:l,pyramidLevel:a}=r,c=s/t,f=l/i,m=a<n&&c*f>=16,u=a===n&&this._requireTooManySrcTiles(s,l,t,i);if(m||u||(0===s||0===l)){const s=new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_26__["default"]({x:(e.xmax-e.xmin)/t,y:(e.ymax-e.ymin)/i,spatialReference:e.spatialReference});let l=(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.projectResolution)(s,this.rasterInfo.spatialReference,e,r.datumTransformation);const u=!l||o.srcResolution&&l.x+l.y<o.srcResolution.x+o.srcResolution.y;if(m&&o.srcResolution&&u){const e=Math.round(Math.log(Math.max(c,f))/Math.LN2)-1;if(n-a+3>=e){const t=2**e;l={x:o.srcResolution.x*t,y:o.srcResolution.y*t}}}l&&(r.srcResolution=l,this._updateSourceDataInfo(e,r))}return this._requireTooManySrcTiles(r.srcWidth,r.srcHeight,t,i)&&(r.srcWidth=0,r.srcHeight=0),r}_requireTooManySrcTiles(e,t,i,o){const{tileInfo:r}=this.rasterInfo.storageInfo,n=Math.ceil(e/r.size[0])*Math.ceil(t/r.size[1]),s=e/i,l=t/o,a=Math.max(1,(i+o)/1024);return n>=V*a||s>N||l>N}_updateSourceDataInfo(e,t){t.srcWidth=0,t.srcHeight=0;const{rasterInfo:i}=this,o=i.spatialReference,{srcResolution:r,datumTransformation:n}=t,{pyramidLevel:s,pyramidResolution:l,excessiveReading:a}=(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.snapPyramid)(r,i,this.ioConfig.sampling);if(a)return;let c=t.srcExtent||(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_23__.projectExtent)(e,o,n);if(null==c)return;const f=i.transform;f&&(c=f.inverseTransform(c)),t.srcExtent=c;const{x:m,y:u}=i.storageInfo.origin,h=Math.floor((c.xmin-m)/l.x+.1),p=Math.floor((u-c.ymax)/l.y+.1),d=Math.floor((c.xmax-m)/l.x-.1),x=Math.floor((u-c.ymin)/l.y-.1),y=c.width<.1*l.x?0:d-h+1,g=c.height<.1*l.y?0:x-p+1;t.pyramidLevel=s,t.pyramidResolution=l,t.srcWidth=y,t.srcHeight=g,t.ul={x:h,y:p}}_getRequestOptionsWithSliceId(e){return null!=this.rasterInfo.multidimensionalInfo&&null==e.sliceId&&(e={...e,sliceId:this.getSliceIndex(e.multidimensionalDefinition)}),e}_processIdentifyResult(e,t){const{srcLocation:i,position:o,pyramidLevel:r,useTransposedTile:n}=t,s=e.pixels[0].length/e.width/e.height;if(!(!e.mask||e.mask[o]))return{location:i,value:null};const{multidimensionalInfo:l}=this.rasterInfo;if(null==l||!n){const t=e.pixels.map((e=>e[o])),n={location:i,value:t,pyramidLevel:r},s=this._computeMagDirValues(t.map((e=>[e])));return s?.length&&(n.magdirValue=s.map((e=>e[0]))),n}let a=e.pixels.map((e=>e.slice(o*s,o*s+s))),c=this._computeMagDirValues(a);const{requestSomeSlices:f,identifyOptions:u}=t;let h=(0,_multidimensionalUtils_js__WEBPACK_IMPORTED_MODULE_18__.createSlices)(l,u.transposedVariableName);if(f){const e=(0,_multidimensionalUtils_js__WEBPACK_IMPORTED_MODULE_18__.getSliceIds)(h,u.multidimensionalDefinition,u.timeExtent);a=a.map((t=>e.map((e=>t[e])))),c=c?.map((t=>e.map((e=>t[e])))),h=e.map((e=>h[e]))}const p=e.noDataValues||this.rasterInfo.noDataValue,d={pixels:a,pixelType:e.pixelType};let x;null!=p&&((0,_rasterFormats_pixelRangeUtils_js__WEBPACK_IMPORTED_MODULE_20__.convertNoDataToMask)(d,p),x=d.mask);return{location:i,value:null,dataSeries:h.map(((e,t)=>{const i={value:0===x?.[t]?null:a.map((e=>e[t])),multidimensionalDefinition:e.multidimensionalDefinition.map((e=>new _DimensionalDefinition_js__WEBPACK_IMPORTED_MODULE_14__["default"]({...e,isSlice:!0})))};return c?.length&&(i.magdirValue=[c[0][t],c[1][t]]),i})),pyramidLevel:r}}};function Q(e,t,i){return Math.abs(e.x-t.x)<i&&Math.abs(e.y-t.y)<i}(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)()],$.prototype,"_rasterTileAlignmentInfo",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)()],$.prototype,"_tileFetchQueue",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({readOnly:!0})],$.prototype,"_isGlobalWrappableSource",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({readOnly:!0})],$.prototype,"_hasNoneOrGCSShiftTransform",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)()],$.prototype,"_openPromise",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)()],$.prototype,"rasterJobHandler",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({readOnly:!0})],$.prototype,"rasterId",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)(_commonProperties_js__WEBPACK_IMPORTED_MODULE_13__.url)],$.prototype,"url",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({type:String,json:{write:!0}})],$.prototype,"datasetName",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)({type:String,json:{write:!0}})],$.prototype,"datasetFormat",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)()],$.prototype,"hasUniqueSourceStorageInfo",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)()],$.prototype,"rasterInfo",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)()],$.prototype,"ioConfig",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_7__.property)()],$.prototype,"sourceJSON",void 0),$=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_11__.subclass)("esri.layers.support.rasterDatasets.BaseRaster")],$);const X=$;


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/rasterDatasets/CovJSONRaster.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/rasterDatasets/CovJSONRaster.js ***!
  \**********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ h; }
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/RandomLCG.js */ "./node_modules/@arcgis/core/core/RandomLCG.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _BaseRaster_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./BaseRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/BaseRaster.js");
/* harmony import */ var _covJSONParser_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./covJSONParser.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/covJSONParser.js");
/* harmony import */ var _InMemoryRaster_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./InMemoryRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/InMemoryRaster.js");
/* harmony import */ var _rasterFunctions_stretchUtils_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../rasterFunctions/stretchUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/stretchUtils.js");
/* harmony import */ var _rest_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../rest/support/FeatureSet.js */ "./node_modules/@arcgis/core/rest/support/FeatureSet.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
let m=class extends _BaseRaster_js__WEBPACK_IMPORTED_MODULE_7__["default"]{constructor(){super(...arguments),this.datasetFormat="CovJSON"}fetchRawTile(e,t,r,s={}){return this._inMemoryRaster.fetchRawTile(e,t,r,s)}async _open(e){const{extent:t,pixelBlocks:r,multidimensionalInfo:s,attributeTable:a,bandNames:o}=await this._fetchData(e),{statistics:i,histograms:n}=(0,_rasterFunctions_stretchUtils_js__WEBPACK_IMPORTED_MODULE_10__.computeStatisticsHistograms)(r[0]),m=o?.map((e=>({BandName:e}))),h={DataType:a?"Thematic":s?"Scientific":"Generic",BandProperties:m},d=new _InMemoryRaster_js__WEBPACK_IMPORTED_MODULE_9__["default"]({source:{extent:t,pixelBlocks:r,attributeTable:a?_rest_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_11__["default"].fromJSON(a):null,multidimensionalInfo:s,statistics:i,histograms:n,keyProperties:h,isPseudoSpatialReference:!1}});await d.open(),this._inMemoryRaster=d;const u=this.source?"":this.url.slice(this.url.lastIndexOf("/")+1);this._set("datasetName",u.slice(0,u.indexOf("."))),this._set("rasterInfo",d.rasterInfo)}async _fetchData(e){const r=this.source??(await this.request(this.url,{signal:e?.signal})).data,s="imagery-tile-layer:open-coverage-json";if("coverage"!==r.type?.toLowerCase()||"grid"!==r.domain?.domainType?.toLowerCase())throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"](s,"Only coverage with Grid domain type is supported");if(!r.ranges)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"](s,"Missing ranges in the grid coverage data");if(!r.domain.referencing?.length)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"](s,"Missing domain referencing in the grid coverage data");const a=Object.values(r.ranges);for(let n=0;n<a.length;n++){const{axisNames:e,shape:r,type:c,values:l}=a[n];if(!("ndarray"===c.toLowerCase()&&l?.length&&e?.length&&r?.length))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"](s,"Only ranges with valid NdArray, axisNames, shape, and inline values are supported");if(!((0,_covJSONParser_js__WEBPACK_IMPORTED_MODULE_8__.isXAxis)(e[e.length-1])&&(0,_covJSONParser_js__WEBPACK_IMPORTED_MODULE_8__.isYAxis)(e[e.length-2])))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"](s,"Only row-major ordered pixel values are supported. X axis must be the last axis.")}return (0,_covJSONParser_js__WEBPACK_IMPORTED_MODULE_8__.parseGridCoverage)(r)}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)({type:String,json:{write:!0}})],m.prototype,"datasetFormat",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)({constructOnly:!0})],m.prototype,"source",void 0),m=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__.subclass)("esri.layers.support.rasterDatasets.CovJSONRaster")],m);const h=m;


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/rasterDatasets/DBFParser.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/rasterDatasets/DBFParser.js ***!
  \******************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ r; }
/* harmony export */ });
/* harmony import */ var _byteStreamUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./byteStreamUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/byteStreamUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
function t(e){const t=e.fields,r=e.records,n=t.some((e=>"oid"===e.name.toLowerCase()))?"OBJECTID":"OID",i=[{name:n,type:"esriFieldTypeOID",alias:"OID"}].concat(t.map((e=>({name:e.name,type:"esriFieldType"+e.typeName,alias:e.name})))),a=i.map((e=>e.name)),s=[];let o=0,l=0;return r.forEach((e=>{const t={};for(t[n]=o++,l=1;l<a.length;l++)t[a[l]]=e[l-1];s.push({attributes:t})})),{displayFieldName:"",fields:i,features:s}}class r{static get supportedVersions(){return[5]}static parse(r){const n=new DataView(r),i=3&n.getUint8(0);if(3!==i)return{header:{version:i},recordSet:null};const a=n.getUint32(4,!0),s=n.getUint16(8,!0),o=n.getUint16(10,!0),l={version:i,recordCount:a,headerByteCount:s,recordByteCount:o};let p=32;const d=[],g=[];let h;if(3===i){for(;13!==n.getUint8(p);)h=String.fromCharCode(n.getUint8(p+11)).trim(),d.push({name:(0,_byteStreamUtils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToUTF8)(new Uint8Array(r,p,11)),type:h,typeName:["String","Date","Double","Boolean","String","Integer"][["C","D","F","L","M","N"].indexOf(h)],length:n.getUint8(p+16)}),p+=32;if(p+=1,d.length>0)for(;g.length<a&&r.byteLength-p>o;){const t=[];32===n.getUint8(p)?(p+=1,d.forEach((n=>{if("C"===n.type)t.push((0,_byteStreamUtils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToUTF8)(new Uint8Array(r,p,n.length)).trim());else if("N"===n.type)t.push(parseInt(String.fromCharCode.apply(null,new Uint8Array(r,p,n.length)).trim(),10));else if("F"===n.type)t.push(parseFloat(String.fromCharCode.apply(null,new Uint8Array(r,p,n.length)).trim()));else if("D"===n.type){const e=String.fromCharCode.apply(null,new Uint8Array(r,p,n.length)).trim();t.push(new Date(parseInt(e.slice(0,4),10),parseInt(e.slice(4,6),10)-1,parseInt(e.slice(6,8),10)))}p+=n.length})),g.push(t)):p+=o}}return{header:l,fields:d,records:g,recordSet:t({fields:d,records:g})}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/rasterDatasets/FunctionRaster.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/rasterDatasets/FunctionRaster.js ***!
  \***********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ u; }
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/RandomLCG.js */ "./node_modules/@arcgis/core/core/RandomLCG.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _geometry_Polygon_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../geometry/Polygon.js */ "./node_modules/@arcgis/core/geometry/Polygon.js");
/* harmony import */ var _BaseRaster_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./BaseRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/BaseRaster.js");
/* harmony import */ var _rasterFunctions_clipUtils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../rasterFunctions/clipUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/clipUtils.js");
/* harmony import */ var _rasterFunctions_pixelUtils_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../rasterFunctions/pixelUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/pixelUtils.js");
/* harmony import */ var _rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../rasterFunctions/rasterProjectionHelper.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/rasterProjectionHelper.js");
/* harmony import */ var _rest_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../rest/support/FeatureSet.js */ "./node_modules/@arcgis/core/rest/support/FeatureSet.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const p=40;let m=class extends _BaseRaster_js__WEBPACK_IMPORTED_MODULE_8__["default"]{constructor(){super(...arguments),this.datasetFormat="Function",this.tileType="Raster",this.rasterFunction=null,this._clippingGeometry=new Map}async fetchPixels(t,e,r,s={}){const{rasters:i,rasterIds:o}=this.primaryRasters;let l=!1;const{interpolation:c}=s,p=this.rasterFunction.flatWebGLFunctionChain?.hasFocalFunction;!s.requestRawData&&p&&(l=1===i.length&&!s.skipRasterFunction,s={...s,interpolation:"bilinear",requestRawData:l});const m=i.map((i=>i.fetchPixels(t,e,r,s))),u=await Promise.all(m),h=u.map((t=>t.pixelBlock)),f=l||s.requestRawData?u.map((t=>t.srcTilePixelSize)):null;if(s.skipRasterFunction||h.every((t=>null==t)))return u[0];const d=u.find((t=>null!=t.pixelBlock))?.extent??t;let y=this.rasterJobHandler?await this.rasterJobHandler.process({extent:d,primaryPixelBlocks:h,primaryPixelSizes:f,primaryRasterIds:o}):this.rasterFunction.process({extent:d,primaryPixelBlocks:h,primaryPixelSizes:f,primaryRasterIds:o});const{transformGrid:g}=u[0];if(!l||null==y||null==g){const t=s.noClip?null:this.getClippingGeometry(d.spatialReference);return s.noClip||s.requestRawData||null==y||!t||(y=await (0,_rasterFunctions_clipUtils_js__WEBPACK_IMPORTED_MODULE_9__.clip)(y,d,t)),{...u[0],pixelBlock:y}}const x={rows:g.spacing[0],cols:g.spacing[1]};let R;if(this.rasterJobHandler){R=(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:[y],srcMosaicSize:{width:y.width,height:y.height},destDimension:{width:e,height:r},coefs:g.coefficients,sampleSpacing:x,projectDirections:!1,gcsGrid:null,isUV:!1,interpolation:c,alignmentInfo:void 0,blockWidths:null},s)).pixelBlock}else R=(0,_rasterFunctions_pixelUtils_js__WEBPACK_IMPORTED_MODULE_10__.approximateTransform)(y,{width:e,height:r},g.coefficients,x,c);const w=s.noClip?null:this.getClippingGeometry(t.spatialReference);return s.noClip||s.requestRawData||null==R||null==w||(R=await (0,_rasterFunctions_clipUtils_js__WEBPACK_IMPORTED_MODULE_9__.clip)(R,t,w)),{extent:t,srcExtent:u[0].srcExtent,pixelBlock:R}}getClippingGeometry(t){const e=this._clippingGeometry.get("0");if(!t||!e)return e;const r=f(t);let s=this._clippingGeometry.get(r);return null!=s||(s=t.equals(e.spatialReference)?e:(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_11__.projectPolygon)(e,t),this._clippingGeometry.set(r,s)),s}async _open(t){const{rasterFunction:r}=this;this.primaryRasters?.rasters?.length?r.sourceRasters=this.primaryRasters.rasters:(this.primaryRasters=r.getPrimaryRasters(),this.rasterJobHandler&&this.primaryRasters.rasters?.forEach((t=>t.rasterJobHandler=this.rasterJobHandler)));const{rasters:s,rasterIds:i}=this.primaryRasters,o=s.map((e=>e.rasterInfo?void 0:e.open(t)));await Promise.all(o);const n=s.map((({rasterInfo:t})=>t)),a=r.bind({rasterInfos:n,rasterIds:i});if(r.rawSourceRasterInfos=n,!a.success||0===n.length)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("raster-function:open",`cannot bind the function: ${a.error??""}`);const l="Table"===r.functionName?r:r.functionArguments?.raster;"Table"===l?.functionName&&(r.rasterInfo.attributeTable=_rest_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_12__["default"].fromJSON(l.functionArguments.attributeTableAsRecordSet)),await this.syncJobHandler();const p=n[0];this.hasUniqueSourceStorageInfo=1===n.length||n.slice(1).every((t=>h(t,p))),this.set("sourceJSON",s[0].sourceJSON),this.set("rasterInfo",r.rasterInfo),await this._updateClipGeometry()}async syncJobHandler(){return this.rasterJobHandler?.updateRasterFunction(this.rasterFunction)}async _updateClipGeometry(){const t=this.rasterFunction.getClippingGeometries()[0];let e=t?.clippingGeometry;if(e&&"inside"===t.clippingType){const{extent:t}=this.rasterInfo,{difference:r,densify:s}=await Promise.all(/*! import() */[__webpack_require__.e("vendors-node_modules_arcgis_core_chunks_geometryEngineBase_js"), __webpack_require__.e("node_modules_arcgis_core_geometry_geometryEngine_js")]).then(__webpack_require__.bind(__webpack_require__, /*! ../../../geometry/geometryEngine.js */ "./node_modules/@arcgis/core/geometry/geometryEngine.js"));let o=s(_geometry_Polygon_js__WEBPACK_IMPORTED_MODULE_7__["default"].fromExtent(t),2*(t.width+t.height)/p);o=(0,_rasterFunctions_rasterProjectionHelper_js__WEBPACK_IMPORTED_MODULE_11__.projectPolygon)(o,e.spatialReference),e=r(o,e)}this._clippingGeometry.clear(),e&&this._clippingGeometry.set("0",e)}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)({type:String,json:{write:!0}})],m.prototype,"datasetFormat",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)()],m.prototype,"tileType",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)()],m.prototype,"rasterFunction",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)()],m.prototype,"primaryRasters",void 0),m=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__.subclass)("esri.layers.support.rasterDatasets.FunctionRaster")],m);const u=m;function h(t,e){const{storageInfo:r,pixelSize:s,spatialReference:i,extent:o}=t,{storageInfo:n,pixelSize:a,spatialReference:l,extent:c}=e;return s.x===a.x&&s.y===a.y&&i.equals(l)&&o.equals(c)&&r.blockHeight===n.blockHeight&&r.blockWidth===n.blockWidth&&r.maximumPyramidLevel===n.maximumPyramidLevel}function f(t){return String(t.wkid??t.wkt??t.wkt2)}


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/rasterDatasets/ImageAuxRaster.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/rasterDatasets/ImageAuxRaster.js ***!
  \***********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ d; }
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _geometry_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../geometry.js */ "./node_modules/@arcgis/core/geometry.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../core/RandomLCG.js */ "./node_modules/@arcgis/core/core/RandomLCG.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _BaseRaster_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./BaseRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/BaseRaster.js");
/* harmony import */ var _InMemoryRaster_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./InMemoryRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/InMemoryRaster.js");
/* harmony import */ var _pamParser_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./pamParser.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/pamParser.js");
/* harmony import */ var _rasterFormats_RasterCodec_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../rasterFormats/RasterCodec.js */ "./node_modules/@arcgis/core/layers/support/rasterFormats/RasterCodec.js");
/* harmony import */ var _rasterFunctions_stretchUtils_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../rasterFunctions/stretchUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/stretchUtils.js");
/* harmony import */ var _rasterTransforms_PolynomialTransform_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../rasterTransforms/PolynomialTransform.js */ "./node_modules/@arcgis/core/layers/support/rasterTransforms/PolynomialTransform.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/* harmony import */ var _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../geometry/Extent.js */ "./node_modules/@arcgis/core/geometry/Extent.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
let h=class extends _BaseRaster_js__WEBPACK_IMPORTED_MODULE_9__["default"]{fetchRawTile(t,s,e,r={}){return this._inMemoryRaster.fetchRawTile(t,s,e,r)}async _open(t){const s=await this._fetchData(t);let{spatialReference:e,statistics:r,histograms:o,transform:a}=await this._fetchAuxiliaryData(t);const i=!e;i&&(e=new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_15__["default"]({wkid:3857})),o?.length&&null==r&&(r=(0,_rasterFunctions_stretchUtils_js__WEBPACK_IMPORTED_MODULE_13__.estimateStatisticsFromHistograms)(o));const{width:m,height:l}=s;let c=new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_16__["default"]({xmin:-.5,ymin:.5-l,xmax:m-.5,ymax:.5,spatialReference:e});const h=a?a.forwardTransform(c):c;let d=!0;if(a){const t=a.forwardCoefficients;d=t&&0===t[1]&&0===t[2],d&&(a=null,c=h)}const g=new _InMemoryRaster_js__WEBPACK_IMPORTED_MODULE_10__["default"]({source:{extent:h,nativeExtent:c,transform:a,pixelBlocks:[s],statistics:r,histograms:o,keyProperties:{DateType:"Processed"},isPseudoSpatialReference:i},ioConfig:{sampling:"closest",skipStatistics:!0}});this.ioConfig.skipMapInfo&&(g.ioConfig.skipMapInfo=!0),await g.open(),g.source=null,this._set("rasterInfo",g.rasterInfo),this._inMemoryRaster=g}async _fetchData(t){const{data:e}=await this.request(this.url,{responseType:"array-buffer",signal:t?.signal}),r=(0,_rasterFormats_RasterCodec_js__WEBPACK_IMPORTED_MODULE_12__.getFormat)(e).toUpperCase();if("JPG"!==r&&"PNG"!==r&&"GIF"!==r&&"BMP"!==r)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("image-aux-raster:open","the data is not a supported format");this._set("datasetFormat",r);const o=r.toLowerCase(),a="gif"===o||"bmp"===o||!(0,_core_has_js__WEBPACK_IMPORTED_MODULE_3__["default"])("ios"),i=await this.decodePixelBlock(e,{format:o,useCanvas:a,hasNoZlibMask:!0});if(null==i)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("image-aux-raster:open","the data cannot be decoded");return i}async _fetchAuxiliaryData(t){const s=t?.signal,{skipExtensions:o=[],skipMapInfo:a}=this.ioConfig,i=a||o.includes("aux.xml")?null:this.request(this.url+".aux.xml",{responseType:"xml",signal:s}),n=this.datasetFormat,l="JPG"===n?"jgw":"PNG"===n?"pgw":"BMP"===n?"bpw":null,p=l&&o.includes(l)?null:this.request(this.url.slice(0,this.url.lastIndexOf("."))+"."+l,{responseType:"text",signal:s}),f=await (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.eachAlways)([i,p]);if(s?.aborted)throw (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.createAbortError)();const u=(0,_pamParser_js__WEBPACK_IMPORTED_MODULE_11__.parsePAMInfo)(f[0].value?.data);if(!u.transform){const t=f[1].value?f[1].value.data.split("\n").slice(0,6).map((t=>Number(t))):null;u.transform=6===t?.length?new _rasterTransforms_PolynomialTransform_js__WEBPACK_IMPORTED_MODULE_14__["default"]({forwardCoefficients:[t[4],t[5],t[0],-t[1],t[2],-t[3]]}):null}return u}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__.property)({type:String,json:{write:!0}})],h.prototype,"datasetFormat",void 0),h=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_8__.subclass)("esri.layers.support.rasterDatasets.ImageAuxRaster")],h);const d=h;


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/rasterDatasets/ImageServerRaster.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/rasterDatasets/ImageServerRaster.js ***!
  \**************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ I; }
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _geometry_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../geometry.js */ "./node_modules/@arcgis/core/geometry.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/maybe.js */ "./node_modules/@arcgis/core/core/maybe.js");
/* harmony import */ var _core_urlUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/urlUtils.js */ "./node_modules/@arcgis/core/core/urlUtils.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../core/RandomLCG.js */ "./node_modules/@arcgis/core/core/RandomLCG.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _RasterInfo_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../RasterInfo.js */ "./node_modules/@arcgis/core/layers/support/RasterInfo.js");
/* harmony import */ var _RasterStorageInfo_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../RasterStorageInfo.js */ "./node_modules/@arcgis/core/layers/support/RasterStorageInfo.js");
/* harmony import */ var _TileInfo_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../TileInfo.js */ "./node_modules/@arcgis/core/layers/support/TileInfo.js");
/* harmony import */ var _TilemapCache_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../TilemapCache.js */ "./node_modules/@arcgis/core/layers/support/TilemapCache.js");
/* harmony import */ var _BaseRaster_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./BaseRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/BaseRaster.js");
/* harmony import */ var _rasterFunctions_pixelUtils_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../rasterFunctions/pixelUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/pixelUtils.js");
/* harmony import */ var _rasterTransforms_GCSShiftTransform_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../rasterTransforms/GCSShiftTransform.js */ "./node_modules/@arcgis/core/layers/support/rasterTransforms/GCSShiftTransform.js");
/* harmony import */ var _rest_imageService_fetchRasterInfo_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../rest/imageService/fetchRasterInfo.js */ "./node_modules/@arcgis/core/rest/imageService/fetchRasterInfo.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/* harmony import */ var _geometry_Point_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../../geometry/Point.js */ "./node_modules/@arcgis/core/geometry/Point.js");
/* harmony import */ var _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../../geometry/Extent.js */ "./node_modules/@arcgis/core/geometry/Extent.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
let g=class extends _BaseRaster_js__WEBPACK_IMPORTED_MODULE_14__["default"]{constructor(){super(...arguments),this._levelOffset=0,this._tilemapCache=null,this._slices=null,this.datasetFormat="RasterTileServer",this.tileType=null}async fetchRawTile(e,t,i,s={}){const{storageInfo:r,extent:a}=this.rasterInfo,{transposeInfo:l}=r,o=null!=l&&!!s.transposedVariableName;if(this._slices&&!o&&null==s.sliceId)return null;const n=o?0:r.maximumPyramidLevel-e+this._levelOffset,c=`${this.url}/tile/${n}/${t}/${i}`,m=this._slices?o?{variable:s.transposedVariableName}:{sliceId:s.sliceId||0}:null,{data:h}=await this.request(c,{query:m,responseType:"array-buffer",signal:s.signal});if(!h)return null;const f=o?l.tileSize:r.tileInfo.size,p=await this.decodePixelBlock(h,{width:f[0],height:f[1],planes:null,pixelType:null,isPoint:"Elevation"===this.tileType,returnInterleaved:o,noDataValue:this.rasterInfo.noDataValue});if(null==p)return null;const d=r.blockBoundary[e];if("jpg"!==r.compression||i>d.minCol&&i<d.maxCol&&t>d.minRow&&t<d.maxRow)return p;const{origin:y,blockWidth:x,blockHeight:g}=r,{x:v,y:S}=this.getPyramidPixelSize(e),I=Math.round((a.xmin-y.x)/v)%x,w=Math.round((a.xmax-y.x)/v)%x||x,j=Math.round((y.y-a.ymax)/S)%g,M=Math.round((y.y-a.ymin)/S)%g||g,b=i===d.minCol?I:0,T=t===d.minRow?j:0,_=i===d.maxCol?w:x,O=t===d.maxRow?M:g;return (0,_rasterFunctions_pixelUtils_js__WEBPACK_IMPORTED_MODULE_15__.setValidBoundary)(p,{x:b,y:T},{width:_-b,height:O-T}),p}getSliceIndex(e){if(!this._slices||null==e||0===e.length)return null;const t=e;for(let i=0;i<this._slices.length;i++){const e=this._slices[i].multidimensionalDefinition;if(e.length===t.length&&!e.some((e=>{const i=t.find((t=>e.variableName===t.variableName&&t.dimensionName===e.dimensionName));if(!i)return!0;return(Array.isArray(e.values[0])?`${e.values[0][0]}-${e.values[0][1]}`:e.values[0])!==(Array.isArray(i.values[0])?`${i.values[0][0]}-${i.values[0][1]}`:i.values[0])})))return i}return null}async fetchVariableStatisticsHistograms(e,t){const i=this.request(this.url+"/statistics",{query:{variable:e,f:"json"},signal:t}).then((e=>e.data?.statistics)),s=this.request(this.url+"/histograms",{query:{variable:e,f:"json"},signal:t}).then((e=>e.data?.histograms)),r=await Promise.all([i,s]);return r[0]&&r[0].forEach((e=>{e.avg=e.mean,e.stddev=e.standardDeviation})),r[1]?.[0]?.counts?.length||(r[1]=null),{statistics:r[0]||null,histograms:r[1]||null}}async computeBestPyramidLevelForLocation(e,t={}){if(!this._tilemapCache)return 0;let i=this.identifyPixelLocation(e,0,t.datumTransformation);if(null===i)return null;let s=0;const{maximumPyramidLevel:r}=this.rasterInfo.storageInfo;let a=r-s+this._levelOffset;const l=i.srcLocation;for(;a>=0;){try{if("available"===await this._tilemapCache.fetchAvailability(a,i.row,i.col,t))break}catch{}if(a--,s++,i=this.identifyPixelLocation(l,s,t.datumTransformation),null===i)return null}return-1===a||null==i?null:s}async _open(e){const r=e?.signal,a=this.sourceJSON?{data:this.sourceJSON}:await this.request(this.url,{query:{f:"json"},signal:r});a.ssl&&(this.url=this.url.replace(/^http:/i,"https:"));const l=a.data;if(this.sourceJSON=l,!l)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("imageserverraster:open","cannot initialize tiled image service, missing service info");if(!l.tileInfo)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("imageserverraster:open","use ImageryLayer to open non-tiled image services");this._fixScaleInServiceInfo();const m=["jpg","jpeg","png","png8","png24","png32","mixed"];this.tileType=l.cacheType,null==this.tileType&&(m.includes(l.tileInfo.format.toLowerCase())?this.tileType="Map":"lerc"===l.tileInfo.format.toLowerCase()?this.tileType="Elevation":this.tileType="Raster"),this.datasetName=l.name?.slice(l.name.indexOf("/")+1)??"";const u=await this._fetchRasterInfo({signal:r});if(null==u)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("image-server-raster:open","cannot initialize image service");(0,_rest_imageService_fetchRasterInfo_js__WEBPACK_IMPORTED_MODULE_17__.patchServiceInfo)(u,l);const h="Map"===this.tileType?v(l.tileInfo,l):_TileInfo_js__WEBPACK_IMPORTED_MODULE_12__["default"].fromJSON(l.tileInfo);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_3__.assertIsSome)(h);const[p,d]=this._computeMinMaxLOD(u,h),{extent:y,pixelSize:x}=u,g=.5/u.width*x.x,I=Math.max(x.x,x.y),{lods:w}=h;("Map"!==this.tileType&&0!==l.maxScale||Math.abs(x.x-x.y)>g||!w.some((e=>Math.abs(e.resolution-I)<g)))&&(x.x=x.y=p.resolution,u.width=Math.ceil((y.xmax-y.xmin)/x.x-.1),u.height=Math.ceil((y.ymax-y.ymin)/x.y-.1));const j=p.level-d.level,[M,b]=h.size,T=[],_=[];w.forEach(((e,t)=>{e.level>=d.level&&e.level<=p.level&&T.push({x:e.resolution,y:e.resolution}),t<w.length-1&&_.push(Math.round(10*e.resolution/w[t+1].resolution)/10)})),T.sort(((e,t)=>e.x-t.x));const O=this.computeBlockBoundary(y,M,b,h.origin,T,j),R=T.length>1?T.slice(1):null;let z;l.transposeInfo&&(z={tileSize:[l.transposeInfo.rows,l.transposeInfo.cols],packetSize:u.keyProperties?._yxs.PacketSize??0});const N=_.length<=1||_.length>=3&&_.slice(0,-1).every((e=>e===_[0]))?_[0]??2:Math.round(10/(d.resolution/p.resolution)**(-1/j))/10;if(u.storageInfo=new _RasterStorageInfo_js__WEBPACK_IMPORTED_MODULE_11__["default"]({blockWidth:h.size[0],blockHeight:h.size[1],pyramidBlockWidth:h.size[0],pyramidBlockHeight:h.size[1],pyramidResolutions:R,pyramidScalingFactor:N,compression:h.format,origin:h.origin,firstPyramidLevel:1,maximumPyramidLevel:j,tileInfo:h,transposeInfo:z,blockBoundary:O}),S(u),this._set("rasterInfo",u),l.capabilities.toLowerCase().includes("tilemap")){const e={tileInfo:u.storageInfo.tileInfo,parsedUrl:(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_4__.urlToObject)(this.url),url:this.url,tileServers:[]};this._tilemapCache=new _TilemapCache_js__WEBPACK_IMPORTED_MODULE_13__.TilemapCache({layer:e})}}async _fetchRasterInfo(e){const t=this.sourceJSON;if("Map"===this.tileType){const e=t.fullExtent||t.extent,i=Math.ceil((e.xmax-e.xmin)/t.pixelSizeX-.1),s=Math.ceil((e.ymax-e.ymin)/t.pixelSizeY-.1),r=_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_18__["default"].fromJSON(t.spatialReference||e.spatialReference),a=new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_19__["default"]({x:t.pixelSizeX,y:t.pixelSizeY,spatialReference:r});return new _RasterInfo_js__WEBPACK_IMPORTED_MODULE_10__["default"]({width:i,height:s,bandCount:3,extent:_geometry_Extent_js__WEBPACK_IMPORTED_MODULE_20__["default"].fromJSON(e),spatialReference:r,pixelSize:a,pixelType:"u8",statistics:null,keyProperties:{DataType:"processed"}})}const{signal:i}=e,s=(0,_rest_imageService_fetchRasterInfo_js__WEBPACK_IMPORTED_MODULE_17__.fetchServiceRasterInfo)(this.url,this.sourceJSON,{signal:i,query:this.ioConfig.customFetchParameters}),r=t.hasMultidimensions?this.request(`${this.url}/slices`,{query:{f:"json"},signal:i}).then((e=>e.data?.slices)).catch((()=>null)):null,a=await Promise.all([s,r]);return this._slices=a[1],a[0]}_fixScaleInServiceInfo(){const{sourceJSON:e}=this;e.minScale&&e.minScale<0&&(e.minScale=0),e.maxScale&&e.maxScale<0&&(e.maxScale=0)}_computeMinMaxLOD(e,t){const{pixelSize:i}=e,s=.5/e.width*i.x,{lods:r}=t,a=t.lodAt(Math.max.apply(null,r.map((e=>e.level)))),l=t.lodAt(Math.min.apply(null,r.map((e=>e.level)))),{tileType:o}=this;if("Map"===o)return this._levelOffset=r[0].level,[a,l];if("Raster"===o){return[r.find((e=>e.resolution===i.x))??a,l]}const{minScale:n,maxScale:c}=this.sourceJSON;let m=a;c>0&&(m=r.find((e=>Math.abs(e.scale-c)<s)),m||(m=r.filter((e=>e.scale>c)).sort(((e,t)=>e.scale>t.scale?1:-1))[0]??a));let u=l;return n>0&&(u=r.find((e=>Math.abs(e.scale-n)<s))??l,this._levelOffset=u.level-l.level),[m,u]}};function v(e,t){if(!e)return null;const{minScale:i,maxScale:s,minLOD:r,maxLOD:a}=t;if(null!=r&&null!=a)return _TileInfo_js__WEBPACK_IMPORTED_MODULE_12__["default"].fromJSON({...e,lods:e.lods.filter((({level:e})=>null!=e&&e>=r&&e<=a))});if(0!==i&&0!==s){const t=e=>Math.round(1e4*e)/1e4,r=i?t(i):1/0,a=s?t(s):-1/0;return _TileInfo_js__WEBPACK_IMPORTED_MODULE_12__["default"].fromJSON({...e,lods:e.lods.filter((e=>{const i=t(e.scale);return i<=r&&i>=a}))})}return _TileInfo_js__WEBPACK_IMPORTED_MODULE_12__["default"].fromJSON(e)}function S(e){const{extent:t,spatialReference:i}=e;t.xmin>-1&&t.xmax>181&&i?.wkid&&i.isGeographic&&(e.nativeExtent=e.extent,e.transform=new _rasterTransforms_GCSShiftTransform_js__WEBPACK_IMPORTED_MODULE_16__["default"],e.extent=e.transform.forwardTransform(t))}(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__.property)({type:String,json:{write:!0}})],g.prototype,"datasetFormat",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__.property)()],g.prototype,"tileType",void 0),g=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_9__.subclass)("esri.layers.support.rasterDatasets.ImageServerRaster")],g);const I=g;


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/rasterDatasets/InMemoryRaster.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/rasterDatasets/InMemoryRaster.js ***!
  \***********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ g; }
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _geometry_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../geometry.js */ "./node_modules/@arcgis/core/geometry.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../core/RandomLCG.js */ "./node_modules/@arcgis/core/core/RandomLCG.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _DimensionalDefinition_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../DimensionalDefinition.js */ "./node_modules/@arcgis/core/layers/support/DimensionalDefinition.js");
/* harmony import */ var _RasterInfo_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../RasterInfo.js */ "./node_modules/@arcgis/core/layers/support/RasterInfo.js");
/* harmony import */ var _BaseRaster_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./BaseRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/BaseRaster.js");
/* harmony import */ var _multidimensionalUtils_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./multidimensionalUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/multidimensionalUtils.js");
/* harmony import */ var _rasterFunctions_pixelUtils_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../rasterFunctions/pixelUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/pixelUtils.js");
/* harmony import */ var _rasterFunctions_stretchUtils_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../rasterFunctions/stretchUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/stretchUtils.js");
/* harmony import */ var _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../geometry/Extent.js */ "./node_modules/@arcgis/core/geometry/Extent.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
let f=class extends _BaseRaster_js__WEBPACK_IMPORTED_MODULE_11__["default"]{constructor(){super(...arguments),this.datasetFormat="MEMORY",this.source=null}get url(){return""}fetchRawTile(t,e,s,i={}){if(!this._pixelBlockTiles){const{rasterInfo:r}=this,[o,a]=r.storageInfo.tileInfo.size,{sliceId:l}=i,{pixelBlocks:n}=this.source,c={pixelBlock:null==l?n[0]:n[l],useBilinear:"thematic"!==r.dataType,tileSize:{width:o,height:a},level:t,row:e,col:s},p=this.rasterJobHandler?this.rasterJobHandler.clipTile(c,i):(0,_rasterFunctions_pixelUtils_js__WEBPACK_IMPORTED_MODULE_13__.clipTile)(c);return Promise.resolve(p)}const r=this._pixelBlockTiles.get(`${t}/${e}/${s}`);return Promise.resolve(r)}async _open(t){const e=this.source,{pixelBlocks:s,attributeTable:i,statistics:r,histograms:o,name:l,nativeExtent:n,transform:m}=e,c=s[0],{width:p,height:u,pixelType:f}=c,g=e.extent??new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_15__["default"]({xmin:-.5,ymin:.5,xmax:p-.5,ymax:u-.5,spatialReference:new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_16__["default"]({wkid:3857})}),x=e.isPseudoSpatialReference??!e.extent,y={x:g.width/p,y:g.height/u},b={...e.keyProperties};i&&(b.DataType="Thematic");const v=new _RasterInfo_js__WEBPACK_IMPORTED_MODULE_10__["default"]({width:p,height:u,pixelType:f,extent:g,nativeExtent:n,attributeTable:i,transform:m,pixelSize:y,spatialReference:g.spatialReference,bandCount:c.pixels.length,keyProperties:b,multidimensionalInfo:e.multidimensionalInfo,statistics:r,isPseudoSpatialReference:x,histograms:o});this.ioConfig.skipMapInfo&&this.updateImageSpaceRasterInfo(v),this.createRemoteDatasetStorageInfo(v,512,512),this._set("rasterInfo",v),this.updateTileInfo(),v.multidimensionalInfo?await this._buildMDimStats(e.pixelBlocks,v.multidimensionalInfo):await this._buildInMemoryRaster(c,{width:512,height:512},t),v.multidimensionalInfo||(this.source=null),this.datasetName=l}async _buildInMemoryRaster(t,i,r){const{rasterInfo:o}=this,a=o.storageInfo.maximumPyramidLevel??0,l="thematic"!==o.dataType,n=this.rasterJobHandler?this.rasterJobHandler.split({pixelBlock:t,tileSize:i,maximumPyramidLevel:a,useBilinear:l},r):Promise.resolve((0,_rasterFunctions_pixelUtils_js__WEBPACK_IMPORTED_MODULE_13__.split)(t,i,a,l)),m=null!=o.statistics,u=null!=o.histograms,h=this.ioConfig.skipStatistics||m?Promise.resolve({statistics:null,histograms:null}):this.rasterJobHandler?this.rasterJobHandler.estimateStatisticsHistograms({pixelBlock:t},r):Promise.resolve((0,_rasterFunctions_stretchUtils_js__WEBPACK_IMPORTED_MODULE_14__.estimateStatisticsHistograms)(t)),d=await (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.eachAlways)([n,h]);if(!d[0].value&&d[1].value)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("inmemory-raster:open","failed to build in memory raster");this._pixelBlockTiles=d[0].value,m||(o.statistics=d[1].value?.statistics),u||(o.histograms=d[1].value?.histograms)}async _buildMDimStats(t,e,s){for(let i=0;i<e.variables.length;i++){const r=e.variables[i];if(r.statistics)continue;const a=r.dimensions.map((t=>new _DimensionalDefinition_js__WEBPACK_IMPORTED_MODULE_9__["default"]({variableName:r.name,dimensionName:t.name,values:[t.values?.[0]??t.extent?.[0]],isSlice:!0}))),l=(0,_multidimensionalUtils_js__WEBPACK_IMPORTED_MODULE_12__.getSliceIndex)(a,e),m=null==l?null:t[l];if(null==m)continue;const c=this.rasterJobHandler?await this.rasterJobHandler.computeStatisticsHistograms({pixelBlock:m},s):(0,_rasterFunctions_stretchUtils_js__WEBPACK_IMPORTED_MODULE_14__.computeStatisticsHistograms)(m);r.statistics=c.statistics,r.histograms||(r.histograms=c.histograms)}}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__.property)({type:String,json:{write:!0}})],f.prototype,"datasetFormat",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__.property)()],f.prototype,"source",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__.property)()],f.prototype,"url",null),f=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_8__.subclass)("esri.layers.support.rasterDatasets.InMemoryRaster")],f);const g=f;


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/rasterDatasets/MRFRaster.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/rasterDatasets/MRFRaster.js ***!
  \******************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ b; }
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _geometry_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../geometry.js */ "./node_modules/@arcgis/core/geometry.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/RandomLCG.js */ "./node_modules/@arcgis/core/core/RandomLCG.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _PixelBlock_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../PixelBlock.js */ "./node_modules/@arcgis/core/layers/support/PixelBlock.js");
/* harmony import */ var _RasterInfo_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../RasterInfo.js */ "./node_modules/@arcgis/core/layers/support/RasterInfo.js");
/* harmony import */ var _RasterStorageInfo_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../RasterStorageInfo.js */ "./node_modules/@arcgis/core/layers/support/RasterStorageInfo.js");
/* harmony import */ var _BaseRaster_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./BaseRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/BaseRaster.js");
/* harmony import */ var _pamParser_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./pamParser.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/pamParser.js");
/* harmony import */ var _xmlUtilities_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./xmlUtilities.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/xmlUtilities.js");
/* harmony import */ var _rasterFormats_utils_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../rasterFormats/utils.js */ "./node_modules/@arcgis/core/layers/support/rasterFormats/utils.js");
/* harmony import */ var _rasterFunctions_stretchUtils_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../rasterFunctions/stretchUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/stretchUtils.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/* harmony import */ var _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../geometry/Extent.js */ "./node_modules/@arcgis/core/geometry/Extent.js");
/* harmony import */ var _geometry_Point_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../../geometry/Point.js */ "./node_modules/@arcgis/core/geometry/Point.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const y=new Map;y.set("Int8","s8"),y.set("UInt8","u8"),y.set("Int16","s16"),y.set("UInt16","u16"),y.set("Int32","s32"),y.set("UInt32","u32"),y.set("Float32","f32"),y.set("Float64","f32"),y.set("Double64","f32");const x=new Map;x.set("none",{blobExtension:".til",isOneSegment:!0,decoderFormat:"bip"}),x.set("lerc",{blobExtension:".lrc",isOneSegment:!1,decoderFormat:"lerc"}),x.set("deflate",{blobExtension:".pzp",isOneSegment:!0,decoderFormat:"deflate"}),x.set("jpeg",{blobExtension:".pjg",isOneSegment:!0,decoderFormat:"jpg"});let w=class extends _BaseRaster_js__WEBPACK_IMPORTED_MODULE_11__["default"]{constructor(){super(...arguments),this._files=null,this._storageIndex=null,this.datasetFormat="MRF"}async fetchRawTile(t,e,r,s={}){const{blockWidth:i,blockHeight:a,blockBoundary:n}=this.rasterInfo.storageInfo,l=n[t];if(!l||l.maxRow<e||l.maxCol<r||l.minRow>e||l.minCol>r)return null;const{bandCount:f,pixelType:c}=this.rasterInfo,{ranges:m,actualTileWidth:p,actualTileHeight:h}=this._getTileLocation(t,e,r);if(!m||0===m.length)return null;if(0===m[0].from&&0===m[0].to){const t=new Uint8Array(i*a);return new _PixelBlock_js__WEBPACK_IMPORTED_MODULE_8__["default"]({width:i,height:a,pixels:void 0,mask:t,validPixelCount:0})}const{bandIds:u}=this.ioConfig,g=this._getBandSegmentCount(),d=[];let y=0;for(y=0;y<g;y++)u&&!u.includes(y)||d.push(this.request(this._files.data,{range:{from:m[y].from,to:m[y].to},responseType:"array-buffer",signal:s.signal}));const w=await Promise.all(d),I=w.map((t=>t.data.byteLength)).reduce(((t,e)=>t+e)),b=new Uint8Array(I),R=[];let A=0;for(y=0;y<g;y++)R.push(A),b.set(new Uint8Array(w[y].data),A),A+=w[y].data.byteLength;const F=x.get(this.rasterInfo.storageInfo.compression).decoderFormat,_=await this.decodePixelBlock(b.buffer,{width:i,height:a,format:F,planes:u?.length||f,offsets:R,pixelType:c});if(null==_)return null;let{noDataValue:S}=this.rasterInfo;if(null!=S&&"lerc"!==F&&!_.mask&&(S=S[0],null!=S)){const t=_.width*_.height,e=new Uint8Array(t);if(Math.abs(S)>1e24)for(y=0;y<t;y++)Math.abs((_.pixels[0][y]-S)/S)>1e-6&&(e[y]=1);else for(y=0;y<t;y++)_.pixels[0][y]!==S&&(e[y]=1);_.mask=e}let k=0,M=0;if(p!==i||h!==a){let t=_.mask;if(t)for(y=0;y<a;y++)if(M=y*i,y<h)for(k=p;k<i;k++)t[M+k]=0;else for(k=0;k<i;k++)t[M+k]=0;else for(t=new Uint8Array(i*a),_.mask=t,y=0;y<h;y++)for(M=y*i,k=0;k<p;k++)t[M+k]=1}return _}async _open(t){this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);const e=t?t.signal:null,r=await this.request(this.url,{responseType:"xml",signal:e}),{rasterInfo:s,files:o}=this._parseHeader(r.data),{skipMapInfo:i,skipExtensions:a=[]}=this.ioConfig;if(!a.includes("aux.xml")&&!i){const e=await this._fetchAuxiliaryData(t);null!=e&&(s.statistics=e.statistics??s.statistics,s.histograms=e.histograms,e.histograms&&null==s.statistics&&(s.statistics=(0,_rasterFunctions_stretchUtils_js__WEBPACK_IMPORTED_MODULE_15__.estimateStatisticsFromHistograms)(e.histograms)))}i&&this.updateImageSpaceRasterInfo(s),this._set("rasterInfo",s),this._files=o;const n=await this.request(o.index,{responseType:"array-buffer",signal:e});this._storageIndex=I(n.data);const{blockWidth:l,blockHeight:f}=this.rasterInfo.storageInfo,c=this.rasterInfo.storageInfo.pyramidScalingFactor,{width:m,height:p}=this.rasterInfo,u=[],g=this._getBandSegmentCount();let d=0,y=-1;for(;d<this._storageIndex.length;){y++;const t=Math.ceil(m/l/c**y)-1,e=Math.ceil(p/f/c**y)-1;d+=(t+1)*(e+1)*g*4,u.push({maxRow:e,maxCol:t,minCol:0,minRow:0})}this.rasterInfo.storageInfo.blockBoundary=u,y>0&&(this.rasterInfo.storageInfo.firstPyramidLevel=1,this.rasterInfo.storageInfo.maximumPyramidLevel=y),this.updateTileInfo()}_getBandSegmentCount(){return x.get(this.rasterInfo.storageInfo.compression).isOneSegment?1:this.rasterInfo.bandCount}_getTileLocation(t,e,r){const{blockWidth:s,blockHeight:o,pyramidScalingFactor:i}=this.rasterInfo.storageInfo,{width:a,height:n}=this.rasterInfo,l=this._getBandSegmentCount();let f,c,m,p=0,h=0;for(m=0;m<t;m++)h=i**m,f=Math.ceil(a/s/h),c=Math.ceil(n/o/h),p+=f*c;h=i**t,f=Math.ceil(a/s/h),c=Math.ceil(n/o/h),p+=e*f+r,p*=4*l;const u=this._storageIndex.subarray(p,p+4*l);let g=0,d=0;const y=[];for(let x=0;x<l;x++)g=u[4*x]*2**32+u[4*x+1],d=g+u[4*x+2]*2**32+u[4*x+3],y.push({from:g,to:d});return{ranges:y,actualTileWidth:r<f-1?s:Math.ceil(a/h)-s*(f-1),actualTileHeight:e<c-1?o:Math.ceil(n/h)-o*(c-1)}}_parseHeader(t){const r=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_13__.getElement)(t,"MRF_META/Raster");if(!r)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("mrf:open","not a valid MRF format");const s=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_13__.getElement)(r,"Size"),o=parseInt(s.getAttribute("x"),10),n=parseInt(s.getAttribute("y"),10),f=parseInt(s.getAttribute("c"),10),p=((0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_13__.getElementValue)(r,"Compression")||"none").toLowerCase();if(!x.has(p))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("mrf:open","currently does not support compression "+p);const h=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_13__.getElementValue)(r,"DataType")||"UInt8",w=y.get(h);if(null==w)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("mrf:open","currently does not support pixel type "+h);const I=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_13__.getElement)(r,"PageSize"),b=parseInt(I.getAttribute("x"),10),R=parseInt(I.getAttribute("y"),10),A=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_13__.getElement)(r,"DataValues");let F,_;A&&(_=A.getAttribute("NoData"),null!=_&&(F=_.trim().split(" ").map((t=>parseFloat(t)))));if((0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_13__.getElement)(t,"MRF_META/CachedSource"))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("mrf:open","currently does not support MRF referencing other data files");const S=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_13__.getElement)(t,"MRF_META/GeoTags"),k=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_13__.getElement)(S,"BoundingBox");let M,j=!1;if(null!=k){const t=parseFloat(k.getAttribute("minx")),e=parseFloat(k.getAttribute("miny")),r=parseFloat(k.getAttribute("maxx")),s=parseFloat(k.getAttribute("maxy")),o=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_13__.getElementValue)(S,"Projection")||"";let i=_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_16__["default"].WGS84;if("LOCAL_CS[]"!==o)if(o.toLowerCase().startsWith("epsg:")){const t=Number(o.slice(5));isNaN(t)||0===t||(i=new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_16__["default"]({wkid:t}))}else i=(0,_pamParser_js__WEBPACK_IMPORTED_MODULE_12__.parseSpatialReference)(o)??_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_16__["default"].WGS84;else j=!0,i=new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_16__["default"]({wkid:3857});M=new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_17__["default"](t,e,r,s),M.spatialReference=i}else j=!0,M=new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_17__["default"]({xmin:-.5,ymin:.5-n,xmax:o-.5,ymax:.5,spatialReference:new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_16__["default"]({wkid:3857})});const C=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_13__.getElement)(t,"MRF_META/Rsets"),T=parseInt(C?.getAttribute("scale")||"2",10),L=M.spatialReference,U=new _RasterStorageInfo_js__WEBPACK_IMPORTED_MODULE_10__["default"]({origin:new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_18__["default"]({x:M.xmin,y:M.ymax,spatialReference:L}),blockWidth:b,blockHeight:R,pyramidBlockWidth:b,pyramidBlockHeight:R,compression:p,pyramidScalingFactor:T}),B=new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_18__["default"]({x:M.width/o,y:M.height/n,spatialReference:L}),E=new _RasterInfo_js__WEBPACK_IMPORTED_MODULE_9__["default"]({width:o,height:n,extent:M,isPseudoSpatialReference:j,spatialReference:L,bandCount:f,pixelType:w,pixelSize:B,noDataValue:F,storageInfo:U}),P=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_13__.getElementValue)(t,"datafile"),W=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_13__.getElementValue)(t,"IndexFile");return{rasterInfo:E,files:{mrf:this.url,index:W||this.url.replace(".mrf",".idx"),data:P||this.url.replace(".mrf",x.get(p).blobExtension)}}}async _fetchAuxiliaryData(t){try{const{data:e}=await this.request(this.url+".aux.xml",{responseType:"xml",signal:t?.signal});return (0,_pamParser_js__WEBPACK_IMPORTED_MODULE_12__.parsePAMInfo)(e)}catch{return null}}};function I(t){if(t.byteLength%16>0)throw new Error("invalid array buffer must be multiples of 16");let e,r,s,o,i,a;if(_rasterFormats_utils_js__WEBPACK_IMPORTED_MODULE_14__.isPlatformLittleEndian){for(r=new Uint8Array(t),o=new ArrayBuffer(t.byteLength),s=new Uint8Array(o),i=0;i<t.byteLength/4;i++)for(a=0;a<4;a++)s[4*i+a]=r[4*i+3-a];e=new Uint32Array(o)}else e=new Uint32Array(t);return e}(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.property)()],w.prototype,"_files",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.property)()],w.prototype,"_storageIndex",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.property)({type:String,json:{write:!0}})],w.prototype,"datasetFormat",void 0),w=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__.subclass)("esri.layers.support.rasterDatasets.MRFRaster")],w);const b=w;


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/rasterDatasets/RasterFactory.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/rasterDatasets/RasterFactory.js ***!
  \**********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ u; }
/* harmony export */ });
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _CovJSONRaster_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CovJSONRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/CovJSONRaster.js");
/* harmony import */ var _ImageAuxRaster_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ImageAuxRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/ImageAuxRaster.js");
/* harmony import */ var _ImageServerRaster_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ImageServerRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/ImageServerRaster.js");
/* harmony import */ var _InMemoryRaster_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./InMemoryRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/InMemoryRaster.js");
/* harmony import */ var _MRFRaster_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./MRFRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/MRFRaster.js");
/* harmony import */ var _TIFFRaster_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./TIFFRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/TIFFRaster.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const n=new Map;n.set("MRF",{desc:"Meta Raster Format",constructor:_MRFRaster_js__WEBPACK_IMPORTED_MODULE_5__["default"]}),n.set("TIFF",{desc:"GeoTIFF",constructor:_TIFFRaster_js__WEBPACK_IMPORTED_MODULE_6__["default"]}),n.set("RasterTileServer",{desc:"Raster Tile Server",constructor:_ImageServerRaster_js__WEBPACK_IMPORTED_MODULE_3__["default"]}),n.set("JPG",{desc:"JPG Raster Format",constructor:_ImageAuxRaster_js__WEBPACK_IMPORTED_MODULE_2__["default"]}),n.set("PNG",{desc:"PNG Raster Format",constructor:_ImageAuxRaster_js__WEBPACK_IMPORTED_MODULE_2__["default"]}),n.set("GIF",{desc:"GIF Raster Format",constructor:_ImageAuxRaster_js__WEBPACK_IMPORTED_MODULE_2__["default"]}),n.set("BMP",{desc:"BMP Raster Format",constructor:_ImageAuxRaster_js__WEBPACK_IMPORTED_MODULE_2__["default"]}),n.set("CovJSON",{desc:"COVJSON Raster Format",constructor:_CovJSONRaster_js__WEBPACK_IMPORTED_MODULE_1__["default"]}),n.set("MEMORY",{desc:"In Memory Raster Format",constructor:_InMemoryRaster_js__WEBPACK_IMPORTED_MODULE_4__["default"]});class u{static get supportedFormats(){const t=new Set;return n.forEach(((r,e)=>t.add(e))),t}static async open(r){const{url:e,ioConfig:s,source:o,sourceJSON:a}=r;let c=r.datasetFormat??s?.datasetFormat;null==c&&(e.includes(".")?c=e.slice(e.lastIndexOf(".")+1).toUpperCase():"coverage"===o?.type?.toLowerCase()?c="CovJSON":o?.extent&&o.pixelblocks&&(c="MEMORY")),"OVR"===c||"TIF"===c?c="TIFF":"JPG"===c||"JPEG"===c||"JFIF"===c?c="JPG":"COVJSON"===c&&(c="CovJSON"),e.toLowerCase().includes("/imageserver")&&!e.toLowerCase().includes("/wcsserver")&&(c="RasterTileServer");const u={url:e,source:o,sourceJSON:a,datasetFormat:c,ioConfig:s??{bandIds:null,sampling:null}};if(Object.keys(u).forEach((t=>{null==u[t]&&delete u[t]})),c){if(!this.supportedFormats.has(c))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"]("rasterfactory:open","not a supported format "+c);if("CRF"===c)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"]("rasterfactory:open",`cannot open raster: ${e}`);const s=new(0,n.get(c).constructor)(u);return await s.open({signal:r.signal}),s}const i=Array.from(n.keys()).filter((t=>"CovJSON"!==t&&"Memory"!==t));let l=0;const m=()=>{if(c=i[l++],!c)return null;if("CRF"===c)return null;const t=new(0,n.get(c).constructor)(u);return t.open({signal:r.signal}).then((()=>t)).catch((()=>m()))};return m()}static register(t,r,e){n.has(t.toUpperCase())||n.set(t.toUpperCase(),{desc:r,constructor:e})}}


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/rasterDatasets/TIFFRaster.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/rasterDatasets/TIFFRaster.js ***!
  \*******************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ D; }
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _geometry_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../geometry.js */ "./node_modules/@arcgis/core/geometry.js");
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/arrayUtils.js */ "./node_modules/@arcgis/core/core/arrayUtils.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _RasterInfo_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../RasterInfo.js */ "./node_modules/@arcgis/core/layers/support/RasterInfo.js");
/* harmony import */ var _RasterStorageInfo_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../RasterStorageInfo.js */ "./node_modules/@arcgis/core/layers/support/RasterStorageInfo.js");
/* harmony import */ var _BaseRaster_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./BaseRaster.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/BaseRaster.js");
/* harmony import */ var _DBFParser_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./DBFParser.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/DBFParser.js");
/* harmony import */ var _pamParser_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./pamParser.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/pamParser.js");
/* harmony import */ var _rasterFormats_TiffDecoder_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../rasterFormats/TiffDecoder.js */ "./node_modules/@arcgis/core/layers/support/rasterFormats/TiffDecoder.js");
/* harmony import */ var _rasterFormats_TiffTags_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../rasterFormats/TiffTags.js */ "./node_modules/@arcgis/core/layers/support/rasterFormats/TiffTags.js");
/* harmony import */ var _rasterFunctions_stretchUtils_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../rasterFunctions/stretchUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterFunctions/stretchUtils.js");
/* harmony import */ var _rasterTransforms_PolynomialTransform_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../rasterTransforms/PolynomialTransform.js */ "./node_modules/@arcgis/core/layers/support/rasterTransforms/PolynomialTransform.js");
/* harmony import */ var _rest_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../rest/support/FeatureSet.js */ "./node_modules/@arcgis/core/rest/support/FeatureSet.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/* harmony import */ var _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../../geometry/Extent.js */ "./node_modules/@arcgis/core/geometry/Extent.js");
/* harmony import */ var _geometry_Point_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../../geometry/Point.js */ "./node_modules/@arcgis/core/geometry/Point.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const _=(e,t)=>e.get(t)?.values,F=(e,t)=>e.get(t)?.values?.[0];let v=class extends _BaseRaster_js__WEBPACK_IMPORTED_MODULE_10__["default"]{constructor(){super(...arguments),this._files=null,this._headerInfo=null,this._bufferSize=1048576,this.datasetFormat="TIFF"}async fetchRawTile(e,t,r,i={}){if(!this._headerInfo?.isSupported||this.isBlockOutside(e,t,r))return null;const s=await this._fetchRawTiffTile(e,t,r,!1,i);if(null!=s&&this._headerInfo.hasMaskBand){const a=await this._fetchRawTiffTile(e,t,r,!0,i);null!=a&&a.pixels[0]instanceof Uint8Array&&(s.mask=a.pixels[0])}return s}async _open(e){const t=e?e.signal:null,{data:s}=await this.request(this.url,{range:{from:0,to:this._bufferSize},responseType:"array-buffer",signal:t});if(!s)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"]("tiffraster:open","failed to open url "+this.url);this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1,this.url.lastIndexOf("."));const{littleEndian:a,firstIFDPos:n,isBigTiff:o}=(0,_rasterFormats_TiffDecoder_js__WEBPACK_IMPORTED_MODULE_13__.parseSignature)(s),f=[];await this._readIFDs(f,s,a,n,0,o?8:4,t);const{imageInfo:l,rasterInfo:u}=k(f),p=(0,_rasterFormats_TiffDecoder_js__WEBPACK_IMPORTED_MODULE_13__.getPyramidIFDs)(f),d=(0,_rasterFormats_TiffDecoder_js__WEBPACK_IMPORTED_MODULE_13__.getMaskIFDs)(f);if(this._headerInfo={littleEndian:a,isBigTiff:o,ifds:f,pyramidIFDs:p,maskIFDs:d,...l},this._set("rasterInfo",u),!l.isSupported)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"]("tiffraster:open","this tiff is not supported: "+l.message);if(!l.tileWidth)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"]("tiffraster:open","none-tiled tiff is not optimized for access, convert to COG and retry.");u.isPseudoSpatialReference&&_core_Logger_js__WEBPACK_IMPORTED_MODULE_4__["default"].getLogger(this).warn("The spatial reference for this tiff is unsupported. Only EPSG spatial reference codes and Esri WKTs are supported.");const y=f[0].get("PREDICTOR")?.values?.[0],g=f[0].get("SAMPLEFORMAT")?.values?.[0];if(3===g&&2===y)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"]("tiffraster:open","unsupported horizontal difference encoding. Predictor=3 is supported for floating point data");const{skipMapInfo:x,skipExtensions:T=[]}=this.ioConfig;if(!T.includes("aux.xml")&&!x){const t=await this._fetchAuxiliaryMetaData(e);null!=t&&P(t,u)}T.includes("vat.dbf")||1!==u.bandCount||"u8"!==u.pixelType||x||(u.attributeTable=await this._fetchAuxiliaryTable(e),null!=u.attributeTable&&(u.keyProperties.DataType="thematic")),x&&this.updateImageSpaceRasterInfo(u),this.updateTileInfo()}async _readIFDs(e,t,r,i,s,a=4,n){if(!i)return null;if(i>=t.byteLength||i<0){t=(await this.request(this.url,{range:{from:i+s,to:i+s+this._bufferSize},responseType:"array-buffer",signal:n})).data,s=i+s,i=0}const o=await this._readIFD(t,r,i,s,_rasterFormats_TiffTags_js__WEBPACK_IMPORTED_MODULE_14__["default"].tiffTags,a,n);if(e.push(o.ifd),!o.nextIFD)return null;await this._readIFDs(e,t,r,o.nextIFD-s,s,a,n)}async _readIFD(e,r,i,s,a=_rasterFormats_TiffTags_js__WEBPACK_IMPORTED_MODULE_14__["default"].tiffTags,n=4,o){if(!e)return null;const f=(0,_rasterFormats_TiffDecoder_js__WEBPACK_IMPORTED_MODULE_13__.parseIFD)(e,r,i,s,a,n);if(f.success){const i=[];if(f.ifd?.forEach((e=>{e.values||i.push(e)})),i.length>0){const a=i.map((e=>e.offlineOffsetSize)).filter(_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_2__.isSome),n=Math.min.apply(null,a.map((e=>e[0])));if(Math.min.apply(null,a.map((e=>e[0]+e[1])))-n<=this._bufferSize){const{data:t}=await this.request(this.url,{range:{from:n,to:n+this._bufferSize},responseType:"array-buffer",signal:o});e=t,s=n,i.forEach((t=>(0,_rasterFormats_TiffDecoder_js__WEBPACK_IMPORTED_MODULE_13__.parseFieldValues)(e,r,t,s)))}}if(f.ifd?.has("GEOKEYDIRECTORY")){const t=f.ifd.get("GEOKEYDIRECTORY"),i=t?.values;if(i&&i.length>4){const a=i[0]+"."+i[1]+"."+i[2],n=await this._readIFD(e,r,t.valueOffset+6-s,s,_rasterFormats_TiffTags_js__WEBPACK_IMPORTED_MODULE_14__["default"].geoKeys,2,o);t.data=n.ifd,t.data&&t.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[a]})}}return f}if(f.requiredBufferSize&&f.requiredBufferSize!==e.byteLength){const t=await this.request(this.url,{range:{from:s,to:s+f.requiredBufferSize+4},responseType:"array-buffer",signal:o});return(e=t.data).byteLength<f.requiredBufferSize?null:this._readIFD(e,r,0,s,_rasterFormats_TiffTags_js__WEBPACK_IMPORTED_MODULE_14__["default"].tiffTags,4,o)}}async _fetchRawTiffTile(e,t,r,i,s={}){const a=this._getTileLocation(e,t,r,i);if(!a)return null;const{ranges:n,actualTileWidth:o,actualTileHeight:f,ifd:l}=a,u=n.map((e=>this.request(this.url,{range:e,responseType:"array-buffer",signal:s.signal}))),p=await Promise.all(u),c=p.map((e=>e.data.byteLength)).reduce(((e,t)=>e+t)),m=1===p.length?p[0].data:new ArrayBuffer(c),h=[0],d=[0];if(p.length>1){const e=new Uint8Array(m);for(let t=0,r=0;t<p.length;t++){const i=p[t].data;e.set(new Uint8Array(i),r),h[t]=r,r+=i.byteLength,d[t]=i.byteLength}}const{blockWidth:y,blockHeight:g}=this.getBlockWidthHeight(e),x=await this.decodePixelBlock(m,{format:"tiff",customOptions:{headerInfo:this._headerInfo,ifd:l,offsets:h,sizes:d},width:y,height:g,planes:null,pixelType:null});if(null==x)return null;let T,I,w;if(o!==y||f!==g){let e=x.mask;if(e)for(T=0;T<g;T++)if(w=T*y,T<f)for(I=o;I<y;I++)e[w+I]=0;else for(I=0;I<y;I++)e[w+I]=0;else for(e=new Uint8Array(y*g),x.mask=e,T=0;T<f;T++)for(w=T*y,I=0;I<o;I++)e[w+I]=1}return x}_getTileLocation(e,t,r,i=!1){const{firstPyramidLevel:s,blockBoundary:a}=this.rasterInfo.storageInfo,n=0===e?0:e-(s-1),{_headerInfo:o}=this;if(!o)return null;const f=i?o.maskIFDs[n]:0===n?o?.ifds[0]:o?.pyramidIFDs[n-1];if(!f)return null;const l=(0,_rasterFormats_TiffDecoder_js__WEBPACK_IMPORTED_MODULE_13__.isBSQConfig)(f,o),u=_(f,"TILEOFFSETS");if(void 0===u)return null;const p=_(f,"TILEBYTECOUNTS"),{minRow:c,minCol:m,maxRow:h,maxCol:d}=a[n];if(t>h||r>d||t<c||r<m)return null;const y=F(f,"IMAGEWIDTH"),x=F(f,"IMAGELENGTH"),T=F(f,"TILEWIDTH"),I=F(f,"TILELENGTH"),w=[];if(l){const{bandCount:e}=this.rasterInfo;for(let i=0;i<e;i++){const e=i*(h+1)*(d+1)+t*(d+1)+r;w[i]={from:u[e],to:u[e]+p[e]-1}}}else{const e=t*(d+1)+r;w.push({from:u[e],to:u[e]+p[e]-1})}for(let g=0;g<w.length;g++)if(null==w[g].from||!w[g].to||w[g].to<0)return null;return{ranges:w,ifd:f,actualTileWidth:r===d&&y%T||T,actualTileHeight:t===h&&x%I||I}}async _fetchAuxiliaryMetaData(e){try{const{data:t}=await this.request(this.url+".aux.xml",{responseType:"xml",signal:e?.signal});return (0,_pamParser_js__WEBPACK_IMPORTED_MODULE_12__.parsePAMInfo)(t)}catch{return null}}async _fetchAuxiliaryTable(e){try{const{data:t}=await this.request(this.url+".vat.dbf",{responseType:"array-buffer",signal:e?.signal}),r=_DBFParser_js__WEBPACK_IMPORTED_MODULE_11__["default"].parse(t);return r?.recordSet?_rest_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_17__["default"].fromJSON(r.recordSet):null}catch{return null}}};function k(e){const t=(0,_rasterFormats_TiffDecoder_js__WEBPACK_IMPORTED_MODULE_13__.getImageInfo)(e),{width:r,height:i,tileWidth:s,tileHeight:a,planes:f,pixelType:l,compression:u,firstPyramidLevel:c,maximumPyramidLevel:m,pyramidBlockWidth:h,pyramidBlockHeight:d,pyramidResolutions:y,tileBoundary:g,affine:T,metadata:I}=t,R=t.extent.spatialReference?.wkt||t.extent.spatialReference?.wkid;let v=(0,_pamParser_js__WEBPACK_IMPORTED_MODULE_12__.parseSpatialReference)(R),k=!!t.isPseudoGeographic;null==v&&(k=!0,v=new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_18__["default"]({wkid:3857}));const P=new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_19__["default"]({...t.extent,spatialReference:v}),D=new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_20__["default"](P?{x:P.xmin,y:P.ymax,spatialReference:v}:{x:0,y:0}),O=new _RasterStorageInfo_js__WEBPACK_IMPORTED_MODULE_9__["default"]({blockWidth:s,blockHeight:a,pyramidBlockWidth:h,pyramidBlockHeight:d,compression:u,origin:D,firstPyramidLevel:c,maximumPyramidLevel:m,pyramidResolutions:y,blockBoundary:g}),L=new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_20__["default"]({x:(P.xmax-P.xmin)/r,y:(P.ymax-P.ymin)/i,spatialReference:v}),j=I?{BandProperties:I.bandProperties,DataType:I.dataType}:{};let B=null;const z=F(e[0],"PHOTOMETRICINTERPRETATION"),A=_(e[0],"COLORMAP");if(z<=3&&A?.length>3&&A.length%3==0){B=[];const e=A.length/3;for(let t=0;t<e;t++)B.push([t,A[t]>>>8,A[t+e]>>>8,A[t+2*e]>>>8])}const C=new _RasterInfo_js__WEBPACK_IMPORTED_MODULE_8__["default"]({width:r,height:i,bandCount:f,pixelType:l,pixelSize:L,storageInfo:O,spatialReference:v,isPseudoSpatialReference:k,keyProperties:j,extent:P,colormap:B,statistics:I?I.statistics:null});if(T?.length&&(C.nativeExtent=new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_19__["default"]({xmin:-.5,ymin:.5-i,xmax:r-.5,ymax:.5,spatialReference:v}),C.transform=new _rasterTransforms_PolynomialTransform_js__WEBPACK_IMPORTED_MODULE_16__["default"]({polynomialOrder:1,forwardCoefficients:[T[2]+T[0]/2,T[5]-T[3]/2,T[0],T[3],-T[1],-T[4]]}),C.extent=C.transform.forwardTransform(C.nativeExtent),C.pixelSize=new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_20__["default"]({x:(P.xmax-P.xmin)/r,y:(P.ymax-P.ymin)/i,spatialReference:v}),O.origin.x=-.5,O.origin.y=.5),y){const{x:e,y:t}=C.pixelSize;y.forEach((r=>{r.x*=e,r.y*=t}))}return{imageInfo:t,rasterInfo:C}}function P(e,t){if(t.statistics=e.statistics??t.statistics,t.histograms=e.histograms,e.histograms&&null==t.statistics&&(t.statistics=(0,_rasterFunctions_stretchUtils_js__WEBPACK_IMPORTED_MODULE_15__.estimateStatisticsFromHistograms)(e.histograms)),e.transform&&null==t.transform){t.transform=e.transform,t.nativeExtent=t.extent;const r=t.transform.forwardTransform(t.nativeExtent);t.pixelSize=new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_20__["default"]({x:(r.xmax-r.xmin)/t.width,y:(r.ymax-r.ymin)/t.height,spatialReference:t.spatialReference}),t.extent=r}t.isPseudoSpatialReference&&e.spatialReference&&(t.spatialReference=e.spatialReference,t.extent.spatialReference=t.nativeExtent.spatialReference=t.storageInfo.origin.spatialReference=t.spatialReference)}(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__.property)()],v.prototype,"_files",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__.property)()],v.prototype,"_headerInfo",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__.property)()],v.prototype,"_bufferSize",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__.property)({type:String,json:{write:!0}})],v.prototype,"datasetFormat",void 0),v=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__.subclass)("esri.layers.support.rasterDatasets.TIFFRaster")],v);const D=v;


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/rasterDatasets/covJSONParser.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/rasterDatasets/covJSONParser.js ***!
  \**********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isXAxis: function() { return /* binding */ i; },
/* harmony export */   isYAxis: function() { return /* binding */ r; },
/* harmony export */   parseGridCoverage: function() { return /* binding */ p; }
/* harmony export */ });
/* harmony import */ var _Color_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../Color.js */ "./node_modules/@arcgis/core/Color.js");
/* harmony import */ var _geometry_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../geometry.js */ "./node_modules/@arcgis/core/geometry.js");
/* harmony import */ var _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../geometry/Extent.js */ "./node_modules/@arcgis/core/geometry/Extent.js");
/* harmony import */ var _intl_locale_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../intl/locale.js */ "./node_modules/@arcgis/core/intl/locale.js");
/* harmony import */ var _PixelBlock_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../PixelBlock.js */ "./node_modules/@arcgis/core/layers/support/PixelBlock.js");
/* harmony import */ var _rasterFormats_pixelRangeUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../rasterFormats/pixelRangeUtils.js */ "./node_modules/@arcgis/core/layers/support/rasterFormats/pixelRangeUtils.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
function i(e){return["x","e","east","long","longitude"].includes(e.toLowerCase())}function r(e){return["y","n","west","lat","latitude"].includes(e.toLowerCase())}function o(e){const{axes:n}=e.domain,l=Object.keys(n),s=[],o=[];let u=-1,m=-1,c=[];for(let t=0;t<l.length;t++){const e=l[t];i(e)?u=t:r(e)&&(m=t);const a=n[e],d=[];if("values"in a){a.values.forEach((e=>d.push("string"==typeof e?new Date(e).getTime():e)));const e=d[1]-d[0];s.push([d[0]-.5*e,d[d.length-1]+.5*e]),o.push(e)}else{const{start:e,stop:t,num:n}=a,l=(t-e)/(n-1);s.push([e-.5*l,t+.5*l]),o.push(l);for(let s=0;s<n;s++)d.push(e+l*s)}c.push({name:e,values:d,extent:[d[0],d[d.length-1]]})}u>-1&&-1===m?m=0===u?1:0:m>-1&&-1===u?u=0===m?1:0:-1===m&&-1===u&&(u=0,m=1),c=c.filter(((e,t)=>!(t===u||t===m)));const{referencing:d}=e.domain,f=d.find((e=>e.coordinates.includes(l[u]))).system.id,p=f?.slice(f.lastIndexOf("/")+1),h=null==p||"CRS84"===p?4326:Number(p),g=new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_6__["default"]({wkid:h}),[b,y]=s[u],[x,j]=s[m],v=new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_2__["default"]({xmin:b,xmax:y,ymin:x,ymax:j,spatialReference:g});return{width:Math.round(v.width/o[u]),height:Math.round(v.height/o[m]),extent:v,dimensions:c}}function u(e){const t=(0,_intl_locale_js__WEBPACK_IMPORTED_MODULE_3__.getLanguage)();return t?e[t]??Object.values(e)[0]:Object.values(e)[0]}function m(){return Math.round(255*Math.random())}function c(t){const n={},{parameters:l}=t;if(!l)return n;for(const[s,a]of Object.entries(l)){const{type:t,description:l,unit:i,categoryEncoding:r,observedProperty:o}=a;if("Parameter"===t&&(n[s]={},l&&(n[s].description=u(l)),i&&(n[s].unit=i.label?u(i.label):null,n[s].symbol=i.symbol?.value),r)){const t=Object.entries(r).map(((e,t)=>({OID:t,Value:Number(e[1]),ClassName:e[0].slice(e[0].lastIndexOf("/")+1),Count:1})));let l=!1;o?.categories?.length&&(o.categories.forEach((n=>{if(!n.id)return;const s=n.id.slice(n.id.lastIndexOf("/")+1),a=t.find((e=>e.ClassName===s));if(!a)return;const i=n.label?u(n.label):null;if(a.Label=i,n.preferredColor){const t=_Color_js__WEBPACK_IMPORTED_MODULE_0__["default"].fromHex(n.preferredColor);t&&(l=!0,a.Red=t.r,a.Green=t.g,a.Blue=t.b)}})),l&&t.forEach((e=>{null==e.Red&&(e.Red=m(),e.Green=m(),e.Blue=m())})));const a={objectIdFieldName:"",fields:[{name:"OID",type:"esriFieldTypeOID",alias:"OID",domain:null},{name:"Value",type:"esriFieldTypeInteger",alias:"Value",domain:null},{name:"Count",type:"esriFieldTypeDouble",alias:"Count",domain:null},{name:"ClassName",type:"esriFieldTypeString",alias:"ClassName",domain:null,length:50},{name:"Label",type:"esriFieldTypeString",alias:"Label",domain:null,length:50}],features:t.map((e=>({attributes:e})))};l&&a.fields.push({name:"Red",type:"esriFieldTypeInteger",alias:"Red",domain:null},{name:"Green",type:"esriFieldTypeInteger",alias:"Green",domain:null},{name:"Blue",type:"esriFieldTypeInteger",alias:"Blue",domain:null}),n[s].attributeTable=a}}return n}function d(e){let t=Number.MAX_VALUE,n=-Number.MAX_VALUE;for(let l=0;l<e.length;l++){const s=e[l];null!=s&&(s<t&&(t=s),s>n&&(n=s))}return (0,_rasterFormats_pixelRangeUtils_js__WEBPACK_IMPORTED_MODULE_5__.getIntegerPixelType)(t,n)}function f(e,t,n){const l=e.map(((e,n)=>({name:e,count:t[n]}))).sort(((e,t)=>e.name>t.name?-1:1)),s=(a=1,e=>a*=e.count);var a;const i=[...l.slice(1),{name:"",count:1}].reverse().map(s).reverse();let r=0;for(let o=e.length-1;o>=0;o--){r+=i[l.findIndex((({name:t})=>t===e[o]))]*(n%t[o]),n=Math.floor(n/t[o])}return r}function p(e){const{width:t,height:n,extent:s,dimensions:a}=o(e),{ranges:i}=e,r=Object.keys(i).sort(((e,t)=>e<t?-1:1)),u=[];for(let l=0;l<r.length;l++){const e=r[l];a?.length&&u.push({name:e,dimensions:a})}const m=c(e);u.forEach((e=>m[e.name]&&Object.assign(e,m[e.name])));const p=u.length?{variables:u}:void 0,h=[];for(let o=0;o<r.length;o++){const e=r[o],{values:s,dataType:u,axisNames:m,shape:c}=i[e],p=c.length>2?o*c.slice(0,-2).reduce(((e,t)=>e*t)):0,g=m.slice(0,-2),b=c.slice(0,-2),y="float"===u?"f32":d(s),x=t*n,j=s.length/x;for(let i=0;i<j;i++){const e=_PixelBlock_js__WEBPACK_IMPORTED_MODULE_4__["default"].createEmptyBand(y,x),r=new Uint8Array(x).fill(255);let u=!1;const m=i*x;for(let t=0;t<x;t++){const n=s[m+t];null==n?(r[t]=0,u=!0):e[t]=n}if(0===o||a?.length){const s=new _PixelBlock_js__WEBPACK_IMPORTED_MODULE_4__["default"]({width:t,height:n,mask:u?r:null,pixels:[e],pixelType:y});if(s.updateStatistics(),a?.length){h[f(g,b,i)+p]=s}else h.push(s)}else{const t=h[i];t.pixels.push(e),u?t.mask&&(t.mask=_PixelBlock_js__WEBPACK_IMPORTED_MODULE_4__["default"].combineBandMasks([t.mask,r])):t.mask=u?r:null}}}const g=Object.values(m).find((e=>e.attributeTable))?.attributeTable;return{extent:s,pixelBlocks:h,multidimensionalInfo:p,attributeTable:g,bandNames:p?void 0:r}}


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/rasterDatasets/pamParser.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/rasterDatasets/pamParser.js ***!
  \******************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   parsePAMInfo: function() { return /* binding */ S; },
/* harmony export */   parseSpatialReference: function() { return /* binding */ d; }
/* harmony export */ });
/* harmony import */ var _geometry_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../geometry.js */ "./node_modules/@arcgis/core/geometry.js");
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/arrayUtils.js */ "./node_modules/@arcgis/core/core/arrayUtils.js");
/* harmony import */ var _geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../geometry/support/spatialReferenceUtils.js */ "./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js");
/* harmony import */ var _xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./xmlUtilities.js */ "./node_modules/@arcgis/core/layers/support/rasterDatasets/xmlUtilities.js");
/* harmony import */ var _rasterTransforms_PolynomialTransform_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../rasterTransforms/PolynomialTransform.js */ "./node_modules/@arcgis/core/layers/support/rasterTransforms/PolynomialTransform.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
function u(e,t){if(!e||!t)return null;const n=[];for(let r=0;r<e.length;r++)n.push(e[r]),n.push(t[r]);return n}function c(e){const t=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElement)(e,"GeodataXform"),n=d((0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElementNumericValue)(t,"SpatialReference/WKID")||(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElementValue)(t,"SpatialReference/WKT"));if("typens:PolynomialXform"!==t.getAttribute("xsi:type"))return{spatialReference:n,transform:null};const s=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElementNumericValue)(t,"PolynomialOrder")??1,f=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElementNumericValues)(t,"CoeffX/Double"),c=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElementNumericValues)(t,"CoeffY/Double"),m=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElementNumericValues)(t,"InverseCoeffX/Double"),p=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElementNumericValues)(t,"InverseCoeffY/Double"),S=u(f,c),C=u(m,p);return{spatialReference:n,transform:S&&C&&S.length&&C.length?new _rasterTransforms_PolynomialTransform_js__WEBPACK_IMPORTED_MODULE_4__["default"]({spatialReference:n,polynomialOrder:s,forwardCoefficients:S,inverseCoefficients:C}):null}}function m(e){const t=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElementNumericValue)(e,"NoDataValue"),n=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElement)(e,"Histograms/HistItem"),l=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElementNumericValue)(n,"HistMin"),o=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElementNumericValue)(n,"HistMax"),f=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElementNumericValue)(n,"BucketCount"),u=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElementValue)(n,"HistCounts")?.split("|").map((e=>Number(e)));let c,m,d,p;(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElements)(e,"Metadata/MDI").forEach((e=>{const t=Number(e.textContent??e.nodeValue);switch(e.getAttribute("key").toUpperCase()){case"STATISTICS_MINIMUM":c=t;break;case"STATISTICS_MAXIMUM":m=t;break;case"STATISTICS_MEAN":d=t;break;case"STATISTICS_STDDEV":p=t}}));const S=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElementNumericValue)(e,"Metadata/SourceBandIndex");return{noDataValue:t,histogram:u?.length&&null!=l&&null!=o?{min:l,max:o,size:f||u.length,counts:u}:null,sourceBandIndex:S,statistics:null!=c&&null!=m?{min:c,max:m,avg:d,stddev:p}:null}}function d(e){if(!e)return null;let n=Number(e);if(!isNaN(n)&&0!==n)return new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_5__["default"]({wkid:n});if(e=String(e).trim(),(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_2__.isWKT2)(e))return new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_5__["default"]({wkt2:e});const r=e.toUpperCase();if(r.startsWith("COMPD_CS")){if(!r.includes("VERTCS")||!r.includes("GEOGCS")&&!r.startsWith("PROJCS"))return null;const t=r.indexOf("VERTCS"),s=r.indexOf("PROJCS"),a=s>-1?s:r.indexOf("GEOGCS");if(-1===a)return null;const i=e.slice(a,e.lastIndexOf("]",t)+1).trim(),l=e.slice(t,e.lastIndexOf("]")).trim();n=p(i);const o=new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_5__["default"](n?{wkid:n}:{wkt:i}),u=p(l);return u&&(o.vcsWkid=u),o}return r.startsWith("GEOGCS")||r.startsWith("PROJCS")?(n=p(e),new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_5__["default"](0!==n?{wkid:n}:{wkt:e})):null}function p(e){const t=e.replaceAll("]","[").replaceAll('"',"").split("[").map((e=>e.trim())).filter((e=>""!==e)),n=t[t.length-1].split(","),r=n[0]?.toLowerCase();if(("epsg"===r||"esri"===r)&&e.endsWith('"]]')){const e=Number(n[1]);if(!isNaN(e)&&0!==e)return e}return 0}function S(t){if("pamdataset"!==t?.documentElement.tagName?.toLowerCase())return{};const a={spatialReference:null,transform:null,metadata:{},rasterBands:[],statistics:null,histograms:null};t.documentElement.childNodes.forEach((e=>{if(1===e.nodeType)if((0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.isSameTagIgnoreNS)(e,"SRS")){if(!a.spatialReference){const t=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElementValue)(e);a.spatialReference=d(t)}}else if((0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.isSameTagIgnoreNS)(e,"Metadata"))if("xml:ESRI"===e.getAttribute("domain")){const{spatialReference:t,transform:n}=c(e);a.transform=n,a.spatialReference||(a.spatialReference=t)}else{(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElements)(e,"MDI").forEach((e=>a.metadata[e.getAttribute("key")]=(0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.getElementValue)(e)))}else if((0,_xmlUtilities_js__WEBPACK_IMPORTED_MODULE_3__.isSameTagIgnoreNS)(e,"PAMRasterBand")){const t=m(e);null!=t.sourceBandIndex&&null==a.rasterBands[t.sourceBandIndex]?a.rasterBands[t.sourceBandIndex]=t:a.rasterBands.push(t)}}));const i=a.rasterBands;if(i.length){const t=!!i[0].statistics;a.statistics=t?i.map((e=>e.statistics)).filter(_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__.isSome):null;const n=!!i[0].histogram;a.histograms=n?i.map((e=>e.histogram)).filter(_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__.isSome):null}return a}


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/rasterDatasets/xmlUtilities.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/rasterDatasets/xmlUtilities.js ***!
  \*********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getElement: function() { return /* binding */ e; },
/* harmony export */   getElementNumericValue: function() { return /* binding */ o; },
/* harmony export */   getElementNumericValues: function() { return /* binding */ u; },
/* harmony export */   getElementValue: function() { return /* binding */ t; },
/* harmony export */   getElementValues: function() { return /* binding */ l; },
/* harmony export */   getElements: function() { return /* binding */ n; },
/* harmony export */   getNodeNameIgnoreNS: function() { return /* binding */ c; },
/* harmony export */   getSpaceDelimitedNumericValues: function() { return /* binding */ r; },
/* harmony export */   isSameTagIgnoreNS: function() { return /* binding */ i; }
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
function n(e,t){if(!e||!t)return[];let l=t;t.includes("/")?(l=t.slice(0,t.indexOf("/")),t=t.slice(t.indexOf("/")+1)):t="";const r=[];if(t){const u=n(e,l);for(let e=0;e<u.length;e++){n(u[e],t).forEach((n=>r.push(n)))}return r}const u=e.getElementsByTagNameNS("*",l);if(!u||0===u.length)return[];for(let n=0;n<u.length;n++)r.push(u[n]||u.item(n));return r}function e(t,l){if(!t||!l)return null;let r=l;l.includes("/")?(r=l.slice(0,l.indexOf("/")),l=l.slice(l.indexOf("/")+1)):l="";const u=n(t,r);return u.length>0?l?e(u[0],l):u[0]:null}function t(n,t=null){const l=t?e(n,t):n;let r;return l?(r=l.textContent||l.nodeValue,r?r.trim():null):null}function l(e,t){const l=n(e,t),r=[];let u;for(let n=0;n<l.length;n++)u=l[n].textContent||l[n].nodeValue,u&&(u=u.trim(),""!==u&&r.push(u));return r}function r(n,e=null){const l=t(n,e);return l?.split(" ").map((n=>Number(n)))??[]}function u(n,e){return l(n,e).map((n=>Number(n)))}function o(n,e){const l=t(n,e);return Number(l)}function i(n,e){const t=n?.nodeName?.toLowerCase(),l=e.toLowerCase();return t.slice(t.lastIndexOf(":")+1)===l}function c(n){return n.nodeName.slice(n.nodeName.lastIndexOf(":")+1)}


/***/ })

}]);
//# sourceMappingURL=vendors-node_modules_arcgis_core_layers_ImageryTileLayer_js.6e4988d827e5e36ee537.js.map