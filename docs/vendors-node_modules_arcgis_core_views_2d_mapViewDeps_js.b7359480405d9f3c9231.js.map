{"version":3,"file":"vendors-node_modules_arcgis_core_views_2d_mapViewDeps_js.b7359480405d9f3c9231.js","mappings":"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","sources":["webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/geometry/support/meshUtils/exporters/gltf/imageutils.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/support/requestImageUtils.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/symbols/cim/CIMResourceManager.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/symbols/cim/Rasterizer.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/symbols/cim/SDFHelper.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/symbols/cim/animationUtils.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/symbols/cim/cimAnalyzer.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/symbols/cim/rasterizingUtils.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/ManagedCanvas.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/Stage.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/vectorTiles/shaders/Programs.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/vectorTiles/shaders/VTLMaterialManager.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/vectorTiles/shaders/sources/resolver.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/vectorTiles/shaders/sources/shaderRepository.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/BitBlitRenderer.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/GlyphMosaic.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/GlyphSource.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/MaterialManager.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/Painter.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/RectangleBinPack.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/SDFConverter.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/SpriteMosaic.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/TextureManager.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/TextureUploadManager.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/TileReshuffleManager.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/WorldExtentClipRenderer.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/animatedFormats/AnimatableTextureResource.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/animatedFormats/utils.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/animations/store/AnimationStore.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/effects/BlendEffect.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/effects/Effect.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/effects/FeatureEffect.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/effects/HighlightEffect.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/effects/HittestEffect.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/effects/highlight/HighlightRenderer.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/effects/highlight/HighlightSurfaces.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/effects/post-processing/Bloom.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/effects/post-processing/Blur.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/effects/post-processing/Colorize.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/effects/post-processing/DropShadow.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/effects/post-processing/EffectManager.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/effects/post-processing/Opacity.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/painter/RenderPass.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/TechniqueProgramCache.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/blend/BlendTechnique.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/grid/GridTechnique.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/magnifier/MagnifierTechnique.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/grid/GridView2D.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/grid/constants.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/grid/gridUtils.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/magnifier/MagnifierView2D.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/mapViewDeps.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/magnifier/resources.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../../../../../core/has.js\";import e from\"../../../../../core/Error.js\";import{throwIfAborted as t}from\"../../../../../core/promiseUtils.js\";import{isDataProtocol as n,dataComponents as r}from\"../../../../../core/urlUtils.js\";function a(e){const t=m(e);return null!=t?t.toDataURL():\"\"}async function i(n,r){const a=m(n);if(null==a)throw new e(\"imageToArrayBuffer\",\"Unsupported image type\");const i=o(n),s=await new Promise((e=>a.toBlob(e,i)));if(t(r),!s)throw new e(\"imageToArrayBuffer\",\"Failed to encode image\");const c=await s.arrayBuffer();return t(r),{data:c,type:i}}function o(e){if(!(e instanceof HTMLImageElement))return\"image/png\";const t=e.src;if(n(t)){const e=r(t);return\"image/jpeg\"===e?.mediaType?e.mediaType:\"image/png\"}return/\\.png$/i.test(t)?\"image/png\":/\\.(jpg|jpeg)$/i.test(t)?\"image/jpeg\":\"image/png\"}function m(e){if(e instanceof HTMLCanvasElement)return e;if(e instanceof HTMLVideoElement)return null;const t=document.createElement(\"canvas\");t.width=e.width,t.height=e.height;const n=t.getContext(\"2d\");return e instanceof HTMLImageElement?n.drawImage(e,0,0,e.width,e.height):e instanceof ImageData&&n.putImageData(e,0,0),t}function s(e){const t=[],n=new Uint8Array(e);for(let r=0;r<n.length;r++)t.push(String.fromCharCode(n[r]));return\"data:application/octet-stream;base64,\"+btoa(t.join(\"\"))}function c(e){if(e.byteLength<8)return!1;const t=new Uint8Array(e);return 137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]&&13===t[4]&&10===t[5]&&26===t[6]&&10===t[7]}export{s as encodeBase64DataUri,i as imageToArrayBuffer,a as imageToDataURI,m as imageTypeToCanvas,c as isArrayBufferPNG};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../request.js\";async function t(t,r){const{data:a}=await e(t,{responseType:\"image\",...r});return a}export{t as requestImage};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{loadFont as e}from\"../../core/fontUtils.js\";import{getImageData as t}from\"../../core/imageUtils.js\";class i{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(e){return this._resourceMap.get(e)??null}async fetchResource(e,i){const h=this._resourceMap.get(e);if(h)return{width:h.width,height:h.height};let r=this._inFlightResourceMap.get(e);return r?r.then((e=>({width:e.width,height:e.height}))):(r=t(e,i),this._inFlightResourceMap.set(e,r),r.then((t=>(this._inFlightResourceMap.delete(e),this._resourceMap.set(e,t),{width:t.width,height:t.height})),(()=>({width:0,height:0}))))}deleteResource(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}loadFont(t){return e(t)}}export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{CIMSymbolHelper as e}from\"./CIMSymbolHelper.js\";import{rasterizeFillStyle as r,rasterizeDash1D as t}from\"./rasterizingUtils.js\";import a from\"./Rect.js\";import{getSDFInfo as s,buildSDF as n}from\"./SDFHelper.js\";import{normalizeDashTemplate as i,resampleHermite as o}from\"./utils.js\";import{rasterizedVectorMarkerMinSize as c,patternFillRasterizationScale as l}from\"../../views/2d/engine/webgl/definitions.js\";const h=512;class f{constructor(e){this._resourceManager=e,this._cachedRasterizationCanvas=null}dispose(){this._cachedRasterizationCanvas=null}get _canvas(){return this._cachedRasterizationCanvas||(this._cachedRasterizationCanvas=document.createElement(\"canvas\")),this._cachedRasterizationCanvas}rasterizeJSONResource(e){switch(e.type){case\"dash\":{const r=i(e.dashTemplate),[a,s,n]=t(r);return{size:[s,n],image:new Uint32Array(a.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}case\"fill-style\":{const[t,a,s,n]=r(this._canvas,e,l);return{size:[a,s],image:new Uint32Array(t.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0,rasterizationScale:n}}case\"sdf\":return d(e);case\"CIMHatchFill\":case\"CIMVectorMarker\":case\"CIMPictureMarker\":return this._rasterizeCIMJSONResource(e)}}_rasterizeCIMJSONResource(r){switch(r.type){case\"CIMHatchFill\":{const t=e.fromCIMHatchFill(r,l);return this._rasterizeCIMVectorMarker(t)}case\"CIMPictureMarker\":{const t=e.fromCIMInsidePolygon(r);return this._rasterizeCIMVectorMarker(t)}case\"CIMVectorMarker\":{if(\"CIMMarkerPlacementInsidePolygon\"===r.markerPlacement?.type){const t=e.fromCIMInsidePolygon(r);return this._rasterizeCIMVectorMarker(t)}const t=s(r);return t&&!r.avoidSDFRasterization?d(t):this._rasterizeCIMVectorMarker(r,!1,c)}}}_rasterizeCIMVectorMarker(r,t=!0,s){const n=t?a.fromExtent(r.frame):null,[i,o,c,l,h]=e.rasterize(this._canvas,r,n,this._resourceManager,!0,s);return i?{size:[o,c],image:new Uint32Array(i.buffer),sdf:!1,simplePattern:!1,anchorX:l,anchorY:h}:null}rasterizeImageResource(e,r,t,a){this._canvas.width=e,this._canvas.height=r;const s=this._canvas.getContext(\"2d\",{willReadFrequently:!0});t instanceof ImageData?s.putImageData(t,0,0):(t.setAttribute(\"width\",`${e}px`),t.setAttribute(\"height\",`${r}px`),s.drawImage(t,0,0,e,r));const n=s.getImageData(0,0,e,r),i=new Uint8Array(n.data);if(a)for(const o of a)if(o&&o.oldColor&&4===o.oldColor.length&&o.newColor&&4===o.newColor.length){const[e,r,t,a]=o.oldColor,[s,n,c,l]=o.newColor;if(e===s&&r===n&&t===c&&a===l)continue;for(let o=0;o<i.length;o+=4)e===i[o]&&r===i[o+1]&&t===i[o+2]&&a===i[o+3]&&(i[o]=s,i[o+1]=n,i[o+2]=c,i[o+3]=l)}let c;for(let o=0;o<i.length;o+=4)c=i[o+3]/255,i[o]=i[o]*c,i[o+1]=i[o+1]*c,i[o+2]=i[o+2]*c;let l=i,f=e,d=r;const u=h;if(f>=u||d>=u){const t=f/d;t>1?(f=u,d=Math.round(u/t)):(d=u,f=Math.round(u*t)),l=new Uint8Array(4*f*d);const a=new Uint8ClampedArray(l.buffer);o(i,e,r,a,f,d,!1)}return{size:[f,d],image:new Uint32Array(l.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}}function d(e){if(!e)return null;const{data:r,width:t,height:a,sdfPaddingRatio:s,sdfDecodeCoeff:i}=n(e);return r?{size:[t,a],image:new Uint32Array(r.buffer),sdf:!0,simplePattern:!0,sdfPaddingRatio:s,sdfDecodeCoeff:i,anchorX:0,anchorY:0}:null}export{f as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{packFloatRGBA as t}from\"../../core/floatRGBA.js\";import{isExtent as o}from\"../../geometry/support/jsonUtils.js\";import n from\"./Rect.js\";import{defaultSdfTextureSize as r,spritePadding as i}from\"../../views/2d/engine/webgl/definitions.js\";const e=.45;function a(t,o=.5){switch(t.type){case\"CIMPointSymbol\":{const o=t.symbolLayers;if(!o||1!==o.length)return null;const n=o[0];return\"CIMVectorMarker\"!==n.type?null:a(n)}case\"CIMVectorMarker\":{const n=t.markerGraphics;if(!n||1!==n.length)return null;const r=n[0];if(!r)return null;const i=r.geometry;if(!i)return null;const e=r.symbol;return!e||\"CIMPolygonSymbol\"!==e.type&&\"CIMLineSymbol\"!==e.type||e.symbolLayers?.some((t=>!!t.effects))?null:{type:\"sdf\",geom:i,sdfPaddingRatio:o,asFill:\"CIMPolygonSymbol\"===e.type}}}}function l(t){return t?t.rings?t.rings:t.paths?t.paths:void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:null:null}function s(t){let o=1/0,r=-1/0,i=1/0,e=-1/0;for(const n of t)for(const t of n)t[0]<o&&(o=t[0]),t[0]>r&&(r=t[0]),t[1]<i&&(i=t[1]),t[1]>e&&(e=t[1]);return new n(o,i,r-o,e-i)}function f(t){let o=1/0,n=-1/0,r=1/0,i=-1/0;for(const e of t)for(const t of e)t[0]<o&&(o=t[0]),t[0]>n&&(n=t[0]),t[1]<r&&(r=t[1]),t[1]>i&&(i=t[1]);return[o,r,n,i]}function m(t){return t?t.rings?f(t.rings):t.paths?f(t.paths):o(t)?[t.xmin,t.ymin,t.xmax,t.ymax]:null:null}function c(t,o){const[n,e,a,l]=m(t),s=a-n,f=l-e,c=r,h=i,u=Math.floor(.5*(c*o-h)),y=(c-2*(u+h))/Math.max(s,f),d=Math.round(s*y),x=Math.round(f*y);return{pixelDimensions:[s,f],texelDimensions:[Math.round((d+2*u)/y),Math.round((x+2*u)/y)]}}function h(t,o,n,a,l,s,f){const[m,c,h,u]=t;if(h<m||u<c)return{frameSizeRatio:0,anchorX:0,anchorY:0,widthRatio:1,sdfPaddingRatio:.5};const y=h-m,d=u-c,x=Math.max(y,d);let M=.5;if(null!=s&&null!=n){if(!f&&null!=o){s*=(o.ymax-o.ymin)/n}const t=s/(s+x),r=.1;t>e&&t<1&&(M=Math.min(t+r,.99))}const g=r,p=i,R=Math.floor(.5*(g*M-p)),w=(g-2*(R+p))/x,P=Math.round(y*w)+2*R,b=Math.round(d*w)+2*R;let C=1;if(o){C=b*(1-M)/((o.ymax-o.ymin)*w)}let I=0,S=0,j=1;a&&(l?o&&n&&o.ymax-o.ymin>0&&(j=(o.xmax-o.xmin)/(o.ymax-o.ymin),I=a.x/(n*j),S=a.y/n):(I=a.x,S=a.y)),o&&(I=.5*(o.xmax+o.xmin)+I*(o.xmax-o.xmin),S=.5*(o.ymax+o.ymin)+S*(o.ymax-o.ymin)),I-=m,S-=c,I*=w,S*=w,I+=R,S+=R;let v=I/P-.5,F=S/b-.5;return l&&n&&(v*=n*j,F*=n),{frameSizeRatio:C,anchorX:v,anchorY:F,widthRatio:j,sdfPaddingRatio:M}}function u(t){const o=l(t.geom),n=s(o),e=r,a=i,f=Math.floor(.5*(e*t.sdfPaddingRatio-a)),m=e-2*(f+a),c=m/Math.max(n.width,n.height),h=Math.round(n.width*c)+2*f,u=Math.round(n.height*c)+2*f,M=[];for(const r of o)if(r&&r.length>1){const o=[];for(const i of r){let[r,e]=i;r-=n.x,e-=n.y,r*=c,e*=c,r+=f-.5,e+=f-.5,t.asFill?o.push([r,e]):o.push([Math.round(r),Math.round(e)])}if(t.asFill){const t=o.length-1;o[0][0]===o[t][0]&&o[0][1]===o[t][1]||o.push(o[0])}M.push(o)}const g=y(M,h,u,f);return t.asFill&&d(M,h,u,f,g),{data:x(g,f),width:h,height:u,sdfPaddingRatio:t.sdfPaddingRatio,sdfDecodeCoeff:2*f/m}}function y(t,o,n,r){const i=o*n,e=new Array(i),a=r*r+1;for(let l=0;l<i;++l)e[l]=a;for(const l of t){const t=l.length;for(let i=1;i<t;++i){const t=l[i-1],a=l[i];let s,f,m,c;t[0]<a[0]?(s=t[0],f=a[0]):(s=a[0],f=t[0]),t[1]<a[1]?(m=t[1],c=a[1]):(m=a[1],c=t[1]);let h=Math.floor(s)-r,u=Math.floor(f)+r,y=Math.floor(m)-r,d=Math.floor(c)+r;h<0&&(h=0),u>o&&(u=o),y<0&&(y=0),d>n&&(d=n);const x=a[0]-t[0],M=a[1]-t[1],g=x*x+M*M;for(let r=h;r<u;r++)for(let i=y;i<d;i++){const l=r+.5,s=i+.5;let f,m,c=(l-t[0])*x+(s-t[1])*M;c<0?(f=t[0],m=t[1]):c>g?(f=a[0],m=a[1]):(c/=g,f=t[0]+c*x,m=t[1]+c*M);const h=(l-f)*(l-f)+(s-m)*(s-m),u=(n-i-1)*o+r;h<e[u]&&(e[u]=h)}}}for(let l=0;l<i;++l)e[l]=Math.sqrt(e[l]);return e}function d(t,o,n,r,i){for(const e of t){const t=e.length;for(let a=1;a<t;++a){const t=e[a-1],l=e[a];let s,f,m,c;t[0]<l[0]?(s=t[0],f=l[0]):(s=l[0],f=t[0]),t[1]<l[1]?(m=t[1],c=l[1]):(m=l[1],c=t[1]);let h=Math.floor(s),u=Math.floor(f)+1,y=Math.floor(m),d=Math.floor(c)+1;h<r&&(h=r),u>o-r&&(u=o-r),y<r&&(y=r),d>n-r&&(d=n-r);for(let e=y;e<d;++e){if(t[1]>e==l[1]>e)continue;const a=e+.5,s=(n-e-1)*o;for(let o=h;o<u;++o){o+.5<(l[0]-t[0])*(a-t[1])/(l[1]-t[1])+t[0]&&(i[s+o]=-i[s+o])}for(let t=r;t<h;++t)i[s+t]=-i[s+t]}}}}function x(o,n){const r=2*n,i=o.length,e=new Uint8Array(4*i);for(let a=0;a<i;++a){const n=.5-o[a]/r;t(n,e,4*a)}return e}export{u as buildSDF,m as getExtent,c as getSDFDimensions,a as getSDFInfo,h as getSDFMetrics};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport t from\"../../core/Logger.js\";import{animationDebugFlags as r}from\"./animationDebugFlags.js\";import{defaultCIMValues as e}from\"./defaultCIMValues.js\";import{AnimatedSymbolRepeatType as n,AnimatedSymbolEasingType as o}from\"./enums.js\";import{getProcessParam as i,getValue as a,getSize as s}from\"./utils.js\";import{TimeOrigin as m}from\"../../views/2d/engine/webgl/animations/instructions.js\";function l(t,r,e){return{transform:A(t,r,e.transform),fromColor:d(t,r,e.fromColor),toColor:b(t,r,e.toColor),colorMix:P(t,r,e.colorMix),toOpacity:g(t,r,e.toOpacity),opacityMix:I(t,r,e.opacityMix),hasAnimations:e.hasAnimations||!!r.animations&&r.animations.length>0}}function c(t){return!r.forceStaticPath&&(r.forceAnimatedPath||t.hasAnimations)}function f(r,e,n){if(\"CIMCharacterMarker\"===e.type)return t.getLogger(\"animationUtils\").error(\"#handleMarker()\",\"CIM character markers do not support animations\"),n;const o=i(r,e,\"OffsetX\"),a=i(r,e,\"OffsetY\");if(\"CIMPictureMarker\"===e.type)return{...n,transform:{type:\"AnimatedTransform\",relativeTranslation:!1,absoluteScale:!0,translation:v([o,a]),rotation:v(0),scale:v(i(r,e,\"Size\")),parent:n.transform}};const s=e.frame,m=s.ymax-s.ymin;return{...n,transform:{type:\"AnimatedTransform\",relativeTranslation:!1,absoluteScale:!1,translation:v([o,a]),rotation:v(0),scale:v({type:\"Process\",op:\"Divide\",left:i(r,e,\"Size\"),right:m}),parent:n.transform}}}function p(t,r){let e=0,n=0;const o=\"Absolute\"!==t.anchorPointUnits;return t.anchorPoint&&(e=-t.anchorPoint.x,n=-t.anchorPoint.y),{...r,transform:{type:\"AnimatedTransform\",relativeTranslation:o,absoluteScale:!1,translation:v([e,n]),rotation:v(0),scale:v(1),parent:r.transform}}}function u(t,r){return\"Absolute\"===t.anchorPointUnits?r:p(t,r)}function y(t,r){return\"Absolute\"!==t.anchorPointUnits?r:p(t,r)}function C(t,r,e){return{...t,transform:{type:\"AnimatedTransform\",relativeTranslation:!1,absoluteScale:!1,translation:v([r,e]),rotation:v(0),scale:v(1),parent:t.transform}}}function M(t,r){switch(r.type){case\"CIMPictureMarker\":case\"CIMVectorMarker\":return i(t,r,\"Rotation\")}return 0}function S(t,r){switch(r.type){case\"CIMPointSymbol\":case\"CIMVectorMarker\":return[1,1,1,1];case\"CIMSolidStroke\":case\"CIMSolidFill\":return i(t,r,\"Color\");case\"CIMPictureMarker\":case\"CIMPictureStroke\":case\"CIMPictureFill\":return i(t,r,\"TintColor\")}return[1,1,1,1]}function A(t,r,e){return{type:\"AnimatedTransform\",relativeTranslation:!1,absoluteScale:!1,translation:k(t,r),rotation:O(t,r),scale:h(t,r),parent:e}}function d(t,r,e){return{type:\"AnimatedColor\",color:v(S(t,r)),opacity:v(1),parent:e}}function b(t,r,e){const{animations:n}=r;let o=S(t,r);const a=n?.filter((t=>\"CIMSymbolAnimationColor\"===t.type))[0];return a&&(o=i(t,a,\"ToColor\")),{type:\"AnimatedColor\",color:v(o),opacity:v(1),parent:e}}function P(t,r,e){const{animations:n}=r,o=n?.filter((t=>\"CIMSymbolAnimationColor\"===t.type))[0];return o?{type:\"AnimatedColor\",color:v([1,1,1,1]),opacity:{from:0,to:1,timing:T(t,o?.animatedSymbolProperties)},parent:[1,1,1,1]}:e}function g(t,r,e){const{animations:n}=r;let o=v(1);const a=n?.filter((t=>\"CIMSymbolAnimationTransparency\"===t.type))[0];if(a){o=v({type:\"Process\",op:\"Transparency\",value:i(t,a,\"ToTransparency\")})}return{type:\"AnimatedColor\",color:v([1,1,1,1]),opacity:o,parent:e}}function I(t,r,e){const{animations:n}=r,o=n?.filter((t=>\"CIMSymbolAnimationTransparency\"===t.type))[0];return o?{type:\"AnimatedColor\",color:v([1,1,1,1]),opacity:{from:0,to:1,timing:T(t,o?.animatedSymbolProperties)},parent:[1,1,1,1]}:e}function T(t,r){if(!r)return{duration:1,startTimeOffset:0,repeatDelay:0,timeOriginSelector:m.Local,repeatType:n.Loop,easing:o.Linear,playAnimation:1,reverseAnimation:0};const s=i(t,r,\"Duration\");let l;if(i(t,r,\"RandomizeStartTime\")){l={type:\"Process\",op:\"Random\",min:0,max:s,seed:i(t,r,\"RandomizeStartSeed\")}}else l=i(t,r,\"StartTimeOffset\");const c=i(t,r,\"RepeatDelay\"),f=i(t,r,\"PlayAnimation\"),p=i(t,r,\"ReverseAnimation\"),u=a(r.repeatType,e.CIMAnimatedSymbolProperties.repeattype);return{duration:s,startTimeOffset:l,repeatDelay:c,timeOriginSelector:u===n.None?m.Local:m.Global,repeatType:u,easing:a(r.easing,e.CIMAnimatedSymbolProperties.easing),playAnimation:f,reverseAnimation:p}}function h(t,r){const{animations:e}=r;if(\"CIMPictureMarker\"!==r.type&&\"CIMVectorMarker\"!==r.type&&\"CIMPointSymbol\"!==r.type)return v(1);let n;n=\"CIMPictureMarker\"===r.type||\"CIMVectorMarker\"===r.type?i(t,r,\"Size\"):s(r)||10;const o=e?.filter((t=>\"CIMSymbolAnimationScale\"===t.type))[0];if(!o){const r=e?.filter((t=>\"CIMSymbolAnimationSize\"===t.type))[0];if(!r)return v(1);return{from:1,to:{type:\"Process\",op:\"Divide\",left:i(t,r,\"ToSize\"),right:n},timing:T(t,r.animatedSymbolProperties)}}return{from:1,to:i(t,o,\"ScaleFactor\"),timing:T(t,o.animatedSymbolProperties)}}function k(t,r){const{animations:e}=r,n=e?.filter((t=>\"CIMSymbolAnimationOffset\"===t.type))[0];if(!n)return v([0,0]);return{from:[0,0],to:[i(t,n,\"OffsetX\"),i(t,n,\"OffsetY\")],timing:T(t,n.animatedSymbolProperties)}}function O(t,r){const{animations:e}=r,n=M(t,r),o=e?.filter((t=>\"CIMSymbolAnimationRotation\"===t.type))[0];if(!o)return v(n);return{from:n,to:i(t,o,\"ToRotation\"),timing:T(t,o.animatedSymbolProperties)}}function v(t){return{from:t,to:t,timing:{duration:1,startTimeOffset:0,repeatDelay:0,timeOriginSelector:m.Local,repeatType:n.Loop,easing:o.Linear,playAnimation:1,reverseAnimation:0}}}function L(t){if(null==t)return!1;if(\"object\"!=typeof t)return!1;if(t.animations&&Array.isArray(t.animations)&&t.animations.length>0)return!0;for(const r in t)if(L(t[r]))return!0;return!1}export{L as checkForAnimations,l as getAnimationParams,v as getStaticParam,y as handleAbsoluteAnchor,p as handleAnchor,f as handleMarker,u as handleRelativeAnchor,c as shouldUseAnimatedPath,C as translate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{isRGB as e}from\"../../core/colorUtils.js\";import{getFontFamily as r}from\"../../core/fontUtils.js\";import{clone as t}from\"../../core/lang.js\";import i from\"../../core/Logger.js\";import{pt2px as o,px2pt as a}from\"../../core/screenUtils.js\";import{numericHash as s}from\"../../core/string.js\";import{checkForAnimations as l,getAnimationParams as n,handleAbsoluteAnchor as p,handleMarker as c,handleRelativeAnchor as m,translate as y,getStaticParam as f,shouldUseAnimatedPath as h}from\"./animationUtils.js\";import{CIMSymbolHelper as d}from\"./CIMSymbolHelper.js\";import{defaultCIMValues as u}from\"./defaultCIMValues.js\";import{Alignment as v}from\"./enums.js\";import{OverrideHelper as O}from\"./OverrideHelper.js\";import{getExtent as _,getSDFMetrics as S,getSDFDimensions as g}from\"./SDFHelper.js\";import{colorToArray as M,normalizeAlpha as k,getSize as b,isCIMMarkerStrokePlacement as C,getTintColor as P,getNumericValue as x,normalizePrimitiveOverrideProps as z,getDefaultCIMValue as L,getEnum as I,getStrokeWidth as E,getFillColor as V,getStrokeColor as N,fromCIMFontDecoration as R,fromCIMFontStyle as w,fromCIMHorizontalAlignment as A,fromCIMVerticalAlignment as G,isValidCIMValue as X,uncapitalize as F}from\"./utils.js\";import{CIMEffectHelper as T}from\"./effects/CIMEffectHelper.js\";import{randomInsidePolygonTextureSize as Y}from\"../../views/2d/engine/webgl/definitions.js\";const j=()=>i.getLogger(\"esri.symbols.cim.cimAnalyzer\");function W(e){const r=e.markerPlacement;return r&&r.angleToLine?v.MAP:v.SCREEN}class D{constructor(e){this._cimLayers=[],this._poMap={},this._primitiveOverrides=[],e&&(this._resourceManager=e)}analyzeSymbolReference(r,t,i){if(this._cimLayers=i??[],!r)return this._cimLayers;if(this._reset(),r.primitiveOverrides){this._primitiveOverrides=r.primitiveOverrides;for(const r of this._primitiveOverrides){const t=r.valueExpressionInfo;if(t)this._setPoMap(r.primitiveName,r.propertyName,t);else if(null!=r.value){let t=r.value;r.propertyName.includes(\"Color\")&&(e(t)&&(t=M(t)),t=k(t)),this._setPoMap(r.primitiveName,r.propertyName,t)}}}return this._analyzeSymbol(r.symbol,t),this._cimLayers}_reset(){this._cimLayers=[],this._poMap={},this._primitiveOverrides=[]}_analyzeSymbol(e,r){switch(e?.type){case\"CIMPointSymbol\":case\"CIMLineSymbol\":case\"CIMPolygonSymbol\":this._analyzeMultiLayerSymbol(e,r)}}_analyzeMultiLayerSymbol(e,r){const t=e?.symbolLayers;if(!t)return;const i=e.effects;let o=v.SCREEN;const a=b(e)??0;\"CIMPointSymbol\"===e.type&&\"Map\"===e.angleAlignment&&(o=v.MAP);let s={transform:[0,0,0,1],fromColor:[1,1,1,1],toColor:[1,1,1,1],colorMix:[0,0,0,0],toOpacity:[1,1,1,1],opacityMix:[0,0,0,0],hasAnimations:l(e)};s=n(this._poMap,e,s);const p=\"CIMPolygonSymbol\"===e.type;let c=t.length;for(;c--;){const l=t[c];if(!l||!1===l.enable)continue;let n;i?.length&&(n=[...i]);const m=l.effects;m?.length&&(i?n.push(...m):n=[...m]);let y=null;if(n){y=[];for(const e of n){const r=O.findEffectOverrides(e,this._primitiveOverrides);r&&y.push(r)}}const f=[];switch(O.findApplicableOverrides(l,this._primitiveOverrides,f),l.type){case\"CIMSolidFill\":this._analyzeSolidFill(l,y);break;case\"CIMPictureFill\":this._analyzePictureFill(l,y);break;case\"CIMHatchFill\":this._analyzeHatchFill(l,y);break;case\"CIMGradientFill\":this._analyzeGradientFill(l,y);break;case\"CIMSolidStroke\":this._analyzeSolidStroke(l,y,p,a);break;case\"CIMPictureStroke\":this._analyzePictureStroke(l,y,p,a);break;case\"CIMGradientStroke\":this._analyzeGradientStroke(l,y,p,a);break;case\"CIMCharacterMarker\":case\"CIMPictureMarker\":case\"CIMVectorMarker\":{\"CIMLineSymbol\"!==e.type&&\"CIMPolygonSymbol\"!==e.type||(o=W(l));const t=[],i=l.primitiveName;i&&t.push(i);const n=p&&C(l.markerPlacement);this._analyzeMarker(l,y,null,t,o,a,r,[],s,!1,n);break}default:j().error(\"Cannot analyze CIM layer\",l.type)}}}_analyzeSolidFill(e,r){const{primitiveName:t,type:i}=e,o=k(e.color);this._cimLayers.push({type:\"fill\",spriteRasterizationParam:null,colorLocked:!!e.colorLocked,color:this._getValueOrOverrideExpression(i,t,\"Color\",o),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:r,applyRandomOffset:!1,sampleAlphaOnly:!0,hasUnresolvedReplacementColor:!1})}_analyzePictureFill(e,r){const{primitiveName:t,type:i}=e,o=P(e),a=x(e.height,u.CIMPictureFill.height);let s=x(e.scaleX,1);if(\"width\"in e&&\"number\"==typeof e.width){const r=e.width;let t=1;const i=this._resourceManager.getResource(e.url);null!=i&&(t=i.width/i.height),s/=t*(a/r)}const l={type:\"sprite-rasterization-param\",resource:e,overrides:this._getPrimitiveMaterialOverrides(t,i)};this._cimLayers.push({type:\"fill\",spriteRasterizationParam:l,colorLocked:!!e.colorLocked,effects:r,color:this._getValueOrOverrideExpression(i,t,\"TintColor\",o),height:this._getValueOrOverrideExpression(i,t,\"Height\",a),scaleX:this._getValueOrOverrideExpression(i,t,\"ScaleX\",s),angle:this._getValueOrOverrideExpression(i,t,\"Rotation\",x(e.rotation)),offsetX:this._getValueOrOverrideExpression(i,t,\"OffsetX\",x(e.offsetX)),offsetY:this._getValueOrOverrideExpression(i,t,\"OffsetY\",x(e.offsetY)),applyRandomOffset:!1,sampleAlphaOnly:!1,hasUnresolvedReplacementColor:!1})}_analyzeHatchFill(e,r){const{primitiveName:t,type:i}=e,o=this._analyzeMaterialOverrides(t,[\"Rotation\",\"OffsetX\",\"OffsetY\"]),a=z(o);let s=[255,255,255,1],l=!1;if(e.lineSymbol?.symbolLayers)for(const p of e.lineSymbol.symbolLayers){if(\"CIMSolidStroke\"!==p.type)continue;const e=p.primitiveName??t;l||!e||p.colorLocked||null==this._poMap[e]?.Color&&null==this._poMap[e]?.StrokeColor||(s=k(p.color),s=this._maybeGetValueOrOverrideExpression(e,\"StrokeColor\")??this._getValueOrOverrideExpression(i,e,\"Color\",s),l=!0);const r=this._maybeGetValueOrOverrideExpression(e,\"StrokeWidth\");if(r){let t=null,o=null;\"number\"==typeof r?t=r:o=r.valueExpressionInfo;let s=a.find((e=>\"strokeWidth\"===e.propertyName));s?s.propertyName=\"width\":(s={type:\"CIMPrimitiveOverride\",primitiveName:e,propertyName:\"width\",valueExpressionInfo:o,value:t,defaultValue:L(i,\"width\")},a.push(s))}}const n={type:\"sprite-rasterization-param\",resource:e,overrides:a};this._cimLayers.push({type:\"fill\",spriteRasterizationParam:n,colorLocked:!!e.colorLocked,effects:r,color:s,height:this._getValueOrOverrideExpression(i,t,\"Separation\",x(e.separation,u.CIMHatchFill.separation)),scaleX:1,angle:this._getValueOrOverrideExpression(i,t,\"Rotation\",x(e.rotation)),offsetX:this._getValueOrOverrideExpression(i,t,\"OffsetX\",x(e.offsetX)),offsetY:this._getValueOrOverrideExpression(i,t,\"OffsetY\",x(e.offsetY)),applyRandomOffset:!1,sampleAlphaOnly:!0,hasUnresolvedReplacementColor:!l})}_analyzeGradientFill(e,r){this._cimLayers.push({type:\"fill\",spriteRasterizationParam:null,colorLocked:!!e.colorLocked,effects:r,color:[128,128,128,1],height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,applyRandomOffset:!1,sampleAlphaOnly:!1,hasUnresolvedReplacementColor:!1})}_analyzeSolidStroke(e,r,t,i){const{primitiveName:o,type:a}=e,s=k(e.color),l=x(e.width,u.CIMSolidStroke.width),n=I(e.capStyle,u.CIMSolidStroke.capstyle),p=I(e.joinStyle,u.CIMSolidStroke.joinstyle),c=e.miterLimit;let m,y,f,h,d=[];if(this._analyzePrimitiveOverrides(o,r,null,null)&&(d=this._getPrimitiveMaterialOverrides(o,a)),r&&Array.isArray(r)&&r.length>0){const e=r[r.length-1].effect;e&&\"CIMGeometricEffectDashes\"===e.type&&\"NoConstraint\"===e.lineDashEnding&&(m=e.dashTemplate,y=e.scaleDash,f=e.offsetAlongLine,h=e.primitiveName,(r=[...r]).pop())}null!=h&&d.push(...this._getPrimitiveMaterialOverrides(h,a).filter((e=>\"dashTemplate\"===e.propertyName)));const v=void 0!==m?{type:\"sprite-rasterization-param\",resource:{type:\"dash\",dashTemplate:m,primitiveName:h},overrides:d}:null;this._cimLayers.push({type:\"line\",spriteRasterizationParam:v,isOutline:t,colorLocked:!!e.colorLocked,effects:r,color:this._getValueOrOverrideExpression(a,o,\"Color\",s),width:this._getValueOrOverrideExpression(a,o,\"Width\",l),cap:this._getValueOrOverrideExpression(a,o,\"CapStyle\",n),join:this._getValueOrOverrideExpression(a,o,\"JoinStyle\",p),miterLimit:c&&this._getValueOrOverrideExpression(a,o,\"MiterLimit\",c),referenceWidth:i,zOrder:U(e.name),dashTemplate:this._maybeGetValueOrOverrideExpression(h,\"DashTemplate\")??m,offsetAlongLine:this._getValueOrOverrideExpression(a,h,\"OffsetAlongLine\",f??0),scaleDash:y,sampleAlphaOnly:!0})}_analyzePictureStroke(e,r,t,i){const{primitiveName:o,type:a}=e,s=P(e),l=x(e.width,u.CIMPictureStroke.width),n=I(e.capStyle,u.CIMPictureStroke.capstyle),p=I(e.joinStyle,u.CIMPictureStroke.joinstyle),c=e.miterLimit,m={type:\"sprite-rasterization-param\",resource:e,overrides:this._getPrimitiveMaterialOverrides(o,a)};this._cimLayers.push({type:\"line\",spriteRasterizationParam:m,isOutline:t,colorLocked:!!e.colorLocked,effects:r,color:this._getValueOrOverrideExpression(a,o,\"TintColor\",s),width:this._getValueOrOverrideExpression(a,o,\"Width\",l),cap:this._getValueOrOverrideExpression(a,o,\"CapStyle\",n),join:this._getValueOrOverrideExpression(a,o,\"JoinStyle\",p),miterLimit:c&&this._getValueOrOverrideExpression(a,o,\"MiterLimit\",c),referenceWidth:i,zOrder:U(e.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1})}_analyzeGradientStroke(e,r,t,i){const{primitiveName:o,type:a}=e,s=x(e.width,u.CIMSolidStroke.width),l=I(e.capStyle,u.CIMGradientStroke.capstyle),n=I(e.joinStyle,u.CIMGradientStroke.joinstyle),p=e.miterLimit;this._cimLayers.push({type:\"line\",spriteRasterizationParam:null,isOutline:t,colorLocked:!!e.colorLocked,effects:r,color:[128,128,128,1],width:this._getValueOrOverrideExpression(a,o,\"Width\",s),cap:this._getValueOrOverrideExpression(a,o,\"CapStyle\",l),join:this._getValueOrOverrideExpression(a,o,\"JoinStyle\",n),miterLimit:p&&this._getValueOrOverrideExpression(a,o,\"MiterLimit\",p),referenceWidth:i,zOrder:U(e.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1})}_analyzeMarker(e,r,t,i,o,a,s,l,y,f=!1,h=!1){if(f||=!!e.colorLocked,this._analyzeMarkerInsidePolygon(e,r,f))return;const d=x(e.size,u.CIMVectorMarker.size),v=x(e.rotation),O=x(e.offsetX),_=x(e.offsetY),{primitiveName:S,type:g}=e,M=this._getValueOrOverrideExpression(g,S,\"Size\",d),k=this._getValueOrOverrideExpression(g,S,\"Rotation\",v),b=this._getValueOrOverrideExpression(g,S,\"OffsetX\",O),C=this._getValueOrOverrideExpression(g,S,\"OffsetY\",_);let P=y;switch(P=p(e,P),P=c(this._poMap,e,P),P=m(e,P),P=n(this._poMap,e,P),e.type){case\"CIMPictureMarker\":this._analyzePictureMarker(e,r,t,i,o,a,M,k,b,C,l,P,f,h);break;case\"CIMVectorMarker\":this._analyzeVectorMarker(e,r,t,i,o,a,M,k,b,C,l,P,s,f,h)}}_analyzeMarkerInsidePolygon(e,r,t){const{markerPlacement:i,type:o}=e;if(!i||\"CIMMarkerPlacementInsidePolygon\"!==i.type)return!1;if(\"CIMVectorMarker\"===o||\"CIMPictureMarker\"===o){const t=e.primitiveName;if(t&&this._analyzePrimitiveOverrides([t],r,null,null))return!1;const a=i.primitiveName;if(a&&this._analyzePrimitiveOverrides([a],r,null,null))return!1;if(\"CIMVectorMarker\"===o){const{markerGraphics:r}=e;if(r)for(const e of r){const{symbol:r}=e;if(\"CIMPolygonSymbol\"===r?.type&&r.symbolLayers){const{symbolLayers:e}=r;for(const r of e)if(\"CIMSolidStroke\"===r.type)return!1}}}else{const{animatedSymbolProperties:r}=e;if(r)return!1}}const s=Math.abs(i.stepX),l=Math.abs(i.stepY);if(0===s||0===l)return!0;let n,p;if(\"Random\"===i.gridType){const e=a(Y),r=Math.max(Math.floor(e/s),1);n=l*Math.max(Math.floor(e/l),1);p=r*s/n}else i.shiftOddRows?(n=2*l,p=s/l*.5):(n=l,p=s/l);const c=P(e),m=\"CIMCharacterMarker\"===e.type?null:{type:\"sprite-rasterization-param\",resource:e,overrides:[]};return this._cimLayers.push({type:\"fill\",spriteRasterizationParam:m,colorLocked:t,effects:r,color:c,height:n,scaleX:p,angle:i.gridAngle,offsetX:x(i.offsetX),offsetY:x(i.offsetY),applyRandomOffset:\"Random\"===i.gridType,sampleAlphaOnly:\"CIMPictureMarker\"!==e.type,hasUnresolvedReplacementColor:!0}),!0}_analyzePictureMarker(e,r,i,o,a,l,n,p,c,m,y,f,h,d){const{animatedSymbolProperties:u,primitiveName:v,type:O}=e;let _=x(e.scaleX,1);const S=P(e);i||(i=this._createMarkerPlacementOverrideExpression(e.markerPlacement));const g=this._createGIFAnimatedSymbolPropertiesOverrideExpression(u),M=e.anchorPoint??{x:0,y:0};if(\"width\"in e&&\"number\"==typeof e.width){const r=e.width;let t=1;const i=this._resourceManager.getResource(e.url);null!=i&&(t=i.width/i.height);_/=t*(x(e.size)/r)}const k=[...o];let b;e.primitiveName&&k.push(e.primitiveName),u||g?b={type:\"animated\",url:e.url,urlHash:\"H\"+s(e.url),playAnimation:e.animatedSymbolProperties?.playAnimation,reverseAnimation:e.animatedSymbolProperties?.reverseAnimation,randomizeStartTime:e.animatedSymbolProperties?.randomizeStartTime,randomizeStartSeed:e.animatedSymbolProperties?.randomizeStartSeed,startTimeOffset:e.animatedSymbolProperties?.startTimeOffset,duration:e.animatedSymbolProperties?.duration,repeatType:e.animatedSymbolProperties?.repeatType,repeatDelay:e.animatedSymbolProperties?.repeatDelay}:(b=t(e),b.markerPlacement=null);const C={type:\"sprite-rasterization-param\",resource:b,overrides:this._getMaterialOverrides(k,O)};g&&C.overrides.push(...g.overrides);const z=n;this._cimLayers.push({type:\"marker\",spriteRasterizationParam:C,colorLocked:h,effects:r,scaleSymbolsProportionally:!1,alignment:a,size:n,scaleX:this._getValueOrOverrideExpression(O,v,\"ScaleX\",_),rotation:p,offsetX:c,offsetY:m,transform:{type:\"cim-marker-transform-param\",params:y},color:this._getValueOrOverrideExpression(O,v,\"TintColor\",S),anchorPoint:{x:M.x,y:M.y},isAbsoluteAnchorPoint:\"Relative\"!==e.anchorPointUnits,outlineColor:[0,0,0,0],outlineWidth:0,frameHeight:0,widthRatio:1,rotateClockwise:!!e.rotateClockwise,referenceSize:l,sizeRatio:1,isOutline:d,markerPlacement:i,animationParams:Q(f),baseSize:z})}_analyzeVectorMarker(e,r,t,i,o,a,s,l,p,c,m,h,d,u,v){const O=e.markerGraphics;if(!O)return;const _=e.frame;let S=0;S=_?_.ymax-_.ymin:a;const g=!!e.scaleSymbolsProportionally;if(S){const r={offsetX:p,offsetY:c,rotation:l,size:s,frameHeight:S,rotateClockWise:!!e.rotateClockwise,absoluteAnchorPoint:!1,scaleSymbolsProportionally:g};m=[...m,r]}t||(t=this._createMarkerPlacementOverrideExpression(e.markerPlacement));for(const M of O)if(M){const s=M.symbol;if(!s)continue;const l=M.primitiveName;l&&i.push(l);let p,c=h;if((\"CIMPointSymbol\"===s.type||\"CIMTextSymbol\"===s.type)&&_){let r=0,t=0;const i=M.geometry;\"x\"in i&&\"y\"in i&&(r+=i.x-.5*(_.xmin+_.xmax),t+=i.y-.5*(_.ymin+_.ymax));const o=e.anchorPoint;let a=!1;o&&(\"Absolute\"===e.anchorPointUnits?(r-=o.x,t-=o.y,a=!0):_&&(r-=(_.xmax-_.xmin)*o.x,t-=(_.ymax-_.ymin)*o.y));const s={offsetX:r,offsetY:t,rotation:0,size:0,frameHeight:0,rotateClockWise:!1,absoluteAnchorPoint:a,scaleSymbolsProportionally:g};p=[...m,s]}if(\"CIMPointSymbol\"===s.type||\"CIMTextSymbol\"===s.type){const e=M.geometry;if(\"x\"in e&&\"y\"in e){const{x:r,y:t}=e,i=_?.5*-(_.xmin+_.xmax):0,o=_?.5*-(_.ymin+_.ymax):0;r+i===0&&t+o===0||(c=y(c,r+i,t+o))}}switch(\"CIMPointSymbol\"===s.type&&(c=n(this._poMap,s,c)),s.type){case\"CIMPointSymbol\":case\"CIMLineSymbol\":case\"CIMPolygonSymbol\":d||q(s)?(c={...c,transform:{type:\"AnimatedTransform\",relativeTranslation:!1,absoluteScale:!0,translation:f([0,0]),rotation:f(0),scale:f(S),parent:h.transform}},this._analyzeMultiLayerGraphicNonSDF(e,r,t,M,i,o,a,p??m,c,S,u,v)):this._analyzeMultiLayerGraphic(e,r,t,M,i,o,a,p??m,c,S,u,v);break;case\"CIMTextSymbol\":this._analyzeTextGraphic(r,t,M,i,o,a,p??m,u)}l&&i.pop()}}_analyzeMultiLayerGraphic(e,r,t,i,o,a,s,l,p,c,m,y){const f=i.symbol,d=f.symbolLayers;if(!d)return;let v=d.length;if(B(d)&&!h(p))return void this._analyzeCompositeMarkerGraphic(e,r,t,i,d,a,s,l,c,m,y);const O=this._resourceManager.geometryEngine,M=T.applyEffects(f.effects,i.geometry,O);if(M)for(;v--;){const f=d[v];if(!f||!1===f.enable)continue;const h=f.primitiveName;switch(h&&o.push(h),f.type){case\"CIMSolidFill\":case\"CIMSolidStroke\":{const o=T.applyEffects(f.effects,M,O),d=_(o);if(!d)continue;const v=\"Relative\"!==e.anchorPointUnits,b=E(f)??0,{frameSizeRatio:C,anchorX:P,anchorY:z,widthRatio:L,sdfPaddingRatio:I}=S(d,e.frame,e.size,e.anchorPoint,v,b,e.scaleSymbolsProportionally),R=\"CIMSolidFill\"===f.type,w={type:\"sdf\",geom:o,sdfPaddingRatio:I,asFill:R},{path:A}=f,G=R?k(V(f)):null==A?k(N(f)):[0,0,0,0],X=R?[0,0,0,0]:k(N(f));if(!R&&!b)break;const F=i.primitiveName;let Y=null;R&&!f.colorLocked&&(Y=this._maybeGetValueOrOverrideExpression(F,\"FillColor\"));let j=null;R||f.colorLocked||(j=this._maybeGetValueOrOverrideExpression(F,\"StrokeColor\"));const W=Y??this._getValueOrOverrideExpression(f.type,h,\"Color\",G),D=j??this._getValueOrOverrideExpression(f.type,h,\"Color\",X),H=this._maybeGetValueOrOverrideExpression(F,\"StrokeWidth\")??this._getValueOrOverrideExpression(f.type,h,\"Width\",b),U=A?{type:\"sprite-rasterization-param\",resource:{type:\"path\",path:A,asFill:R},overrides:[]}:{type:\"sprite-rasterization-param\",resource:w,overrides:[]},J=n(this._poMap,f,p),B=x(e.size,u.CIMVectorMarker.size),q=this._getValueOrOverrideExpression(e.type,e.primitiveName,\"Size\",B);this._cimLayers.push({type:\"marker\",spriteRasterizationParam:U,colorLocked:!!f.colorLocked||!!m,effects:r,scaleSymbolsProportionally:!!e.scaleSymbolsProportionally,alignment:a,anchorPoint:{x:P,y:z},isAbsoluteAnchorPoint:v,size:c,rotation:0,offsetX:0,offsetY:0,scaleX:1,transform:{type:\"cim-marker-transform-param\",params:l},frameHeight:c,widthRatio:L,rotateClockwise:!1,referenceSize:s,sizeRatio:C,color:W,outlineColor:D,outlineWidth:H,isOutline:y,markerPlacement:t,animationParams:Q(J),isStroke:\"CIMSolidFill\"!==f.type,baseSize:q,...g(o,I)});break}case\"CIMPictureMarker\":case\"CIMVectorMarker\":f.markerPlacement?this._analyzeMultiLayerGraphicNonSDF(e,r,t,i,o,a,s,l,p,c,!!f.colorLocked||!!m,y):this._analyzeMarker(f,r,t,o,a,s,!1,l,p,m,y);break;default:this._analyzeMultiLayerGraphicNonSDF(e,r,t,i,o,a,s,l,p,c,!!f.colorLocked||!!m,y)}h&&o.pop()}}_analyzeTextGraphic(e,t,i,o,a,s,l,n){const p=[];O.findApplicableOverrides(i,this._primitiveOverrides,p);const c=i.geometry;if(!(\"x\"in c)||!(\"y\"in c))return;const m=i.symbol,y=R(m),f=w(m.fontStyleName),h=r(m.fontFamilyName);m.font={family:h,decoration:y,...f};const d=x(m.height,u.CIMTextSymbol.height),v=x(m.angle),_=x(m.offsetX),S=x(m.offsetY),{haloSymbol:g}=m,M=x(m.haloSize,0);let b=[0,0,0,0];if(g?.symbolLayers?.length){const e=g.symbolLayers;for(const r of e)if(r.color){b=this._getValueOrOverrideExpression(m?.haloSymbol?.type??\"CIMPolygonSymbol\",r.primitiveName,\"Color\",k(r.color));break}}const C=i.primitiveName;let P=[0,0,0,1],z=[0,0,0,0],L=0,I=!1;if(m.symbol?.symbolLayers)for(const r of m.symbol.symbolLayers){const e=r.primitiveName;if(\"CIMSolidStroke\"===r.type)z=this._getValueOrOverrideExpression(\"CIMSolidStroke\",e,\"Color\",k(r.color)),L=this._getValueOrOverrideExpression(\"CIMSolidStroke\",e,\"Width\",E(r)??0);else if(\"CIMSolidFill\"===r.type){const t=k(r.color);I=I??!!r.colorLocked,P=this._getValueOrOverrideExpression(\"CIMSolidFill\",e??C,\"Color\",t)}}let V=null,N=null,X=null,F=null,T=null;C&&(V=this._maybeGetValueOrOverrideExpression(C,\"TextSize\"),N=this._maybeGetValueOrOverrideExpression(C,\"TextAngle\"),X=this._maybeGetValueOrOverrideExpression(C,\"TextOffsetX\"),F=this._maybeGetValueOrOverrideExpression(C,\"TextOffsetY\"),I||(T=this._maybeGetValueOrOverrideExpression(C,\"FillColor\")));const Y=T??P;let j=null,W=null,D=0;if(m.callout&&\"CIMBackgroundCallout\"===m.callout.type){const e=m.callout;if(e.backgroundSymbol){const r=e.backgroundSymbol.symbolLayers;if(r)for(const e of r)\"CIMSolidFill\"===e.type?j=k(e.color):\"CIMSolidStroke\"===e.type&&(W=k(e.color),D=x(e.width,u.CIMSolidStroke.width))}}const H=this._getValueOrOverrideExpression(m.type,i.primitiveName,\"TextString\",i.textString??\"\");if(null==H)return;const{fontStyleName:U}=m,J=h+(U?\"-\"+U.toLowerCase():\"-regular\"),B=this._getMaterialOverrides(o,m.type);B.push(...this._getPrimitiveMaterialOverrides(i.primitiveName,m.type));const q={type:\"text-rasterization-param\",resource:{type:\"text\",textString:i.textString??\"\",font:m.font,symbol:m,primitiveName:i.primitiveName},overrides:B};this._cimLayers.push({type:\"text\",lineWidth:m.lineWidth,textRasterizationParam:q,colorLocked:!!n||!!I,effects:e,alignment:a,anchorPoint:{x:0,y:0},isAbsoluteAnchorPoint:!1,fontName:J,decoration:y,haloSize:M,haloColor:b,weight:f.weight,style:f.style,size:V??d,angle:N??v,offsetX:X??_,offsetY:F??S,transform:{type:\"cim-marker-transform-param\",params:l},horizontalAlignment:A(m.horizontalAlignment),verticalAlignment:G(m.verticalAlignment),text:H,color:Y,outlineColor:z,outlineSize:L,backgroundColor:j,borderLineColor:W,borderLineWidth:D,referenceSize:s,sizeRatio:1,markerPlacement:t})}_analyzeMultiLayerGraphicNonSDF(e,r,t,i,a,s,l,n,p,c,m,y){const f=H(e,i),h=e.primitiveName,v=this._analyzeMaterialOverrides(h,[\"Rotation\",\"OffsetX\",\"OffsetY\"]),O=z(v),[_,S,g]=d.getTextureAnchor(f,this._resourceManager),M=this._getMaterialOverrides(a,e.type);M.push(...O);const k={type:\"sprite-rasterization-param\",resource:{...f,avoidSDFRasterization:!0},overrides:M},b=x(e.size,u.CIMVectorMarker.size),C=this._getValueOrOverrideExpression(e.type,h,\"Size\",b);this._cimLayers.push({type:\"marker\",spriteRasterizationParam:k,colorLocked:m,effects:r,scaleSymbolsProportionally:!!e.scaleSymbolsProportionally,alignment:s,anchorPoint:{x:_,y:S},isAbsoluteAnchorPoint:!1,size:c,rotation:0,offsetX:0,offsetY:0,transform:{type:\"cim-marker-transform-param\",params:n},color:[255,255,255,1],outlineColor:[0,0,0,0],outlineWidth:0,scaleX:1,frameHeight:c,widthRatio:1,rotateClockwise:!!e.rotateClockwise,referenceSize:l,sizeRatio:g/o(e.size),isOutline:y,markerPlacement:t,animationParams:Q(p),baseSize:C})}_createMarkerPlacementOverrideExpression(e){if(!e)return null;const r=[];return O.findApplicableOverrides(e,this._primitiveOverrides,r),{type:\"cim-marker-placement-param\",placement:e,overrides:K(r)}}_createGIFAnimatedSymbolPropertiesOverrideExpression(e){if(!e)return null;const r=[];return O.findApplicableOverrides(e,this._primitiveOverrides,r),{type:\"cim-gif-animation-params\",animation:e,overrides:K(r)}}_analyzeCompositeMarkerGraphic(e,r,t,i,o,a,s,l,n,p,c){const m=i.geometry,y=o[0],f=o[1],h=_(m);if(!h)return;const d=\"Relative\"!==e.anchorPointUnits,v=x(y.width,u.CIMSolidStroke.width),{frameSizeRatio:O,anchorX:g,anchorY:M,widthRatio:b,sdfPaddingRatio:C}=S(h,e.frame,e.size,e.anchorPoint,d,v,e.scaleSymbolsProportionally),{path:P}=f,z=f.primitiveName,L=y.primitiveName,I=i.primitiveName;let E=null;f.colorLocked||p||(E=this._maybeGetValueOrOverrideExpression(I,\"FillColor\"));const V=E??this._getValueOrOverrideExpression(f.type,z,\"Color\",k(f.color));let N=null;y.colorLocked||p||(N=this._maybeGetValueOrOverrideExpression(I,\"StrokeColor\"));const R=N??this._getValueOrOverrideExpression(y.type,L,\"Color\",k(y.color)),w=this._maybeGetValueOrOverrideExpression(I,\"StrokeWidth\")??this._getValueOrOverrideExpression(y.type,L,\"Width\",v),A={type:\"sprite-rasterization-param\",resource:P?{type:\"path\",path:P,asFill:!0}:{type:\"sdf\",geom:m,sdfPaddingRatio:C,asFill:!0},overrides:[]};this._cimLayers.push({type:\"marker\",spriteRasterizationParam:A,colorLocked:p,effects:r,scaleSymbolsProportionally:!!e.scaleSymbolsProportionally,alignment:a,anchorPoint:{x:g,y:M},isAbsoluteAnchorPoint:d,size:n,rotation:0,offsetX:0,offsetY:0,scaleX:1,transform:{type:\"cim-marker-transform-param\",params:l},frameHeight:n,widthRatio:b,rotateClockwise:!1,referenceSize:s,sizeRatio:O,color:V,outlineColor:R,outlineWidth:w,isOutline:c,markerPlacement:t})}_setPoMap(e,r,t){let i;this._poMap[e]?i=this._poMap[e]:(i={},this._poMap[e]=i),i[r]=t}_maybeGetValueOrOverrideExpression(e,r,t){return this._getValueOrOverrideExpression(\"\",e,r,t,!1)}_getValueOrOverrideExpression(e,r,t,i,o=!0){if(o&&!X(i)&&(i=L(e,t.toLowerCase())),null==r)return i;const a=this._poMap[r];if(null==a)return i;const s=a[t];return\"string\"==typeof s||\"number\"==typeof s||Array.isArray(s)?s:s?{valueExpressionInfo:s,defaultValue:i}:i}_analyzePrimitiveOverrides(e,r,t,i){if(null==e)return!1;\"string\"==typeof e&&(e=[e]);for(const o of this._primitiveOverrides)if(e.includes(o.primitiveName)&&o.valueExpressionInfo)return!0;if(null!=r)for(const o of r)if(o?.overrides.length>0)return!0;if(null!=t)for(const o of t)if(o?.overrides.length>0)return!0;if(null!=i)for(const o of i)if(o?.overrides.length>0)return!0;return!1}_getMaterialOverrides(e,r){if(!e)return[];const t=[];for(const i of e)t.push(...this._getPrimitiveMaterialOverrides(i,r));return t}_getPrimitiveMaterialOverrides(e,r){if(!e)return[];const t=z(this._primitiveOverrides.filter((r=>r.primitiveName===e)));return t.forEach((e=>e.defaultValue=L(r,e.propertyName.toLowerCase()))),t}_analyzeMaterialOverrides(e,r){return this._primitiveOverrides.filter((t=>t.primitiveName!==e||!r.includes(t.propertyName)))}}function H(e,r){return{type:e.type,enable:!0,name:e.name,colorLocked:e.colorLocked,primitiveName:e.primitiveName,anchorPoint:e.anchorPoint,anchorPointUnits:e.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:e.rotateClockwise,rotation:0,size:e.size,billboardMode3D:e.billboardMode3D,depth3D:e.depth3D,frame:e.frame,markerGraphics:[r],scaleSymbolsProportionally:e.scaleSymbolsProportionally,respectFrame:e.respectFrame,clippingPath:e.clippingPath}}function U(e){if(e&&0===e.indexOf(\"Level_\")){const r=parseInt(e.slice(6),10);if(!isNaN(r))return r}return 0}function J(e,r){if(!r||0===r.length)return e;const i=t(e);return O.applyOverrides(i,r),i}const B=e=>e&&2===e.length&&e[0].enable&&e[1].enable&&\"CIMSolidStroke\"===e[0].type&&\"CIMSolidFill\"===e[1].type&&null==e[0].path&&null==e[1].path&&!e[0].effects&&!e[1].effects&&!e[0].animations&&!e[1].animations;function q(e){const r=e.symbolLayers;if(!r)return!1;const t=r.find((e=>e.effects?.find((e=>\"CIMGeometricEffectDashes\"===e.type&&null!=e.dashTemplate)))),i=r.find((e=>e.effects?.find((e=>\"CIMGeometricEffectAddControlPoints\"===e.type))));return!!t||!!i}function K(e){return t(e).map((e=>({...e,propertyName:F(e.propertyName)})))}function Q(e){return h(e)?{type:\"animation-params\",params:e}:null}export{D as CIMAnalyzer,J as analyzeCIMResource};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{packFloatRGBA as o}from\"../../core/floatRGBA.js\";import{nextPowerOfTwo as t}from\"../../core/mathUtils.js\";import{dashSdfRasterizationScale as r,dashSdfDistanceNormalization as a,dashRadius as e}from\"./constants.js\";const n=o=>\"vertical\"===o||\"horizontal\"===o||\"cross\"===o||\"esriSFSCross\"===o||\"esriSFSVertical\"===o||\"esriSFSHorizontal\"===o;function s(o,r,a){const e=r.style,s=t(Math.ceil(a)),i=n(e)?8*s:16*s,l=2*s;o.width=i,o.height=i;const h=o.getContext(\"2d\");h.strokeStyle=\"#ffffff\",h.lineWidth=s,h.beginPath(),\"vertical\"!==e&&\"cross\"!==e&&\"esriSFSCross\"!==e&&\"esriSFSVertical\"!==e||(h.moveTo(i/2,-l),h.lineTo(i/2,i+l)),\"horizontal\"!==e&&\"cross\"!==e&&\"esriSFSCross\"!==e&&\"esriSFSHorizontal\"!==e||(h.moveTo(-l,i/2),h.lineTo(i+l,i/2)),\"backward-diagonal\"!==e&&\"diagonal-cross\"!==e&&\"esriSFSDiagonalCross\"!==e&&\"esriSFSBackwardDiagonal\"!==e||(h.moveTo(-l,-l),h.lineTo(i+l,i+l),h.moveTo(i-l,-l),h.lineTo(i+l,l),h.moveTo(-l,i-l),h.lineTo(l,i+l)),\"forward-diagonal\"!==e&&\"diagonal-cross\"!==e&&\"esriSFSForwardDiagonal\"!==e&&\"esriSFSDiagonalCross\"!==e||(h.moveTo(i+l,-l),h.lineTo(-l,i+l),h.moveTo(l,-l),h.lineTo(-l,l),h.moveTo(i+l,i-l),h.lineTo(i-l,i+l)),h.stroke();const c=h.getImageData(0,0,o.width,o.height),m=new Uint8Array(c.data);let f;for(let t=0;t<m.length;t+=4)f=m[t+3]/255,m[t]=m[t]*f,m[t+1]=m[t+1]*f,m[t+2]=m[t+2]*f;return[m,o.width,o.height,s]}function i(t){t.length%2==1&&(t=[...t,...t]);const e=t.reduce(((o,t)=>o+t),0),n=Math.round(e*r),s=1,i=new Float32Array(n*s);let l=0,h=0,c=.5,m=!0;for(const o of t){for(l=h,h+=o*r;c<=h;){const o=c-.5,t=Math.min(Math.abs(c-l),Math.abs(c-h));i[o]=m?-t:t,c++}m=!m}const f=i.length,S=new Uint8Array(4*f);for(let g=0;g<f;++g){const t=i[g]/r;o(t/a*.5+.5,S,4*g)}return[S,n,s]}function l(t,r){null==t&&(t=[]);const a=\"Butt\"===r,n=\"Square\"===r,s=!a&&!n;t.length%2==1&&(t=[...t,...t]);const i=e,l=2*i;let h=0;for(const o of t)h+=o;const c=Math.round(h*i),m=new Float32Array(c*l),f=.5*i;let S=0,g=0,M=.5,d=!0;for(const o of t){for(S=g,g+=o*i;M<=g;){let o=.5;for(;o<l;){const t=(o-.5)*c+M-.5,r=s?(o-i)*(o-i):Math.abs(o-i);m[t]=d?a?Math.max(Math.max(S+f-M,r),Math.max(M-g+f,r)):r:s?Math.min((M-S)*(M-S)+r,(M-g)*(M-g)+r):n?Math.min(Math.max(M-S,r),Math.max(g-M,r)):Math.min(Math.max(M-S+f,r),Math.max(g+f-M,r)),o++}M++}d=!d}const T=m.length,F=new Uint8Array(4*T);for(let e=0;e<T;++e){const t=(s?Math.sqrt(m[e]):m[e])/i;o(t,F,4*e)}return[F,c,l]}export{l as rasterizeDash,i as rasterizeDash1D,s as rasterizeFillStyle};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Evented.js\";import{on as t}from\"../../../core/events.js\";import{handlesGroup as a}from\"../../../core/handleUtils.js\";import has from\"../../../core/has.js\";import{deg2rad as r}from\"../../../core/mathUtils.js\";import{identity as s,scale as i,rotate as o,translate as n}from\"../../../core/libs/gl-matrix-2/math/mat2d.js\";import{create as h}from\"../../../core/libs/gl-matrix-2/factories/mat2df64.js\";class c{constructor(r){this.events=new e,this._hasMajorPerformanceCaveat=!1,this._lastRenderFrameCounter=0,this._canvas=document.createElement(\"canvas\"),this._canvas.setAttribute(\"style\",\"width: 100%; height:100%; display:block; willChange:transform\");const s={failIfMajorPerformanceCaveat:!0,alpha:!0,antialias:!1,depth:!0,stencil:!0,powerPreference:\"high-performance\"};r.appendChild(this._canvas);let i=this._canvas.getContext(\"webgl2\",s);i||(i=this._canvas.getContext(\"webgl2\",{...s,failIfMajorPerformanceCaveat:!1}),this._hasMajorPerformanceCaveat=!0),this._gl=i,this._handles=a([t(this._canvas,\"webglcontextlost\",(e=>this.events.emit(\"webgl-context-lost\",e)))])}destroy(){this._canvas.parentNode?.removeChild(this._canvas),this._canvas=null,this._handles.remove(),this._gl=null}get gl(){return this._gl}render(e,t){if(this._hasMajorPerformanceCaveat||has(\"esri-force-performance-mode\")){if(++this._lastRenderFrameCounter>=has(\"esri-performance-mode-frames-between-render\")&&(t(),this._lastRenderViewState=e.state.clone(),this._lastRenderFrameCounter=0),this._lastRenderViewState){const[t,a,r,s,i,o]=this._computeViewTransform(this._lastRenderViewState,e.state);this._canvas.style.transform=`matrix(${t}, ${a}, ${r}, ${s}, ${i}, ${o})`}}else t()}resize(e){const t=this._canvas,a=t.style,{state:{size:r},pixelRatio:s}=e,i=r[0],o=r[1],n=Math.round(i*s),h=Math.round(o*s);t.width===n&&t.height===h||(t.width=n,t.height=h),a.width=i+\"px\",a.height=o+\"px\"}_computeViewTransform(e,t){const[a,c]=e.center,[l,m]=t.center,[d,f]=e.toScreen([0,0],l,m),[_,p]=e.toScreen([0,0],a,c),v=_-d,g=p-f,w=e.scale/t.scale,u=t.rotation-e.rotation,C=h();return s(C),i(C,C,[w,w]),o(C,C,r(u)),n(C,C,[v,g]),C}}export{c as ManagedCanvas};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import has from\"../../../core/has.js\";import{removeMaybe as t}from\"../../../core/maybe.js\";import{addFrameTask as r}from\"../../../core/scheduling.js\";import{signal as s}from\"../../../core/signal.js\";import{create as i}from\"../../../core/libs/gl-matrix-2/factories/mat3f32.js\";import{CIMAnalyzer as n}from\"../../../symbols/cim/cimAnalyzer.js\";import{Container as a}from\"./Container.js\";import{ManagedCanvas as o}from\"./ManagedCanvas.js\";import{MAX_TILE_RESHUFFLES_PER_FRAME as h}from\"./webgl/definitions.js\";import{WGLDrawPhase as d}from\"./webgl/enums.js\";import l from\"./webgl/Painter.js\";import{ArrayBufferPool as m}from\"./webgl/PooledUint32Array.js\";import{Profiler as c}from\"./webgl/Profiler.js\";import{TileReshuffleManager as u}from\"./webgl/TileReshuffleManager.js\";import{startup as p,shutdown as f}from\"./webgl/shaderGraph/techniques/TechniqueRegistry.js\";import{MeshWriterRegistry as g}from\"./webgl/shaderGraph/techniques/mesh/MeshWriterRegistry.js\";import{Timeline as _}from\"../support/Timeline.js\";import{TextureWrapMode as b,SizedPixelFormat as w,RenderbufferFormat as R,PixelFormat as y,PixelType as x}from\"../../webgl/enums.js\";import{FramebufferObject as P}from\"../../webgl/FramebufferObject.js\";import{RenderbufferDescriptor as j}from\"../../webgl/RenderbufferDescriptor.js\";import{RenderingContext as C}from\"../../webgl/RenderingContext.js\";import{TextureDescriptor as T}from\"../../webgl/TextureDescriptor.js\";const M=2e3;class O extends a{constructor(t,i){super(),this.meshWriterRegistry=new g,this._trash=new Set,this._renderRemainingTime=0,this._lastFrameRenderTime=0,this._renderRequested=s(!1),this.stage=this,this._stationary=!0,this._reshuffleManager=new u,this._canvas=new o(t),this.context=new C(this._canvas.gl,i.contextOptions??{}),this.painter=new l(this.context,this),this._cimAnalyzer=new n(this.painter.textureManager.resourceManager),has(\"esri-2d-profiler\")&&(this._debugOutput=document.createElement(\"div\"),this._debugOutput.setAttribute(\"style\",\"margin: 24px 64px; position: absolute; color: red;\"),t.appendChild(this._debugOutput));const a=()=>this.highlightGradient;this._renderParameters={drawPhase:0,state:this.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1,blendMode:null,deltaTime:-1,time:0,inFadeTransition:!1,effects:null,context:this.context,painter:this.painter,timeline:i.timeline||new _,renderingOptions:i.renderingOptions,requestRender:()=>this.requestRender(),allowDelayedRender:!1,requireFBO:!1,profiler:new c(this.context,this._debugOutput),dataUploadCounter:0,get highlightGradient(){return a()},reshuffleManager:this._reshuffleManager,backgroundColor:i.backgroundColor},this._taskHandle=r({render:e=>this.renderFrame(e)}),this._taskHandle.pause(),this._lostWebGLContextHandle=this._canvas.events.on(\"webgl-context-lost\",(t=>this.emit(\"webgl-error\",{error:new e(\"webgl-context-lost\",t.statusMessage)}))),this._bufferPool=new m,p()}destroy(){f(this.context),this.removeAllChildren(),this._emptyTrash(),this._taskHandle=t(this._taskHandle),this._lostWebGLContextHandle=t(this._lostWebGLContextHandle),this._canvas.destroy(),this._debugOutput?.parentNode?.removeChild(this._debugOutput),this._bufferPool.destroy(),this.painter.dispose(),this.context.dispose(),this._canvas=null}get textureManager(){return this.painter.textureManager}get backgroundColor(){return this._renderParameters.backgroundColor}set backgroundColor(e){this._renderParameters.backgroundColor=e,this.requestRender()}get bufferPool(){return this._bufferPool}get cimAnalyzer(){return this._cimAnalyzer}get renderingOptions(){return this._renderingOptions}set renderingOptions(e){this._renderingOptions=e,this.requestRender()}get renderRequested(){return this._renderRequested.value}get state(){return this._state}set state(e){this._state=e,this.requestRender()}get stationary(){return this._stationary}set stationary(e){this._stationary!==e&&(this._stationary=e,this.requestRender())}trashDisplayObject(e){this._trash.add(e),this.requestRender()}untrashDisplayObject(e){return this._trash.delete(e)}requestRender(){this._renderRemainingTime=M,this.renderRequested||(this._renderRequested.value=!0,this._taskHandle.resume())}renderFrame(e){const t=this._lastFrameRenderTime?e.time-this._lastFrameRenderTime:0;this._renderRemainingTime-=t,this._renderRemainingTime<=0&&this._taskHandle.pause(),this._lastFrameRenderTime=e.time,this._renderRequested.value=!1,this._renderParameters.state=this._state,this._renderParameters.stationary=this.stationary,this._renderParameters.pixelRatio=window.devicePixelRatio,this._renderParameters.globalOpacity=1,this._renderParameters.time=e.time,this._renderParameters.deltaTime=e.deltaTime,this._renderParameters.effects=null,this.processRender(this._renderParameters),this._emptyTrash()}_createTransforms(){return{displayViewScreenMat3:i()}}renderChildren(e){for(const t of this.children)t.beforeRender(e);this._reshuffleManager.reshuffle(h),this._canvas.render(e,(()=>this._renderChildren(this.children,e)));for(const t of this.children)t.afterRender(e)}_renderChildren(e,t){const r=this.context;this.painter.textureUploadManager.upload(),r.resetInfo(),t.profiler.recordStart(\"drawLayers\"),t.dataUploadCounter=0,this.painter.beforeRenderPhases(t,t.backgroundColor,this.state.padding),t.drawPhase=d.MAP;for(const s of e)s.processRender(t);if(this.children.some((e=>e.hasHighlight))){t.drawPhase=d.HIGHLIGHT;for(const r of e)r.processRender(t)}if(this.children.some((e=>e.hasLabels))){t.drawPhase=d.LABEL;for(const r of e)r.processRender(t)}if(has(\"esri-tiles-debug\")){t.drawPhase=d.DEBUG;for(const r of e)r.processRender(t)}this.painter.afterRenderPhases(t),t.profiler.recordEnd(\"drawLayers\"),r.logInfo()}doRender(e){const t=this.context,{state:r,pixelRatio:s}=e;this._canvas.resize(e),t.setViewport(0,0,s*r.size[0],s*r.size[1]),t.setDepthWriteEnabled(!0),t.setStencilWriteMask(255),this.renderChildren(e)}async takeScreenshot(e,t,r,s){const i=Math.round(this.state.size[0]*e.resolutionScale),n=Math.round(this.state.size[1]*e.resolutionScale),a=e.resolutionScale,o=this.context,h=this._state.clone();if(null!=s){const e=h.viewpoint;h.viewpoint.rotation=s,h.viewpoint=e}const d={...this._renderParameters,drawPhase:null,globalOpacity:1,stationary:!0,state:h,pixelRatio:a,time:performance.now(),deltaTime:0,blendMode:null,effects:null,inFadeTransition:!1,backgroundColor:r},l=new T(i,n);l.wrapMode=b.CLAMP_TO_EDGE,l.internalFormat=w.RGBA8,l.isImmutable=!0;const m=new P(o,l,new j(R.DEPTH_STENCIL,i,n)),c=o.getBoundFramebufferObject(),u=o.getViewport();o.bindFramebuffer(m),o.setViewport(0,0,i,n),this._renderChildren(t??this.children,d);const p=this._readbackScreenshot(m,{...e.cropArea,y:n-(e.cropArea.y+e.cropArea.height)});o.bindFramebuffer(c),o.setViewport(u.x,u.y,u.width,u.height),this.requestRender();const f=await p;let g;return 1===e.outputScale?g=f:(g=new ImageData(Math.round(f.width*e.outputScale),Math.round(f.height*e.outputScale)),(await import(\"../../support/screenshotUtils.js\")).resampleHermite(f,g,!0)),m.dispose(),g}async _readbackScreenshot(e,t){const r=(await import(\"../../support/screenshotUtils.js\")).createEmptyImageData(t.width,t.height,document.createElement(\"canvas\"));return await e.readPixelsAsync(t.x,t.y,t.width,t.height,y.RGBA,x.UNSIGNED_BYTE,new Uint8Array(r.data.buffer)),r}_emptyTrash(){for(;this._trash.size>0;){const e=Array.from(this._trash);this._trash.clear();for(const t of e)t.processDetach()}}}export{O as Stage,M as extraRenderTime};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{resolveIncludes as e}from\"./sources/resolver.js\";import{glslifyDefineMap as r}from\"../../../../webgl/programUtils.js\";const t=e=>r({PATTERN:e.pattern}),a={shaders:r=>({vertexShader:t(r)+e(\"background/background.vert\"),fragmentShader:t(r)+e(\"background/background.frag\")})},d={shaders:r=>({vertexShader:e(\"circle/circle.vert\"),fragmentShader:e(\"circle/circle.frag\")})},n=e=>r({PATTERN:e.pattern}),i={shaders:r=>({vertexShader:n(r)+e(\"fill/fill.vert\"),fragmentShader:n(r)+e(\"fill/fill.frag\")})},l={shaders:r=>({vertexShader:e(\"outline/outline.vert\"),fragmentShader:e(\"outline/outline.frag\")})},s=e=>r({SDF:e.sdf}),f={shaders:r=>({vertexShader:s(r)+e(\"icon/icon.vert\"),fragmentShader:s(r)+e(\"icon/icon.frag\")})},h=e=>r({PATTERN:e.pattern,SDF:e.sdf}),o={shaders:r=>({vertexShader:h(r)+e(\"line/line.vert\"),fragmentShader:h(r)+e(\"line/line.frag\")})},g={shaders:r=>({vertexShader:e(\"text/text.vert\"),fragmentShader:e(\"text/text.frag\")})};export{a as background,d as circle,i as fill,f as icon,o as line,l as outline,g as text};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ShaderProgramType as e}from\"../enums.js\";import{text as r,outline as t,line as a,icon as s,fill as n,circle as c,background as o}from\"./Programs.js\";class p{constructor(){this._programByKey=new Map}dispose(){this._programByKey.forEach((e=>e.dispose())),this._programByKey.clear()}getMaterialProgram(e,r,t){const a=r.key<<3|this._getMaterialOptionsValue(r.type,t);if(this._programByKey.has(a))return this._programByKey.get(a);const s=this._getProgramTemplate(r.type),{shaders:n}=s,{vertexShader:c,fragmentShader:o}=n(t),p=r.getShaderHeader(),u=r.getShaderMain(),i=c.replace(\"#pragma header\",p).replace(\"#pragma main\",u),g=e.programCache.acquire(i,o,r.getAttributeLocations());return this._programByKey.set(a,g),g}_getMaterialOptionsValue(r,t){switch(r){case e.BACKGROUND:return(t.pattern?1:0)<<1;case e.FILL:return(t.pattern?1:0)<<1;case e.OUTLINE:return 0;case e.LINE:{const e=t;return(e.sdf?1:0)<<2|(e.pattern?1:0)<<1}case e.ICON:return(t.sdf?1:0)<<1;case e.CIRCLE:case e.TEXT:default:return 0}}_getProgramTemplate(p){switch(p){case e.BACKGROUND:return o;case e.CIRCLE:return c;case e.FILL:return n;case e.ICON:return s;case e.LINE:return a;case e.OUTLINE:return t;case e.TEXT:return r;default:return null}}}export{p as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport r from\"./shaderRepository.js\";import{ShaderCompiler as e}from\"../../../../../webgl/ShaderCompiler.js\";function o(e){let o=r;return e.split(\"/\").forEach((r=>{o&&(o=o[r])})),o}const t=new e(o);function n(r){return t.resolveIncludes(r)}export{n as resolveIncludes};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nconst e={background:{\"background.frag\":\"#ifdef PATTERN\\nuniform lowp float u_opacity;\\nuniform lowp sampler2D u_texture;\\nvarying mediump vec4 v_tlbr;\\nvarying mediump vec2 v_tileTextureCoord;\\n#else\\nuniform lowp vec4 u_color;\\n#endif\\nvoid main() {\\n#ifdef PATTERN\\nmediump vec2 normalizedTextureCoord = mod(v_tileTextureCoord, 1.0);\\nmediump vec2 samplePos = mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\\nlowp vec4 color = texture2D(u_texture, samplePos);\\ngl_FragColor = u_opacity * color;\\n#else\\ngl_FragColor = u_color;\\n#endif\\n}\",\"background.vert\":\"precision mediump float;\\nattribute vec2 a_pos;\\nuniform highp mat3 u_dvsMat3;\\nuniform mediump float u_coord_range;\\nuniform mediump float u_depth;\\n#ifdef PATTERN\\nuniform mediump mat3 u_pattern_matrix;\\nvarying mediump vec2 v_tileTextureCoord;\\nuniform mediump vec4 u_tlbr;\\nuniform mediump vec2 u_mosaicSize;\\nvarying mediump vec4 v_tlbr;\\n#endif\\nvoid main() {\\ngl_Position = vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\\n#ifdef PATTERN\\nv_tileTextureCoord = (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\\nv_tlbr             = u_tlbr / u_mosaicSize.xyxy;\\n#endif\\n}\"},circle:{\"circle.frag\":\"precision lowp float;\\nvarying lowp vec4 v_color;\\nvarying lowp vec4 v_stroke_color;\\nvarying mediump float v_blur;\\nvarying mediump float v_stroke_width;\\nvarying mediump float v_radius;\\nvarying mediump vec2 v_offset;\\nvoid main()\\n{\\nmediump float dist = length(v_offset);\\nmediump float alpha = smoothstep(0.0, -v_blur, dist - 1.0);\\nlowp float color_mix_ratio = v_stroke_width < 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\\ngl_FragColor = alpha * mix(v_color, v_stroke_color, color_mix_ratio);\\n}\",\"circle.vert\":\"precision mediump float;\\nattribute vec2 a_pos;\\n#pragma header\\nvarying lowp vec4 v_color;\\nvarying lowp vec4 v_stroke_color;\\nvarying mediump float v_blur;\\nvarying mediump float v_stroke_width;\\nvarying mediump float v_radius;\\nvarying mediump vec2 v_offset;\\nuniform highp mat3 u_dvsMat3;\\nuniform highp mat3 u_displayMat3;\\nuniform mediump vec2 u_circleTranslation;\\nuniform mediump float u_depth;\\nuniform mediump float u_antialiasingWidth;\\nvoid main()\\n{\\n#pragma main\\nv_color = color * opacity;\\nv_stroke_color = stroke_color * stroke_opacity;\\nv_stroke_width = stroke_width;\\nv_radius = radius;\\nv_blur = max(blur, u_antialiasingWidth / (radius + stroke_width));\\nmediump vec2 offset = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\\nv_offset = offset;\\nmediump vec3 pos = u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\\ngl_Position = vec4(pos.xy, u_depth, 1.0);\\n}\"},fill:{\"fill.frag\":\"precision lowp float;\\n#ifdef PATTERN\\nuniform lowp sampler2D u_texture;\\nvarying mediump vec2 v_tileTextureCoord;\\nvarying mediump vec4 v_tlbr;\\n#endif\\nvarying lowp vec4 v_color;\\nvec4 mixColors(vec4 color1, vec4 color2) {\\nfloat compositeAlpha = color2.a + color1.a * (1.0 - color2.a);\\nvec3 compositeColor = color2.rgb + color1.rgb * (1.0 - color2.a);\\nreturn vec4(compositeColor, compositeAlpha);\\n}\\nvoid main()\\n{\\n#ifdef PATTERN\\nmediump vec2 normalizedTextureCoord = fract(v_tileTextureCoord);\\nmediump vec2 samplePos = mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\\nlowp vec4 color = texture2D(u_texture, samplePos);\\ngl_FragColor = v_color[3] * color;\\n#else\\ngl_FragColor = v_color;\\n#endif\\n}\",\"fill.vert\":\"precision mediump float;\\nattribute vec2 a_pos;\\n#pragma header\\nuniform highp mat3 u_dvsMat3;\\nuniform highp mat3 u_displayMat3;\\nuniform mediump float u_depth;\\nuniform mediump vec2 u_fillTranslation;\\n#ifdef PATTERN\\n#include <util/util.glsl>\\nuniform mediump vec2 u_mosaicSize;\\nuniform mediump float u_patternFactor;\\nvarying mediump vec2 v_tileTextureCoord;\\nvarying mediump vec4 v_tlbr;\\n#endif\\nvarying lowp vec4 v_color;\\nvoid main()\\n{\\n#pragma main\\nv_color = color * opacity;\\n#ifdef PATTERN\\nfloat patternWidth = nextPOT(tlbr.z - tlbr.x);\\nfloat patternHeight = nextPOT(tlbr.w - tlbr.y);\\nfloat scaleX = 1.0 / (patternWidth * u_patternFactor);\\nfloat scaleY = 1.0 / (patternHeight * u_patternFactor);\\nmat3 patterMat = mat3(scaleX, 0.0,    0.0,\\n0.0,    -scaleY, 0.0,\\n0.0,    0.0,    1.0);\\nv_tileTextureCoord = (patterMat * vec3(a_pos, 1.0)).xy;\\nv_tlbr             = tlbr / u_mosaicSize.xyxy;\\n#endif\\nvec3 pos = u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\\ngl_Position = vec4(pos.xy, u_depth, 1.0);\\n}\"},icon:{\"icon.frag\":\"precision mediump float;\\nuniform lowp sampler2D u_texture;\\n#ifdef SDF\\nuniform lowp vec4 u_color;\\nuniform lowp vec4 u_outlineColor;\\n#endif\\nvarying mediump vec2 v_tex;\\nvarying lowp float v_opacity;\\nvarying mediump vec2 v_size;\\nvarying lowp vec4 v_color;\\n#ifdef SDF\\nvarying mediump flaot v_halo_width;\\n#endif\\n#include <util/encoding.glsl>\\nvec4 mixColors(vec4 color1, vec4 color2) {\\nfloat compositeAlpha = color2.a + color1.a * (1.0 - color2.a);\\nvec3 compositeColor = color2.rgb + color1.rgb * (1.0 - color2.a);\\nreturn vec4(compositeColor, compositeAlpha);\\n}\\nvoid main()\\n{\\n#ifdef SDF\\nlowp vec4 fillPixelColor = v_color;\\nfloat d = rgba2float(texture2D(u_texture, v_tex)) - 0.5;\\nconst float softEdgeRatio = 0.248062016;\\nfloat size = max(v_size.x, v_size.y);\\nfloat dist = d * softEdgeRatio * size;\\nfillPixelColor *= clamp(0.5 - dist, 0.0, 1.0);\\nif (v_halo_width > 0.25) {\\nlowp vec4 outlinePixelColor = u_outlineColor;\\nconst float outlineLimitRatio = (16.0 / 86.0);\\nfloat clampedOutlineSize = softEdgeRatio * min(v_halo_width, outlineLimitRatio * max(v_size.x, v_size.y));\\noutlinePixelColor *= clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\\ngl_FragColor = v_opacity * mixColors(fillPixelColor, outlinePixelColor);\\n}\\nelse {\\ngl_FragColor = v_opacity * fillPixelColor;\\n}\\n#else\\nlowp vec4 texColor = texture2D(u_texture, v_tex);\\ngl_FragColor = v_opacity * texColor;\\n#endif\\n}\",\"icon.vert\":\"attribute vec2 a_pos;\\nattribute vec2 a_vertexOffset;\\nattribute vec4 a_texAngleRange;\\nattribute vec4 a_levelInfo;\\nattribute float a_opacityInfo;\\n#pragma header\\nvarying lowp vec4 v_color;\\n#ifdef SDF\\nvarying mediump float v_halo_width;\\n#endif\\nuniform highp mat3 u_dvsMat3;\\nuniform highp mat3 u_displayMat3;\\nuniform highp mat3 u_displayViewMat3;\\nuniform mediump vec2 u_iconTranslation;\\nuniform vec2 u_mosaicSize;\\nuniform mediump float u_depth;\\nuniform mediump float u_mapRotation;\\nuniform mediump float u_level;\\nuniform lowp float u_keepUpright;\\nuniform mediump float u_fadeDuration;\\nvarying mediump vec2 v_tex;\\nvarying lowp float v_opacity;\\nvarying mediump vec2 v_size;\\nconst float C_OFFSET_PRECISION = 1.0 / 8.0;\\nconst float C_256_TO_RAD = 3.14159265359 / 128.0;\\nconst float C_DEG_TO_RAD = 3.14159265359 / 180.0;\\nconst float tileCoordRatio = 1.0 / 8.0;\\nuniform highp float u_time;\\nvoid main()\\n{\\n#pragma main\\nv_color = color;\\nv_opacity = opacity;\\n#ifdef SDF\\nv_halo_width = halo_width;\\n#endif\\nfloat modded = mod(a_opacityInfo, 128.0);\\nfloat targetOpacity = (a_opacityInfo - modded) / 128.0;\\nfloat startOpacity = modded / 127.0;\\nfloat interpolatedOpacity = clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\\nv_opacity *= interpolatedOpacity;\\nmediump float a_angle         = a_levelInfo[1];\\nmediump float a_minLevel      = a_levelInfo[2];\\nmediump float a_maxLevel      = a_levelInfo[3];\\nmediump vec2 a_tex            = a_texAngleRange.xy;\\nmediump float delta_z = 0.0;\\nmediump float rotated = mod(a_angle + u_mapRotation, 256.0);\\ndelta_z += (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\\ndelta_z += 1.0 - step(a_minLevel, u_level);\\ndelta_z += step(a_maxLevel, u_level);\\ndelta_z += step(v_opacity, 0.0);\\nvec2 offset = C_OFFSET_PRECISION * a_vertexOffset;\\nv_size = abs(offset);\\n#ifdef SDF\\noffset = (120.0 / 86.0) * offset;\\n#endif\\nmediump vec3 pos = u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\\ngl_Position = vec4(pos.xy, u_depth + delta_z, 1.0);\\nv_tex = a_tex.xy / u_mosaicSize;\\n}\"},line:{\"line.frag\":\"precision lowp float;\\nvarying mediump vec2 v_normal;\\nvarying highp float v_accumulatedDistance;\\nvarying mediump float v_lineHalfWidth;\\nvarying lowp vec4 v_color;\\nvarying mediump float v_blur;\\n#if defined (PATTERN) || defined(SDF)\\nvarying mediump vec4 v_tlbr;\\nvarying mediump vec2 v_patternSize;\\nvarying mediump float v_widthRatio;\\nuniform sampler2D u_texture;\\nuniform mediump float u_antialiasing;\\n#endif\\n#ifdef SDF\\n#include <util/encoding.glsl>\\n#endif\\nvoid main()\\n{\\nmediump float fragDist = length(v_normal) * v_lineHalfWidth;\\nlowp float alpha = clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\\n#ifdef PATTERN\\nmediump float relativeTexX = fract(v_accumulatedDistance / (v_patternSize.x * v_widthRatio));\\nmediump float relativeTexY = 0.5 + v_normal.y * v_lineHalfWidth / (v_patternSize.y * v_widthRatio);\\nmediump vec2 texCoord = mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\\nlowp vec4 color = texture2D(u_texture, texCoord);\\ngl_FragColor = alpha * v_color[3] * color;\\n#elif defined(SDF)\\nmediump float relativeTexX = fract((v_accumulatedDistance * 0.5) / (v_patternSize.x * v_widthRatio));\\nmediump float relativeTexY =  0.5 + 0.25 * v_normal.y;\\nmediump vec2 texCoord = mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\\nmediump float d = rgba2float(texture2D(u_texture, texCoord)) - 0.5;\\nfloat dist = d * (v_lineHalfWidth + u_antialiasing / 2.0);\\ngl_FragColor = alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\\n#else\\ngl_FragColor = alpha * v_color;\\n#endif\\n}\",\"line.vert\":\"precision mediump float;\\nattribute vec2 a_pos;\\nattribute vec4 a_extrude_offset;\\nattribute vec4 a_dir_normal;\\nattribute vec2 a_accumulatedDistance;\\n#pragma header\\nuniform highp mat3 u_dvsMat3;\\nuniform highp mat3 u_displayMat3;\\nuniform highp mat3 u_displayViewMat3;\\nuniform mediump float u_zoomFactor;\\nuniform mediump vec2 u_lineTranslation;\\nuniform mediump float u_antialiasing;\\nuniform mediump float u_depth;\\nvarying mediump vec2 v_normal;\\nvarying highp float v_accumulatedDistance;\\nconst float scale = 1.0 / 31.0;\\nconst mediump float tileCoordRatio = 8.0;\\n#if defined (SDF)\\nconst mediump float sdfPatternHalfWidth = 15.5;\\n#endif\\n#if defined (PATTERN) || defined(SDF)\\nuniform mediump vec2 u_mosaicSize;\\nvarying mediump vec4 v_tlbr;\\nvarying mediump vec2 v_patternSize;\\nvarying mediump float v_widthRatio;\\n#endif\\nvarying lowp vec4 v_color;\\nvarying mediump float v_lineHalfWidth;\\nvarying mediump float v_blur;\\nvoid main()\\n{\\n#pragma main\\nv_color = color * opacity;\\nv_blur = blur + u_antialiasing;\\nv_normal = a_dir_normal.zw * scale;\\n#if defined (PATTERN) || defined(SDF)\\nv_tlbr          = tlbr / u_mosaicSize.xyxy;\\nv_patternSize   = vec2(tlbr.z - tlbr.x, tlbr.y - tlbr.w);\\n#if defined (PATTERN)\\nv_widthRatio = width / v_patternSize.y;\\n#else\\nv_widthRatio = width / sdfPatternHalfWidth / 2.0;\\n#endif\\n#endif\\nv_lineHalfWidth = (width + u_antialiasing) * 0.5;\\nmediump vec2 dir = a_dir_normal.xy * scale;\\nmediump vec2 offset_ = a_extrude_offset.zw * scale * offset;\\nmediump vec2 dist = v_lineHalfWidth * scale * a_extrude_offset.xy;\\nmediump vec3 pos = u_dvsMat3 * vec3(a_pos + offset_ * tileCoordRatio / u_zoomFactor, 1.0) + u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\\ngl_Position = vec4(pos.xy, u_depth, 1.0);\\n#if defined (PATTERN) || defined(SDF)\\nv_accumulatedDistance = a_accumulatedDistance.x * u_zoomFactor / tileCoordRatio + dot(dir, dist + offset_);\\n#endif\\n}\"},outline:{\"outline.frag\":\"varying lowp vec4 v_color;\\nvarying mediump vec2 v_normal;\\nvoid main()\\n{\\nlowp float dist = abs(v_normal.y);\\nlowp float alpha = smoothstep(1.0, 0.0, dist);\\ngl_FragColor = alpha * v_color;\\n}\",\"outline.vert\":\"attribute vec2 a_pos;\\nattribute vec2 a_offset;\\nattribute vec2 a_xnormal;\\n#pragma header\\nvarying lowp vec4 v_color;\\nuniform highp mat3 u_dvsMat3;\\nuniform highp mat3 u_displayMat3;\\nuniform mediump vec2 u_fillTranslation;\\nuniform mediump float u_depth;\\nuniform mediump float u_outline_width;\\nvarying lowp vec2 v_normal;\\nconst float scale = 1.0 / 15.0;\\nvoid main()\\n{\\n#pragma main\\nv_color = color * opacity;\\nv_normal = a_xnormal;\\nmediump vec2 dist = u_outline_width * scale * a_offset;\\nmediump vec3 pos = u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\\ngl_Position = vec4(pos.xy, u_depth, 1.0);\\n}\"},text:{\"text.frag\":\"uniform lowp sampler2D u_texture;\\nvarying lowp vec2 v_tex;\\nvarying lowp vec4 v_color;\\nvarying mediump float v_edgeWidth;\\nvarying mediump float v_edgeDistance;\\nvoid main()\\n{\\nlowp float dist = texture2D(u_texture, v_tex).a;\\nmediump float alpha = smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist);\\ngl_FragColor = alpha * v_color;\\n}\",\"text.vert\":\"attribute vec2 a_pos;\\nattribute vec2 a_vertexOffset;\\nattribute vec4 a_texAngleRange;\\nattribute vec4 a_levelInfo;\\nattribute float a_opacityInfo;\\n#pragma header\\nvarying lowp vec4 v_color;\\nuniform highp mat3 u_dvsMat3;\\nuniform highp mat3 u_displayMat3;\\nuniform highp mat3 u_displayViewMat3;\\nuniform mediump vec2 u_textTranslation;\\nuniform vec2 u_mosaicSize;\\nuniform mediump float u_depth;\\nuniform mediump float u_mapRotation;\\nuniform mediump float u_level;\\nuniform lowp float u_keepUpright;\\nuniform mediump float u_fadeDuration;\\nvarying lowp vec2 v_tex;\\nconst float offsetPrecision = 1.0 / 8.0;\\nconst mediump float edgePos = 0.75;\\nuniform mediump float u_antialiasingWidth;\\nvarying mediump float v_edgeDistance;\\nvarying mediump float v_edgeWidth;\\nuniform lowp float u_halo;\\nconst float sdfFontScale = 1.0 / 24.0;\\nconst float sdfPixel = 3.0;\\nuniform highp float u_time;\\nvoid main()\\n{\\n#pragma main\\nif (u_halo > 0.5)\\n{\\nv_color = halo_color * opacity;\\nhalo_width *= sdfPixel;\\nhalo_blur *= sdfPixel;\\n}\\nelse\\n{\\nv_color = color * opacity;\\nhalo_width = 0.0;\\nhalo_blur = 0.0;\\n}\\nfloat modded = mod(a_opacityInfo, 128.0);\\nfloat targetOpacity = (a_opacityInfo - modded) / 128.0;\\nfloat startOpacity = modded / 127.0;\\nfloat interpolatedOpacity = clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\\nv_color *= interpolatedOpacity;\\nmediump float a_angle       = a_levelInfo[1];\\nmediump float a_minLevel    = a_levelInfo[2];\\nmediump float a_maxLevel    = a_levelInfo[3];\\nmediump vec2 a_tex          = a_texAngleRange.xy;\\nmediump float a_visMinAngle    = a_texAngleRange.z;\\nmediump float a_visMaxAngle    = a_texAngleRange.w;\\nmediump float delta_z = 0.0;\\nmediump float angle = mod(a_angle + u_mapRotation, 256.0);\\nif (a_visMinAngle < a_visMaxAngle)\\n{\\ndelta_z += (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) + (1.0 - step(a_visMinAngle, angle)));\\n}\\nelse\\n{\\ndelta_z += (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) * (1.0 - step(a_visMinAngle, angle)));\\n}\\ndelta_z += 1.0 - step(a_minLevel, u_level);\\ndelta_z += step(a_maxLevel, u_level);\\ndelta_z += step(v_color[3], 0.0);\\nv_tex = a_tex.xy / u_mosaicSize;\\nv_edgeDistance = edgePos - halo_width / size;\\nv_edgeWidth = (u_antialiasingWidth + halo_blur) / size;\\nmediump vec3 pos = u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\\ngl_Position = vec4(pos.xy, u_depth + delta_z, 1.0);\\n}\"},util:{\"encoding.glsl\":\"const vec4 rgba2float_factors = vec4(\\n255.0 / (256.0),\\n255.0 / (256.0 * 256.0),\\n255.0 / (256.0 * 256.0 * 256.0),\\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\\n);\\nfloat rgba2float(vec4 rgba) {\\nreturn dot(rgba, rgba2float_factors);\\n}\",\"util.glsl\":\"float nextPOT(in float x) {\\nreturn pow(2.0, ceil(log2(abs(x))));\\n}\"}};export{e as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{disposeMaybe as r}from\"../../../../core/maybe.js\";import{PosTex2b as t}from\"./DefaultVertexAttributeLayouts.js\";import{bitBlit as e}from\"./shaders/BitBlitPrograms.js\";import{BufferObject as i}from\"../../../webgl/BufferObject.js\";import{BlendFactor as s,PrimitiveType as a,Usage as o}from\"../../../webgl/enums.js\";import{createProgram as m}from\"../../../webgl/ProgramTemplate.js\";import{VertexArrayObject as n}from\"../../../webgl/VertexArrayObject.js\";class _{constructor(){this._initialized=!1}dispose(){this._program=r(this._program),this._vertexArrayObject=r(this._vertexArrayObject)}render(r,t,e,i){r&&(this._initialized||this._initialize(r),r.setBlendFunctionSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA),r.bindVAO(this._vertexArrayObject),r.useProgram(this._program),t.setSamplingMode(e),r.bindTexture(t,0),this._program.setUniform1i(\"u_tex\",0),this._program.setUniform1f(\"u_opacity\",i),r.drawArrays(a.TRIANGLE_STRIP,0,4),r.bindTexture(null,0),r.bindVAO())}_initialize(r){if(this._initialized)return!0;const s=m(r,e);if(!s)return!1;const a=new Int8Array(16);a[0]=-1,a[1]=-1,a[2]=0,a[3]=0,a[4]=1,a[5]=-1,a[6]=1,a[7]=0,a[8]=-1,a[9]=1,a[10]=0,a[11]=1,a[12]=1,a[13]=1,a[14]=1,a[15]=1;const _=e.attributes,p=new n(r,_,t,new Map([[\"geometry\",i.createVertex(r,o.STATIC_DRAW,a)]]));return this._program=s,this._vertexArrayObject=p,this._initialized=!0,!0}}export{_ as BitBlitRenderer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport has from\"../../../../core/has.js\";import{throwIfNotAbortError as t}from\"../../../../core/promiseUtils.js\";import e from\"./Rect.js\";import i from\"./RectangleBinPack.js\";import{PixelFormat as h,TextureWrapMode as s}from\"../../../webgl/enums.js\";import{Texture as r}from\"../../../webgl/Texture.js\";import{TextureDescriptor as a}from\"../../../webgl/TextureDescriptor.js\";const n=256,o=t=>Math.floor(t/256);function c(t){const e=new Set;for(const i of t)e.add(o(i));return e}function l(e,i,h){return e.has(i)||e.set(i,h().then((()=>{e.delete(i)})).catch((h=>{e.delete(i),t(h)}))),e.get(i)}const g=t=>({rect:new e(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,top:0},code:t,sdf:!0});class p{constructor(t,e,h){this.width=0,this.height=0,this._dirties=[],this._glyphData=[],this._currentPage=0,this._glyphCache={},this._textures=[],this._rangePromises=new Map,this._preloadCache={},this.width=t,this.height=e,this._glyphSource=h,this._binPack=new i(t-4,e-4),this._glyphData.push(new Uint8Array(t*e)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyphs()}dispose(){this._binPack=null;for(const t of this._textures)t&&t.dispose();this._textures.length=0,this._glyphData.length=0}_initDecorationGlyphs(){const t=[117,149,181,207,207,181,149,117],e=[],i=[];for(let r=0;r<t.length;r++){const h=t[r];for(let t=0;t<11;t++){const s=r>=3&&r<5&&t>=3&&t<8?255:0;e.push(h),i.push(s)}}const h={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(e)},s={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(i)};this._recordGlyph(h),this._recordGlyph(s)}getTexture(t,e){if(!this._textures[e]){const i=new a;i.pixelFormat=h.ALPHA,i.wrapMode=s.CLAMP_TO_EDGE,i.width=this.width,i.height=this.height,this._textures[e]=new r(t,i,new Uint8Array(this.width*this.height))}return this._dirties[e]&&(this._textures[e].setData(this._glyphData[e]),this._dirties[e]=!1),this._textures[e]}async getGlyphItems(t,e,i){const h=this._getGlyphCache(t);return await this._fetchRanges(t,e,i),e.map((e=>this._getMosaicItem(h,t,e)))}bind(t,e,i,h){const s=this.getTexture(t,i);s.setSamplingMode(e),t.bindTexture(s,h)}preloadASCIIGlyphCache(t){const e=this._preloadCache[t];if(null!=e)return e;const i=this._glyphSource.preloadASCIIRange(t).then((()=>{const e=this._getGlyphCache(t);for(let i=0;i<256;i++)this._getMosaicItem(e,t,i)}));return this._preloadCache[t]=i,i}_getGlyphCache(t){return this._glyphCache[t]||(this._glyphCache[t]={}),this._glyphCache[t]}_invalidate(){this._dirties[this._currentPage]=!0}async _fetchRanges(t,e,i){const h=c(e),s=[];h.forEach((e=>{s.push(this._fetchRange(t,e,i))})),await Promise.all(s)}async _fetchRange(t,e,i){if(e>n)return;const h=t+e;return l(this._rangePromises,h,(()=>this._glyphSource.getRange(t,e,i)))}_getMosaicItem(t,e,i){if(!t[i]){const h=this._glyphSource.getGlyph(e,i);if(!h?.metrics)return g(i);const s=this._recordGlyph(h),r=this._currentPage,a=h.metrics;t[i]={rect:s,page:r,metrics:a,code:i,sdf:!0},this._invalidate()}return t[i]}_recordGlyph(t){const h=t.metrics;let s;if(0===h.width)s=new e(0,0,0,0);else{const e=3,r=h.width+2*e,a=h.height+2*e;s=this._binPack.allocate(r,a),s.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyphs(),this._binPack=new i(this.width-4,this.height-4),s=this._binPack.allocate(r,a));const n=this._glyphData[this._currentPage],o=t.bitmap;let c,l;if(o)for(let t=0;t<a;t++){c=r*t,l=this.width*(s.y+t)+s.x;for(let t=0;t<r;t++)n[l+t]=o[c+t]}has(\"esri-glyph-debug\")&&this._showDebugPage(n)}return s}_showDebugPage(t){const e=document.createElement(\"canvas\"),i=e.getContext(\"2d\"),h=new ImageData(this.width,this.height),s=h.data;e.width=this.width,e.height=this.height,e.style.border=\"1px solid black\";for(let r=0;r<t.length;++r)s[4*r]=t[r],s[4*r+1]=0,s[4*r+2]=0,s[4*r+3]=255;i.putImageData(h,0,0),document.body.appendChild(e)}}export{p as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../../request.js\";import t from\"../../../../core/pbf.js\";class a{constructor(e){for(this._metrics=[],this._bitmaps=[];e.next();)switch(e.tag()){case 1:{const t=e.getMessage();for(;t.next();)switch(t.tag()){case 3:{const e=t.getMessage();let a,s,r,n,i,c,g;for(;e.next();)switch(e.tag()){case 1:a=e.getUInt32();break;case 2:s=e.getBytes();break;case 3:r=e.getUInt32();break;case 4:n=e.getUInt32();break;case 5:i=e.getSInt32();break;case 6:c=e.getSInt32();break;case 7:g=e.getUInt32();break;default:e.skip()}e.release(),a&&(this._metrics[a]={width:r,height:n,left:i,top:c,advance:g},this._bitmaps[a]=s);break}default:t.skip()}t.release();break}default:e.skip()}}getMetrics(e){return this._metrics[e]}getBitmap(e){return this._bitmaps[e]}}class s{constructor(){this._ranges=[]}getRange(e){return this._ranges[e]}addRange(e,t){this._ranges[e]=t}}class r{constructor(e){this._glyphInfo={},this._baseURL=e}getRange(s,r,n){const i=this._getFontStack(s);if(i.getRange(r))return Promise.resolve();const c=256*r,g=c+255,o=this._baseURL.replace(\"{fontstack}\",s).replace(\"{range}\",c+\"-\"+g);return e(o,{responseType:\"array-buffer\",...n}).then((e=>{i.addRange(r,new a(new t(new Uint8Array(e.data),new DataView(e.data))))}))}async preloadASCIIRange(s){const r=this._getFontStack(s),n=0,i=255,c=this._baseURL.replace(\"{fontstack}\",s).replace(\"{range}\",n+\"-\"+i),g=await e(c,{responseType:\"array-buffer\"}),o=new a(new t(new Uint8Array(g.data),new DataView(g.data)));for(let e=n;e<=i;e++)r.getRange(e)||r.addRange(e,o)}getGlyph(e,t){const a=this._getFontStack(e);if(!a)return;const s=Math.floor(t/256),r=a.getRange(s);return r?{metrics:r.getMetrics(t),bitmap:r.getBitmap(t)}:void 0}_getFontStack(e){let t=this._glyphInfo[e];return t||(t=this._glyphInfo[e]=new s),t}}export{r as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{createProgramTemplate as r}from\"./shaders/MaterialPrograms.js\";class e{constructor(r){this._rctx=r,this._programByKey=new Map}dispose(){this._programByKey.forEach((r=>r.dispose())),this._programByKey.clear()}getProgram(e,t=[]){const a=e.vsPath+\".\"+e.fsPath+JSON.stringify(t);if(this._programByKey.has(a))return this._programByKey.get(a);const s={...t.map((r=>\"string\"==typeof r?{name:r,value:!0}:r)).reduce(((r,e)=>({...r,[e.name]:e.value})),{})},{vsPath:o,fsPath:h,attributes:i}=e,g=r(o,h,i,s),m=this._rctx.programCache.acquire(g.shaders.vertexShader,g.shaders.fragmentShader,g.attributes);if(!m)throw new Error(\"Unable to get program for key: ${key}\");return this._programByKey.set(a,m),m}}export{e as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import{disposeMaybe as e,destroyMaybe as t}from\"../../../../core/maybe.js\";import{brushes as s}from\"../brushes.js\";import r from\"../vectorTiles/shaders/VTLMaterialManager.js\";import{BitBlitRenderer as i}from\"./BitBlitRenderer.js\";import{backbufferStencilVisible as n}from\"./definitions.js\";import{WGLDrawPhase as a}from\"./enums.js\";import o from\"./MaterialManager.js\";import l from\"./TextureManager.js\";import{TextureUploadManager as h}from\"./TextureUploadManager.js\";import{WorldExtentRenderer as f}from\"./WorldExtentClipRenderer.js\";import{BlendEffect as c}from\"./effects/BlendEffect.js\";import{FeatureEffect as d}from\"./effects/FeatureEffect.js\";import u from\"./effects/HighlightEffect.js\";import{HittestEffect as p}from\"./effects/HittestEffect.js\";import{EffectManager as _}from\"./effects/post-processing/EffectManager.js\";import{SimpleMesh as b}from\"./meshing/SimpleMesh.js\";import m from\"./painter/RenderPass.js\";import{TechniqueProgramCache as E}from\"./shaderGraph/techniques/TechniqueProgramCache.js\";import{TextureSamplingMode as S,TextureWrapMode as g,CompareFunction as w,BlendFactor as M,RenderbufferFormat as P,BlendOperation as C,Face as B}from\"../../../webgl/enums.js\";import{FramebufferObject as F}from\"../../../webgl/FramebufferObject.js\";import{Renderbuffer as R}from\"../../../webgl/Renderbuffer.js\";import{RenderbufferDescriptor as T}from\"../../../webgl/RenderbufferDescriptor.js\";import{TextureDescriptor as N}from\"../../../webgl/TextureDescriptor.js\";class O{constructor(e,t){this.context=e,this._currentPipelineStateNeedsUpdate=!1,this._blitRenderer=new i,this._worldExtentRenderer=new f,this._brushCache=new Map,this._lastWidth=null,this._lastHeight=null,this._vtlMaterialManager=new r,this._blendEffect=new c,this._stencilBuf=null,this._prevBeforeLayerFBOStack=[],this._fboPool=[],this.effects={highlight:new u,hittest:new p,insideEffect:new d(\"inside\"),outsideEffect:new d(\"outside\")},this._programCache=new E,this._shaderState={shader:null,uniforms:null,defines:null,optionalAttributes:null,useComputeBuffer:!1},this.materialManager=new o(e),this.textureManager=new l(t),this.textureUploadManager=new h(t),this._effectsManager=new _,this._quadMesh=b.fromVertexStream(e,[0,0,1,0,0,1,1,1])}dispose(){if(this._programCache.destroy(),this.materialManager.dispose(),this.textureManager.dispose(),this.textureUploadManager.destroy(),this._blitRenderer=e(this._blitRenderer),this._worldExtentRenderer=e(this._worldExtentRenderer),this._quadMesh=t(this._quadMesh),this._brushCache&&(this._brushCache.forEach((e=>e.dispose())),this._brushCache.clear(),this._brushCache=null),this._fbos){let e;for(e in this._fbos)this._fbos[e]&&this._fbos[e].dispose()}for(const e of this._fboPool)e.dispose();if(this._fboPool.length=0,this.effects){let e;for(e in this.effects)this.effects[e]&&this.effects[e].dispose()}this._effectsManager.dispose(),this._blendEffect.dispose(this.context),this._vtlMaterialManager=e(this._vtlMaterialManager)}clearShaderCache(){this._programCache.destroy(),this._programCache=new E}get blitRenderer(){return this._blitRenderer}get vectorTilesMaterialManager(){return this._vtlMaterialManager}get quadMesh(){return this._quadMesh}getFbos(){if(!this._fbos)throw new Error(\"InternalError: Painter FBOs not initialized\");return this._fbos}acquireFbo(e,t){let s;if(this._fboPool.length>0)s=this._fboPool.pop();else{const r=new N(e,t);r.samplingMode=S.NEAREST,r.wrapMode=g.CLAMP_TO_EDGE,s=new F(this.context,r,this._stencilBuf)}return s.width===e&&s.height===t||s.resize(e,t),s}releaseFbo(e){this._fboPool.push(e)}getSharedStencilBuffer(){return this._stencilBuf}beforeRenderPhases(e,t,s){const{context:r}=e;this._worldExtentRenderer.render(e,t,s);const{width:i,height:n}=r.getViewport();if(this.updateFBOs(i,n),this._prevFBO=r.getBoundFramebufferObject(),r.bindFramebuffer(this.getFbos().output),r.setColorMask(!0,!0,!0,!0),null!=t){const{r:e,g:s,b:i,a:n}=t;r.setClearColor(n*e/255,n*s/255,n*i/255,n)}else r.setClearColor(0,0,0,0);r.setDepthWriteEnabled(!0),r.setClearDepth(1),r.clear(r.gl.COLOR_BUFFER_BIT|r.gl.DEPTH_BUFFER_BIT),r.setDepthWriteEnabled(!1)}afterRenderPhases(e){const{context:t}=e;t.bindFramebuffer(this._prevFBO),t.setStencilFunction(w.EQUAL,n,255),t.setStencilTestEnabled(!0),t.setDepthTestEnabled(!1),this.blitTexture(t,this.getFbos().output.colorTexture,S.NEAREST)}beforeRenderLayer(e,t,s){const{context:r,blendMode:i,effects:n,drawPhase:a,requireFBO:o}=e;if(o||A(a,i,n,s)){const e=r.getBoundFramebufferObject();this._prevBeforeLayerFBOStack.push(e);const{width:t,height:s}=r.getViewport(),i=this.acquireFbo(t,s);r.bindFramebuffer(i),r.setColorMask(!0,!0,!0,!0),r.setClearColor(0,0,0,0),r.setDepthWriteEnabled(!0),r.setClearDepth(1),r.clear(r.gl.COLOR_BUFFER_BIT|r.gl.DEPTH_BUFFER_BIT),r.setDepthWriteEnabled(!1)}r.setDepthWriteEnabled(!1),r.setDepthTestEnabled(!1),r.setStencilTestEnabled(!0),r.setClearStencil(t),r.setStencilWriteMask(255),r.clear(r.gl.STENCIL_BUFFER_BIT)}afterRenderLayer(e,t){const{context:s,blendMode:r,effects:i,requireFBO:n,drawPhase:o}=e;if(n||A(o,r,i,t)){const n=s.getBoundFramebufferObject();null!=i&&i.length>0&&o===a.MAP&&(s.setColorMask(!0,!0,!0,!0),this._applyEffects(e,i,n)),s.bindFramebuffer(this._prevBeforeLayerFBOStack.pop()),s.setStencilTestEnabled(!1),s.setStencilWriteMask(0),s.setBlendingEnabled(!0),s.setBlendFunctionSeparate(M.ONE,M.ONE_MINUS_SRC_ALPHA,M.ONE,M.ONE_MINUS_SRC_ALPHA),s.setColorMask(!0,!0,!0,!0);const l=null==r||o===a.HIGHLIGHT?\"normal\":r;this._blendEffect.draw(e,n.colorTexture,S.NEAREST,l,t),this.releaseFbo(n)}}renderObject(e,t,r,i){const n=s[r];if(!n)return;let a=this._brushCache.get(n);void 0===a&&(a=new n,this._brushCache.set(n,a)),a.prepareState(e),a.draw(e,t,i)}renderObjects(e,t,r,i){const n=s[r];if(!n)return;let a=this._brushCache.get(n);void 0===a&&(a=new n,this._brushCache.set(n,a)),a.drawMany(e,t,i)}registerRenderPass(e){const t=e.brushes.map((e=>(this._brushCache.has(e)||this._brushCache.set(e,new e),this._brushCache.get(e))));return new m(t,e)}blitTexture(e,t,s,r=1){e.setBlendingEnabled(!0),e.setBlendFunctionSeparate(M.ONE,M.ONE_MINUS_SRC_ALPHA,M.ONE,M.ONE_MINUS_SRC_ALPHA),e.setColorMask(!0,!0,!0,!0),this._blitRenderer.render(e,t,s,r),this._currentPipelineStateNeedsUpdate=!0}getPostProcessingEffects(e){return this._effectsManager.getPostProcessingEffects(e)}updateFBOs(e,t){if(e!==this._lastWidth||t!==this._lastHeight){if(this._lastWidth=e,this._lastHeight=t,this._fbos){let s;for(s in this._fbos)this._fbos[s].resize(e,t);return}const s=new N(e,t);s.samplingMode=S.NEAREST,s.wrapMode=g.CLAMP_TO_EDGE;const r=new T(P.DEPTH_STENCIL,e,t);this._stencilBuf=new R(this.context,r),this._fbos={output:new F(this.context,s,this._stencilBuf),effect0:new F(this.context,s,this._stencilBuf)}}}_applyEffects(e,t,s){const{context:r}=e,i=this._effectsManager.getPostProcessingEffects(t);for(const{postProcessingEffect:n,effect:a}of i)r.bindFramebuffer(s),n.draw(e,s,a);this._currentPipelineStateNeedsUpdate=!0}setShader(e){this._shaderState.shader=e.shader,this._shaderState.uniforms=e.uniforms,this._shaderState.defines=e.defines,this._shaderState.optionalAttributes=e.optionalAttributes,this._shaderState.useComputeBuffer=e.useComputeBuffer??!1}setPipelineState(e){e!==this._currentPipelineState&&(this._currentPipelineState=e,this._currentPipelineStateNeedsUpdate=!0)}submitDraw(e,t){const{shader:s,uniforms:r,defines:i,optionalAttributes:n}=this._shaderState,a=e.context,o=t.getAttributePrecisionPackFactors(),l=this._programCache.getProgram(s,o,r,i??{},n??{});return l.setUniforms(r),l.bind(a),this.updatePipelineState(a),this.setStencilRef(a,t),t.draw(e,s.locationInfo),l.cleanupTemporaryTextures(),{vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}}submitDrawMesh(e,t,s,r){this.submitDrawMeshUntyped(e,t,s,r)}submitDrawMeshUntyped(e,t,s,r){this.setShader(t);const{shader:i,uniforms:n,defines:a,optionalAttributes:o}=this._shaderState,l=this._programCache.getProgram(i,{},n,a??{},o??{});if(l.setUniforms(n),l.bind(e),this.updatePipelineState(e),r)for(const h of r)s.bind(e,h),s.draw(e);else for(let h=0;h<s.parts.length;h++)s.bind(e,h),s.draw(e);s.unbind(e),l.cleanupTemporaryTextures()}updatePipelineState(e){this._currentPipelineStateNeedsUpdate&&(this._currentPipelineStateNeedsUpdate=!1,this._updatePipelineState(e))}_updatePipelineState(e){if(null==this._currentPipelineState)throw new Error(\"Pipeline state not defined. Call setPipelineState before calling submitDraw \");const{color:t,depth:s,stencil:r}=this._currentPipelineState;if(t){const{blendMode:s,write:r}=t;switch(e.setColorMask(...r),e.setBlendingEnabled(!0),e.setBlendEquation(C.ADD),s){case\"composite\":e.setBlendFunctionSeparate(M.ONE,M.ONE_MINUS_SRC_ALPHA,M.ONE,M.ONE_MINUS_SRC_ALPHA);break;case\"additive\":e.setBlendFunctionSeparate(M.ONE,M.ONE,M.ONE,M.ONE);break;case\"custom\":{const{blendParameters:s}=t,{dstAlpha:r,dstRGB:i,srcAlpha:n,srcRGB:a}=s;e.setBlendFunctionSeparate(a,i,n,r);break}case\"delete\":e.setBlendEquation(C.REVERSE_SUBTRACT),e.setBlendFunctionSeparate(M.ONE,M.ONE_MINUS_SRC_ALPHA,M.ONE,M.ONE_MINUS_SRC_ALPHA)}}if(s){const{test:t,write:r}=s;r?(e.setDepthWriteEnabled(!0),e.setDepthRange(r.zNear,r.zFar)):e.setDepthWriteEnabled(!1),t?(e.setDepthTestEnabled(!0),e.setDepthFunction(t)):e.setDepthTestEnabled(!1)}else e.setDepthTestEnabled(!1),e.setDepthWriteEnabled(!1);if(r){const{test:t,write:s}=r;if(t){const{compare:s,mask:r,op:i,ref:n}=t;e.setStencilTestEnabled(!0),\"function\"!=typeof n&&e.setStencilFunctionSeparate(B.FRONT_AND_BACK,s,n,r),e.setStencilOpSeparate(B.FRONT_AND_BACK,i.fail,i.zFail,i.zPass)}else e.setStencilTestEnabled(!1);if(s){const{mask:t}=s;e.setStencilWriteMask(t)}else e.setStencilWriteMask(0)}else e.setStencilTestEnabled(!1),e.setStencilWriteMask(0)}setStencilRef(e,t){if(null==this._currentPipelineState)throw new Error(\"Pipeline state not defined. Call setPipelineState before calling submitDraw \");const{stencil:s}=this._currentPipelineState;if(s){const{test:r}=s;if(r){const{compare:s,mask:i,ref:n}=r;if(\"function\"==typeof n){const r=t.getStencilReference();if(null===r)throw new Error(\"InternalError: Stencil reference expected for target but not defined\");e.setStencilFunctionSeparate(B.FRONT_AND_BACK,s,r,i)}}}}}function A(e,t,s,r){return e!==a.LABEL_ALPHA&&e!==a.LABEL&&e!==a.HIGHLIGHT&&(1!==r||null!=t&&\"normal\"!==t||null!=s&&s.length>0)}export{O as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport h from\"./Rect.js\";class t{constructor(t,e){this._width=0,this._height=0,this._free=[],this._width=t,this._height=e,this._free.push(new h(0,0,t,e))}get width(){return this._width}get height(){return this._height}allocate(t,e){if(t>this._width||e>this._height)return new h;let i=null,s=-1;for(let h=0;h<this._free.length;++h){const r=this._free[h];t<=r.width&&e<=r.height&&(null===i||r.y<=i.y&&r.x<=i.x)&&(i=r,s=h)}return null===i?new h:(this._free.splice(s,1),i.width<i.height?(i.width>t&&this._free.push(new h(i.x+t,i.y,i.width-t,e)),i.height>e&&this._free.push(new h(i.x,i.y+e,i.width,i.height-e))):(i.width>t&&this._free.push(new h(i.x+t,i.y,i.width-t,i.height)),i.height>e&&this._free.push(new h(i.x,i.y+e,t,i.height-e))),new h(i.x,i.y,t,e))}release(h){for(let t=0;t<this._free.length;++t){const e=this._free[t];if(e.y===h.y&&e.height===h.height&&e.x+e.width===h.x)e.width+=h.width;else if(e.x===h.x&&e.width===h.width&&e.y+e.height===h.y)e.height+=h.height;else if(h.y===e.y&&h.height===e.height&&h.x+h.width===e.x)e.x=h.x,e.width+=h.width;else{if(h.x!==e.x||h.width!==e.width||h.y+h.height!==e.y)continue;e.y=h.y,e.height+=h.height}this._free.splice(t,1),this.release(h)}this._free.push(h)}}export{t as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{packFloatRGBA as t}from\"../../../../core/floatRGBA.js\";import{onAbort as e,createAbortError as s}from\"../../../../core/promiseUtils.js\";import{destroyHiddenSvg as i,createHiddenSvg as r,createSvgElement as n}from\"../svgUtils.js\";const o=1e20;class a{constructor(t,e=2){this._textureSize=t,this._rasterizationScale=e,this._canvasSize=this._textureSize*this._rasterizationScale,this._svg=null;const{_canvasSize:s}=this,i=document.createElement(\"canvas\");i.width=i.height=s,this._context=i.getContext(\"2d\",{willReadFrequently:!1}),this._gridOuter=new Float64Array(s*s),this._gridInner=new Float64Array(s*s),this._f=new Float64Array(s),this._d=new Float64Array(s),this._z=new Float64Array(s+1),this._v=new Int16Array(s)}dispose(){this._context=this._gridOuter=this._gridInner=this._f=this._d=this._z=this._v=null,this._svg=i(this._svg)}draw(i,r,n){const{_canvasSize:a,_textureSize:h,_rasterizationScale:_}=this,l=h/4;this._initSVG();const c=this.createSVGString(i,r);return new Promise(((i,r)=>{const d=new Image;d.src=\"data:image/svg+xml; charset=utf8, \"+encodeURIComponent(c),d.onload=()=>{d.onload=null,this._context.clearRect(0,0,a,a),this._context.drawImage(d,0,0,a,a);const e=this._context.getImageData(0,0,a,a),s=new Uint8Array(h*h*4);for(let t=0;t<a*a;t++){const s=e.data[4*t+3]/255;this._gridOuter[t]=1===s?0:0===s?o:Math.max(0,.5-s)**2,this._gridInner[t]=1===s?o:0===s?0:Math.max(0,s-.5)**2}this._edt(this._gridOuter,a,a),this._edt(this._gridInner,a,a);for(let i=0;i<h*h;i++){let e=0;for(let t=0;t<_;t++){const s=Math.floor(i/h)*_+t;for(let t=0;t<_;t++){const r=s*a+(i%h*_+t);e+=this._gridOuter[r]-this._gridInner[r]}}e/=_*_,e/=_;t(.5-e/(2*l),s,4*i)}i(s)};const g=n?.signal;g&&e(g,(()=>r(s())))}))}_initSVG(){return this._svg||(this._svg=r()),this._svg}createSVGString(t,e){const s=this._initSVG(),i=n(\"path\");i.setAttribute(\"d\",t),s.appendChild(i);const r=i.getBBox(),o=r.width/r.height,a=this._canvasSize/2;let h,_,l;if(o>1){h=a/r.width;const t=a*(1/o);_=this._canvasSize/4,l=a-t/2}else{h=a/r.height;_=a-a*o/2,l=this._canvasSize/4}const c=-r.x*h+_,d=-r.y*h+l;i.setAttribute(\"style\",`transform: matrix(${h}, 0, 0, ${h}, ${c}, ${d})`),i.setAttribute(\"stroke-width\",\"\"+.5/h);const g=`<svg style=\"fill:${e?\"red\":\"none\"}; stroke:${e?\"none\":\"red\"}\" height=\"${this._canvasSize}\" width=\"${this._canvasSize}\" xmlns=\"http://www.w3.org/2000/svg\">${s.innerHTML}</svg>`;return s.removeChild(i),g}_edt(t,e,s){const i=this._f,r=this._d,n=this._v,o=this._z;for(let a=0;a<e;a++){for(let r=0;r<s;r++)i[r]=t[r*e+a];this._edt1d(i,r,n,o,s);for(let i=0;i<s;i++)t[i*e+a]=r[i]}for(let a=0;a<s;a++){for(let s=0;s<e;s++)i[s]=t[a*e+s];this._edt1d(i,r,n,o,e);for(let s=0;s<e;s++)t[a*e+s]=Math.sqrt(r[s])}}_edt1d(t,e,s,i,r){s[0]=0,i[0]=-o,i[1]=+o;for(let n=1,a=0;n<r;n++){let e=(t[n]+n*n-(t[s[a]]+s[a]*s[a]))/(2*n-2*s[a]);for(;e<=i[a];)a--,e=(t[n]+n*n-(t[s[a]]+s[a]*s[a]))/(2*n-2*s[a]);a++,s[a]=n,i[a]=e,i[a+1]=+o}for(let n=0,o=0;n<r;n++){for(;i[o+1]<n;)o++;e[n]=(n-s[o])*(n-s[o])+t[s[o]]}}}export{a as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/Error.js\";import has from\"../../../../core/has.js\";import{spritePadding as e}from\"./definitions.js\";import{log2 as i}from\"./GeometryUtils.js\";import s from\"./Rect.js\";import a from\"./RectangleBinPack.js\";import{TextureWrapMode as r}from\"../../../webgl/enums.js\";import{Texture as o}from\"../../../webgl/Texture.js\";import{TextureDescriptor as h}from\"../../../webgl/TextureDescriptor.js\";function c(t){return t&&\"static\"===t.type}class n{constructor(t,e,i=0){this._mosaicPages=[],this._maxItemSize=0,this._currentPage=0,this._pageWidth=0,this._pageHeight=0,this._mosaicRects=new Map,this._spriteCopyQueue=[],this.pixelRatio=1,this._pageWidth=t,this._pageHeight=e,i>0&&(this._maxItemSize=i),this.pixelRatio=window.devicePixelRatio||1,this._binPack=new a(this._pageWidth,this._pageHeight);const s=Math.floor(this._pageWidth),r=Math.floor(this._pageHeight);this._mosaicPages.push({mosaicsData:{type:\"static\",data:new Uint32Array(s*r)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}getWidth(t){return t>=this._mosaicPages.length?-1:this._mosaicPages[t].size[0]}getHeight(t){return t>=this._mosaicPages.length?-1:this._mosaicPages[t].size[1]}getPageTexture(t){return t<this._mosaicPages.length?this._mosaicPages[t].texture:null}has(t){return this._mosaicRects.has(t)}get itemCount(){return this._mosaicRects.size}getSpriteItem(t){return this._mosaicRects.get(t)}addSpriteItem(t,i,a,r,o,h,n=1,g=.5,p=1){if(this._mosaicRects.has(t))return this._mosaicRects.get(t);let m,d,u;if(c(a))[m,d,u]=this._allocateImage(i[0],i[1]);else{m=new s(0,0,i[0],i[1]),d=this._mosaicPages.length;const t=void 0;this._mosaicPages.push({mosaicsData:a,size:[i[0]+2*e,i[1]+2*e],dirty:!0,texture:t})}if(m.width<=0||m.height<=0)return null;const l={type:\"sprite\",rect:m,width:i[0],height:i[1],sdf:o,simplePattern:h,rasterizationScale:n,sdfPaddingRatio:g,sdfDecodeCoeff:p,page:d};return this._mosaicRects.set(t,l),c(a)&&(has(\"esri-mosaic-debug\")&&this._showDebugSprite(i,a.data),this._copy({rect:m,spriteSize:i,spriteData:a.data,page:d,pageSize:u,repeat:r,sdf:o})),l}hasItemsToProcess(){return 0!==this._spriteCopyQueue.length}processNextItem(){const t=this._spriteCopyQueue.pop();t&&this._copy(t)}getMosaicItemPosition(t){const i=this.getSpriteItem(t),s=i?.rect;if(!s)return null;s.width=i.width,s.height=i.height;const a=i.width,r=i.height,o=e,h=this._mosaicPages[i.page].size;return{size:[i.width,i.height],tl:[(s.x+o)/h[0],(s.y+o)/h[1]],br:[(s.x+o+a)/h[0],(s.y+o+r)/h[1]],page:i.page}}bind(t,e,i=0,s=0){const a=this._mosaicPages[i],r=a.mosaicsData;let o=a.texture;if(o||(o=p(t,a.size),a.texture=o),o.setSamplingMode(e),c(r))t.bindTexture(o,s),a.dirty&&(o.setData(new Uint8Array(r.data.buffer)),o.generateMipmap(),has(\"esri-mosaic-debug\")&&this._showDebugPage(i));else{r.data.loadFrame(o),t.bindTexture(o,s),o.generateMipmap()}a.dirty=!1}getTexture(t,e=0){const i=this._mosaicPages[e],s=i.mosaicsData;let a=i.texture;if(a||(a=p(t,i.size),i.texture=a),c(s))i.dirty&&(a.setData(new Uint8Array(s.data.buffer)),a.generateMipmap(),has(\"esri-mosaic-debug\")&&this._showDebugPage(e));else{s.data.loadFrame(a),a.generateMipmap()}return i.dirty=!1,a}dispose(){this._binPack=null;for(const t of this._mosaicPages){const e=t.texture;e&&e.dispose();const i=t.mosaicsData;if(!c(i)){i.data.destroy()}}this._mosaicPages=null,this._mosaicRects.clear()}static _copyBits(t,e,i,s,a,r,o,h,c,n,g){let p=s*e+i,m=h*r+o;if(g){m-=r;for(let o=-1;o<=n;o++,p=((o+n)%n+s)*e+i,m+=r)for(let e=-1;e<=c;e++)a[m+e]=t[p+(e+c)%c]}else for(let d=0;d<n;d++){for(let e=0;e<c;e++)a[m+e]=t[p+e];p+=e,m+=r}}_copy(i){if(i.page>=this._mosaicPages.length)return;const s=this._mosaicPages[i.page],a=s.mosaicsData;if(!c(s.mosaicsData))throw new t(\"mapview-invalid-resource\",\"unsuitable data type!\");const r=i.spriteData,o=a.data;n._copyBits(r,i.spriteSize[0],0,0,o,i.pageSize[0],i.rect.x+e,i.rect.y+e,i.spriteSize[0],i.spriteSize[1],i.repeat),s.dirty=!0}_allocateImage(t,r){t+=2*e,r+=2*e;const o=Math.max(t,r);if(this._maxItemSize&&this._maxItemSize<o){const e=2**Math.ceil(i(t)),a=2**Math.ceil(i(r)),o=new s(0,0,t,r);return this._mosaicPages.push({mosaicsData:{type:\"static\",data:new Uint32Array(e*a)},size:[e,a],dirty:!0,texture:void 0}),[o,this._mosaicPages.length-1,[e,a]]}const h=this._binPack.allocate(t,r);if(h.width<=0){const e=this._mosaicPages[this._currentPage];return!e.dirty&&c(e.mosaicsData)&&(e.mosaicsData.data=null),this._currentPage=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:{type:\"static\",data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new a(this._pageWidth,this._pageHeight),this._allocateImage(t,r)}return[h,this._currentPage,[this._pageWidth,this._pageHeight]]}_showDebugSprite([t,e],i){const s=document.createElement(\"canvas\");s.width=t,s.height=e,s.setAttribute(\"style\",`position: absolute; top: ${4+204*g++}px; right: 208px; width: 200px; height: 200px; border: 1px solid black;`);const a=s.getContext(\"2d\"),r=new ImageData(t,e);r.data.set(new Uint8Array(i.buffer)),a.putImageData(r,0,0),document.body.appendChild(s)}_showDebugPage(t){const e=this._mosaicPages[t],{size:[i,s],mosaicsData:a}=e;if(!c(a))return;const r=`mosaicDebugPage${t}`,o=document.getElementById(r)??document.createElement(\"canvas\");o.id=r,o.width=i,o.height=s,o.setAttribute(\"style\",`position: absolute; top: ${4+204*t}px; right: 4px; width: 200px; height: 200px; border: 1px solid black;`);const h=o.getContext(\"2d\"),n=new ImageData(i,s);n.data.set(new Uint8Array(a.data.buffer)),h.putImageData(n,0,0),document.body.appendChild(o)}}let g=0;function p(t,e){const i=new h;return i.width=e[0],i.height=e[1],i.wrapMode=r.CLAMP_TO_EDGE,new o(t,i,null)}export{n as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../../config.js\";import t from\"../../../../request.js\";import{bidiText as i}from\"../../../../core/BidiText.js\";import s from\"../../../../core/Error.js\";import{getFullyQualifiedFontName as r}from\"../../../../core/fontUtils.js\";import has from\"../../../../core/has.js\";import a from\"../../../../core/Logger.js\";import{throwIfAborted as n,isAbortError as o}from\"../../../../core/promiseUtils.js\";import{pt2px as c}from\"../../../../core/screenUtils.js\";import{numericHash as h}from\"../../../../core/string.js\";import l from\"../../../../symbols/cim/CIMResourceManager.js\";import{CIMSymbolHelper as u}from\"../../../../symbols/cim/CIMSymbolHelper.js\";import p from\"../../../../symbols/cim/Rasterizer.js\";import{normalizeDashTemplate as m}from\"../../../../symbols/cim/utils.js\";import{svgSdfTextureInnerSize as d,textureBindingSpriteAtlas as g,textureBindingGlyphAtlas as f}from\"./definitions.js\";import{MosaicType as y}from\"./enums.js\";import _ from\"./GlyphMosaic.js\";import M from\"./GlyphSource.js\";import I from\"./Rect.js\";import w from\"./SDFConverter.js\";import S from\"./SpriteMosaic.js\";import{charCodes as z,discardUrlIfHasUrlHash as R,isSVGImage as T}from\"./Utils.js\";import{AnimatableTextureResource as C}from\"./animatedFormats/AnimatableTextureResource.js\";import{AnimationStore as P}from\"./animations/store/AnimationStore.js\";import{QueueProcessor as x}from\"../../../support/QueueProcessor.js\";import{TextureSamplingMode as b}from\"../../../webgl/enums.js\";const j=\"arial-unicode-ms-regular\",v=()=>a.getLogger(\"esri.views.2d.engine.webgl.TextureManager\"),$=(e,t,i)=>v().error(new s(e,t,i));class A{static fromMosaic(e,t){return new A(e,t.page,t.sdf)}constructor(e,t,i){this.mosaicType=e,this.page=t,this.sdf=i}}class k{constructor(i){this._requestRender=i,this._resourceManager=new l,this._invalidFontsMap=new Map,this._sdfConverter=new w(d),this._bindingInfos=new Array,this._hashToBindingIndex=new Map,this._ongoingRasterizations=new Map,this._imageRequestQueue=new x({concurrency:10,process:async(e,i)=>{n(i);try{return await t(e,{responseType:\"image\",signal:i})}catch(r){if(!o(r))throw new s(\"mapview-invalid-resource\",`Could not fetch requested resource at ${e}`,r);throw r}}}),this.animationStore=new P,this._spriteMosaic=new S(2048,2048,500),this._glyphSource=new M(`${e.fontsUrl}/{fontstack}/{range}.pbf`),this._glyphMosaic=new _(1024,1024,this._glyphSource),this._rasterizer=new p(this.resourceManager)}dispose(){this._spriteMosaic.dispose(),this._glyphMosaic.dispose(),this._rasterizer.dispose(),this._sdfConverter.dispose(),this._spriteMosaic=null,this._glyphMosaic=null,this._sdfConverter=null,this._hashToBindingIndex.clear(),this._hashToBindingIndex=null,this._bindingInfos=null,this._ongoingRasterizations.clear(),this._ongoingRasterizations=null,this._imageRequestQueue.clear(),this._imageRequestQueue=null,this._resourceManager.destroy(),this.animationStore.destroy()}get sprites(){return this._spriteMosaic}get glyphs(){return this._glyphMosaic}get resourceManager(){return this._resourceManager}async rasterizeItem(e,t){if(null==e)return $(\"mapview-null-resource\",\"Unable to rasterize null resource\"),null;if(\"animation-info\"===e.type){const{resource:t}=e,i=this.animationStore.add(t),{location:s}=i;return{rect:new I(s.column,s.row,t.length,1),page:s.page,type:\"sprite\",width:t.length,height:1,rasterizationScale:1,sdfPaddingRatio:.5,sdfDecodeCoeff:1,simplePattern:!1}}if(\"cim-rasterization-info\"!==e.type)return $(\"mapview-unexpected-resource\",\"Unable to rasterize resource\"),null;const{resource:i}=e;if(\"text\"===i.type){const e=await this._rasterizeText(i,t);for(const t of e.glyphs)this._setTextureBinding(y.GLYPH,t);return e}const s=await this._rasterizeSprite(i,t);return s&&this._setTextureBinding(y.SPRITE,s),s}getMosaicInfo(e,t,i=!1){const s=this._getTextureBindingInfo(e,t,i);return s?{size:s.size,texture:{texture:s.texture,unit:\"sprite\"===s.type?g:f}}:($(\"mapview-invalid-resource\",`Unable to find resource for ${t}`),{size:[0,0],texture:{texture:null,unit:0}})}_getTextureBindingInfo(e,t,i){const s=this._bindingInfos[t-1],r=s.page,a=i?b.LINEAR_MIPMAP_LINEAR:b.LINEAR;switch(s.mosaicType){case y.SPRITE:{const t=[this.sprites.getWidth(r),this.sprites.getHeight(r)],i=this._spriteMosaic.getTexture(e,r);return i.setSamplingMode(a),{type:\"sprite\",texture:i,size:t}}case y.GLYPH:{const t=[this.glyphs.width,this.glyphs.height],i=this._glyphMosaic.getTexture(e,r);return this._glyphMosaic.bind(e,a,r,f),i.setSamplingMode(a),{type:\"glyph\",texture:i,size:t}}default:return $(\"mapview-texture-manager\",`Cannot handle unknown type ${s.mosaicType}`),null}}_hashMosaic(e,t){return 1|e<<1|(t.sdf?1:0)<<2|t.page<<3}_setTextureBinding(e,t){const i=this._hashMosaic(e,t);if(!this._hashToBindingIndex.has(i)){const s=A.fromMosaic(e,t),r=this._bindingInfos.length+1;this._hashToBindingIndex.set(i,r),this._bindingInfos.push(s)}t.textureBinding=this._hashToBindingIndex.get(i)}async _rasterizeText(e,t){const{font:s,textString:a}=e,n=r(s),o=this._invalidFontsMap.has(n),[c,h]=i(a),l=z(c);try{const e=o?j:n;has(\"esri-2d-stabilize-glyphs\")&&await this._glyphMosaic.preloadASCIIGlyphCache(e);return{type:\"glyphs\",glyphs:await this._glyphMosaic.getGlyphItems(e,l,t),isRightToLeft:h}}catch(u){$(\"mapview-invalid-resource\",`Couldn't find font ${n}. Falling back to Arial Unicode MS Regular`),this._invalidFontsMap.set(n,!0);return{type:\"glyphs\",glyphs:await this._glyphMosaic.getGlyphItems(j,l,t),isRightToLeft:h}}}_hashSpriteResource(e){switch(e.type){case\"path\":return`path:${e.path}.${e.asFill?1:0}`;case\"CIMPictureMarker\":return`${e.type}:${e.url}:${e.size}`;case\"CIMPictureFill\":return`${e.type}:${e.url}:${e.height}`;case\"CIMPictureStroke\":return`${e.type}:${e.url}:${e.width}`;case\"dash\":return`dash:${e.capStyle}.${m(e.dashTemplate).join(\"\")}`;case\"sdf\":return`sdf:${JSON.stringify(e.geom)}.${e.asFill?1:0}`;case\"fill-style\":return`fill_style:${e.style}`;case\"animated\":return JSON.stringify(R(e));case\"CIMHatchFill\":case\"CIMVectorMarker\":return JSON.stringify(e)}}async _rasterizeSprite(e,t){if(!e)return null;const i=h(this._hashSpriteResource(e));if(this._spriteMosaic.has(i))return this._spriteMosaic.getSpriteItem(i);if(\"url\"in e&&e.url||\"CIMPictureFill\"===e.type||\"CIMPictureStroke\"===e.type||\"CIMPictureMarker\"===e.type||\"CIMVectorMarker\"===e.type){const t=[];u.fetchResources({type:\"CIMPointSymbol\",symbolLayers:[e]},this._resourceManager,t),t.length>0&&await Promise.all(t)}switch(e.type){case\"CIMPictureMarker\":return\"CIMMarkerPlacementInsidePolygon\"===e.markerPlacement?.type?this._rasterizeJSONResource(i,e):this._handleAsyncResource(i,e,t);case\"animated\":case\"CIMPictureFill\":case\"CIMPictureStroke\":case\"path\":return this._handleAsyncResource(i,e,t);case\"sdf\":case\"dash\":case\"fill-style\":case\"CIMVectorMarker\":case\"CIMHatchFill\":return this._rasterizeJSONResource(i,e)}}_rasterizeJSONResource(e,t){const i=this._rasterizer.rasterizeJSONResource(t);if(i){const{size:s,image:r,sdf:a,simplePattern:n,rasterizationScale:o,sdfPaddingRatio:c,sdfDecodeCoeff:h}=i;return this._addItemToMosaic(e,s,{type:\"static\",data:r},F(t),a,n,o,c,h)}return null}async _handleAsyncResource(e,t,i){if(this._ongoingRasterizations.has(e))return this._ongoingRasterizations.get(e);let s;return s=\"path\"===t.type?this._handleSVG(t,e,i):this._handleImage(t,e,i),this._ongoingRasterizations.set(e,s),s.finally((()=>this._ongoingRasterizations.delete(e))),s}async _handleSVG(e,t,i){const s=[d,d],{asFill:r}=e,a=await this._sdfConverter.draw(e.path,r,i);return this._addItemToMosaic(t,s,{type:\"static\",data:new Uint32Array(a.buffer)},!1,!0,!0)}async _handleGIFOrPNG(e,t,i){const s=e.url,r=this.resourceManager.getResource(s);if(null==r)return null;const{width:a,height:n}=r;if(r instanceof HTMLImageElement){if(\"animated\"===e.type)return $(\"mapview-unexpected-resource\",\"Attempt to configure animations for a non-animated image.\"),null;const i=\"colorSubstitutions\"in e?e.colorSubstitutions:void 0,{size:s,sdf:o,image:c}=this._rasterizer.rasterizeImageResource(a,n,r,i);return this._addItemToMosaic(t,s,{type:\"static\",data:c},F(e),o,!1)}let o,c,h;\"animated\"===e.type?(o=!1,c={type:\"CIMAnimatedSymbolProperties\",playAnimation:e.playAnimation,reverseAnimation:e.reverseAnimation,randomizeStartTime:e.randomizeStartTime,randomizeStartSeed:e.randomizeStartSeed,startTimeOffset:e.startTimeOffset,duration:e.duration,repeatType:e.repeatType,repeatDelay:e.repeatDelay},h=e.startGroup||0):(o=F(e),c={type:\"CIMAnimatedSymbolProperties\"},h=0);const l=new C(r,this._requestRender,c,h);return this._addItemToMosaic(t,[l.width,l.height],{type:\"animated\",data:l},o,!1,!1)}async _handleImage(e,t,i){const r=e.url;if(B(r)||N(r))return this._handleGIFOrPNG(e,t,i);if(\"animated\"===e.type)return $(\"mapview-unexpected-resource\",\"Attempt to configure animations for a non-animated image.\"),null;try{let s;const a=this.resourceManager.getResource(r);if(null!=a&&a instanceof HTMLImageElement)s=a;else{const{data:e}=await this._imageRequestQueue.push(r,{...i});s=e}if(T(r))if(\"width\"in e&&\"height\"in e)s.width=c(e.width),s.height=c(e.height);else if(\"cim\"in e){const t=e;s.width=c(t.width??t.scaleX*t.size),s.height=c(t.size)}if(!s.width||!s.height)return null;const n=s.width,o=s.height,h=\"colorSubstitutions\"in e?e.colorSubstitutions:void 0,{size:l,sdf:u,image:p}=this._rasterizer.rasterizeImageResource(n,o,s,h);return this._addItemToMosaic(t,l,{type:\"static\",data:p},F(e),u,!1)}catch($){if(!o($))throw new s(\"mapview-invalid-resource\",`Could not fetch requested resource at ${r}. ${$.message}`);throw $}}_addItemToMosaic(e,t,i,s,r,a,n,o,c){return this._spriteMosaic.addSpriteItem(e,t,i,s,r,a,n,o,c)}}function F(e){switch(e.type){case\"CIMVectorMarker\":case\"CIMPictureMarker\":return O(e);default:return!0}}const G=e=>null!=e&&e.startsWith(\"data:image/gif\"),B=e=>e&&(e.includes(\".gif\")||G(e)),L=e=>null!=e&&e.startsWith(\"data:image/png\"),N=e=>e&&(e.includes(\".png\")||L(e)),O=e=>e&&\"markerPlacement\"in e&&e.markerPlacement&&\"CIMMarkerPlacementInsidePolygon\"===e.markerPlacement.type;export{k as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{createResolver as e,throwIfAborted as t,onAbortOrThrow as s}from\"../../../../core/promiseUtils.js\";import{textureUploadManagerBudget as o,textureUploadManagerChunkSize as u}from\"./definitions.js\";class r{constructor(e){this._queue=[],this._refreshable=e}destroy(){this._queue=[]}enqueueTextureUpdate(o,r){const n=e(),h=o,i=u,a=Math.ceil(h.height/i);t(r);for(let e=0;e<a;e++){const t=e*i,s=e===a-1,u=s?h.height-i*e:i;this._queue.push({type:\"chunk\",request:o,resolver:n,chunk:e,chunkOffset:t,destHeight:u,chunkIsLast:s,options:r})}return s(r,(e=>n.reject(e))),n.promise}upload(){let e=0;for(;this._queue.length;){const t=performance.now(),s=this._queue.shift();if(s){if(null!=s.options.signal&&s.options.signal.aborted)continue;switch(s.type){case\"chunk\":this._uploadChunk(s);break;case\"no-chunk\":this._uploadNoChunk(s)}const u=performance.now()-t;if(e+=u,e+u>=o)break}}this._queue.length&&this._refreshable.requestRender()}_uploadChunk(e){const{request:t,resolver:s,chunkOffset:o,chunkIsLast:u,destHeight:r}=e,{data:n,texture:h,width:i}=t;null!=n&&(h.updateData(0,0,o,i,r,n,o),u&&s.resolve())}_uploadNoChunk(e){const{request:t,resolver:s}=e,{data:o,texture:u}=t;u.setData(o),s.resolve()}}export{r as TextureUploadManager};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass s{constructor(){this._candidateTiles=[]}schedule(s){this._candidateTiles.includes(s)||this._candidateTiles.push(s)}reshuffle(s){const e=[];for(const i of this._candidateTiles)s>0?(i.reshuffle(),s--):e.push(i);this._candidateTiles=e}}export{s as TileReshuffleManager};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{disposeMaybe as t}from\"../../../../core/maybe.js\";import{toRadian as i}from\"../../../../core/libs/gl-matrix-2/math/common.js\";import{fromTranslation as e,scale as r,rotate as s,translate as o}from\"../../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as a}from\"../../../../core/libs/gl-matrix-2/factories/mat3f32.js\";import{fromValues as n}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{i as l}from\"../../../../chunks/vec32.js\";import{create as m}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{backbufferStencilVisible as c,backbufferStencilClipped as h}from\"./definitions.js\";import d from\"./VertexStream.js\";import{stencil as _}from\"./shaders/StencilPrograms.js\";import{CompareFunction as p,StencilOperation as f}from\"../../../webgl/enums.js\";import{createProgram as u}from\"../../../webgl/ProgramTemplate.js\";const g=n(-.5,-.5);class b{constructor(){this._centerNdc=m(),this._pxToNdc=m(),this._worldDimensionsPx=m(),this._mat3=a(),this._initialized=!1}dispose(){this._program=t(this._program),this._quad=t(this._quad)}render(t,i,e){const{context:r}=t,s=this._updateGeometry(t,e);if(null!=i){const{r:t,g:e,b:s,a:o}=i;r.setClearColor(o*t/255,o*e/255,o*s/255,o)}else r.setClearColor(0,0,0,0);if(r.setStencilFunction(p.ALWAYS,0,255),r.setStencilWriteMask(255),!s)return r.setClearStencil(c),void r.clear(r.gl.STENCIL_BUFFER_BIT|r.gl.COLOR_BUFFER_BIT);r.setClearStencil(h),r.clear(r.gl.STENCIL_BUFFER_BIT|r.gl.COLOR_BUFFER_BIT),this._initialized||this._initialize(r),r.setDepthWriteEnabled(!1),r.setDepthTestEnabled(!1),r.setColorMask(!1,!1,!1,!1),r.setBlendingEnabled(!1),r.setStencilOp(f.KEEP,f.KEEP,f.REPLACE),r.setStencilFunction(p.ALWAYS,c,255),r.setStencilTestEnabled(!0),r.useProgram(this._program),this._program.setUniformMatrix3fv(\"u_worldExtent\",this._mat3),this._quad.bind(),this._quad.draw(),this._quad.unbind()}_initialize(t){if(this._initialized)return;const i=u(t,_);i&&(this._program=i,this._quad=new d(t,[0,0,1,0,0,1,1,1]),this._initialized=!0)}_updateGeometry(t,a){const{state:n,pixelRatio:m}=t,{size:c,rotation:h}=n,d=Math.round(c[0]*m),_=Math.round(c[1]*m);if(!n.spatialReference.isWrappable)return!1;const p=i(h),f=Math.abs(Math.cos(p)),u=Math.abs(Math.sin(p)),b=Math.round(d*f+_*u),x=Math.round(m*n.worldScreenWidth);if(b<=x)return!1;const E=d*u+_*f,S=(a.left-a.right)*m/d,j=(a.bottom-a.top)*m/_;l(this._worldDimensionsPx,x,E,1),l(this._pxToNdc,2/d,-2/_,1),l(this._centerNdc,S,j,1);const C=this._mat3;return e(C,this._centerNdc),r(C,C,this._pxToNdc),0!==h&&s(C,C,p),r(C,C,this._worldDimensionsPx),o(C,C,g),!0}}export{b as WorldExtentRenderer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{spritePadding as t}from\"../definitions.js\";import{play as i}from\"./utils.js\";class a{constructor(t,a,h,e){this._animation=t,this._frameData=null;const n=t=>{this._frameData=t,a.requestRender()};this.frameCount=this._animation.frameDurations.length,this.width=this._animation.width,this.height=this._animation.height,this._playHandle=i(this._animation,h,e,n)}destroy(){this._playHandle.remove()}loadFrame(i){const a=this._frameData;if(null==a)return;const h=\"width\"in a?a.width:a.codedWidth,e=\"height\"in a?a.height:a.codedHeight;i.updateData(0,t,t,h,e,a),this._frameData=null}}export{a as AnimatableTextureResource};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{makeHandle as t}from\"../../../../../core/handleUtils.js\";import{Milliseconds as e}from\"../../../../../core/time.js\";import{imageTypeToCanvas as r}from\"../../../../../geometry/support/meshUtils/exporters/gltf/imageutils.js\";import{AnimatedSymbolRepeatType as i}from\"../../../../../symbols/cim/enums.js\";import{getRandomValue as a}from\"../grouping.js\";function n(t){return e(t.frameDurations.reduce(((t,e)=>t+e),0))}function o(t){const{width:e,height:r}=t,i=t.frameDurations.reverse(),a=e=>{const r=t.frameDurations.length-1-e;return t.getFrame(r)};return{frameCount:t.frameCount,duration:t.duration,frameDurations:i,getFrame:a,width:e,height:r}}function s(t,r){const{width:i,height:a,getFrame:n}=t,o=r/t.duration,s=t.frameDurations.map((t=>e(t*o)));return{frameCount:t.frameCount,duration:t.duration,frameDurations:s,getFrame:n,width:i,height:a}}function m(t,r){const{width:i,height:a,getFrame:n}=t,o=t.frameDurations.slice(),s=o.shift();return o.unshift(e(s+r)),{frameCount:t.frameCount,duration:t.duration+r,frameDurations:o,getFrame:n,width:i,height:a}}function u(t,r){const{width:i,height:a,getFrame:n}=t,o=t.frameDurations.slice(),s=o.pop();return o.push(e(s+r)),{frameCount:t.frameCount,duration:t.duration+r,frameDurations:o,getFrame:n,width:i,height:a}}class h{constructor(t,e,r,i){this._animation=t,this._repeatType=r,this._onFrameData=i,this._direction=1,this._currentFrame=0,this.timeToFrame=this._animation.frameDurations[this._currentFrame];let a=0;for(;e>a;)a+=this.timeToFrame,this.nextFrame();const n=this._animation.getFrame(this._currentFrame);this._onFrameData(n)}nextFrame(){if(this._currentFrame+=this._direction,this._direction>0){if(this._currentFrame===this._animation.frameDurations.length)switch(this._repeatType){case i.None:this._currentFrame-=this._direction;break;case i.Loop:this._currentFrame=0;break;case i.Oscillate:this._currentFrame-=this._direction,this._direction=-1}}else if(-1===this._currentFrame)switch(this._repeatType){case i.None:this._currentFrame-=this._direction;break;case i.Loop:this._currentFrame=this._animation.frameDurations.length-1;break;case i.Oscillate:this._currentFrame-=this._direction,this._direction=1}this.timeToFrame=this._animation.frameDurations[this._currentFrame];const t=this._animation.getFrame(this._currentFrame);this._onFrameData(t)}}function c(t,r,c,f){let l,{repeatType:d}=r;if(null==d&&(d=i.Loop),!0===r.reverseAnimation&&(t=o(t)),null!=r.duration&&(t=s(t,e(1e3*r.duration))),null!=r.repeatDelay){const a=1e3*r.repeatDelay;d===i.Loop?t=u(t,e(a)):d===i.Oscillate&&(t=m(u(t,e(a/2)),e(a/2)))}if(null!=r.startTimeOffset)l=e(1e3*r.startTimeOffset);else if(null!=r.randomizeStartTime){const i=82749913,o=null!=r.randomizeStartSeed?r.randomizeStartSeed:i,s=a(c,o);l=e(s*n(t))}else l=e(0);return new h(t,l,d,f)}function f(e,r,i,a){const n=null==r.playAnimation||r.playAnimation,o=c(e,r,i,a);let s,m=o.timeToFrame;function u(){s=n?setTimeout((()=>{o.nextFrame(),m=o.timeToFrame,u()}),m):void 0}return u(),t((()=>n&&clearTimeout(s)))}let l,d;function g(){return l??=document.createElement(\"canvas\"),d??=l.getContext(\"2d\"),{canvas:l,ctx:d}}function F(t,e,i){const{canvas:a,ctx:n}=g();a.width=e,a.height=i;const o=[],s=t.frameDurations.length;for(let m=0;m<s;m++){const a=t.getFrame(m);n.clearRect(0,0,e,i),a instanceof ImageData?n.drawImage(r(a),0,0,e,i):n.drawImage(a,0,0,e,i),o.push(n.getImageData(0,0,e,i))}return{width:e,height:i,frameDurations:t.frameDurations,getFrame:t=>o[t],frameCount:t.frameCount,duration:t.duration}}export{h as Player,s as adjustDuration,u as appendDelay,c as createPlayer,n as getDuration,f as play,m as prependDelay,F as resize,o as reverse};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{PixelFormat as t,PixelType as e,TextureWrapMode as s,TextureSamplingMode as r}from\"../../../../../webgl/enums.js\";import{Texture as o}from\"../../../../../webgl/Texture.js\";import{TextureDescriptor as i}from\"../../../../../webgl/TextureDescriptor.js\";import{ValidatedTextureDescriptor as n}from\"../../../../../webgl/ValidatedTextureDescriptor.js\";class h{constructor(){this._entries=new l,this._nodes=new Map,this._book=new a}add(t){let e=this._entries.get(t);if(!e){const s=this._book.add(t),r=new Object;e={location:s,references:0,handle:r};const o=this._entries.set(t,e);this._nodes.set(r,o)}return e.references++,e}remove(t){const e=this._nodes.get(t.handle);e&&e.payload&&(e.payload.references--,0===e.payload.references&&(this._book.remove(e.payload.location),this._entries.delete(e),this._nodes.delete(t.handle)))}getTexture(t,e){return this._book.getTexture(t,e)}destroy(){this._book.destroy()}}class u{constructor(t,e){this.parent=t,this.key=e,this.payload=null,this._children=new Map}get(t){return this._children.get(t)}ensure(t){let e=this._children.get(t);return e||(e=new u(this,t),this._children.set(t,e)),e}delete(t){this._children.delete(t)}}class l{constructor(){this._root=new u(null,NaN)}set(t,e){let s=this._root;for(const r of t)for(const t of r)s=s.ensure(t);return s.payload=e,s}delete(t){t.parent?.delete(t.key)}get(t){let e=this._root;for(const s of t)for(const t of s){const s=e.get(t);if(!s)return;e=s}return e.payload||void 0}}class a{constructor(){this._pages=[]}add(t){0===this._pages.length&&this._pages.push(new _);let e=this._pages.length-1,s=this._pages[e].add(t);if(s||(this._pages.push(new _),e=this._pages.length-1,s=this._pages[e].add(t)),!s)throw new Error(\"Data allocation failed.\");return{...s,page:e}}remove(t){this._pages[t.page].remove(t)}getTexture(t,e){return this._pages[e].getTexture(t)}destroy(){}}class _{constructor(){this._cursor={row:0,column:0},this._columns=1024,this._rows=1024,this._data=new Float32Array(this._columns*this._rows*4),this._texture=null,this._textureCursor={row:0,column:0}}add(t){if(t.length>this._columns)throw new Error(`The maximum allocation size is ${this._columns} texels.`);const e={...this._cursor};if(e.column+=t.length,e.column>=this._columns&&(e.column=t.length,e.row++),e.row>=this._rows)return null;this._cursor=e;const s={...this._cursor};s.column-=t.length;let r=4*(s.row*this._columns+s.column);for(let o=0;o<t.length;o++)this._data[r++]=t[o][0],this._data[r++]=t[o][1],this._data[r++]=t[o][2],this._data[r++]=t[o][3];return s}remove(t){}getTexture(h){if(!this._texture){const u=new i(this._columns,this._rows);u.pixelFormat=t.RGBA,u.dataType=e.FLOAT,u.wrapMode=s.CLAMP_TO_EDGE,u.samplingMode=r.NEAREST,u.hasMipmap=!1;const l=new n(h,u);this._texture=new o(h,l)}if(this._cursor.row===this._textureCursor.row&&this._cursor.column===this._textureCursor.column)return this._texture;const u=this._textureCursor.row,l=this._cursor.row-u+1;return this._texture.updateData(0,0,u,this._columns,l,this._data,u),this._textureCursor.row=this._cursor.row,this._textureCursor.column=this._cursor.column,this._texture}destroy(){this._texture?.dispose()}}export{h as AnimationStore,l as PrefixMap};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{WGLDrawPhase as e}from\"../enums.js\";import{BlendTechnique as n}from\"../shaderGraph/techniques/blend/BlendTechnique.js\";class s{constructor(){this._blendTechnique=new n}dispose(e){this._blendTechnique?.shutdown()}draw(n,s,o,r,d){const{drawPhase:i}=n;i!==e.LABEL&&i!==e.LABEL_ALPHA&&this._blendTechnique.render(n,{colorTexture:s,config:{opacity:d,samplingMode:o},blendMode:r})}}export{s as BlendEffect};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass t{constructor(){this.name=this.constructor.name}createOptions(t,r){return null}}export{t as Effect};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{Effect as e}from\"./Effect.js\";import{TextureSamplingMode as t}from\"../../../../webgl/enums.js\";class s extends e{constructor(e){super(),this.name=this.constructor.name,this.defines=[e]}dispose(){}bind({context:e,painter:t}){this._prev=e.getBoundFramebufferObject();const s=t.getFbos().effect0;e.bindFramebuffer(s),e.setColorMask(!0,!0,!0,!0),e.setClearColor(0,0,0,0),e.clear(e.gl.COLOR_BUFFER_BIT)}unbind(){}draw(e,s){const{context:r,painter:o}=e,n=o.getPostProcessingEffects(s),c=r.getBoundFramebufferObject();for(const{postProcessingEffect:t,effect:f}of n)t.draw(e,c,f);r.bindFramebuffer(this._prev),r.setStencilTestEnabled(!1),o.blitTexture(r,c.colorTexture,t.NEAREST),r.setStencilTestEnabled(!0)}}export{s as FeatureEffect};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../../../../../core/has.js\";import{BitBlitRenderer as e}from\"../BitBlitRenderer.js\";import{Effect as t}from\"./Effect.js\";import s from\"./highlight/HighlightRenderer.js\";import r from\"./highlight/HighlightSurfaces.js\";import{TextureSamplingMode as i}from\"../../../../webgl/enums.js\";const h=4,d=4/h;class l extends t{constructor(){super(...arguments),this.defines=[\"highlight\"],this._hlRenderer=new s,this._width=void 0,this._height=void 0,this._boundFBO=null,this._hlSurfaces=new r,this._adjustedWidth=void 0,this._adjustedHeight=void 0,this._blitRenderer=new e}dispose(){this._hlSurfaces?.dispose(),this._hlRenderer?.dispose(),this._boundFBO=null}bind(e){const{context:t,painter:s}=e,{width:r,height:i}=t.getViewport(),h=s.getFbos().effect0;this.setup(e,r,i),t.bindFramebuffer(h),t.setColorMask(!0,!0,!0,!0),t.setClearColor(0,0,0,0),t.clear(t.gl.COLOR_BUFFER_BIT)}unbind(){}setup({context:e},t,s){this._width=t,this._height=s;const r=t%h,i=s%h;t+=r<h/2?-r:h-r,s+=i<h/2?-i:h-i,this._adjustedWidth=t,this._adjustedHeight=s,this._boundFBO=e.getBoundFramebufferObject();const l=Math.round(t*d),o=Math.round(s*d);this._hlRenderer.setup(e,l,o),this._hlSurfaces.setup(e,l,o)}draw(e){const{context:t,passOptions:s}=e,r=s.activeGradient,h=t.getBoundFramebufferObject();t.setViewport(0,0,this._adjustedWidth*d,this._adjustedHeight*d),t.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),t.setStencilTestEnabled(!1),t.setClearColor(0,0,0,0),t.clear(t.gl.COLOR_BUFFER_BIT),this._blitRenderer.render(t,h.colorTexture,i.NEAREST,1),t.setStencilTestEnabled(!1),t.setBlendingEnabled(!1),t.setColorMask(!1,!1,!1,!0),t.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo),t.setClearColor(0,0,0,0),t.clear(t.gl.COLOR_BUFFER_BIT),this._hlRenderer.preBlur(t,this._hlSurfaces.sharedBlur1Tex),t.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),t.setClearColor(0,0,0,0),t.clear(t.gl.COLOR_BUFFER_BIT),this._hlRenderer.finalBlur(t,this._hlSurfaces.sharedBlur2Tex),t.bindFramebuffer(this._boundFBO),t.setBlendingEnabled(!0),t.setColorMask(!0,!0,!0,!0),t.setViewport(0,0,this._width,this._height),this._hlRenderer.renderHighlight(t,this._hlSurfaces.sharedBlur1Tex,r),this._boundFBO=null}}export{l as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport has from\"../../../../../core/has.js\";import{AttributeDataType as t,hittestToleranceMobile as e,hittestToleranceDesktop as s,hittestToleranceSmallSymbol as i,hittestSmallSymbolThreshold as o}from\"../definitions.js\";import{Effect as r}from\"./Effect.js\";import{PixelFormat as n,PixelType as l}from\"../../../../webgl/enums.js\";class c extends r{constructor(){super(...arguments),this.name=this.constructor.name,this.defines=[\"hittest\"]}dispose(){null!=this._fbo&&this._fbo.dispose()}createOptions({pixelRatio:t},r){if(!r.length)return null;const n=r.shift(),l=n.x,c=n.y;this._outstanding=n;const a=has(\"esri-mobile\");return{type:\"hittest\",distance:(a?e:s)*t,smallSymbolDistance:(a?e:i)*t,smallSymbolSizeThreshold:o,position:[l,c]}}bind(e){const{context:s,attributeView:i}=e;if(!i.size)return;const o=i.getBlock(t.GPGPU);if(null==o)return;const r=o.getFBO(s);s.setViewport(0,0,i.size,i.size),s.bindFramebuffer(r),s.setColorMask(!0,!0,!0,!0),s.setClearColor(0,0,0,0),s.clear(s.gl.COLOR_BUFFER_BIT|s.gl.DEPTH_BUFFER_BIT)}unbind(){}draw(t){if(null==this._outstanding)return;const e=this._outstanding;this._outstanding=null,this._resolve(t,e.resolvers)}async _resolve(e,s){const{context:i,attributeView:o}=e,r=o.getBlock(t.GPGPU);if(null==r)return void s.forEach((t=>t.resolve([])));const c=r.getFBO(i),a=new Uint8Array(c.width*c.height*4);try{await c.readPixelsAsync(0,0,c.width,c.height,n.RGBA,l.UNSIGNED_BYTE,a)}catch(u){return void s.forEach((t=>t.resolve([])))}const h=[];for(let t=0;t<a.length;t+=4){const e=t/4;a[t]&&h.push(e)}s.forEach((t=>t.resolve(h)))}}export{c as HittestEffect};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{textureBindingHighlight0 as r,textureBindingHighlight1 as e}from\"../../definitions.js\";import{alphaToRgbaChannelSelectorMatrix as s,rgbaToRgbaChannelSelectorMatrix as i,sigma as t}from\"./parameters.js\";import{highlight as o,blur as u}from\"../../shaders/HighlightPrograms.js\";import{BufferObject as a}from\"../../../../../webgl/BufferObject.js\";import{PrimitiveType as h,BlendFactor as m,Usage as n,DataType as _}from\"../../../../../webgl/enums.js\";import{createProgram as g}from\"../../../../../webgl/ProgramTemplate.js\";import{VertexArrayObject as d}from\"../../../../../webgl/VertexArrayObject.js\";import{VertexElementDescriptor as l}from\"../../../../../webgl/VertexElementDescriptor.js\";class c{constructor(){this._width=void 0,this._height=void 0,this._resources=null}dispose(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)}preBlur(e,i){e.bindTexture(i,r),e.useProgram(this._resources.blurProgram),this._resources.blurProgram.setUniform4fv(\"u_direction\",[1,0,1/this._width,0]),this._resources.blurProgram.setUniformMatrix4fv(\"u_channelSelector\",s),e.bindVAO(this._resources.quadVAO),e.drawArrays(h.TRIANGLE_STRIP,0,4),e.bindVAO()}finalBlur(e,s){e.bindTexture(s,r),e.useProgram(this._resources.blurProgram),this._resources.blurProgram.setUniform4fv(\"u_direction\",[0,1,0,1/this._height]),this._resources.blurProgram.setUniformMatrix4fv(\"u_channelSelector\",i),e.bindVAO(this._resources.quadVAO),e.drawArrays(h.TRIANGLE_STRIP,0,4),e.bindVAO()}renderHighlight(e,s,i){e.bindTexture(s,r),e.useProgram(this._resources.highlightProgram),i.applyHighlightOptions(e,this._resources.highlightProgram),e.bindVAO(this._resources.quadVAO),e.setBlendingEnabled(!0),e.setBlendFunction(m.ONE,m.ONE_MINUS_SRC_ALPHA),e.drawArrays(h.TRIANGLE_STRIP,0,4),e.bindVAO()}_initialize(s,i,h){this._width=i,this._height=h;const m=a.createVertex(s,n.STATIC_DRAW,new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]).buffer),c=new d(s,new Map([[\"a_position\",0],[\"a_texcoord\",1]]),new Map([[\"geometry\",[new l(\"a_position\",2,_.BYTE,0,4),new l(\"a_texcoord\",2,_.UNSIGNED_BYTE,2,4)]]]),new Map([[\"geometry\",m]])),f=g(s,o),b=g(s,u);s.useProgram(f),f.setUniform1i(\"u_texture\",r),f.setUniform1i(\"u_shade\",e),f.setUniform1f(\"u_sigma\",t),s.useProgram(b),b.setUniform1i(\"u_texture\",r),b.setUniform1f(\"u_sigma\",t),this._resources={quadGeometry:m,quadVAO:c,highlightProgram:f,blurProgram:b}}setup(r,e,s){this._resources?(this._width=e,this._height=s):this._initialize(r,e,s)}}export{c as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{TextureWrapMode as r,RenderbufferFormat as e}from\"../../../../../webgl/enums.js\";import{FramebufferObject as s}from\"../../../../../webgl/FramebufferObject.js\";import{RenderbufferDescriptor as t}from\"../../../../../webgl/RenderbufferDescriptor.js\";import{TextureDescriptor as o}from\"../../../../../webgl/TextureDescriptor.js\";function i(i,h,u){const l=new o(h,u);return l.wrapMode=r.CLAMP_TO_EDGE,new s(i,l,new t(e.STENCIL_INDEX8,h,u))}class h{constructor(){this._width=void 0,this._height=void 0,this._resources=null}dispose(){this._resources&&(this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=null)}_initialize(r,e,s){this._width=e,this._height=s;const t=i(r,e,s),o=i(r,e,s);this._resources={sharedBlur1Fbo:t,sharedBlur2Fbo:o}}setup(r,e,s){!this._resources||this._width===e&&this._height===s||this.dispose(),this._resources||this._initialize(r,e,s)}get sharedBlur1Tex(){return this._resources.sharedBlur1Fbo.colorTexture}get sharedBlur1Fbo(){return this._resources.sharedBlur1Fbo}get sharedBlur2Tex(){return this._resources.sharedBlur2Fbo.colorTexture}get sharedBlur2Fbo(){return this._resources.sharedBlur2Fbo}}export{h as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{disposeMaybe as t}from\"../../../../../../core/maybe.js\";import e from\"../../VertexStream.js\";import{BlendFactor as s,PixelFormat as i,TextureWrapMode as r}from\"../../../../../webgl/enums.js\";import{FramebufferObject as o}from\"../../../../../webgl/FramebufferObject.js\";import{TextureDescriptor as n}from\"../../../../../webgl/TextureDescriptor.js\";const a=5,u=[1,0],l=[0,1],m=[1,.8,.6,.4,.2],_=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];class h{constructor(){this._intensityFBO=null,this._compositeFBO=null,this._mipsFBOs=new Array(a),this._nMips=a,this._kernelSizeArray=[3,5,7,9,11],this._size=[0,0],this._programDesc={luminosityHighPass:{vsPath:\"post-processing/pp\",fsPath:\"post-processing/bloom/luminosityHighPass\",attributes:new Map([[\"a_position\",0]])},gaussianBlur:{vsPath:\"post-processing/pp\",fsPath:\"post-processing/bloom/gaussianBlur\",attributes:new Map([[\"a_position\",0]])},composite:{vsPath:\"post-processing/pp\",fsPath:\"post-processing/bloom/composite\",attributes:new Map([[\"a_position\",0]])},blit:{vsPath:\"post-processing/pp\",fsPath:\"post-processing/blit\",attributes:new Map([[\"a_position\",0]])}}}dispose(){if(this._quad=t(this._quad),this._intensityFBO=t(this._intensityFBO),this._compositeFBO=t(this._compositeFBO),this._mipsFBOs){for(let t=0;t<this._nMips;t++)this._mipsFBOs[t]&&(this._mipsFBOs[t].horizontal.dispose(),this._mipsFBOs[t].vertical.dispose());this._mipsFBOs=null}}draw(t,i,r){const{width:o,height:n}=i,{context:h,painter:p}=t,{materialManager:c}=p,d=h.gl,f=this._programDesc,{strength:b,radius:F,threshold:O}=r;this._quad||(this._quad=new e(h,[-1,-1,1,-1,-1,1,1,1])),this._createOrResizeResources(t,o,n),h.setStencilTestEnabled(!1),h.setBlendingEnabled(!0),h.setBlendFunction(s.ONE,s.ONE_MINUS_SRC_ALPHA),h.setStencilWriteMask(0);const B=this._quad;B.bind(),h.bindFramebuffer(this._intensityFBO);const g=c.getProgram(f.luminosityHighPass);h.useProgram(g),h.bindTexture(i.colorTexture,0),g.setUniform1i(\"u_texture\",0),g.setUniform3fv(\"u_defaultColor\",[0,0,0]),g.setUniform1f(\"u_defaultOpacity\",0),g.setUniform1f(\"u_luminosityThreshold\",O),g.setUniform1f(\"u_smoothWidth\",.01);const T=[Math.round(o/2),Math.round(n/2)];h.setViewport(0,0,T[0],T[1]),h.setClearColor(0,0,0,0),h.clear(d.COLOR_BUFFER_BIT),B.draw(),h.setBlendingEnabled(!1);let x=this._intensityFBO.colorTexture;for(let e=0;e<this._nMips;e++){const t=c.getProgram(f.gaussianBlur,[{name:\"radius\",value:this._kernelSizeArray[e]}]);h.useProgram(t),h.bindTexture(x,e+1),t.setUniform1i(\"u_colorTexture\",e+1),t.setUniform2fv(\"u_texSize\",T),t.setUniform2fv(\"u_direction\",u),h.setViewport(0,0,T[0],T[1]);const s=this._mipsFBOs[e];h.bindFramebuffer(s.horizontal),B.draw(),x=s.horizontal.colorTexture,h.bindFramebuffer(s.vertical),h.bindTexture(x,e+1),t.setUniform2fv(\"u_direction\",l),B.draw(),x=s.vertical.colorTexture,T[0]=Math.round(T[0]/2),T[1]=Math.round(T[1]/2)}h.setViewport(0,0,o,n);const w=c.getProgram(f.composite,[{name:\"nummips\",value:a}]);h.bindFramebuffer(this._compositeFBO),h.useProgram(w),w.setUniform1f(\"u_bloomStrength\",b),w.setUniform1f(\"u_bloomRadius\",F),w.setUniform1fv(\"u_bloomFactors\",m),w.setUniform3fv(\"u_bloomTintColors\",_),h.bindTexture(this._mipsFBOs[0].vertical.colorTexture,1),w.setUniform1i(\"u_blurTexture1\",1),h.bindTexture(this._mipsFBOs[1].vertical.colorTexture,2),w.setUniform1i(\"u_blurTexture2\",2),h.bindTexture(this._mipsFBOs[2].vertical.colorTexture,3),w.setUniform1i(\"u_blurTexture3\",3),h.bindTexture(this._mipsFBOs[3].vertical.colorTexture,4),w.setUniform1i(\"u_blurTexture4\",4),h.bindTexture(this._mipsFBOs[4].vertical.colorTexture,5),w.setUniform1i(\"u_blurTexture5\",5),B.draw(),h.bindFramebuffer(i),h.setBlendingEnabled(!0);const M=c.getProgram(f.blit);h.useProgram(M),h.bindTexture(this._compositeFBO.colorTexture,6),M.setUniform1i(\"u_texture\",6),h.setBlendFunction(s.ONE,s.ONE),B.draw(),B.unbind(),h.setBlendFunction(s.ONE,s.ONE_MINUS_SRC_ALPHA),h.setStencilTestEnabled(!0)}_createOrResizeResources(t,e,s){const{context:a}=t;if(this._compositeFBO&&this._size[0]===e&&this._size[1]===s)return;this._size[0]=e,this._size[1]=s;const u=[Math.round(e/2),Math.round(s/2)];if(this._compositeFBO)this._compositeFBO.resize(e,s);else{const t=new n(e,s);t.internalFormat=i.RGBA,t.wrapMode=r.CLAMP_TO_EDGE,this._compositeFBO=new o(a,t)}if(this._intensityFBO)this._intensityFBO.resize(u[0],u[1]);else{const t=new n(u[0],u[1]);t.internalFormat=i.RGBA,t.wrapMode=r.CLAMP_TO_EDGE,this._intensityFBO=new o(a,t)}for(let l=0;l<this._nMips;l++){if(this._mipsFBOs[l])this._mipsFBOs[l].horizontal.resize(u[0],u[1]),this._mipsFBOs[l].vertical.resize(u[0],u[1]);else{const t=new n(u[0],u[1]);t.internalFormat=i.RGBA,t.wrapMode=r.CLAMP_TO_EDGE,this._mipsFBOs[l]={horizontal:new o(a,t),vertical:new o(a,t)}}u[0]=Math.round(u[0]/2),u[1]=Math.round(u[1]/2)}}}export{h as Bloom};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../VertexStream.js\";import{BlendFactor as t,PixelFormat as s,TextureWrapMode as r}from\"../../../../../webgl/enums.js\";import{FramebufferObject as i}from\"../../../../../webgl/FramebufferObject.js\";import{TextureDescriptor as a}from\"../../../../../webgl/TextureDescriptor.js\";const n=[1,0],o=[0,1];class u{constructor(){this._blurFBO=null,this._size=[0,0],this._programDesc={gaussianBlur:{vsPath:\"post-processing/pp\",fsPath:\"post-processing/blur/gaussianBlur\",attributes:new Map([[\"a_position\",0]])},radialBlur:{vsPath:\"post-processing/pp\",fsPath:\"post-processing/blur/radial-blur\",attributes:new Map([[\"a_position\",0]])},blit:{vsPath:\"post-processing/pp\",fsPath:\"post-processing/blit\",attributes:new Map([[\"a_position\",0]])}}}dispose(){this._blurFBO&&(this._blurFBO.dispose(),this._blurFBO=null)}draw(t,s,r){const{context:i}=t,{type:a,radius:n}=r;if(0===n)return;this._createOrResizeResources(t),this._quad||(this._quad=new e(i,[-1,-1,1,-1,-1,1,1,1]));const o=this._quad;o.bind(),\"blur\"===a?this._gaussianBlur(t,s,n):this._radialBlur(t,s),o.unbind()}_gaussianBlur(e,s,r){const{context:i,state:a,painter:u,pixelRatio:l}=e,{size:d}=a,{materialManager:b}=u,c=this._programDesc,_=this._quad,p=[Math.round(l*d[0]),Math.round(l*d[1])],h=this._blurFBO,m=b.getProgram(c.gaussianBlur,[{name:\"radius\",value:Math.ceil(r)}]);i.useProgram(m),i.setBlendingEnabled(!1),i.bindFramebuffer(h),i.bindTexture(s.colorTexture,4),m.setUniform1i(\"u_colorTexture\",4),m.setUniform2fv(\"u_texSize\",p),m.setUniform2fv(\"u_direction\",n),m.setUniform1f(\"u_sigma\",r),_.draw(),i.bindFramebuffer(s),i.setStencilWriteMask(0),i.setStencilTestEnabled(!1),i.setDepthWriteEnabled(!1),i.setDepthTestEnabled(!1),i.bindTexture(h?.colorTexture,5),m.setUniform1i(\"u_colorTexture\",5),m.setUniform2fv(\"u_direction\",o),_.draw(),i.setBlendingEnabled(!0),i.setBlendFunction(t.ONE,t.ONE_MINUS_SRC_ALPHA),i.setStencilTestEnabled(!0)}_radialBlur(e,s){const{context:r,painter:i}=e,{materialManager:a}=i,n=this._programDesc,o=this._quad,u=this._blurFBO;r.bindFramebuffer(u);const l=a.getProgram(n.radialBlur);r.useProgram(l),r.setBlendingEnabled(!1),r.bindTexture(s.colorTexture,4),l.setUniform1i(\"u_colorTexture\",4),o.draw(),r.bindFramebuffer(s),r.setStencilWriteMask(0),r.setStencilTestEnabled(!1),r.setDepthWriteEnabled(!1),r.setDepthTestEnabled(!1),r.setBlendingEnabled(!0);const d=a.getProgram(n.blit);r.useProgram(d),r.bindTexture(u?.colorTexture,5),d.setUniform1i(\"u_texture\",5),r.setBlendFunction(t.ONE,t.ONE_MINUS_SRC_ALPHA),o.draw()}_createOrResizeResources(e){const{context:t,state:n,pixelRatio:o}=e,{size:u}=n,l=Math.round(o*u[0]),d=Math.round(o*u[1]);if(!this._blurFBO||this._size[0]!==l||this._size[1]!==d)if(this._size[0]=l,this._size[1]=d,this._blurFBO)this._blurFBO.resize(l,d);else{const e=new a(l,d);e.internalFormat=s.RGBA,e.wrapMode=r.CLAMP_TO_EDGE,this._blurFBO=new i(t,e)}}}export{u as Blur};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{disposeMaybe as e}from\"../../../../../../core/maybe.js\";import t from\"../../VertexStream.js\";import{BlendFactor as r,PixelFormat as s,TextureWrapMode as i}from\"../../../../../webgl/enums.js\";import{Texture as o}from\"../../../../../webgl/Texture.js\";import{TextureDescriptor as a}from\"../../../../../webgl/TextureDescriptor.js\";class n{constructor(){this._layerFBOTexture=null,this._size=[0,0],this._programDesc={vsPath:\"post-processing/pp\",fsPath:\"post-processing/filterEffect\",attributes:new Map([[\"a_position\",0]])}}dispose(){this._layerFBOTexture=e(this._layerFBOTexture)}draw(e,t,s){const{width:i,height:o}=t;this._createOrResizeResources(e,i,o);const{context:a,painter:n}=e,{materialManager:c}=n,l=this._programDesc,u=this._quad,_=s.colorMatrix;u.bind();const h=this._layerFBOTexture;a.bindFramebuffer(t),t.copyToTexture(0,0,i,o,0,0,h),a.setBlendingEnabled(!1),a.setStencilTestEnabled(!1);const m=c.getProgram(l);a.useProgram(m),a.bindTexture(h,2),m.setUniformMatrix4fv(\"u_coefficients\",_),m.setUniform1i(\"u_colorTexture\",2),u.draw(),a.setBlendingEnabled(!0),a.setBlendFunction(r.ONE,r.ONE_MINUS_SRC_ALPHA),a.setStencilTestEnabled(!0),u.unbind()}_createOrResizeResources(e,r,n){const{context:c}=e;if(!this._layerFBOTexture||this._size[0]!==r||this._size[1]!==n){if(this._size[0]=r,this._size[1]=n,this._layerFBOTexture)this._layerFBOTexture.resize(r,n);else{const e=new a;e.internalFormat=s.RGBA,e.wrapMode=i.CLAMP_TO_EDGE,e.width=r,e.height=n,this._layerFBOTexture=new o(c,e)}this._quad||(this._quad=new t(c,[-1,-1,1,-1,-1,1,1,1]))}}}export{n as Colorize};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{disposeMaybe as e}from\"../../../../../../core/maybe.js\";import{pt2px as t}from\"../../../../../../core/screenUtils.js\";import r from\"../../VertexStream.js\";import{BlendFactor as s,PixelFormat as i,TextureWrapMode as o}from\"../../../../../webgl/enums.js\";import{FramebufferObject as a}from\"../../../../../webgl/FramebufferObject.js\";import{Texture as n}from\"../../../../../webgl/Texture.js\";import{TextureDescriptor as l}from\"../../../../../webgl/TextureDescriptor.js\";const u=[1,0],h=[0,1];class _{constructor(){this._layerFBOTexture=null,this._horizontalBlurFBO=null,this._verticalBlurFBO=null,this._size=[0,0],this._quad=null,this._programDesc={blur:{vsPath:\"post-processing/pp\",fsPath:\"post-processing/blur/gaussianBlur\",attributes:new Map([[\"a_position\",0]])},composite:{vsPath:\"post-processing/pp\",fsPath:\"post-processing/drop-shadow/composite\",attributes:new Map([[\"a_position\",0]])},blit:{vsPath:\"post-processing/pp\",fsPath:\"post-processing/blit\",attributes:new Map([[\"a_position\",0]])}}}dispose(){this._layerFBOTexture=e(this._layerFBOTexture),this._horizontalBlurFBO=e(this._horizontalBlurFBO),this._verticalBlurFBO=e(this._verticalBlurFBO)}draw(e,i,o){const{context:a,state:n,painter:l}=e,{materialManager:_}=l,c=this._programDesc,p=i.width,m=i.height,f=[Math.round(p),Math.round(m)],{blurRadius:B,offsetX:d,offsetY:b,color:O}=o,F=[t(d),t(b)];this._createOrResizeResources(e,p,m,f);const w=this._horizontalBlurFBO,T=this._verticalBlurFBO;a.setStencilWriteMask(0),a.setStencilTestEnabled(!1),a.setDepthWriteEnabled(!1),a.setDepthTestEnabled(!1);const x=this._layerFBOTexture;i.copyToTexture(0,0,p,m,0,0,x),this._quad||(this._quad=new r(a,[-1,-1,1,-1,-1,1,1,1])),a.setViewport(0,0,f[0],f[1]);const g=this._quad;g.bind(),a.setBlendingEnabled(!1);const z=_.getProgram(c.blur,[{name:\"radius\",value:Math.ceil(B)}]);a.useProgram(z),a.bindFramebuffer(w),a.bindTexture(i.colorTexture,4),z.setUniform1i(\"u_colorTexture\",4),z.setUniform2fv(\"u_texSize\",f),z.setUniform2fv(\"u_direction\",u),z.setUniform1f(\"u_sigma\",B),g.draw(),a.bindFramebuffer(T),a.bindTexture(w?.colorTexture,5),z.setUniform1i(\"u_colorTexture\",5),z.setUniform2fv(\"u_direction\",h),g.draw(),a.bindFramebuffer(i),a.setViewport(0,0,p,m);const M=_.getProgram(c.composite);a.useProgram(M),a.bindTexture(T?.colorTexture,2),M.setUniform1i(\"u_blurTexture\",2),a.bindTexture(x,3),M.setUniform1i(\"u_layerFBOTexture\",3),M.setUniform4fv(\"u_shadowColor\",[O[3]*(O[0]/255),O[3]*(O[1]/255),O[3]*(O[2]/255),O[3]]),M.setUniformMatrix3fv(\"u_displayViewMat3\",n.displayMat3),M.setUniform2fv(\"u_shadowOffset\",F),g.draw(),a.setBlendingEnabled(!0),a.setStencilTestEnabled(!0),a.setBlendFunction(s.ONE,s.ONE_MINUS_SRC_ALPHA),g.unbind()}_createOrResizeResources(e,t,r,s){const{context:u}=e;if(!this._horizontalBlurFBO||this._size[0]!==t||this._size[1]!==r){if(this._size[0]=t,this._size[1]=r,this._horizontalBlurFBO)this._horizontalBlurFBO.resize(s[0],s[1]);else{const e=new l(s[0],s[1]);e.internalFormat=i.RGBA,e.wrapMode=o.CLAMP_TO_EDGE,this._horizontalBlurFBO=new a(u,e)}if(this._verticalBlurFBO)this._verticalBlurFBO.resize(s[0],s[1]);else{const e=new l(s[0],s[1]);e.internalFormat=i.RGBA,e.wrapMode=o.CLAMP_TO_EDGE,this._verticalBlurFBO=new a(u,e)}if(this._layerFBOTexture)this._layerFBOTexture.resize(t,r);else{const e=new l;e.internalFormat=i.RGBA,e.wrapMode=o.CLAMP_TO_EDGE,e.width=t,e.height=r,this._layerFBOTexture=new n(u,e)}}}}export{_ as DropShadow};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{Bloom as o}from\"./Bloom.js\";import{Blur as e}from\"./Blur.js\";import{Colorize as t}from\"./Colorize.js\";import{DropShadow as s}from\"./DropShadow.js\";import{Opacity as r}from\"./Opacity.js\";function c(o){switch(o){case\"bloom\":case\"blur\":case\"opacity\":case\"drop-shadow\":return o;default:return\"colorize\"}}const f={colorize:()=>new t,blur:()=>new e,bloom:()=>new o,opacity:()=>new r,\"drop-shadow\":()=>new s};class i{constructor(){this._effectMap=new Map}dispose(){this._effectMap.forEach((o=>o.dispose())),this._effectMap.clear()}getPostProcessingEffects(o){if(!o||0===o.length)return[];const e=[];for(const t of o){const o=c(t.type);let s=this._effectMap.get(o);s||(s=f[o](),this._effectMap.set(o,s)),e.push({postProcessingEffect:s,effect:t})}return e}}export{i as EffectManager};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{disposeMaybe as e}from\"../../../../../../core/maybe.js\";import{TextureSamplingMode as t,PixelFormat as r,TextureWrapMode as s}from\"../../../../../webgl/enums.js\";import{Texture as i}from\"../../../../../webgl/Texture.js\";import{TextureDescriptor as o}from\"../../../../../webgl/TextureDescriptor.js\";class l{constructor(){this._size=[0,0],this._layerFBOTexture=null}dispose(){this._layerFBOTexture=e(this._layerFBOTexture)}draw(e,r,s){const{width:i,height:o}=r;this._createOrResizeResources(e,i,o);const{context:l,painter:a}=e,{amount:n}=s,h=l.gl,u=this._layerFBOTexture;l.bindFramebuffer(r),r.copyToTexture(0,0,i,o,0,0,u),l.setBlendingEnabled(!0),l.setStencilTestEnabled(!1),l.setDepthTestEnabled(!1),l.setClearColor(0,0,0,0),l.clear(h.COLOR_BUFFER_BIT),a.blitTexture(l,u,t.NEAREST,n)}_createOrResizeResources(e,l,a){const{context:n}=e;if(!this._layerFBOTexture||this._size[0]!==l||this._size[1]!==a)if(this._size[0]=l,this._size[1]=a,this._layerFBOTexture)this._layerFBOTexture.resize(l,a);else{const e=new o;e.internalFormat=r.RGBA,e.wrapMode=s.CLAMP_TO_EDGE,e.samplingMode=t.NEAREST,e.width=l,e.height=a,this._layerFBOTexture=new i(n,e)}}}export{l as Opacity};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{isArrayLike as e}from\"../../../../../core/arrayUtils.js\";import{WGLDrawPhase as r}from\"../enums.js\";class t{constructor(e,t){this.brushes=e,this.name=t.name,this.drawPhase=t.drawPhase||r.MAP,this._targetFn=t.target,this.effects=t.effects||[],this.enableDefaultDraw=t.enableDefaultDraw??(()=>!0),this.forceDrawByDisplayOrder=!!t.forceDrawByDisplayOrder}render(e){const{context:r,profiler:t}=e,s=this._targetFn(),a=this.drawPhase&e.drawPhase;if(t.recordPassStart(this.name),a){this.enableDefaultDraw()&&this._doRender(e,s),t.recordPassEnd();for(const t of this.effects){if(!t.enable())continue;const a=t.apply,n=t.args?.(),i=r.getViewport(),o=r.getBoundFramebufferObject(),d=e.passOptions;this._bindEffect(e,a,n),this._doRender(e,s,a.defines),this._drawAndUnbindEffect(e,a,i,o,d,n)}}}_doRender(e,r,t){if(null==r)return;const{profiler:s,context:a}=e;for(const n of this.brushes){if(s.recordBrushStart(n.name),null!=n.brushEffect){const s=a.getViewport(),i=a.getBoundFramebufferObject(),o=e.passOptions;this._bindEffect(e,n.brushEffect),this._drawWithBrush(n,e,r,t),this._drawAndUnbindEffect(e,n.brushEffect,s,i,o)}else this._drawWithBrush(n,e,r,t);s.recordBrushEnd()}}_drawWithBrush(r,t,s,a){e(s)?(r.prepareState(t,a),r.drawMany(t,s,a)):s.visible&&(r.prepareState(t,a),r.draw(t,s,a))}_bindEffect(e,r,t){const{profiler:s}=e;s.recordPassStart(this.name+\".\"+r.name),r.bind(e,t);const a=r.createOptions(e,t);e.passOptions=a}_drawAndUnbindEffect(e,r,t,s,a,n){const{profiler:i,context:o}=e;e.passOptions=a,i.recordBrushStart(r.name),r.draw(e,n),r.unbind(e,n),o.bindFramebuffer(s);const{x:d,y:f,width:h,height:c}=t;o.setViewport(d,f,h,c),i.recordBrushEnd(),i.recordPassEnd()}}export{t as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass r{constructor(){this._programCache=new Map}destroy(){for(const r of this._programCache.values())r.destroy();this._programCache.clear()}getProgram(r,e,t,a,o){const s=r.getShaderKey(e,t,a,o);let c=this._programCache.get(s);return c||(c=r.getProgram(e,t,a,o),this._programCache.set(s,c)),c}}export{r as TechniqueProgramCache};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{WGLDrawPhase as e}from\"../../../enums.js\";import{simplePipelineState as t}from\"../../utils.js\";import{Technique as r}from\"../Technique.js\";import{TechniqueType as s}from\"../TechniqueType.js\";import{BlendShader as i}from\"../shaders/BlendShader.js\";import{OpacityShader as u}from\"../shaders/OpacityShader.js\";import{BlendFactor as o,PixelFormat as n,TextureWrapMode as a}from\"../../../../../../webgl/enums.js\";import{Texture as c}from\"../../../../../../webgl/Texture.js\";import{TextureDescriptor as f}from\"../../../../../../webgl/TextureDescriptor.js\";class h extends r{constructor(){super(...arguments),this.type=s.Blend,this._backBufferTexture=null,this.shaders={blend:new i,opacity:new u}}shutdown(){super.shutdown(),null!==this._backBufferTexture&&(this._backBufferTexture.dispose(),this._backBufferTexture=null)}render(r,s){const{context:i,drawPhase:u,state:n,pixelRatio:a,inFadeTransition:c,painter:f}=r,{size:h}=n,l=i.getBoundFramebufferObject();let d,p;null!=l?(d=l.width,p=l.height):(d=Math.round(a*h[0]),p=Math.round(a*h[1]));const{blendMode:m}=s;if(\"normal\"===m&&u!==e.LABEL){const e={shader:this.shaders.opacity,uniforms:{config:{layerTexture:{texture:s.colorTexture,unit:0},opacity:s.config.opacity}},defines:null,optionalAttributes:null,useComputeBuffer:!1};return f.setPipelineState(t),void f.submitDrawMesh(i,e,f.quadMesh)}const x=this._createOrResizeTexture(r,d,p);l.copyToTexture(0,0,d,p,0,0,x);const b={color:{write:[!0,!0,!0,!0],blendMode:\"custom\",blendParameters:{srcRGB:o.ONE,dstRGB:o.ZERO,srcAlpha:o.ONE,dstAlpha:o.ZERO}},depth:!1,stencil:!1};f.setPipelineState(b);const T={backbufferTexture:{texture:x,unit:0},layerTexture:{texture:s.colorTexture,unit:1},inFadeOpacity:c?1:0,...s.config},B={shader:this.shaders.blend,uniforms:{config:T},defines:{blendMode:m},optionalAttributes:null,useComputeBuffer:!1};f.submitDrawMesh(i,B,f.quadMesh)}_createOrResizeTexture(e,t,r){const{context:s}=e;if(null!==this._backBufferTexture&&this._backBufferTexture.descriptor?.width===t&&this._backBufferTexture.descriptor?.height===r)return this._backBufferTexture;if(null===this._backBufferTexture){const e=new f;e.internalFormat=n.RGBA,e.wrapMode=a.CLAMP_TO_EDGE,e.width=t,e.height=r,this._backBufferTexture=new c(s,e)}else this._backBufferTexture.resize(t,r);return this._backBufferTexture}}export{h as BlendTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{simplePipelineState as e}from\"../../utils.js\";import{Technique as s}from\"../Technique.js\";import{TechniqueType as r}from\"../TechniqueType.js\";import{GridShader as t}from\"../shaders/GridShader.js\";class i extends s{constructor(){super(...arguments),this.type=r.Grid,this.shaders={grid:new t}}render(s,r){const{context:t,painter:i}=s;i.setPipelineState(e),i.submitDrawMesh(t,{shader:this.shaders.grid,uniforms:r,defines:null,optionalAttributes:null,useComputeBuffer:!1},i.quadMesh)}}export{i as GridTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{clamp as e}from\"../../../../../../../core/mathUtils.js\";import{disposeMaybe as t}from\"../../../../../../../core/maybe.js\";import{isSVG as i}from\"../../../../../../../core/urlUtils.js\";import{simplePipelineState as r}from\"../../utils.js\";import{Technique as s}from\"../Technique.js\";import{TechniqueType as o}from\"../TechniqueType.js\";import{MagnifierShader as a}from\"../shaders/MagnifierShader.js\";import{PixelFormat as n,TextureWrapMode as u,TextureSamplingMode as h}from\"../../../../../../webgl/enums.js\";import{Texture as p}from\"../../../../../../webgl/Texture.js\";import{TextureDescriptor as c}from\"../../../../../../webgl/TextureDescriptor.js\";class l extends s{constructor(){super(...arguments),this.type=o.Magnifier,this._resourcePixelRatio=1,this._position=[0,0,0,0],this.shaders={magnifier:new a}}updateResources(t,i,r,s){t.pixelRatio!==this._resourcePixelRatio&&this._destroyResources(),this._readbackTexture||this._initializeResources(t,i,r,s);const{context:o,pixelRatio:a}=t,{factor:n,offset:u,position:h}=s,{size:p}=t.state,c=s.size*a,l=1/n,m=Math.ceil(l*c);this._readbackTexture.resize(m,m);const x=a*p[0],d=a*p[1],_=.5*m,T=.5*m,f=e(a*h.x,_,x-_-1),g=e(d-a*h.y,T,d-T-1),R=f-_,w=g-T,b=this._readbackTexture;o.bindTexture(b,0),o.gl.copyTexImage2D(b.descriptor.target,0,b.descriptor.pixelFormat,R,w,m,m,0);const y=(f+u.x*a)/x*2-1,M=(g-u.y*a)/d*2-1,k=c/x*2,j=c/d*2;this._position[0]=y,this._position[1]=M,this._position[2]=k,this._position[3]=j}render(e,t){const{context:i,painter:s}=e;s.setPipelineState(r);const o={readbackTexture:{texture:this._readbackTexture,unit:0},maskTexture:{texture:this._maskTexture,unit:7},overlayTexture:{texture:this._overlayTexture,unit:6},drawPos:this._position,...t};s.submitDrawMesh(i,{shader:this.shaders.magnifier,uniforms:{config:o},defines:null,optionalAttributes:null,useComputeBuffer:!1},s.quadMesh)}shutdown(){this._destroyResources()}_initializeResources(e,t,r,s){const o=e.context;this._resourcePixelRatio=e.pixelRatio;const a=Math.ceil(s.size*e.pixelRatio);r.width=a,r.height=a;const l=new c;l.internalFormat=n.RGBA,l.wrapMode=u.CLAMP_TO_EDGE,l.samplingMode=h.NEAREST,l.flipped=!0,l.preMultiplyAlpha=!i(r.src)||!e.context.driverTest.svgPremultipliesAlpha.result,this._overlayTexture=new p(o,l,r),t.width=a,t.height=a,l.pixelFormat=l.internalFormat=n.ALPHA,this._maskTexture=new p(o,l,t);const m=1/s.factor;l.pixelFormat=l.internalFormat=n.RGBA,l.width=l.height=Math.ceil(m*a),l.samplingMode=h.LINEAR,l.flipped=!1,this._readbackTexture=new p(o,l)}_destroyResources(){t(this._maskTexture),t(this._overlayTexture),t(this._readbackTexture)}}export{l as MagnifierTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Handles.js\";import{deg2rad as t}from\"../../../core/mathUtils.js\";import{destroyMaybe as r}from\"../../../core/maybe.js\";import{watch as i,initial as s}from\"../../../core/reactiveUtils.js\";import{convertUnit as n}from\"../../../core/unitUtils.js\";import{fromRotation as o,translate as a,rotate as l,scaleByVec2 as m}from\"../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as c}from\"../../../core/libs/gl-matrix-2/factories/mat3f32.js\";import{set as h,sub as p,scale as d,rotate as u}from\"../../../core/libs/gl-matrix-2/math/vec2.js\";import{ZEROS as f}from\"../../../core/libs/gl-matrix-2/factories/vec2f32.js\";import{create as j}from\"../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{isLoadedOrLoadFor as _,project as g}from\"../../../geometry/projection.js\";import{getClosestDenormalizedXToReference as C}from\"../../../geometry/support/normalizeUtils.js\";import{getResolutionForScale as R}from\"../../../geometry/support/scaleUtils.js\";import{equals as v}from\"../../../geometry/support/spatialReferenceUtils.js\";import{DisplayObject as U}from\"../engine/DisplayObject.js\";import{WGLDrawPhase as y}from\"../engine/webgl/enums.js\";import{GridTechnique as S}from\"../engine/webgl/shaderGraph/techniques/grid/GridTechnique.js\";import{minimumPixelsPerStrideForDisplayWhenScalingOff as b}from\"./constants.js\";import{measureMetersPerUnitAtReferencePoint as L,getScaleFactor as P}from\"./gridUtils.js\";const x=j();class w extends U{constructor(){super(),this._handles=new e,this._projectedCenter=null,this._metersPerSRUnit=null,this._technique=new S,this._grid=null,this.visible=!0}destroy(){this._handles=r(this._handles),this._technique.shutdown()}get grid(){return this._grid}set grid(e){this._grid=e,this._handles.removeAll(),this._handles.add([i((()=>e?.center),(()=>{this._projectedCenter=null}),s),i((()=>[e?.center,e?.dynamicScaling,e?.majorLineColor,e?.majorLineInterval,e?.minorLineColor,e?.rotateWithMap,e?.rotation,e?.spacing,e?.units]),(()=>this.requestRender()),s)])}_createTransforms(){return{displayViewScreenMat3:c()}}doRender(e){if(e.drawPhase!==y.MAP||null==this.grid||!this.visible)return;const{spacing:t,units:r,majorLineInterval:i,dynamicScaling:s,majorLineColor:o,minorLineColor:a}=this.grid;if(0===t)return;if(this._updateDerivedValues(e),null==this._projectedCenter||null==this._metersPerSRUnit)return;const{scale:l,spatialReference:m}=e.state,c=n(t,r,\"meters\"),h=this._metersPerSRUnit*R(l,m),p=c/h;if(!s&&p<b)return;const d=c*P(i,p,s);this._updateTransform(e,h,d),this._technique.render(e,{transform:{dvs:this.transforms.displayViewScreenMat3},config:{pxPerCell:d/h,minorLineColor:q(a),majorLineColor:q(o),majorLineInterval:i,halfWidth:.25,aaWidth:.5}})}_updateDerivedValues(e){if(!this.grid)return;const{center:t}=this.grid,{spatialReference:r}=e.state;this._projectedCenter&&v(this._projectedCenter.spatialReference,r)||(this._metersPerSRUnit=null,v(t.spatialReference,r)?this._projectedCenter=t:_(t.spatialReference,r)?this._projectedCenter=g(t,r):this.requestRender()),null==this._metersPerSRUnit&&null!=this._projectedCenter&&(this._metersPerSRUnit=L(this._projectedCenter))}_updateTransform(e,r,i){const{grid:s}=this,{center:n,rotation:c,size:j,spatialReference:_}=e.state;if(null==s||null==this._projectedCenter||null==this._metersPerSRUnit)return;const g=r*(j[0]/2),R=r*(j[1]/2),v=this._metersPerSRUnit/i,U=this._projectedCenter,y=t(s.rotation),S=t(c),b=this.transforms.displayViewScreenMat3;o(b,-y);const L=_.isWrappable?C(U.x,n[0],_):U.x,P=h(x,L,U.y),w=p(x,n,P);d(w,w,v),s.rotateWithMap||u(w,w,f,-S),u(w,w,f,-y),d(w,w,1/s.majorLineInterval),M(w,w),d(w,w,s.majorLineInterval),u(w,w,f,y),a(b,b,w),s.rotateWithMap&&l(b,b,S);const q=h(x,g/i,R/i);m(b,b,q)}}function M(e,t){return e[0]=t[0]-Math.trunc(t[0]),e[1]=t[1]-Math.trunc(t[1]),e}function q(e){const[t,r,i,s]=e.toArray().map((e=>e/255));return[t*s,r*s,i*s,s]}export{w as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nconst o=50,t=5;export{t as minimumPixelsPerStrideForDisplayWhenScalingOff,o as pixelsPerCell};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../../../geometry.js\";import{getMetersPerUnitForSR as e}from\"../../../core/unitUtils.js\";import{isSupported as t,geodesicLengths as r}from\"../../../geometry/support/geodesicUtils.js\";import{straightLineDensify as o}from\"../../../geometry/support/normalizeUtils.js\";import{isValid as s}from\"../../../geometry/support/spatialReferenceUtils.js\";import{webMercatorToGeographic as n}from\"../../../geometry/support/webMercatorUtils.js\";import{pixelsPerCell as i}from\"./constants.js\";import m from\"../../../geometry/SpatialReference.js\";import p from\"../../../geometry/Point.js\";import c from\"../../../geometry/Polyline.js\";function a(e,t){return Math.log(e)/Math.log(t)}function l(e,t,r){const o=1===e?10:e;return o**(r?Math.round(a(i/t,o)):0)}function f(e){const{isGeographic:t,isWebMercator:r}=e;return!t&&!r}function u(i,a,l){const u=\"number\"==typeof i?null:i,y=l??u?.spatialReference;if(null==y||!s(y)||f(y))return e(y);let g=u?.x??i,j=u?.y??a;const h=1/Math.sqrt(2);let M=g+h,x=j+h;const{isWebMercator:R,isGeographic:U}=y;let b=U&&!t(y)?m.WGS84:y;if(R){let e=new p({x:g,y:j,spatialReference:y});n(e,!0,e),g=e.x,j=e.y,e=new p({x:M,y:x,spatialReference:y}),n(e,!0,e),M=e.x,x=e.y,b=m.WGS84}const w=new c({paths:[[[g,j],[M,x]]],spatialReference:b}),G=o(w,10);let W;try{[W]=r([G],\"meters\")}catch{return e(y)}return W}export{l as getScaleFactor,u as measureMetersPerUnitAtReferencePoint,f as shouldUsePlanar};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../request.js\";import{createTask as s}from\"../../../core/asyncUtils.js\";import r from\"../../../core/Handles.js\";import{destroyMaybe as i,abortMaybe as n}from\"../../../core/maybe.js\";import{watch as t,initial as a}from\"../../../core/reactiveUtils.js\";import{create as o}from\"../../../core/libs/gl-matrix-2/factories/mat3f32.js\";import{UpdatingHandles as l}from\"../../../core/support/UpdatingHandles.js\";import{DisplayObject as h}from\"../engine/DisplayObject.js\";import{WGLDrawPhase as u}from\"../engine/webgl/enums.js\";import{MagnifierTechnique as m}from\"../engine/webgl/shaderGraph/techniques/magnifier/MagnifierTechnique.js\";import{loadMagnifierResources as d}from\"../../magnifier/resources.js\";class c extends h{constructor(){super(),this._handles=new r,this._magnifierTechnique=new m,this.updatingHandles=new l,this.visible=!1}destroy(){this._handles=i(this._handles),this._magnifierTechnique.shutdown(),this._resourcesTask=n(this._resourcesTask)}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){this._backgroundColor=e,this.requestRender()}get magnifier(){return this._magnifier}set magnifier(e){this._magnifier=e,this._handles.removeAll(),this._handles.add([t((()=>e.version),(()=>{this.visible=e.visible&&null!=e.position&&e.size>0,this.requestRender()}),a),t((()=>[e.maskUrl,e.overlayUrl]),(()=>this._reloadResources())),t((()=>e.size),(()=>{this._magnifierTechnique.shutdown(),this.requestRender()}))])}_createTransforms(){return{displayViewScreenMat3:o()}}doRender(e){if(!this._resourcesTask)return void this._reloadResources();if(e.drawPhase!==u.MAP||!this._canRender())return;const s=this._magnifier;if(null==s.position)return;this._magnifierTechnique.updateResources(e,this._mask,this._overlay,s);const r=this.backgroundColor,i=r?[r.a*r.r/255,r.a*r.g/255,r.a*r.b/255,r.a]:[1,1,1,1];this._magnifierTechnique.render(e,{background:i,maskEnabled:s.maskEnabled?1:0,overlayEnabled:s.overlayEnabled?1:0})}_canRender(){return this._mask&&this._overlay&&null!=this._magnifier}_reloadResources(){this._resourcesTask&&this._resourcesTask.abort();const r=null!=this._magnifier?this._magnifier.maskUrl:null,i=null!=this._magnifier?this._magnifier.overlayUrl:null;this._resourcesTask=s((async s=>{const n=null==r||null==i?d(s):null,t=null!=r?e(r,{responseType:\"image\",signal:s}).then((e=>e.data)):n.then((e=>e.mask)),a=null!=i?e(i,{responseType:\"image\",signal:s}).then((e=>e.data)):n.then((e=>e.overlay)),[o,l]=await Promise.all([t,a]);this._mask=o,this._overlay=l,this._magnifierTechnique.shutdown(),this.requestRender()})),this.updatingHandles.addPromise(this._resourcesTask.promise)}}export{c as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nexport{Stage}from\"./engine/Stage.js\";export{LabelManager}from\"./LabelManager.js\";export{default as GraphicsView2D}from\"./layers/graphics/GraphicsView2D.js\";export{default as GraphicContainer}from\"./layers/graphics/GraphicContainer.js\";export{default as MapViewNavigation}from\"./navigation/MapViewNavigation.js\";export{default as MagnifierView2D}from\"./magnifier/MagnifierView2D.js\";export{default as GridView2D}from\"./grid/GridView2D.js\";\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{throwIfAborted as a}from\"../../core/promiseUtils.js\";import{requestImage as t}from\"../../support/requestImageUtils.js\";async function s(s){const r=import(\"./mask-svg.js\"),i=import(\"./overlay-svg.js\"),o=t((await r).default,{signal:s}),e=t((await i).default,{signal:s}),m={mask:await o,overlay:await e};return a(s),m}export{s as loadMagnifierResources};\n"],"names":[],"sourceRoot":""}