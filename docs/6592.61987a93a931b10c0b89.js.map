{"version":3,"file":"6592.61987a93a931b10c0b89.js","mappings":"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","sources":["webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/symbols/cim/CIMResourceManager.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/symbols/cim/CIMSymbolRasterizer.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/symbols/support/previewCIMSymbol.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/collisions/BoundingBox.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{loadFont as e}from\"../../core/fontUtils.js\";import{getImageData as t}from\"../../core/imageUtils.js\";class i{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(e){return this._resourceMap.get(e)??null}async fetchResource(e,i){const h=this._resourceMap.get(e);if(h)return{width:h.width,height:h.height};let r=this._inFlightResourceMap.get(e);return r?r.then((e=>({width:e.width,height:e.height}))):(r=t(e,i),this._inFlightResourceMap.set(e,r),r.then((t=>(this._inFlightResourceMap.delete(e),this._resourceMap.set(e,t),{width:t.width,height:t.height})),(()=>({width:0,height:0}))))}deleteResource(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}loadFont(t){return e(t)}}export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"./CIMResourceManager.js\";import{Transformation as t,CanvasDrawHelper as i}from\"./CIMSymbolDrawHelper.js\";import{CIMSymbolHelper as r}from\"./CIMSymbolHelper.js\";import{OverrideHelper as a}from\"./OverrideHelper.js\";import{mapCIMSymbolToGeometryType as s}from\"./utils.js\";const n=96/72;class h{constructor(t){this._spatialReference=t,this._imageDataCanvas=null,this._cimResourceManager=new e}get _canvas(){return this._imageDataCanvas||(this._imageDataCanvas=document.createElement(\"canvas\")),this._imageDataCanvas}get resourceManager(){return this._cimResourceManager}async rasterizeCIMSymbolAsync(e,t,i,n,h,l,c,m,g){if(!e)return null;const{data:y}=e;if(!y||\"CIMSymbolReference\"!==y.type||!y.symbol)return null;const{symbol:d}=y;l||(l=s(d));const u=await a.resolveSymbolOverrides(y,t,this._spatialReference,h,l,c,m),w=this._cimResourceManager,p=[];r.fetchResources(u,w,p),r.fetchFonts(u,w,p),p.length>0&&await Promise.all(p);const{width:b,height:f}=i,M=o(l,b,f,n),C=r.getEnvelope(u,M,w);if(!C)return null;C.x===1/0&&(C.x=b+2),C.y===1/0&&(C.y=-f/2),C.width===-1/0&&(C.width=b),C.height===-1/0&&(C.height=f);let R=1,v=0,x=0;switch(d.type){case\"CIMPointSymbol\":case\"CIMTextSymbol\":{let e=1;C.width>b&&(e=b/C.width);let t=1;C.height>f&&(t=f/C.height),\"preview\"===n&&(C.width<b&&(e=b/C.width),C.height<f&&(t=f/C.height)),R=Math.min(e,t),v=C.x+C.width/2,x=C.y+C.height/2}break;case\"CIMLineSymbol\":{(g||C.height>f)&&(R=f/C.height),x=C.y+C.height/2;const e=C.x*R+b/2,t=(C.x+C.width)*R+b/2,{paths:i}=M;i[0][0][0]-=e/R,i[0][2][0]-=(t-b)/R}break;case\"CIMPolygonSymbol\":{v=C.x+C.width/2,x=C.y+C.height/2;const e=C.x*R+b/2,t=(C.x+C.width)*R+b/2,i=C.y*R+f/2,r=(C.y+C.height)*R+f/2,{rings:a}=M;e<0&&(a[0][0][0]-=e,a[0][3][0]-=e,a[0][4][0]-=e),i<0&&(a[0][0][1]+=i,a[0][1][1]+=i,a[0][4][1]+=i),t>b&&(a[0][1][0]-=t-b,a[0][2][0]-=t-b),r>f&&(a[0][2][1]+=r-f,a[0][3][1]+=r-f)}}const I={type:\"cim\",data:{type:\"CIMSymbolReference\",symbol:u}};return this.rasterize(I,b,f,v,x,R,l,1,M)}rasterize(e,r,a,h,l,c,m,g=0,y=null){const{data:d}=e;if(!d||\"CIMSymbolReference\"!==d.type||!d.symbol)return null;const{symbol:u}=d,w=this._canvas,p=(window.devicePixelRatio||1)*n;w.width=r*p,w.height=a*p,m||(m=s(u)),y||(y=o(m,r,a,\"legend\")),w.width+=2*g,w.height+=2*g;const b=w.getContext(\"2d\",{willReadFrequently:!0}),f=t.createIdentity();f.translate(-h,-l),f.scale(c*p,-c*p),f.translate(r*p/2+g,a*p/2+g),b.clearRect(0,0,w.width,w.height);return new i(b,this._cimResourceManager,f,!0).drawSymbol(u,y),b.getImageData(0,0,w.width,w.height)}}function o(e,t,i,r){const a=1,s=-t/2+a,n=t/2-a,h=i/2-a,o=-i/2+a;switch(e){case\"esriGeometryPoint\":return{x:0,y:0};case\"esriGeometryPolyline\":return{paths:[[[s,0],[0,0],[n,0]]]};default:return\"legend\"===r?{rings:[[[s,h],[n,0],[n,o],[s,o],[s,h]]]}:{rings:[[[s,h],[n,h],[n,o],[s,o],[s,h]]]}}}export{h as CIMSymbolRasterizer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{px2pt as e,pt2px as t}from\"../../core/screenUtils.js\";import{CIMSymbolHelper as i}from\"../cim/CIMSymbolHelper.js\";import{CIMSymbolRasterizer as l}from\"../cim/CIMSymbolRasterizer.js\";import{OverrideHelper as r}from\"../cim/OverrideHelper.js\";import{mapCIMSymbolToGeometryType as n}from\"../cim/utils.js\";import{SymbolSizeDefaults as a}from\"./previewUtils.js\";import{renderSymbol as o}from\"./renderUtils.js\";const s=new l(null),c=e(a.size),m=e(a.maxSize),u=e(a.lineWidth),f=1;async function h(e,t,i){const l=t?.size;let r=null!=l&&\"object\"==typeof l&&\"width\"in l?l.width:l,n=null!=l&&\"object\"==typeof l&&\"height\"in l?l.height:l;if(null==r||null==n)if(\"esriGeometryPolygon\"===i)r=c,n=c;else{const l=await y(e,t,i);l&&(r=l.width,n=l.height),\"esriGeometryPolyline\"===i&&(r=u),r=null!=r&&isFinite(r)?Math.min(r,m):c,n=null!=n&&isFinite(n)?Math.max(Math.min(n,m),f):c}return\"legend\"===t.style&&\"esriGeometryPolyline\"===i&&(r=u),{width:r,height:n}}async function y(e,t,l){const{feature:n,fieldMap:a,viewParams:o}=t.cimOptions||t,c=await r.resolveSymbolOverrides(e.data,n,null,a,l,null,o);if(!c)return null;(e=e.clone()).data={type:\"CIMSymbolReference\",symbol:c},e.data.primitiveOverrides=void 0;const m=[];return i.fetchResources(c,s.resourceManager,m),i.fetchFonts(c,s.resourceManager,m),m.length>0&&await Promise.all(m),i.getEnvelope(c,null,s.resourceManager)}async function p(e,i={}){const{node:l,opacity:r,symbolConfig:a}=i,c=null!=a&&\"object\"==typeof a&&\"isSquareFill\"in a&&a.isSquareFill,m=i.cimOptions||i,u=m.geometryType||n(e?.data?.symbol),f=await h(e,i,u),{feature:y,fieldMap:p}=m,d=c||\"esriGeometryPolygon\"!==u?\"preview\":\"legend\",g=await s.rasterizeCIMSymbolAsync(e,y,f,d,p,u,null,m.viewParams,m.allowScalingUp);if(!g)return null;const{width:w,height:b}=g,v=document.createElement(\"canvas\");v.width=w,v.height=b;v.getContext(\"2d\").putImageData(g,0,0);const M=t(f.width),j=t(f.height),S=new Image(M,j);S.src=v.toDataURL(),S.ariaLabel=i.ariaLabel??null,S.alt=i.ariaLabel??\"\",null!=r&&(S.style.opacity=`${r}`);let C=S;if(null!=i.effectView){const e={shape:{type:\"image\",x:0,y:0,width:M,height:j,src:S.src},fill:null,stroke:null,offset:[0,0]};C=o([[e]],[M,j],{effectView:i.effectView,ariaLabel:i.ariaLabel})}return l&&C&&l.appendChild(C),C}export{p as previewCIMSymbol};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{fromValues as t,create as h}from\"../../../../../core/libs/gl-matrix-2/factories/vec2f32.js\";class i{constructor(i,e,s,r){this.transformedX=0,this.transformedY=0,this.center=t(i,e),this.centerT=h(),this.halfWidth=s/2,this.halfHeight=r/2,this.width=s,this.height=r}get x(){return this.center[0]}get y(){return this.center[1]}get blX(){return this.center[0]+this.halfWidth}get blY(){return this.center[1]+this.halfHeight}get trX(){return this.center[0]-this.halfWidth}get trY(){return this.center[1]-this.halfHeight}get xmin(){return this.x-this.halfWidth}get xmax(){return this.x+this.halfWidth}get ymin(){return this.y-this.halfHeight}get ymax(){return this.y+this.halfHeight}set x(t){this.center[0]=t}set y(t){this.center[1]=t}clone(){return new i(this.x,this.y,this.width,this.height)}serialize(t){return t.writeF32(this.center[0]),t.writeF32(this.center[1]),t.push(this.width),t.push(this.height),t}findCollisionDelta(t,h=4){const i=Math.abs(t.centerT[0]-this.centerT[0]),e=Math.abs(t.centerT[1]-this.centerT[1]),s=(t.halfWidth+this.halfWidth+h)/i,r=(t.halfHeight+this.halfHeight+h)/e,n=Math.min(s,r);return Math.log2(n)}extend(t){const h=Math.min(this.xmin,t.xmin),i=Math.min(this.ymin,t.ymin),e=Math.max(this.xmax,t.xmax)-h,s=Math.max(this.ymax,t.ymax)-i,r=h+e/2,n=i+s/2;this.width=e,this.height=s,this.halfWidth=e/2,this.halfHeight=s/2,this.x=r,this.y=n}static deserialize(t){const h=t.readF32(),e=t.readF32(),s=t.readInt32(),r=t.readInt32();return new i(h,e,s,r)}}export{i as default};\n"],"names":["i","constructor","this","_resourceMap","Map","_inFlightResourceMap","geometryEngine","geometryEnginePromise","destroy","clear","getResource","e","get","fetchResource","h","width","height","r","then","set","t","delete","deleteResource","loadFont","n","o","s","x","y","paths","rings","_spatialReference","_imageDataCanvas","_cimResourceManager","_canvas","document","createElement","resourceManager","rasterizeCIMSymbolAsync","l","c","m","g","data","type","symbol","d","u","resolveSymbolOverrides","w","p","fetchResources","fetchFonts","length","Promise","all","b","f","M","C","getEnvelope","R","v","Math","min","a","I","rasterize","window","devicePixelRatio","getContext","willReadFrequently","createIdentity","translate","scale","clearRect","drawSymbol","getImageData","size","maxSize","lineWidth","async","feature","fieldMap","viewParams","cimOptions","clone","primitiveOverrides","isFinite","max","style","node","opacity","symbolConfig","isSquareFill","geometryType","allowScalingUp","putImageData","j","S","Image","src","toDataURL","ariaLabel","alt","effectView","shape","fill","stroke","offset","appendChild","transformedX","transformedY","center","centerT","halfWidth","halfHeight","blX","blY","trX","trY","xmin","xmax","ymin","ymax","serialize","writeF32","push","findCollisionDelta","abs","log2","extend","deserialize","readF32","readInt32"],"sourceRoot":""}