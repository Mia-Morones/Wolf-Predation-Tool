{"version":3,"file":"node_modules_arcgis_core_views_interactive_snapping_featureSources_sceneLayerSource_SceneLaye-ae968f.89e779d887f1cfa297a9.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAC0T,cAAc,UAAU,OAAO,kFAAC,kBAAkB,kFAAC,WAAW,EAAE,OAAO,mFAAC,UAAU,mFAAC,IAAI,gBAAgB,gBAAgB,+BAA+B,oBAAoB,8BAA8B,sBAAsB,OAAO,mDAAC,aAAa,mDAAC,eAAe,sBAAsB,OAAO,mDAAC,aAAa,mDAAC,iBAAiB,gBAAgB,QAAQ,mDAAC,CAAC,kDAAC,qBAAqB,mDAAC,eAAe,mDAAC,sBAAsB,yDAAC,YAAY,mDAAC,CAAC,kDAAC,OAAO,mDAAC,CAAC,kDAAC,sBAAsB,OAAO,mDAAC,MAAM,kBAAkB,oBAAoB,kBAAkB,OAAO,mDAAC,YAAY,mDAAC,gBAAgB,sBAAsB,MAAM,kBAAkB,KAAK,mDAAC,CAAC,kDAAC,cAAc,mDAAC,MAAM,mDAAC,IAAI,OAAO,mDAAC,KAAK,yDAAC,SAAS,mDAAC,eAAe,gBAAgB,sCAAsC,MAAM,sBAAsB,GAAG,uBAAuB,cAAc,mDAAC,aAAa,cAAc,mDAAC,CAAC,mDAAC,CAAC,kDAAC,6BAA6B,YAAY,kBAAkB,sBAAsB,mDAAC,aAAa,oBAAoB,0BAA0B,mDAAC,CAAC,kDAAC,gCAAgC,mDAAC,CAAC,kDAAC,qBAAqB,kDAAC,SAAS,kDAAC,OAAO,2JAA2J,QAAQ,kDAAC,OAAO,8GAA8G,8KAA8K,0BAA0B,8BAA8B,MAAM,yDAAC,UAAU,yDAAC,SAAS,QAAQ,kDAAC,SAAS,kDAAC,OAAO,qJAAqJ,mDAAC,SAAS,SAAS,aAAa,mFAAC,MAAM,mFAAC,eAAe,OAAO,6DAAC,YAA+M;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACJ/yE;AACA;AACA;AACA;AAC26B,YAAY,cAAc,iDAAiD,uEAAC,gCAAgC,uEAAC,qCAAqC,wEAAC,eAAe,mFAAC,eAAe,mFAAC,eAAe,mFAAC,0BAA0B,2BAA2B,wBAAwB,qEAAC,yCAAyC,WAAW,4EAA4E,2EAAC,cAAc,QAAQ,eAAe,gCAAgC,WAAW,yCAAyC,iBAAiB,MAAM,WAAW,GAAG,QAAQ,WAAW,EAAE,SAAS,6BAA6B,SAAS,aAAa,iEAAiE,EAAE,2DAA2D,aAAa,6BAA6B,kEAAkE,WAAW,gBAAgB,sCAAsC,MAAM,WAAW,+JAA+J,OAAO,WAAW,0BAA0B,sCAAsC,iCAAiC,QAAQ,uHAAC,gDAAgD,mFAAC,KAAK,mFAAC,GAAG,YAAY,UAAU,KAAK,gDAAgD,QAAQ,4EAAC,8BAA8B,OAAO,mBAAmB,MAAM,qBAAqB,GAAG,QAAQ,kCAAkC,sBAAsB,MAAM,OAAO,cAAc,qBAAqB,qGAAqG,mDAAC,QAAQ,mDAAC,QAAQ,yCAAyC,wDAAwD,6BAA6B,wBAAwB,QAAQ,qDAAC,aAAa,4EAAC,6BAA6B,8EAAC,kBAAkB,qDAAC,sBAAsB,8BAA8B,kFAAC,aAAa,mDAAC,YAAY,kFAAC,QAAQ,kFAAC,IAAI,IAAI,EAAE,uDAAC,EAAE,sFAAC,uGAAuG,UAAU,oBAAoB,qBAAqB,qDAAC,oBAAoB,QAAQ,qDAAC,WAAW,QAAQ,gCAAgC,kFAAC,aAAa,mDAAC,MAAM,EAAE,QAAQ,iBAAiB,yDAAyD,QAAQ,QAAQ,mBAAmB,6CAAkE;;;;;;;;;;;;;;;;;;ACJ50G;AACA;AACA;AACA;AACuH,YAAY,kBAAkB,QAAQ,oDAAC,KAAK,oDAAC,IAAI,OAAO,mDAAC,WAAW,mDAAC,gBAAgB,mDAAC,MAAM,mDAAC,UAA6D","sources":["webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/geometry/support/lineSegment.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/interactive/snapping/featureSources/sceneLayerSource/SceneLayerSnappingSourceWorker.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/interactive/snapping/featureSources/sceneLayerSource/sceneLayerSnappingUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{clamp as t}from\"../../core/mathUtils.js\";import{ObjectStack as r}from\"../../core/ObjectStack.js\";import{c as n,d as o,f as e,h as i,g as c,k as s,s as u}from\"../../chunks/vec32.js\";import{clone as a,create as g}from\"../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{sv3d as f}from\"./vectorStacks.js\";function v(t){return t?{origin:a(t.origin),vector:a(t.vector)}:{origin:g(),vector:g()}}function m(t,r){const n=S.get();return n.origin=t,n.vector=r,n}function p(t,r=v()){return h(t.origin,t.vector,r)}function h(t,r,o=v()){return n(o.origin,t),n(o.vector,r),o}function b(t,r,e=v()){return n(e.origin,t),o(e.vector,r,t),e}function M(r,n){const c=o(f.get(),n,r.origin),s=e(r.vector,c),u=e(r.vector,r.vector),a=t(s/u,0,1),g=o(f.get(),i(f.get(),r.vector,a),c);return e(g,g)}function j(t,r,n){return A(t,r,0,1,n)}function l(t,r,n){return c(n,t.origin,i(n,t.vector,r))}function A(r,n,u,a,g){const{vector:v,origin:m}=r,p=o(f.get(),n,m),h=e(v,p)/s(v);return i(g,v,t(h,u,a)),c(g,g,r.origin)}function d(t,r){if(k(t,m(r.origin,r.direction),!1,x)){const{tA:r,pB:n,distance2:o}=x;if(r>=0&&r<=1)return o;if(r<0)return u(t.origin,n);if(r>1)return u(c(f.get(),t.origin,t.vector),n)}return null}function B(t,r,o){return!!k(t,r,!0,x)&&(n(o,x.pA),!0)}function k(r,n,o,e){const i=1e-6,s=r.origin,a=c(f.get(),s,r.vector),g=n.origin,v=c(f.get(),g,n.vector),m=f.get(),p=f.get();if(m[0]=s[0]-g[0],m[1]=s[1]-g[1],m[2]=s[2]-g[2],p[0]=v[0]-g[0],p[1]=v[1]-g[1],p[2]=v[2]-g[2],Math.abs(p[0])<i&&Math.abs(p[1])<i&&Math.abs(p[2])<i)return!1;const h=f.get();if(h[0]=a[0]-s[0],h[1]=a[1]-s[1],h[2]=a[2]-s[2],Math.abs(h[0])<i&&Math.abs(h[1])<i&&Math.abs(h[2])<i)return!1;const b=m[0]*p[0]+m[1]*p[1]+m[2]*p[2],M=p[0]*h[0]+p[1]*h[1]+p[2]*h[2],j=m[0]*h[0]+m[1]*h[1]+m[2]*h[2],l=p[0]*p[0]+p[1]*p[1]+p[2]*p[2],A=(h[0]*h[0]+h[1]*h[1]+h[2]*h[2])*l-M*M;if(Math.abs(A)<i)return!1;let d=(b*M-j*l)/A,B=(b+M*d)/l;o&&(d=t(d,0,1),B=t(B,0,1));const k=f.get(),x=f.get();return k[0]=s[0]+d*h[0],k[1]=s[1]+d*h[1],k[2]=s[2]+d*h[2],x[0]=g[0]+B*p[0],x[1]=g[1]+B*p[1],x[2]=g[2]+B*p[2],e.tA=d,e.tB=B,e.pA=k,e.pB=x,e.distance2=u(k,x),!0}const x={tA:0,tB:0,pA:g(),pB:g(),distance2:0},S=new r((()=>v()));export{B as closestLineSegmentPoint,d as closestRayDistance2,p as copy,v as create,M as distance2,b as fromPoints,h as fromValues,l as pointAt,j as projectPoint,A as projectPointClamp,m as wrap};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import{throwIfAborted as t}from\"../../../../../core/promiseUtils.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/has.js\";import\"../../../../../core/RandomLCG.js\";import\"../../../../../core/Error.js\";import{subclass as o}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{g as s,j as n}from\"../../../../../chunks/vec32.js\";import{create as i,clone as r}from\"../../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{create as c,fromPoints as d,projectPoint as a}from\"../../../../../geometry/support/lineSegment.js\";import{a as p,o as m}from\"../../../../../chunks/sphere.js\";import u from\"../../../../3d/webgl-engine/lib/Octree.js\";import{extractComponentsEdgeLocationsLayout as h}from\"../../../../3d/webgl-engine/lib/edgeRendering/edgeProcessing.js\";import{maxCandidateCount as g,boundsFromEdge as l}from\"./sceneLayerSnappingUtils.js\";let f=class{constructor(){this._idToComponent=new Map,this._components=new u((e=>e.bounds)),this._edges=new u((e=>e.bounds)),this._tmpLineSegment=c(),this._tmpP1=i(),this._tmpP2=i(),this._tmpP3=i(),this.remoteClient=null}async fetchCandidates(e,o){await Promise.resolve(),t(o),await this._ensureEdgeLocations(e,o);const s=[];return this._edges.forEachNeighbor((t=>(this._addCandidates(e,t,s),s.length<g)),e.bounds),{result:{candidates:s}}}async _ensureEdgeLocations(e,t){const o=[];if(this._components.forEachNeighbor((e=>{if(null==e.info){const{id:t,uid:s}=e;o.push({id:t,uid:s})}return!0}),e.bounds),!o.length)return;const s={components:o},n=await this.remoteClient.invoke(\"fetchAllEdgeLocations\",s,t??{});for(const i of n.components)this._setFetchEdgeLocations(i)}async add(e){const t=new j(e.id,e.bounds);return this._idToComponent.set(t.id,t),this._components.add([t]),{result:{}}}async remove(e){const t=this._idToComponent.get(e.id);if(t){const e=[];this._edges.forEachNeighbor((o=>(o.component===t&&e.push(o),!0)),t.bounds),this._edges.remove(e),this._components.remove([t]),this._idToComponent.delete(t.id)}return{result:{}}}_setFetchEdgeLocations(e){const t=this._idToComponent.get(e.id);if(null==t||e.uid!==t.uid)return;const o=h.createView(e.locations),s=new Array(o.count),n=i(),r=i();for(let i=0;i<o.count;i++){o.position0.getVec(i,n),o.position1.getVec(i,r);const c=l(n,r,e.origin),d=new w(t,i,c);s[i]=d}this._edges.add(s);const{objectIds:c,origin:d}=e;t.info={locations:o,objectIds:c,origin:d}}_addCandidates(e,t,o){const{info:n}=t.component,{origin:i,objectIds:r}=n,c=n.locations,d=c.position0.getVec(t.index,this._tmpP1),a=c.position1.getVec(t.index,this._tmpP2);s(d,d,i),s(a,a,i);const p=r[c.componentIndex.get(t.index)];this._addEdgeCandidate(e,p,d,a,o),b(e,p,d,o),b(e,p,a,o)}_addEdgeCandidate(e,t,o,s,i){if(!e.returnEdge)return;const c=p(e.bounds),u=d(o,s,this._tmpLineSegment),h=a(u,c,this._tmpP3);m(e.bounds,h)&&i.push({type:\"edge\",objectId:t,target:r(h),distance:n(c,h),start:r(o),end:r(s)})}};f=e([o(\"esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker\")],f);const _=f;function b(e,t,o,s){if(!e.returnVertex||!m(e.bounds,o))return;const i=p(e.bounds);s.push({type:\"vertex\",objectId:t,target:r(o),distance:n(i,o)})}class j{constructor(e,t){this.id=e,this.bounds=t,this.info=null,this.uid=++j.uid}}j.uid=0;class w{constructor(e,t,o){this.component=e,this.index=t,this.bounds=o}}export{_ as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{b as s,j as o,g as r}from\"../../../../../chunks/vec32.js\";import{c,a as n}from\"../../../../../chunks/sphere.js\";const t=1e3;function a(t,a,e){const m=c(),p=n(m);return s(p,p,t,.5),s(p,p,a,.5),m[3]=o(p,t),r(p,p,e),m}export{a as boundsFromEdge,t as maxCandidateCount};\n"],"names":[],"sourceRoot":""}