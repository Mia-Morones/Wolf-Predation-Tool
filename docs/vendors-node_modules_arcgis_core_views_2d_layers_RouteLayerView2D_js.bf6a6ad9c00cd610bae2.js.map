{"version":3,"file":"vendors-node_modules_arcgis_core_views_2d_layers_RouteLayerView2D_js.bf6a6ad9c00cd610bae2.js","mappings":"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","sources":["webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/GraphicInstanceStore.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/layers/RouteLayerView2D.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/layers/graphics/AGraphicContainer.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicBoundsRenderer.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicContainer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{FeatureTechniqueInstance as e}from\"./TechniqueInstance.js\";import{Techniques as i}from\"./TechniqueRegistry.js\";import{castInstanceId as t}from\"./mesh/instanceIdUtils.js\";let n=0;function a(i,a){return new e(t(n++),i,a)}const l={visualVariableColor:null,visualVariableOpacity:null,visualVariableSizeMinMaxValue:null,visualVariableSizeScaleStops:null,visualVariableSizeStops:null,visualVariableSizeUnitValue:null,visualVariableRotation:null,visualVariableSizeOutlineScaleStops:null};class o{constructor(){this.instances={fill:a(i.fill,{uniforms:l,optionalAttributes:{zoomRange:!0}}),marker:a(i.marker,{uniforms:l,optionalAttributes:{zoomRange:!0}}),line:a(i.line,{uniforms:l,optionalAttributes:{zoomRange:!0}}),text:a(i.text,{uniforms:l,optionalAttributes:{zoomRange:!0,referenceSymbol:!1,clipAngle:!1}}),complexFill:a(i.complexFill,{uniforms:l,optionalAttributes:{zoomRange:!0}}),texturedLine:a(i.texturedLine,{uniforms:l,optionalAttributes:{zoomRange:!0}}),animatedMarker:a(i.animatedMarker,{uniforms:l,optionalAttributes:{zoomRange:!0}})},this._instancesById=Object.values(this.instances).reduce(((e,i)=>(e.set(i.instanceId,i),e)),new Map)}getInstance(e){return this._instancesById.get(e)}}export{o as GraphicInstanceStore};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import{isSome as e}from\"../../../core/arrayUtils.js\";import r from\"../../../core/Collection.js\";import i from\"../../../core/CollectionFlattener.js\";import{makeHandle as s}from\"../../../core/handleUtils.js\";import{initial as o,watch as a}from\"../../../core/reactiveUtils.js\";import{property as h}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import{subclass as n}from\"../../../core/accessorSupport/decorators/subclass.js\";import p from\"../../../rest/support/DirectionLine.js\";import l from\"../../../rest/support/DirectionPoint.js\";import c from\"../../../rest/support/PointBarrier.js\";import g from\"../../../rest/support/PolygonBarrier.js\";import d from\"../../../rest/support/PolylineBarrier.js\";import u from\"../../../rest/support/RouteInfo.js\";import _ from\"../../../rest/support/Stop.js\";import{LayerView2DMixin as m}from\"./LayerView2D.js\";import w from\"./graphics/GraphicContainer.js\";import f from\"./graphics/GraphicsView2D.js\";import y from\"../../layers/LayerView.js\";const k=[\"route-info\",\"direction-line\",\"direction-point\",\"polygon-barrier\",\"polyline-barrier\",\"point-barrier\",\"stop\"],j={graphic:null,property:null,oldValue:null,newValue:null};function M(t){return t instanceof p||t instanceof l||t instanceof c||t instanceof g||t instanceof d||t instanceof u||t instanceof _}function V(t){return r.isCollection(t)&&t.length&&M(t.at(0))}function G(t){return Array.isArray(t)&&t.length>0&&M(t[0])}const I=new Set([\"default\"]);let v=class extends(m(y)){constructor(){super(...arguments),this._graphics=new r,this._highlightIds=new Map,this._networkFeatureMap=new Map,this._networkGraphicMap=new Map}get _routeItems(){return new i({getCollections:()=>null==this.layer||this.destroyed?[]:[null!=this.layer.routeInfo?new r([this.layer.routeInfo]):null,this.layer.directionLines,this.layer.directionPoints,this.layer.polygonBarriers,this.layer.polylineBarriers,this.layer.pointBarriers,this.layer.stops]})}initialize(){this._updatingHandles.addOnCollectionChange((()=>this._routeItems),(t=>this._routeItemsChanged(t)),o)}destroy(){this._networkFeatureMap.clear(),this._networkGraphicMap.clear(),this._graphics.removeAll(),this._get(\"_routeItems\")?.destroy()}attach(){this._createGraphicsView()}detach(){this._destroyGraphicsView()}async fetchPopupFeaturesAtLocation(t,e){return this._graphicsView.hitTest(t).filter((({popupTemplate:t})=>!!t))}highlight(t){let r;r=M(t)?[this._getNetworkFeatureUid(t)]:G(t)?t.map((t=>this._getNetworkFeatureUid(t))):V(t)?t.map((t=>this._getNetworkFeatureUid(t))).toArray():[t.uid];const i=r.filter(e);return i.length?(this._addHighlight(i),s((()=>this._removeHighlight(i)))):s()}async hitTest(t,r){if(this.suspended)return null;const i=this._graphicsView.hitTest(t).filter(e).map((t=>this._networkGraphicMap.get(t)));if(!i.length)return null;const{layer:s}=this;return i.reverse().map((e=>({type:\"route\",layer:s,mapPoint:t,networkFeature:e})))}isUpdating(){return this._graphicsView.updating}moveEnd(){}update(t){this._graphicsView.processUpdate(t)}viewChange(){this._graphicsView.viewChange()}_addHighlight(t){for(const e of t)if(this._highlightIds.has(e)){const t=this._highlightIds.get(e);this._highlightIds.set(e,t+1)}else this._highlightIds.set(e,1);this._updateHighlight()}_createGraphic(t){const e=t.toGraphic();return e.layer=this.layer,e.sourceLayer=this.layer,e}_createGraphicsView(){const t=this.view,e=()=>this.requestUpdate(),r=new w(t.featuresTilingScheme);this._graphicsView=new f({container:r,graphics:this._graphics,requestUpdateCallback:e,view:t}),this.container.addChild(r),this._updateHighlight()}_destroyGraphicsView(){this.container.removeChild(this._graphicsView.container),this._graphicsView.destroy()}_getDrawOrder(t){const e=this._networkGraphicMap.get(t);return k.indexOf(e.type)}_getNetworkFeatureUid(t){return this._networkFeatureMap.has(t)?this._networkFeatureMap.get(t).uid:null}_removeHighlight(t){for(const e of t)if(this._highlightIds.has(e)){const t=this._highlightIds.get(e)-1;0===t?this._highlightIds.delete(e):this._highlightIds.set(e,t)}this._updateHighlight()}_routeItemsChanged(t){if(t.removed.length){this._graphics.removeMany(t.removed.map((t=>{const e=this._networkFeatureMap.get(t);return this._networkFeatureMap.delete(t),this._networkGraphicMap.delete(e),e})));for(const e of t.removed)this.removeHandles(e)}if(t.added.length){this._graphics.addMany(t.added.map((t=>{const e=this._createGraphic(t);return null==e.symbol?null:(this._networkFeatureMap.set(t,e),this._networkGraphicMap.set(e,t),e)})).filter(e));for(const e of t.added)this.addHandles([a((()=>e.geometry),((t,r)=>{this._updateGraphic(e,\"geometry\",t,r)})),a((()=>e.symbol),((t,r)=>{this._updateGraphic(e,\"symbol\",t,r)}))],e);this._graphics.sort(((t,e)=>this._getDrawOrder(t)-this._getDrawOrder(e)))}}_updateGraphic(t,e,r,i){if(!this._networkFeatureMap.has(t)){const e=this._createGraphic(t);return this._networkFeatureMap.set(t,e),this._networkGraphicMap.set(e,t),void this._graphics.add(e)}const s=this._networkFeatureMap.get(t);s[e]=r,j.graphic=s,j.property=e,j.oldValue=i,j.newValue=r,this._graphicsView.graphicUpdateHandler(j)}_updateHighlight(){const t=Array.from(this._highlightIds.keys()),e=this._getHighlightBits(I);this._graphicsView.setHighlight(t.map((t=>({objectId:t,highlightFlags:e}))))}};t([h()],v.prototype,\"_graphics\",void 0),t([h()],v.prototype,\"_routeItems\",null),v=t([n(\"esri.views.2d.layers.RouteLayerView2D\")],v);const F=v;export{F as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{destroyMaybe as e}from\"../../../../core/maybe.js\";import{AFeatureContainer as t}from\"../../engine/AFeatureContainer.js\";import{FeatureBatchingStrategy as n}from\"../../engine/webgl/enums.js\";import{GraphicInstanceStore as r}from\"../../engine/webgl/shaderGraph/techniques/GraphicInstanceStore.js\";import s from\"./GraphicBoundsRenderer.js\";class i extends t{constructor(e){super(e),this._instanceStore=new r,this.checkHighlight=()=>!0}destroy(){super.destroy(),this._boundsRenderer=e(this._boundsRenderer)}get instanceStore(){return this._instanceStore}enableRenderingBounds(e){this._boundsRenderer=new s(e),this.requestRender()}get hasHighlight(){return this.checkHighlight()}onTileData(e,t){e.onMessage(t),this.contains(e)||this.addChild(e),this.requestRender()}_renderChildren(e,t){e.selection=t;for(const r of this.children){if(!r.visible)continue;const t=r.getDisplayList(this._instanceStore,n.STRICT_ORDER);t?.render(e)}}}export{i as AGraphicContainer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{disposeMaybe as t}from\"../../../../core/maybe.js\";import{identity as e,multiply as r,translate as i,scale as s,rotate as o}from\"../../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as a}from\"../../../../core/libs/gl-matrix-2/factories/mat3f32.js\";import{fromValues as n}from\"../../../../core/libs/gl-matrix-2/factories/vec2f32.js\";import{fromValues as l}from\"../../../../core/libs/gl-matrix-2/factories/vec3f32.js\";import{normalizeMapX as f}from\"../../../../geometry/support/normalizeUtils.js\";import{DisplayObject as m}from\"../../engine/DisplayObject.js\";import{createProgramDescriptor as c}from\"../../engine/webgl/Utils.js\";import{BufferObject as u}from\"../../../webgl/BufferObject.js\";import{BlendFactor as _,PrimitiveType as h,DataType as p,Usage as d}from\"../../../webgl/enums.js\";import{VertexArrayObject as g}from\"../../../webgl/VertexArrayObject.js\";const v=Math.PI/180,x=4;class b extends m{constructor(t){super(),this._program=null,this._vao=null,this._vertexBuffer=null,this._indexBuffer=null,this._dvsMat3=a(),this._localOrigin={x:0,y:0},this._getBounds=t}destroy(){this._vao&&(this._vao.dispose(),this._vao=null,this._vertexBuffer=null,this._indexBuffer=null),this._program=t(this._program)}doRender(t){const{context:e}=t,r=this._getBounds();if(r.length<1)return;this._createShaderProgram(e),this._updateMatricesAndLocalOrigin(t),this._updateBufferData(e,r),e.setBlendingEnabled(!0),e.setDepthTestEnabled(!1),e.setStencilWriteMask(0),e.setStencilTestEnabled(!1),e.setBlendFunction(_.ONE,_.ONE_MINUS_SRC_ALPHA),e.setColorMask(!0,!0,!0,!0);const i=this._program;e.bindVAO(this._vao),e.useProgram(i),i.setUniformMatrix3fv(\"u_dvsMat3\",this._dvsMat3),e.gl.lineWidth(1),e.drawElements(h.LINES,8*r.length,p.UNSIGNED_INT,0),e.bindVAO()}_createTransforms(){return{displayViewScreenMat3:a()}}_createShaderProgram(t){if(this._program)return;const e=\"precision highp float;\\n        uniform mat3 u_dvsMat3;\\n\\n        attribute vec2 a_position;\\n\\n        void main() {\\n          mediump vec3 pos = u_dvsMat3 * vec3(a_position, 1.0);\\n          gl_Position = vec4(pos.xy, 0.0, 1.0);\\n        }\",r=\"precision mediump float;\\n      void main() {\\n        gl_FragColor = vec4(0.75, 0.0, 0.0, 0.75);\\n      }\";this._program=t.programCache.acquire(e,r,y().attributes)}_updateMatricesAndLocalOrigin(t){const{state:a}=t,{displayMat3:m,size:c,resolution:u,pixelRatio:_,rotation:h,viewpoint:p}=a,d=v*h,{x:g,y:x}=p.targetGeometry,b=f(g,a.spatialReference);this._localOrigin.x=b,this._localOrigin.y=x;const y=_*c[0],B=_*c[1],M=u*y,j=u*B,A=e(this._dvsMat3);r(A,A,m),i(A,A,n(y/2,B/2)),s(A,A,l(c[0]/M,-B/j,1)),o(A,A,-d)}_updateBufferData(t,e){const{x:r,y:i}=this._localOrigin,s=2*x*e.length,o=new Float32Array(s),a=new Uint32Array(8*e.length);let n=0,l=0;for(const f of e)f&&(o[2*n]=f[0]-r,o[2*n+1]=f[1]-i,o[2*n+2]=f[0]-r,o[2*n+3]=f[3]-i,o[2*n+4]=f[2]-r,o[2*n+5]=f[3]-i,o[2*n+6]=f[2]-r,o[2*n+7]=f[1]-i,a[l]=n+0,a[l+1]=n+3,a[l+2]=n+3,a[l+3]=n+2,a[l+4]=n+2,a[l+5]=n+1,a[l+6]=n+1,a[l+7]=n+0,n+=4,l+=8);if(this._vertexBuffer?this._vertexBuffer.setData(o.buffer):this._vertexBuffer=u.createVertex(t,d.DYNAMIC_DRAW,o.buffer),this._indexBuffer?this._indexBuffer.setData(a):this._indexBuffer=u.createIndex(t,d.DYNAMIC_DRAW,a),!this._vao){const e=y();this._vao=new g(t,e.attributes,e.bufferLayouts,new Map([[\"geometry\",this._vertexBuffer]]),this._indexBuffer)}}}const y=()=>c(\"bounds\",{geometry:[{location:0,name:\"a_position\",count:2,type:p.FLOAT}]});export{b as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{WGLDrawPhase as e,FeatureSelection as r}from\"../../engine/webgl/enums.js\";import{AGraphicContainer as i}from\"./AGraphicContainer.js\";import{renderHighlight as s}from\"../support/util.js\";class t extends i{renderChildren(i){for(const e of this.children)e.setTransform(i.state);if(super.renderChildren(i),this._updateAttributeView(),this.children.some((e=>e.hasData))){switch(i.drawPhase){case e.MAP:this._renderChildren(i,r.All);break;case e.HIGHLIGHT:this.hasHighlight&&this._renderHighlight(i)}this._boundsRenderer&&this._boundsRenderer.doRender(i)}}_renderHighlight(e){s(e,!1,(e=>{this._renderChildren(e,r.Highlight)}))}}export{t as default};\n"],"names":[],"sourceRoot":""}