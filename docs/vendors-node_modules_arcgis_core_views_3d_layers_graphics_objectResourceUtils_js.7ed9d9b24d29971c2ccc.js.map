{"version":3,"file":"vendors-node_modules_arcgis_core_views_3d_layers_graphics_objectResourceUtils_js.7ed9d9b24d29971c2ccc.js","mappings":"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","sources":["webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/chunks/vec2.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/chunks/vec33.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/chunks/vec43.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/core/devEnvironmentUtils.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/3d/glTF/DefaultLoadingContext.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/3d/glTF/internal/TextureTransformUtils.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/3d/glTF/internal/indexUtils.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/3d/glTF/internal/resourceUtils.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/3d/layers/graphics/ProcessedObjectResource.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/3d/layers/graphics/objectResourceUtils.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/3d/layers/graphics/wosrLoader.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/DefaultMaterial_COLOR_GAMMA.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{isArray as e,isFloat as t,maximumValue as r,isSigned as f}from\"../core/typedArrayUtil.js\";function o(e,t){n(e.typedBuffer,t.typedBuffer,e.typedBufferStride,t.typedBufferStride)}function n(o,n,l=2,u=l){const i=n.length/2;let a=0,d=0;if(e(n)||t(n)){for(let e=0;e<i;++e)o[a]=n[d],o[a+1]=n[d+1],a+=l,d+=u;return}const c=r(n);if(f(n))for(let e=0;e<i;++e)o[a]=Math.max(n[d]/c,-1),o[a+1]=Math.max(n[d+1]/c,-1),a+=l,d+=u;else for(let e=0;e<i;++e)o[a]=n[d]/c,o[a+1]=n[d+1]/c,a+=l,d+=u}function l(e,t,r,f){const o=e.typedBuffer,n=e.typedBufferStride,l=f?.count??e.count;let u=(f?.dstIndex??0)*n;for(let i=0;i<l;++i)o[u]=t,o[u+1]=r,u+=n}const u=Object.freeze(Object.defineProperty({__proto__:null,fill:l,normalizeIntegerBuffer:n,normalizeIntegerBufferView:o},Symbol.toStringTag,{value:\"Module\"}));export{n as a,l as f,o as n,u as v};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nfunction e(e,f){t(e.typedBuffer,f.typedBuffer,e.typedBufferStride,f.typedBufferStride)}function t(e,t,f=3,o=f){const r=t.length/o;let n=0,u=0;for(let c=0;c<r;++c)e[n]=t[u],e[n+1]=t[u+1],e[n+2]=t[u+2],n+=f,u+=o}function f(e,t,f,o,r){const n=e.typedBuffer,u=e.typedBufferStride,c=r?.count??e.count;let d=(r?.dstIndex??0)*u;for(let l=0;l<c;++l)n[d]=t,n[d+1]=f,n[d+2]=o,d+=u}const o=Object.freeze(Object.defineProperty({__proto__:null,copy:t,copyView:e,fill:f},Symbol.toStringTag,{value:\"Module\"}));export{e as a,t as c,f,o as v};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nfunction e(e,f){t(e.typedBuffer,f,e.typedBufferStride)}function t(e,t,f=4){const o=t.typedBuffer,r=t.typedBufferStride,n=t.count;let u=0,c=0;for(let d=0;d<n;++d)e[u]=o[c],e[u+1]=o[c+1],e[u+2]=o[c+2],e[u+3]=o[c+3],u+=f,c+=r}function f(e,t,f,o,r,n){const u=e.typedBuffer,c=e.typedBufferStride,d=n?.count??e.count;let l=(n?.dstIndex??0)*c;for(let p=0;p<d;++p)u[l]=t,u[l+1]=f,u[l+2]=o,u[l+3]=r,l+=c}const o=Object.freeze(Object.defineProperty({__proto__:null,copy:t,copyView:e,fill:f},Symbol.toStringTag,{value:\"Module\"}));export{t as a,e as c,f,o as v};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nfunction c(c){return c=c||globalThis.location.hostname,i.some((a=>null!=c?.match(a)))}function a(c,a){return c?(a=a||globalThis.location.hostname)?null!=a.match(t)||null!=a.match(s)?c.replace(\"static.arcgis.com\",\"staticdev.arcgis.com\"):null!=a.match(o)||null!=a.match(l)?c.replace(\"static.arcgis.com\",\"staticqa.arcgis.com\"):c:c:null}const t=/^devext\\.arcgis\\.com$/,o=/^qaext\\.arcgis\\.com$/,s=/^[\\w-]*\\.mapsdevext\\.arcgis\\.com$/,l=/^[\\w-]*\\.mapsqa\\.arcgis\\.com$/,i=[/^([\\w-]*\\.)?[\\w-]*\\.zrh-dev-local\\.esri\\.com$/,t,o,/^jsapps\\.esri\\.com$/,s,l];export{a as adjustStaticAGOUrl,i as devHostnames,c as isDevEnvironment};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport r from\"../../../request.js\";import{result as e}from\"../../../core/asyncUtils.js\";import t from\"../../../core/Error.js\";import{throwIfAborted as a,throwIfAbortError as o}from\"../../../core/promiseUtils.js\";import{isDataProtocol as s,dataToArrayBuffer as i}from\"../../../core/urlUtils.js\";class n{constructor(r){this._streamDataRequester=r}async loadJSON(r,e){return this._load(\"json\",r,e)}async loadBinary(r,e){return s(r)?(a(e),i(r)):this._load(\"binary\",r,e)}async loadImage(r,e){return this._load(\"image\",r,e)}async _load(a,s,i){if(null==this._streamDataRequester)return(await r(s,{responseType:m[a]})).data;const n=await e(this._streamDataRequester.request(s,a,i));if(!0===n.ok)return n.value;throw o(n.error),new t(\"glt-loader-request-error\",`Request for resource failed: ${n.error}`)}}const m={image:\"image\",binary:\"array-buffer\",json:\"json\",\"image+type\":void 0};export{n as DefaultLoadingContext};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{fromValues as t,create as o}from\"../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";import{ZEROS as r,ONES as l}from\"../../../../core/libs/gl-matrix-2/factories/vec2f32.js\";import{multiply as i}from\"../../../../core/libs/gl-matrix-2/math/mat3.js\";function s(s){if(null==s)return null;const a=null!=s.offset?s.offset:r,n=null!=s.rotation?s.rotation:0,e=null!=s.scale?s.scale:l,f=t(1,0,0,0,1,0,a[0],a[1],1),c=t(Math.cos(n),-Math.sin(n),0,Math.sin(n),Math.cos(n),0,0,0,1),m=t(e[0],0,0,0,e[1],0,0,0,1),u=o();return i(u,c,m),i(u,f,u),u}export{s as getTransformMatrix};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{isUint8Array as r}from\"../../../../core/typedArrayUtil.js\";import{getContinuousIndexArray as t,newIndexArray as e}from\"../../../../geometry/support/Indices.js\";import{PrimitiveType as n}from\"../../../webgl/enums.js\";function o(r,t){switch(t){case n.TRIANGLES:return f(r);case n.TRIANGLE_STRIP:return u(r);case n.TRIANGLE_FAN:return i(r)}}function f(e){return\"number\"==typeof e?t(e):r(e)?new Uint16Array(e):e}function u(r){const t=\"number\"==typeof r?r:r.length;if(t<3)return[];const n=t-2,o=e(3*n);if(\"number\"==typeof r){let r=0;for(let t=0;t<n;t+=1)t%2==0?(o[r++]=t,o[r++]=t+1,o[r++]=t+2):(o[r++]=t+1,o[r++]=t,o[r++]=t+2)}else{let t=0;for(let e=0;e<n;e+=1)e%2==0?(o[t++]=r[e],o[t++]=r[e+1],o[t++]=r[e+2]):(o[t++]=r[e+1],o[t++]=r[e],o[t++]=r[e+2])}return o}function i(r){const t=\"number\"==typeof r?r:r.length;if(t<3)return new Uint16Array(0);const e=t-2,n=e<=65536?new Uint16Array(3*e):new Uint32Array(3*e);if(\"number\"==typeof r){let r=0;for(let t=0;t<e;++t)n[r++]=0,n[r++]=t+1,n[r++]=t+2;return n}const o=r[0];let f=r[1],u=0;for(let i=0;i<e;++i){const t=r[i+2];n[u++]=o,n[u++]=f,n[u++]=t,f=t}return n}export{o as convertPrimitiveToTriangles};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport has from\"../../../../core/has.js\";import{TextureEncodingMimeType as e}from\"../../webgl-engine/lib/basicInterfaces.js\";class t{constructor(t){this.data=t,this.type=\"encoded-mesh-texture\",this.encoding=e.KTX2_ENCODING}}function r(e){return\"encoded-mesh-texture\"===e?.type}async function n(e){const t=new Blob([e]),r=await t.text();return JSON.parse(r)}async function o(r,n){if(n===e.KTX2_ENCODING)return new t(r);const o=new Blob([r],{type:n}),c=URL.createObjectURL(o),s=new Image;if(has(\"esri-iPhone\"))return new Promise(((e,t)=>{const r=()=>{o(),e(s)},n=e=>{o(),t(e)},o=()=>{URL.revokeObjectURL(c),s.removeEventListener(\"load\",r),s.removeEventListener(\"error\",n)};s.addEventListener(\"load\",r),s.addEventListener(\"error\",n),s.src=c}));try{s.src=c,await s.decode()}catch(i){console.warn(\"Failed decoding HTMLImageElement\")}return URL.revokeObjectURL(c),s}export{t as EncodedMeshTexture,o as imageFromBinaryData,r as isEncodedMeshTexture,n as jsonFromBinaryData};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass s{constructor(){this.geometries=new Array,this.materials=new Array,this.textures=new Array}}class t{constructor(t,e,r){this.name=t,this.lodThreshold=e,this.pivotOffset=r,this.stageResources=new s,this.numberOfVertices=0}}export{t as ProcessedObjectResource,s as ProcessedObjectStageResources};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{adjustStaticAGOUrl as e}from\"../../../../core/devEnvironmentUtils.js\";import{hasScaling as t}from\"../../../../core/mathUtils.js\";import{normalFromMat4 as r,fromMat4 as o}from\"../../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as s}from\"../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";import{invert as i}from\"../../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as n}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{ONES as a}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{t as l,d as u,E as c,l as m,n as f,m as d}from\"../../../../chunks/vec32.js\";import{create as p}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{empty as g,expandWithVec3 as x}from\"../../../../geometry/support/aaBoundingBox.js\";import{newFloatArray as b}from\"../../../../geometry/support/FloatArray.js\";import{BufferViewVec4f as h,BufferViewVec4u8 as T,BufferViewVec4u16 as y,BufferViewVec3f as w,BufferViewVec3u8 as v,BufferViewVec3u16 as R}from\"../../../../geometry/support/buffer/BufferView.js\";import{t as j,b as B,n as M,f as S}from\"../../../../chunks/vec3.js\";import{t as F,b as A}from\"../../../../chunks/vec4.js\";import{a as E}from\"../../../../chunks/vec2.js\";import{c as O}from\"../../../../chunks/vec33.js\";import{a as C}from\"../../../../chunks/vec43.js\";import{DefaultLoadingContext as L}from\"../../glTF/DefaultLoadingContext.js\";import{convertPrimitiveToTriangles as I}from\"../../glTF/internal/indexUtils.js\";import{isEncodedMeshTexture as N}from\"../../glTF/internal/resourceUtils.js\";import{getTransformMatrix as k}from\"../../glTF/internal/TextureTransformUtils.js\";import{ProcessedObjectResource as P}from\"./ProcessedObjectResource.js\";import{load as U,processLoadResult as V}from\"./wosrLoader.js\";import{NormalType as _}from\"../../webgl-engine/core/shaderLibrary/attributes/NormalAttribute.glsl.js\";import{Attribute as D}from\"../../webgl-engine/lib/Attribute.js\";import{AlphaDiscardMode as G,DepthTestFunction as q,CullFaceOptions as W}from\"../../webgl-engine/lib/basicInterfaces.js\";import{Geometry as H}from\"../../webgl-engine/lib/Geometry.js\";import{Texture as $}from\"../../webgl-engine/lib/Texture.js\";import{VertexAttribute as z}from\"../../webgl-engine/lib/VertexAttribute.js\";import{DefaultMaterial as K}from\"../../webgl-engine/materials/DefaultMaterial.js\";import{colorGamma as Q}from\"../../webgl-engine/materials/DefaultMaterial_COLOR_GAMMA.js\";import{esriSymbologyMRRFactors as J,advancedMRRFactors as X,useSchematicPBR as Y,schematicMRRFactors as Z}from\"../../webgl-engine/materials/pbrUtils.js\";async function ee(t,r){const o=te(e(t));if(\"wosr\"===o.fileType){const e=await(r.cache?r.cache.loadWOSR(o.url,r):U(o.url,r)),{engineResources:t,referenceBoundingBox:s}=V(e,r);return{lods:t,referenceBoundingBox:s,isEsriSymbolResource:!1,isWosr:!0}}let s;if(r.cache)s=await r.cache.loadGLTF(o.url,r,!!r.usePBR);else{const{loadGLTF:e}=await import(\"../../glTF/loader.js\");s=await e(new L(r.streamDataRequester),o.url,r,r.usePBR)}const i=s.model.meta?.ESRI_proxyEllipsoid,n=s.meta.isEsriSymbolResource&&null!=i&&\"EsriRealisticTreesStyle\"===s.meta.ESRI_webstyle;n&&!s.customMeta.esriTreeRendering&&(s.customMeta.esriTreeRendering=!0,ae(s,i));const a=!!r.usePBR,l=s.meta.isEsriSymbolResource?{usePBR:a,isSchematic:!1,treeRendering:n,mrrFactors:J}:{usePBR:a,isSchematic:!1,treeRendering:!1,mrrFactors:X},u={...r.materialParameters,treeRendering:n},{engineResources:c,referenceBoundingBox:m}=re(s,l,u,r,o.specifiedLodIndex);return{lods:c,referenceBoundingBox:m,isEsriSymbolResource:s.meta.isEsriSymbolResource,isWosr:!1}}function te(e){const t=e.match(/(.*\\.(gltf|glb))(\\?lod=([0-9]+))?$/);if(t)return{fileType:\"gltf\",url:t[1],specifiedLodIndex:null!=t[4]?Number(t[4]):null};return e.match(/(.*\\.(json|json\\.gz))$/)?{fileType:\"wosr\",url:e,specifiedLodIndex:null}:{fileType:\"unknown\",url:e,specifiedLodIndex:null}}function re(e,t,r,o,s){const i=e.model,n=new Array,a=new Map,l=new Map,u=i.lods.length,c=g();return i.lods.forEach(((e,m)=>{const f=!0===o.skipHighLods&&(u>1&&0===m||u>3&&1===m)||!1===o.skipHighLods&&null!=s&&m!==s;if(f&&0!==m)return;const d=new P(e.name,e.lodThreshold,[0,0,0]);e.parts.forEach((e=>{const s=f?new K({},o):oe(i,e,d,t,r,a,l,o),{geometry:n,vertexCount:u}=se(e,s??new K({},o)),p=n.boundingInfo;null!=p&&0===m&&(x(c,p.bbMin),x(c,p.bbMax)),null!=s&&(d.stageResources.geometries.push(n),d.numberOfVertices+=u)})),f||n.push(d)})),{engineResources:n,referenceBoundingBox:c}}function oe(e,t,r,o,s,i,n,l){const u=t.material+(t.attributes.normal?\"_normal\":\"\")+(t.attributes.color?\"_color\":\"\")+(t.attributes.texCoord0?\"_texCoord0\":\"\")+(t.attributes.tangent?\"_tangent\":\"\"),c=e.materials.get(t.material),m=null!=t.attributes.texCoord0,f=null!=t.attributes.normal;if(null==c)return null;const d=ne(c.alphaMode);if(!i.has(u)){if(m){const t=(t,r=!1)=>{if(null!=t&&!n.has(t)){const o=e.textures.get(t);if(null!=o){const e=o.data;n.set(t,new $(N(e)?e.data:e,{...o.parameters,preMultiplyAlpha:!N(e)&&r,encoding:N(e)&&null!=e.encoding?e.encoding:void 0}))}}};t(c.textureColor,d!==G.Opaque),t(c.textureNormal),t(c.textureOcclusion),t(c.textureEmissive),t(c.textureMetallicRoughness)}const r=c.color[0]**(1/Q),p=c.color[1]**(1/Q),g=c.color[2]**(1/Q),x=c.emissiveFactor[0]**(1/Q),b=c.emissiveFactor[1]**(1/Q),h=c.emissiveFactor[2]**(1/Q),T=null!=c.textureColor&&m?n.get(c.textureColor):null,y=Y({normalTexture:c.textureNormal,metallicRoughnessTexture:c.textureMetallicRoughness,metallicFactor:c.metallicFactor,roughnessFactor:c.roughnessFactor,emissiveTexture:c.textureEmissive,emissiveFactor:c.emissiveFactor,occlusionTexture:c.textureOcclusion}),w=null!=c.normalTextureTransform?.scale?c.normalTextureTransform?.scale:a;i.set(u,new K({...o,transparent:d===G.Blend,customDepthTest:q.Lequal,textureAlphaMode:d,textureAlphaCutoff:c.alphaCutoff,diffuse:[r,p,g],ambient:[r,p,g],opacity:c.opacity,doubleSided:c.doubleSided,doubleSidedType:\"winding-order\",cullFace:c.doubleSided?W.None:W.Back,hasVertexColors:!!t.attributes.color,hasVertexTangents:!!t.attributes.tangent,normalType:f?_.Attribute:_.ScreenDerivative,castShadows:!0,receiveShadows:c.receiveShadows,receiveAmbientOcclusion:c.receiveAmbientOcclustion,textureId:null!=T?T.id:void 0,colorMixMode:c.colorMixMode,normalTextureId:null!=c.textureNormal&&m?n.get(c.textureNormal).id:void 0,textureAlphaPremultiplied:null!=T&&!!T.parameters.preMultiplyAlpha,occlusionTextureId:null!=c.textureOcclusion&&m?n.get(c.textureOcclusion).id:void 0,emissiveTextureId:null!=c.textureEmissive&&m?n.get(c.textureEmissive).id:void 0,metallicRoughnessTextureId:null!=c.textureMetallicRoughness&&m?n.get(c.textureMetallicRoughness).id:void 0,emissiveFactor:[x,b,h],mrrFactors:y?Z:[c.metallicFactor,c.roughnessFactor,o.mrrFactors[2]],isSchematic:y,colorTextureTransformMatrix:k(c.colorTextureTransform),normalTextureTransformMatrix:k(c.normalTextureTransform),scale:[w[0],w[1]],occlusionTextureTransformMatrix:k(c.occlusionTextureTransform),emissiveTextureTransformMatrix:k(c.emissiveTextureTransform),metallicRoughnessTextureTransformMatrix:k(c.metallicRoughnessTextureTransform),...s},l))}const p=i.get(u);if(r.stageResources.materials.push(p),m){const e=e=>{null!=e&&r.stageResources.textures.push(n.get(e))};e(c.textureColor),e(c.textureNormal),e(c.textureOcclusion),e(c.textureEmissive),e(c.textureMetallicRoughness)}return p}function se(e,s){const i=e.attributes.position.count,n=I(e.indices||i,e.primitiveType),a=b(3*i),{typedBuffer:l,typedBufferStride:u}=e.attributes.position;j(a,l,e.transform,3,u);const c=[[z.POSITION,new D(a,n,3,!0)]];if(null!=e.attributes.normal){const o=b(3*i),{typedBuffer:s,typedBufferStride:a}=e.attributes.normal;r(ie,e.transform),B(o,s,ie,3,a),t(ie)&&M(o,o),c.push([z.NORMAL,new D(o,n,3,!0)])}if(null!=e.attributes.tangent){const r=b(4*i),{typedBuffer:s,typedBufferStride:a}=e.attributes.tangent;o(ie,e.transform),F(r,s,ie,4,a),t(ie)&&M(r,r,4),c.push([z.TANGENT,new D(r,n,4,!0)])}if(null!=e.attributes.texCoord0){const t=b(2*i),{typedBuffer:r,typedBufferStride:o}=e.attributes.texCoord0;E(t,r,2,o),c.push([z.UV0,new D(t,n,2,!0)])}const m=e.attributes.color;if(null!=m){const t=new Uint8Array(4*i);4===m.elementCount?m instanceof h?A(t,m,255):m instanceof T?C(t,m):m instanceof y&&A(t,m,1/256):(t.fill(255),m instanceof w?S(t,m.typedBuffer,255,4,m.typedBufferStride):e.attributes.color instanceof v?O(t,m.typedBuffer,4,e.attributes.color.typedBufferStride):e.attributes.color instanceof R&&S(t,m.typedBuffer,1/256,4,m.typedBufferStride)),c.push([z.COLOR,new D(t,n,4,!0)])}return{geometry:new H(s,c),vertexCount:i}}const ie=s();function ne(e){switch(e){case\"BLEND\":return G.Blend;case\"MASK\":return G.Mask;case\"OPAQUE\":case null:case void 0:return G.Opaque}}function ae(e,t){for(let r=0;r<e.model.lods.length;++r){const o=e.model.lods[r];for(const s of o.parts){const o=s.attributes.normal;if(null==o)return;const a=s.attributes.position,g=a.count,x=p(),b=p(),h=p(),y=new Uint8Array(4*g),v=new Float64Array(3*g),R=i(n(),s.transform);let j=0,B=0;for(let i=0;i<g;i++){a.getVec(i,b),o.getVec(i,x),l(b,b,s.transform),u(h,b,t.center),c(h,h,t.radius);const n=h[2],p=m(h),g=Math.min(.45+.55*p*p,1);c(h,h,t.radius),null!==R&&l(h,h,R),f(h,h),r+1!==e.model.lods.length&&e.model.lods.length>1&&d(h,h,x,n>-1?.2:Math.min(-4*n-3.8,1)),v[j]=h[0],v[j+1]=h[1],v[j+2]=h[2],j+=3,y[B]=255*g,y[B+1]=255*g,y[B+2]=255*g,y[B+3]=255,B+=4}s.attributes.normal=new w(v),s.attributes.color=new T(y)}}}export{ee as fetch,te as parseUrl};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../../request.js\";import{result as t}from\"../../../../core/asyncUtils.js\";import{estimateNestedObjectSize as r}from\"../../../../core/byteSizeEstimations.js\";import n from\"../../../../core/Error.js\";import s from\"../../../../core/Logger.js\";import{NestedMap as a}from\"../../../../core/NestedMap.js\";import{throwIfAbortError as o}from\"../../../../core/promiseUtils.js\";import{Version as i}from\"../../../../core/Version.js\";import{fromArray as l}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{empty as u,expandWithVec3 as c}from\"../../../../geometry/support/aaBoundingBox.js\";import{getContinuousIndexArray as m}from\"../../../../geometry/support/Indices.js\";import{requestImage as p}from\"../../../../support/requestImageUtils.js\";import{Attribute as f}from\"../../webgl-engine/lib/Attribute.js\";import{CullFaceOptions as d,AlphaDiscardMode as g}from\"../../webgl-engine/lib/basicInterfaces.js\";import{Geometry as y}from\"../../webgl-engine/lib/Geometry.js\";import{Texture as b}from\"../../webgl-engine/lib/Texture.js\";import{VertexAttribute as w}from\"../../webgl-engine/lib/VertexAttribute.js\";import{DefaultMaterial as x}from\"../../webgl-engine/materials/DefaultMaterial.js\";import{TextureWrapMode as h}from\"../../../webgl/enums.js\";const v=()=>s.getLogger(\"esri.views.3d.layers.graphics.objectResourceUtils\");async function A(e,t){const n=await j(e,t),s=await E(n.textureDefinitions??{},t);let a=0;for(const r in s)if(s.hasOwnProperty(r)){const e=s[r];a+=e?.image?e.image.width*e.image.height*4:0}return{resource:n,textures:s,size:a+r(n)}}async function j(r,n){const s=n?.streamDataRequester;if(s)return I(r,s,n);const a=await t(e(r,n));if(!0===a.ok)return a.value.data;o(a.error),P(a.error)}async function I(e,r,n){const s=await t(r.request(e,\"json\",n));if(!0===s.ok)return s.value;o(s.error),P(s.error.details.url)}function P(e){throw new n(\"\",`Request for object resource failed: ${e}`)}function M(e){const t=e.params,r=t.topology;let n=!0;switch(t.vertexAttributes||(v().warn(\"Geometry must specify vertex attributes\"),n=!1),t.topology){case\"PerAttributeArray\":break;case\"Indexed\":case null:case void 0:{const e=t.faces;if(e){if(t.vertexAttributes)for(const r in t.vertexAttributes){const t=e[r];t?.values?(null!=t.valueType&&\"UInt32\"!==t.valueType&&(v().warn(`Unsupported indexed geometry indices type '${t.valueType}', only UInt32 is currently supported`),n=!1),null!=t.valuesPerElement&&1!==t.valuesPerElement&&(v().warn(`Unsupported indexed geometry values per element '${t.valuesPerElement}', only 1 is currently supported`),n=!1)):(v().warn(`Indexed geometry does not specify face indices for '${r}' attribute`),n=!1)}}else v().warn(\"Indexed geometries must specify faces\"),n=!1;break}default:v().warn(`Unsupported topology '${r}'`),n=!1}e.params.material||(v().warn(\"Geometry requires material\"),n=!1);const s=e.params.vertexAttributes;for(const a in s){s[a].values||(v().warn(\"Geometries with externally defined attributes are not yet supported\"),n=!1)}return n}function T(e,t){const r=new Array,n=new Array,s=new Array,o=new a,u=e.resource,c=i.parse(u.version||\"1.0\",\"wosr\");q.validate(c);const p=u.model.name,g=u.model.geometries,h=u.materialDefinitions??{},v=e.textures;let A=0;const j=new Map;for(let a=0;a<g.length;a++){const e=g[a];if(!M(e))continue;const i=k(e),u=e.params.vertexAttributes,c=[],p=t=>{if(\"PerAttributeArray\"===e.params.topology)return null;const r=e.params.faces;for(const e in r)if(e===t)return r[e].values;return null},I=u[w.POSITION],P=I.values.length/I.valuesPerElement;for(const t in u){const e=u[t],r=e.values,n=p(t)??m(P);c.push([t,new f(r,n,e.valuesPerElement,!0)])}const T=i.texture,U=v&&v[T];if(U&&!j.has(T)){const{image:e,parameters:t}=U,r=new b(e,t);n.push(r),j.set(T,r)}const E=j.get(T),q=E?E.id:void 0,R=i.material;let B=o.get(R,T);if(null==B){const e=h[R.slice(R.lastIndexOf(\"/\")+1)].params;1===e.transparency&&(e.transparency=0);const r=U&&U.alphaChannelUsage,n=e.transparency>0||\"transparency\"===r||\"maskAndTransparency\"===r,s=U?O(U.alphaChannelUsage):void 0,a={ambient:l(e.diffuse),diffuse:l(e.diffuse),opacity:1-(e.transparency||0),transparent:n,textureAlphaMode:s,textureAlphaCutoff:.33,textureId:q,initTextureTransparent:!0,doubleSided:!0,cullFace:d.None,colorMixMode:e.externalColorMixMode||\"tint\",textureAlphaPremultiplied:U?.parameters.preMultiplyAlpha??!1};t?.materialParameters&&Object.assign(a,t.materialParameters),B=new x(a,t),o.set(R,T,B)}s.push(B);const C=new y(B,c);A+=c.find((e=>e[0]===w.POSITION))?.[1]?.indices.length??0,r.push(C)}return{engineResources:[{name:p,stageResources:{textures:n,materials:s,geometries:r},pivotOffset:u.model.pivotOffset,numberOfVertices:A,lodThreshold:null}],referenceBoundingBox:U(r)}}function U(e){const t=u();return e.forEach((e=>{const r=e.boundingInfo;null!=r&&(c(t,r.bbMin),c(t,r.bbMax))})),t}async function E(e,t){const r=new Array;for(const a in e){const n=e[a],s=n.images[0].data;if(!s){v().warn(\"Externally referenced texture data is not yet supported\");continue}const o=n.encoding+\";base64,\"+s,i=\"/textureDefinitions/\"+a,l=\"rgba\"===n.channels?n.alphaChannelUsage||\"transparency\":\"none\",u={noUnpackFlip:!0,wrap:{s:h.REPEAT,t:h.REPEAT},preMultiplyAlpha:O(l)!==g.Opaque},c=t?.disableTextures?Promise.resolve(null):p(o,t);r.push(c.then((e=>({refId:i,image:e,parameters:u,alphaChannelUsage:l}))))}const n=await Promise.all(r),s={};for(const a of n)s[a.refId]=a;return s}function O(e){switch(e){case\"mask\":return g.Mask;case\"maskAndTransparency\":return g.MaskBlend;case\"none\":return g.Opaque;default:return g.Blend}}function k(e){const t=e.params;return{id:1,material:t.material,texture:t.texture,region:t.texture}}const q=new i(1,2,\"wosr\");export{E as createTextureResources,A as load,T as processLoadResult};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nconst o=2.1;export{o as colorGamma};\n"],"names":[],"sourceRoot":""}