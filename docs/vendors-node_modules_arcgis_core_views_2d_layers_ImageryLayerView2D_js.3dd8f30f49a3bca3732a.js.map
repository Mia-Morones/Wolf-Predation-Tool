{"version":3,"file":"vendors-node_modules_arcgis_core_views_2d_layers_ImageryLayerView2D_js.3dd8f30f49a3bca3732a.js","mappings":"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","sources":["webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/imagery/RasterVFContainer.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/GraphicInstanceStore.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/layers/ImageryLayerView2D.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/layers/graphics/AGraphicContainer.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicBoundsRenderer.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/layers/graphics/HighlightGraphicContainer.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/layers/imagery/ImageryVFStrategy.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/layers/imagery/ImageryView2D.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/2d/layers/imagery/VectorFieldView2D.js","webpack://react-redux-arcgis-boilerplate/./node_modules/@arcgis/core/views/layers/ImageryLayerView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"./BrushVectorField.js\";import{WGLDrawPhase as r}from\"../webgl/enums.js\";import s from\"../webgl/WGLContainer.js\";class t extends s{constructor(){super(...arguments),this.symbolTypes=[\"triangle\"]}prepareRenderPasses(s){const t=s.registerRenderPass({name:\"imagery (vf)\",brushes:[e],target:()=>this.children,drawPhase:r.MAP});return[...super.prepareRenderPasses(s),t]}doRender(e){this.visible&&e.drawPhase===r.MAP&&this.symbolTypes.forEach((r=>{e.renderPass=r,super.doRender(e)}))}}export{t as RasterVFContainer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{FeatureTechniqueInstance as e}from\"./TechniqueInstance.js\";import{Techniques as i}from\"./TechniqueRegistry.js\";import{castInstanceId as t}from\"./mesh/instanceIdUtils.js\";let n=0;function a(i,a){return new e(t(n++),i,a)}const l={visualVariableColor:null,visualVariableOpacity:null,visualVariableSizeMinMaxValue:null,visualVariableSizeScaleStops:null,visualVariableSizeStops:null,visualVariableSizeUnitValue:null,visualVariableRotation:null,visualVariableSizeOutlineScaleStops:null};class o{constructor(){this.instances={fill:a(i.fill,{uniforms:l,optionalAttributes:{zoomRange:!0}}),marker:a(i.marker,{uniforms:l,optionalAttributes:{zoomRange:!0}}),line:a(i.line,{uniforms:l,optionalAttributes:{zoomRange:!0}}),text:a(i.text,{uniforms:l,optionalAttributes:{zoomRange:!0,referenceSymbol:!1,clipAngle:!1}}),complexFill:a(i.complexFill,{uniforms:l,optionalAttributes:{zoomRange:!0}}),texturedLine:a(i.texturedLine,{uniforms:l,optionalAttributes:{zoomRange:!0}}),animatedMarker:a(i.animatedMarker,{uniforms:l,optionalAttributes:{zoomRange:!0}})},this._instancesById=Object.values(this.instances).reduce(((e,i)=>(e.set(i.instanceId,i),e)),new Map)}getInstance(e){return this._instancesById.get(e)}}export{o as GraphicInstanceStore};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import i from\"../../../Graphic.js\";import t from\"../../../core/Collection.js\";import{makeHandle as r}from\"../../../core/handleUtils.js\";import has from\"../../../core/has.js\";import{watch as s,sync as a}from\"../../../core/reactiveUtils.js\";import{property as h}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import{GraphicsCollection as n}from\"../../../support/GraphicsCollection.js\";import l from\"../engine/flow/FlowView2D.js\";import{LayerView2DMixin as c}from\"./LayerView2D.js\";import w from\"./graphics/GraphicsView2D.js\";import p from\"./graphics/HighlightGraphicContainer.js\";import d from\"./imagery/ImageryView2D.js\";import m from\"./imagery/VectorFieldView2D.js\";import u from\"../../layers/ImageryLayerView.js\";import g from\"../../layers/LayerView.js\";import y from\"../../layers/RefreshableLayerView.js\";let v=class extends(u(y(c(g)))){constructor(){super(...arguments),this._exportImageVersion=-1,this._highlightGraphics=new n,this._highlightView=void 0,this.layer=null,this.subview=null}get pixelData(){const{subview:e}=this;return this.updating||!e?null:\"getPixelData\"in e?e.getPixelData():null}update(e){this.subview?.update(e)}attach(){this.layer.increaseRasterJobHandlerUsage(),this._setSubView(),this.view&&(this._highlightView=new w({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new p(this.view.featuresTilingScheme)}),this.container.addChild(this._highlightView.container)),this.addAttachHandles([s((()=>this.layer.exportImageServiceParameters.version),(e=>{e&&this._exportImageVersion!==e&&(this._exportImageVersion=e,this.requestUpdate())}),a),s((()=>this.timeExtent),(e=>{const{subview:i}=this;i&&(i.timeExtent=e,\"redraw\"in i?this.requestUpdate():i.redrawOrRefetch())}),a),this.layer.on(\"redraw\",(()=>{const{subview:e}=this;e&&(\"redraw\"in e?e.redraw():e.redrawOrRefetch())})),s((()=>this.layer.renderer),(()=>this._setSubView()))])}detach(){this.layer.decreaseRasterJobHandlerUsage(),this.container.removeAllChildren(),this._detachSubview(this.subview),this.subview?.destroy(),this.subview=null,this._highlightView?.destroy(),this._exportImageVersion=-1}viewChange(){}moveEnd(){this.requestUpdate()}highlight(e,s){if(!((Array.isArray(e)?e[0]:t.isCollection(e)?e.at(0):e)instanceof i))return r();let a=[];return Array.isArray(e)||t.isCollection(e)?a=e.map((e=>e.clone())):e instanceof i&&(a=[e.clone()]),this._highlightGraphics.addMany(a),r((()=>this._highlightGraphics.removeMany(a)))}async doRefresh(){this.requestUpdate()}isUpdating(){const e=!this.subview||this.subview.updating||!!this._highlightView?.updating;return has(\"esri-2d-log-updating\")&&console.log(`Updating ImageryLayerView2D (${this.layer.id}): ${e}\\n-> subview ${!this.subview||this.subview.updating}\\n-> higlightView ${this._highlightView?.updating}\\n`),e}_setSubView(){if(!this.view)return;const e=this.layer.renderer?.type;let i=\"imagery\";if(\"vector-field\"===e?i=\"imageryVF\":\"flow\"===e&&(i=\"flow\"),this.subview){const{type:e}=this.subview;if(e===i)return this._attachSubview(this.subview),void(\"flow\"===e?this.subview.redrawOrRefetch():\"imagery\"===e&&\"lerc\"===this.layer.format?this.subview.redraw():this.requestUpdate());this._detachSubview(this.subview),this.subview?.destroy()}this.subview=\"imagery\"===i?new d({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):\"imageryVF\"===i?new m({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):new l({layer:this.layer,layerView:this}),this._attachSubview(this.subview),this.requestUpdate()}_attachSubview(e){e&&!e.attached&&(e.attach(),e.attached=!0,this.container.addChildAt(e.container,0))}_detachSubview(e){e?.attached&&(this.container.removeChild(e.container),e.detach(),e.attached=!1)}};e([h()],v.prototype,\"pixelData\",null),e([h()],v.prototype,\"subview\",void 0),v=e([o(\"esri.views.2d.layers.ImageryLayerView2D\")],v);const b=v;export{b as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{destroyMaybe as e}from\"../../../../core/maybe.js\";import{AFeatureContainer as t}from\"../../engine/AFeatureContainer.js\";import{FeatureBatchingStrategy as n}from\"../../engine/webgl/enums.js\";import{GraphicInstanceStore as r}from\"../../engine/webgl/shaderGraph/techniques/GraphicInstanceStore.js\";import s from\"./GraphicBoundsRenderer.js\";class i extends t{constructor(e){super(e),this._instanceStore=new r,this.checkHighlight=()=>!0}destroy(){super.destroy(),this._boundsRenderer=e(this._boundsRenderer)}get instanceStore(){return this._instanceStore}enableRenderingBounds(e){this._boundsRenderer=new s(e),this.requestRender()}get hasHighlight(){return this.checkHighlight()}onTileData(e,t){e.onMessage(t),this.contains(e)||this.addChild(e),this.requestRender()}_renderChildren(e,t){e.selection=t;for(const r of this.children){if(!r.visible)continue;const t=r.getDisplayList(this._instanceStore,n.STRICT_ORDER);t?.render(e)}}}export{i as AGraphicContainer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{disposeMaybe as t}from\"../../../../core/maybe.js\";import{identity as e,multiply as r,translate as i,scale as s,rotate as o}from\"../../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as a}from\"../../../../core/libs/gl-matrix-2/factories/mat3f32.js\";import{fromValues as n}from\"../../../../core/libs/gl-matrix-2/factories/vec2f32.js\";import{fromValues as l}from\"../../../../core/libs/gl-matrix-2/factories/vec3f32.js\";import{normalizeMapX as f}from\"../../../../geometry/support/normalizeUtils.js\";import{DisplayObject as m}from\"../../engine/DisplayObject.js\";import{createProgramDescriptor as c}from\"../../engine/webgl/Utils.js\";import{BufferObject as u}from\"../../../webgl/BufferObject.js\";import{BlendFactor as _,PrimitiveType as h,DataType as p,Usage as d}from\"../../../webgl/enums.js\";import{VertexArrayObject as g}from\"../../../webgl/VertexArrayObject.js\";const v=Math.PI/180,x=4;class b extends m{constructor(t){super(),this._program=null,this._vao=null,this._vertexBuffer=null,this._indexBuffer=null,this._dvsMat3=a(),this._localOrigin={x:0,y:0},this._getBounds=t}destroy(){this._vao&&(this._vao.dispose(),this._vao=null,this._vertexBuffer=null,this._indexBuffer=null),this._program=t(this._program)}doRender(t){const{context:e}=t,r=this._getBounds();if(r.length<1)return;this._createShaderProgram(e),this._updateMatricesAndLocalOrigin(t),this._updateBufferData(e,r),e.setBlendingEnabled(!0),e.setDepthTestEnabled(!1),e.setStencilWriteMask(0),e.setStencilTestEnabled(!1),e.setBlendFunction(_.ONE,_.ONE_MINUS_SRC_ALPHA),e.setColorMask(!0,!0,!0,!0);const i=this._program;e.bindVAO(this._vao),e.useProgram(i),i.setUniformMatrix3fv(\"u_dvsMat3\",this._dvsMat3),e.gl.lineWidth(1),e.drawElements(h.LINES,8*r.length,p.UNSIGNED_INT,0),e.bindVAO()}_createTransforms(){return{displayViewScreenMat3:a()}}_createShaderProgram(t){if(this._program)return;const e=\"precision highp float;\\n        uniform mat3 u_dvsMat3;\\n\\n        attribute vec2 a_position;\\n\\n        void main() {\\n          mediump vec3 pos = u_dvsMat3 * vec3(a_position, 1.0);\\n          gl_Position = vec4(pos.xy, 0.0, 1.0);\\n        }\",r=\"precision mediump float;\\n      void main() {\\n        gl_FragColor = vec4(0.75, 0.0, 0.0, 0.75);\\n      }\";this._program=t.programCache.acquire(e,r,y().attributes)}_updateMatricesAndLocalOrigin(t){const{state:a}=t,{displayMat3:m,size:c,resolution:u,pixelRatio:_,rotation:h,viewpoint:p}=a,d=v*h,{x:g,y:x}=p.targetGeometry,b=f(g,a.spatialReference);this._localOrigin.x=b,this._localOrigin.y=x;const y=_*c[0],B=_*c[1],M=u*y,j=u*B,A=e(this._dvsMat3);r(A,A,m),i(A,A,n(y/2,B/2)),s(A,A,l(c[0]/M,-B/j,1)),o(A,A,-d)}_updateBufferData(t,e){const{x:r,y:i}=this._localOrigin,s=2*x*e.length,o=new Float32Array(s),a=new Uint32Array(8*e.length);let n=0,l=0;for(const f of e)f&&(o[2*n]=f[0]-r,o[2*n+1]=f[1]-i,o[2*n+2]=f[0]-r,o[2*n+3]=f[3]-i,o[2*n+4]=f[2]-r,o[2*n+5]=f[3]-i,o[2*n+6]=f[2]-r,o[2*n+7]=f[1]-i,a[l]=n+0,a[l+1]=n+3,a[l+2]=n+3,a[l+3]=n+2,a[l+4]=n+2,a[l+5]=n+1,a[l+6]=n+1,a[l+7]=n+0,n+=4,l+=8);if(this._vertexBuffer?this._vertexBuffer.setData(o.buffer):this._vertexBuffer=u.createVertex(t,d.DYNAMIC_DRAW,o.buffer),this._indexBuffer?this._indexBuffer.setData(a):this._indexBuffer=u.createIndex(t,d.DYNAMIC_DRAW,a),!this._vao){const e=y();this._vao=new g(t,e.attributes,e.bufferLayouts,new Map([[\"geometry\",this._vertexBuffer]]),this._indexBuffer)}}}const y=()=>c(\"bounds\",{geometry:[{location:0,name:\"a_position\",count:2,type:p.FLOAT}]});export{b as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../../chunks/tslib.es6.js\";import\"../../../../core/Logger.js\";import\"../../../../core/has.js\";import\"../../../../core/RandomLCG.js\";import\"../../../../core/Error.js\";import{subclass as e}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{WGLDrawPhase as s,FeatureSelection as t}from\"../../engine/webgl/enums.js\";import{AGraphicContainer as o}from\"./AGraphicContainer.js\";import{renderHighlight as i}from\"../support/util.js\";let a=class extends o{get hasHighlight(){return this.children.some((r=>r.hasData))}renderChildren(r){this.attributeView.update(),r.drawPhase===s.HIGHLIGHT&&this.children.some((r=>r.hasData))&&(super.renderChildren(r),r.context.setColorMask(!0,!0,!0,!0),i(r,!0,(r=>{this._renderChildren(r,t.All)}),0))}};a=r([e(\"esri.views.2d.layers.graphics.HighlightGraphicContainer\")],a);const h=a;export{h as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Accessor.js\";import i from\"../../../../core/Logger.js\";import{debounce as r,isAbortError as o}from\"../../../../core/promiseUtils.js\";import{property as s}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/RandomLCG.js\";import{subclass as a}from\"../../../../core/accessorSupport/decorators/subclass.js\";import n from\"../../../../geometry/Extent.js\";import{RasterVFDisplayObject as l}from\"../../engine/imagery/RasterVFDisplayObject.js\";let c=class extends t{constructor(e){super(e),this._loading=null,this.update=r(((e,t)=>this._update(e,t).catch((e=>{o(e)||i.getLogger(this).error(e)}))))}get updating(){return!!this._loading}redraw(e){if(!this.container.children.length)return;const t=this.container.children[0];t.symbolizerParameters=e,t.invalidateVAO(),this.container.symbolTypes=\"wind_speed\"===e.style?[\"scalar\",\"triangle\"]:\"simple_scalar\"===e.style?[\"scalar\"]:[\"triangle\"],this.container.requestRender()}async _update(e,t,i){if(!e.stationary)return;const{extent:r,spatialReference:o}=e.state,s=new n({xmin:r.xmin,ymin:r.ymin,xmax:r.xmax,ymax:r.ymax,spatialReference:o}),[a,l]=e.state.size;this._loading=this.fetchPixels(s,a,l,i);const c=await this._loading;this._addToDisplay(c,t,e.state),this._loading=null}_addToDisplay(e,t,i){if(null==e.pixelBlock)return this.container.children.forEach((e=>e.destroy())),void this.container.removeAllChildren();const{extent:r,pixelBlock:o}=e,s=new l(o);s.offset=[0,0],s.symbolizerParameters=t,s.rawPixelData=e,s.invalidateVAO(),s.x=r.xmin,s.y=r.ymax,s.pixelRatio=i.pixelRatio,s.rotation=i.rotation,s.resolution=i.resolution,s.width=o.width*t.symbolTileSize,s.height=o.height*t.symbolTileSize,this.container.children.forEach((e=>e.destroy())),this.container.removeAllChildren(),this.container.symbolTypes=\"wind_speed\"===t.style?[\"scalar\",\"triangle\"]:\"simple_scalar\"===t.style?[\"scalar\"]:[\"triangle\"],this.container.addChild(s)}};e([s()],c.prototype,\"fetchPixels\",void 0),e([s()],c.prototype,\"container\",void 0),e([s()],c.prototype,\"_loading\",void 0),e([s()],c.prototype,\"updating\",null),c=e([a(\"esri.views.2d.layers.imagery.ImageryVFStrategy\")],c);const p=c;export{p as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import e from\"../../../../Graphic.js\";import i from\"../../../../core/Accessor.js\";import r from\"../../../../core/Logger.js\";import{isAbortError as s}from\"../../../../core/promiseUtils.js\";import{property as a}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/RandomLCG.js\";import{subclass as o}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{mosaicPixelData as p}from\"../../../../layers/support/rasterFunctions/pixelUtils.js\";import{BitmapContainer as n}from\"../../engine/BitmapContainer.js\";import{Container as l}from\"../../engine/Container.js\";import c from\"../../engine/ImageryBitmapSource.js\";import h from\"../support/ExportStrategy.js\";let m=class extends i{constructor(){super(...arguments),this.attached=!1,this.container=new l,this.updateRequested=!1,this.type=\"imagery\",this._bitmapView=new n}destroy(){this.attached&&(this.detach(),this.attached=!1),this.updateRequested=!1}get updating(){return!this.attached||this.isUpdating()}update(t){this.strategy.update(t).catch((t=>{s(t)||r.getLogger(this).error(t)}))}hitTest(t){return new e({attributes:{},geometry:t.clone(),layer:this.layer})}attach(){this.container.addChild(this._bitmapView);const t=this.layer.version>=10,e=this.layer.version>=10.1?this.layer.imageMaxHeight:2048,i=this.layer.version>=10.1?this.layer.imageMaxWidth:2048;this.strategy=new h({container:this._bitmapView,imageNormalizationSupported:t,imageMaxHeight:e,imageMaxWidth:i,fetchSource:this._fetchImage.bind(this),requestUpdate:()=>this.requestUpdate()})}detach(){this.strategy.destroy(),this._bitmapView.removeAllChildren(),this.container.removeAllChildren(),this.updateRequested=!1}redraw(){this.strategy.updateExports((async t=>{const{source:e}=t;if(!e||e instanceof ImageBitmap)return;const i=await this.layer.applyRenderer({extent:e.extent,pixelBlock:e.originalPixelBlock??e.pixelBlock});e.filter=t=>this.layer.pixelFilter?this.layer.applyFilter(t):{...i,extent:e.extent}})).catch((t=>{s(t)||r.getLogger(this).error(t)}))}requestUpdate(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())}isUpdating(){return this.strategy.updating||this.updateRequested}getPixelData(){if(this.updating)return null;const t=this.strategy.bitmaps;if(1===t.length&&t[0].source)return{extent:t[0].source.extent,pixelBlock:t[0].source.originalPixelBlock};if(t.length>1){const e=this.view.extent,i=t.map((t=>t.source)).filter((t=>t.extent&&t.extent.intersects(e))).map((t=>({extent:t.extent,pixelBlock:t.originalPixelBlock}))),r=p(i,e);return null!=r?{extent:r.extent,pixelBlock:r.pixelBlock}:null}return null}async _fetchImage(t,e,i,r){(r=r||{}).timeExtent=this.timeExtent,r.requestAsImageElement=!0,r.returnImageBitmap=!0;const s=await this.layer.fetchImage(t,e,i,r);if(s.imageBitmap)return s.imageBitmap;const a=await this.layer.applyRenderer(s.pixelData,{signal:r.signal}),o=new c(a.pixelBlock,a.extent?.clone(),s.pixelData.pixelBlock);return o.filter=t=>this.layer.applyFilter(t),o}};t([a()],m.prototype,\"attached\",void 0),t([a()],m.prototype,\"container\",void 0),t([a()],m.prototype,\"layer\",void 0),t([a()],m.prototype,\"strategy\",void 0),t([a()],m.prototype,\"timeExtent\",void 0),t([a()],m.prototype,\"view\",void 0),t([a()],m.prototype,\"updateRequested\",void 0),t([a()],m.prototype,\"updating\",null),t([a()],m.prototype,\"type\",void 0),m=t([o(\"esri.views.2d.layers.imagery.ImageryView2D\")],m);const d=m;export{d as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import e from\"../../../../Graphic.js\";import r from\"../../../../request.js\";import i from\"../../../../core/Accessor.js\";import s from\"../../../../core/Logger.js\";import{isAbortError as a}from\"../../../../core/promiseUtils.js\";import{watch as o,syncAndInitial as n}from\"../../../../core/reactiveUtils.js\";import{property as l}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/RandomLCG.js\";import{subclass as m}from\"../../../../core/accessorSupport/decorators/subclass.js\";import c from\"../../../../geometry/Extent.js\";import{srToRESTValue as p}from\"../../../../geometry/support/spatialReferenceUtils.js\";import{projectExtent as h}from\"../../../../layers/support/rasterFunctions/rasterProjectionHelper.js\";import{snapImageToSymbolTile as y,convertVectorFieldData as u}from\"../../../../layers/support/rasterFunctions/vectorFieldUtils.js\";import{RasterVFContainer as x}from\"../../engine/imagery/RasterVFContainer.js\";import d from\"./ImageryVFStrategy.js\";let f=class extends i{constructor(){super(...arguments),this.attached=!1,this.container=new x,this.type=\"imageryVF\",this._dataParameters={exportParametersVersion:0,bbox:\"\",symbolTileSize:0,time:\"\"},this._fetchpixels=async(t,e,r,i)=>{const s=await this._projectFullExtentPromise,{symbolTileSize:a}=this.layer.renderer,{extent:o,width:n,height:l}=y(t,e,r,a,s);if(null!=s&&!s.intersects(t))return{extent:o,pixelBlock:null};const m={bbox:`${o.xmin}, ${o.ymin}, ${o.xmax}, ${o.ymax}`,exportParametersVersion:this.layer.exportImageServiceParameters.version,symbolTileSize:a,time:JSON.stringify(this.timeExtent||\"\")};if(this._canReuseVectorFieldData(m)){const t=this.getPixelData();if(null!=t){if(`${t.extent.xmin}, ${t.extent.ymin}, ${t.extent.xmax}, ${t.extent.ymax}`===m.bbox)return t}}const{pixelData:c}=await this.layer.fetchImage(o,n,l,{timeExtent:this.timeExtent,requestAsImageElement:!1,signal:i});this._dataParameters=m;const p=c?.pixelBlock;if(null==p)return{extent:o,pixelBlock:null};return{extent:o,pixelBlock:\"vector-uv\"===this.layer.rasterInfo.dataType?u(p,\"vector-uv\"):p}}}get updating(){return!this.attached||this._strategy.updating}attach(){this._projectFullExtentPromise=this._getProjectedFullExtent(this.view.spatialReference),this._strategy=new d({container:this.container,fetchPixels:this._fetchpixels}),this.addHandles(o((()=>this.layer.renderer),(t=>this._updateSymbolizerParams(t)),n),\"attach\")}detach(){this._strategy.destroy(),this.container.children.forEach((t=>t.destroy())),this.container.removeAllChildren(),this.removeHandles(\"attach\"),this._strategy=this.container=this._projectFullExtentPromise=null}getPixelData(){const t=this.container.children[0]?.rawPixelData;if(this.updating||!t)return null;const{extent:e,pixelBlock:r}=t;return{extent:e,pixelBlock:r}}hitTest(t){return new e({attributes:{},geometry:t.clone(),layer:this.layer})}update(t){this._strategy.update(t,this._symbolizerParams).catch((t=>{a(t)||s.getLogger(this).error(t)}))}redraw(){const{renderer:t}=this.layer;t&&(this._updateSymbolizerParams(t),this._strategy.redraw(this._symbolizerParams))}_canReuseVectorFieldData(t){const e=this._dataParameters.exportParametersVersion===t.exportParametersVersion,r=this._dataParameters.time===t.time,i=this._dataParameters.symbolTileSize===t.symbolTileSize,s=this._dataParameters.bbox===t.bbox;return e&&r&&i&&s}async _getProjectedFullExtent(t){try{return h(this.layer.fullExtent,t)}catch(e){try{const e=(await r(this.layer.url,{query:{option:\"footprints\",outSR:p(t),f:\"json\"}})).data.featureCollection.layers[0].layerDefinition.extent;return e?c.fromJSON(e):null}catch{return null}}}_updateSymbolizerParams(t){\"vector-field\"===t.type&&(this._symbolizerParams=this.layer.symbolizer.generateWebGLParameters({pixelBlock:null}))}};t([l()],f.prototype,\"attached\",void 0),t([l()],f.prototype,\"container\",void 0),t([l()],f.prototype,\"layer\",void 0),t([l()],f.prototype,\"timeExtent\",void 0),t([l()],f.prototype,\"type\",void 0),t([l()],f.prototype,\"view\",void 0),t([l()],f.prototype,\"updating\",null),f=t([m(\"esri.views.2d.layers.imagery.VectorFieldView2D\")],f);const g=f;export{g as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../core/Error.js\";import{throwIfAborted as r}from\"../../core/promiseUtils.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import i from\"../../geometry/Point.js\";import{combineTimeExtent as p}from\"../../layers/support/timeSupport.js\";import a from\"../../rest/support/Query.js\";import{getFetchPopupTemplate as n}from\"./support/popupUtils.js\";const m=m=>{let u=class extends m{constructor(){super(...arguments),this.view=null}get timeExtent(){return p(this.layer,this.view?.timeExtent,this._get(\"timeExtent\"))}async fetchPopupFeaturesAtLocation(e,o){const{layer:s}=this;if(!e)throw new t(\"imagerylayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s});const{popupEnabled:p}=s,m=n(s,o);if(!p||null==m)return[];const u=await m.getRequiredFields();r(o);const c=new a;c.timeExtent=this.timeExtent,c.geometry=e,c.outFields=u,c.outSpatialReference=e.spatialReference;const{resolution:l,spatialReference:y}=this.view,h=\"2d\"===this.view.type?new i(l,l,y):new i(.5*l,.5*l,y),{returnTopmostRaster:d,showNoDataRecords:f}=m.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},w={returnDomainValues:!0,returnTopmostRaster:d,pixelSize:h,showNoDataRecords:f,signal:o?.signal};return s.queryVisibleRasters(c,w).then((e=>e))}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return e([o()],u.prototype,\"layer\",void 0),e([o()],u.prototype,\"suspended\",void 0),e([o({readOnly:!0})],u.prototype,\"timeExtent\",null),e([o()],u.prototype,\"view\",void 0),u=e([s(\"esri.views.layers.ImageryLayerView\")],u),u};export{m as default};\n"],"names":[],"sourceRoot":""}