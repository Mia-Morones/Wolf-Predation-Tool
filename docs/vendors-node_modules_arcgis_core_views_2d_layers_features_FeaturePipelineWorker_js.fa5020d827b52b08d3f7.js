"use strict";
(self["webpackChunkreact_redux_arcgis_boilerplate"] = self["webpackChunkreact_redux_arcgis_boilerplate"] || []).push([["vendors-node_modules_arcgis_core_views_2d_layers_features_FeaturePipelineWorker_js"],{

/***/ "./node_modules/@arcgis/core/geohash/GeohashCell.js":
/*!**********************************************************!*\
  !*** ./node_modules/@arcgis/core/geohash/GeohashCell.js ***!
  \**********************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   GeohashCell: function() { return /* binding */ l; }
/* harmony export */ });
/* harmony import */ var _geohashUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./geohashUtils.js */ "./node_modules/@arcgis/core/geohash/geohashUtils.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/* harmony import */ var _layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../layers/graphics/featureConversionUtils.js */ "./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js");
/* harmony import */ var _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../layers/graphics/OptimizedGeometry.js */ "./node_modules/@arcgis/core/layers/graphics/OptimizedGeometry.js");
/* harmony import */ var _layers_graphics_data_projectionSupport_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../layers/graphics/data/projectionSupport.js */ "./node_modules/@arcgis/core/layers/graphics/data/projectionSupport.js");
/* harmony import */ var _views_2d_layers_features_aggregation_AAggregateCell_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../views/2d/layers/features/aggregation/AAggregateCell.js */ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/AAggregateCell.js");
/* harmony import */ var _views_2d_layers_features_aggregation_AccumulatedStatistics_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../views/2d/layers/features/aggregation/AccumulatedStatistics.js */ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/AccumulatedStatistics.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class l extends _views_2d_layers_features_aggregation_AAggregateCell_js__WEBPACK_IMPORTED_MODULE_5__.AAggregateCell{static create(t,e,o,s){const r=_views_2d_layers_features_aggregation_AccumulatedStatistics_js__WEBPACK_IMPORTED_MODULE_6__.AccumulatedStatistics.create(t),i=new Array(32);for(let h=0;h<i.length;h++)i[h]=null;return new l(r,e,o,s,i)}constructor(t,e,o,s,r){super(t),this.xNode=e,this.yNode=o,this.depth=s,this.children=r,this._objectIds=new Set,this._count=0,this._xWorldTotal=0,this._yWorldTotal=0,this._xGeohashTotal=0,this._yGeohashTotal=0,this.next=null}get id(){return`${this.xNode}.${this.yNode}`}get containedObjectIds(){return this._objectIds}get count(){return this._count}clone(){const t=new l(this._statistics.clone(),this.xNode,this.yNode,this.depth,this.children);return t._count=this._count,t._xWorldTotal=this._xWorldTotal,t._yWorldTotal=this._yWorldTotal,t._xGeohashTotal=this._xGeohashTotal,t._yGeohashTotal=this._yGeohashTotal,t.next=this.next,t._objectIds=new Set(this._objectIds),t}insert(t,e,o,s,r,i){this._count+=1,this._xWorldTotal+=e,this._yWorldTotal+=o,this._xGeohashTotal+=s,this._yGeohashTotal+=r,this._statistics.insert(t,i),this._objectIds.add(t.getObjectId())}merge(t){if(0!==t._count){this._count+=t._count,this._xWorldTotal+=t._xWorldTotal,this._yWorldTotal+=t._yWorldTotal,this._xGeohashTotal+=t._xWorldTotal,this._yGeohashTotal+=t._yWorldTotal,this._statistics.merge(t._statistics);for(const e of t._objectIds.values())this._objectIds.add(e)}}getCentroid(t){throw new Error("getCentroid not supported for GeohashNode")}getGeometry(t,r){const a=this._getLngLatBounds(),[n,l,d,c]=a,_=(0,_layers_graphics_data_projectionSupport_js__WEBPACK_IMPORTED_MODULE_4__.project)({rings:[[[n,l],[n,c],[d,c],[d,l],[n,l]]]},_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_1__["default"].WGS84,t),u=(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_2__.convertFromPolygon)(new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_3__["default"],_,!1,!1);if(null!=r){return (0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_2__.quantizeOptimizedGeometry)(new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_3__["default"],u,!1,!1,"esriGeometryPolygon",r,!1,!1)}return u}getGeometricCentroid(t,o){const a=this._getLngLatBounds(),[n,l,d,c]=a,_=(0,_layers_graphics_data_projectionSupport_js__WEBPACK_IMPORTED_MODULE_4__.project)({x:(n+d)/2,y:(l+c)/2},_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_1__["default"].WGS84,t),u=(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_2__.convertFromPoint)(new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_3__["default"],_);if(null!=o){return (0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_2__.quantizeOptimizedGeometry)(new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_3__["default"],u,!1,!1,"esriGeometryPoint",o,!1,!1)}return u}getAttributes(){const t={aggregateId:this.id};for(const e of this._statistics.values())t[e.field.name]=e.value;return t.aggregateCount=this._count,t}find(t,e,o,s,r,i){if(s>=o)return this;const h=1-s%2,a=3*h+2*(1-h),n=2*h+3*(1-h),l=30-r-a,d=30-i-n,c=((t&7*h+3*(1-h)<<l)>>l)+((e&3*h+7*(1-h)<<d)>>d)*(8*h+4*(1-h)),_=this.children[c];return null==_?null:_.find(t,e,o,s+1,r+a,i+n)}_getLngLatBounds(){const e=this.depth,o=Math.ceil(e/2),s=Math.floor(e/2),r=30-(3*o+2*s),i=30-(2*o+3*s),h=this.xNode<<r,a=this.yNode<<i;return (0,_geohashUtils_js__WEBPACK_IMPORTED_MODULE_0__.decodeGeohashXY)({geohashX:h,geohashY:a},this.depth)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/geohash/GeohashTree.js":
/*!**********************************************************!*\
  !*** ./node_modules/@arcgis/core/geohash/GeohashTree.js ***!
  \**********************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   GeohashTree: function() { return /* binding */ e; }
/* harmony export */ });
/* harmony import */ var _GeohashCell_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GeohashCell.js */ "./node_modules/@arcgis/core/geohash/GeohashCell.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class e{constructor(e){this._fields=e,this._size=0,this._depth=0,this._root=_GeohashCell_js__WEBPACK_IMPORTED_MODULE_0__.GeohashCell.create(this._fields,0,0,0)}destroy(){}get size(){return this._size}get depth(){return this._depth}find(t,e,s){return this._root.find(t,e,s,0,0,0)}insert(e,s,i,n,o,h,r){let l=this._root,d=0,c=0,a=0;for(;null!==l;){if(l.insert(e,s,i,n,o,r),d>=h)return;const f=Math.ceil((d+1)/2),u=Math.floor((d+1)/2),x=1-d%2,_=30-(3*f+2*u),p=30-(2*f+3*u),M=(n&7*x+3*(1-x)<<_)>>_,m=(o&3*x+7*(1-x)<<p)>>p,g=M+m*(8*x+4*(1-x));c=c<<3*x+2*(1-x)|M,a=a<<2*x+3*(1-x)|m,null==l.children[g]&&(l.children[g]=_GeohashCell_js__WEBPACK_IMPORTED_MODULE_0__.GeohashCell.create(this._fields,c,a,d+1),this._depth=Math.max(this._depth,d+1),this._size+=1),d+=1,l=l.children[g]}}putBins(t,e){for(const s of this.getNodes(e)){const e=t.get(s.id);e?e.merge(s):t.set(s.id,s.clone())}}getNodes(t){const e=[],{geohashBounds:s,level:i}=t;let n=this._root;for(;null!==n;){const t=n.depth,o=n.xNode,h=n.yNode;if(t>=i){e.push(n),n=n.next;continue}const r=Math.ceil((t+1)/2),l=Math.floor((t+1)/2),d=1-t%2,c=30-(3*r+2*l),a=30-(2*r+3*l),f=~((1<<c)-1),u=~((1<<a)-1),x=(s.xLL&f)>>c,_=(s.yLL&u)>>a,p=(s.xTR&f)>>c,M=(s.yTR&u)>>a,m=o<<3*d+2*(1-d),g=h<<2*d+3*(1-d),y=m+8*d+4*(1-d),z=g+4*d+8*(1-d),L=Math.max(m,x),N=Math.max(g,_),B=Math.min(y,p),R=Math.min(z,M);let T=null,j=null;for(let e=N;e<=R;e++)for(let t=L;t<=B;t++){const s=t-m+(e-g)*(8*d+4*(1-d)),i=n.children[s];i&&(T||(T=i,T.next=n.next),j&&(j.next=i),j=i,i.next=n.next)}n=T||n.next}return e}}


/***/ }),

/***/ "./node_modules/@arcgis/core/geohash/geohashUtils.js":
/*!***********************************************************!*\
  !*** ./node_modules/@arcgis/core/geohash/geohashUtils.js ***!
  \***********************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   convertGeohash32ToXY: function() { return /* binding */ E; },
/* harmony export */   decodeBase32Char: function() { return /* binding */ G; },
/* harmony export */   decodeGeohash: function() { return /* binding */ v; },
/* harmony export */   decodeGeohashXY: function() { return /* binding */ R; },
/* harmony export */   encodeBase32Char: function() { return /* binding */ W; },
/* harmony export */   encodeGeohash: function() { return /* binding */ z; },
/* harmony export */   getGeohash: function() { return /* binding */ A; },
/* harmony export */   getGeohashBounds: function() { return /* binding */ S; },
/* harmony export */   getRelativeGeohash: function() { return /* binding */ T; },
/* harmony export */   setGeohashBuf: function() { return /* binding */ Y; },
/* harmony export */   setGeohashXY: function() { return /* binding */ X; },
/* harmony export */   unpackXBits: function() { return /* binding */ F; },
/* harmony export */   unpackYBits: function() { return /* binding */ P; }
/* harmony export */ });
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_mathUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/mathUtils.js */ "./node_modules/@arcgis/core/core/mathUtils.js");
/* harmony import */ var _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../geometry/Extent.js */ "./node_modules/@arcgis/core/geometry/Extent.js");
/* harmony import */ var _geometry_Polygon_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../geometry/Polygon.js */ "./node_modules/@arcgis/core/geometry/Polygon.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/* harmony import */ var _geometry_support_Ellipsoid_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../geometry/support/Ellipsoid.js */ "./node_modules/@arcgis/core/geometry/support/Ellipsoid.js");
/* harmony import */ var _layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../layers/graphics/featureConversionUtils.js */ "./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js");
/* harmony import */ var _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../layers/graphics/OptimizedGeometry.js */ "./node_modules/@arcgis/core/layers/graphics/OptimizedGeometry.js");
/* harmony import */ var _layers_graphics_data_projectionSupport_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../layers/graphics/data/projectionSupport.js */ "./node_modules/@arcgis/core/layers/graphics/data/projectionSupport.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const f=16,l=8,a=4,u=2,h=1,m=new Float64Array(2),p=new Float64Array(2),g=-90,y=90,d=-180,x=180,M="0123456789bcdefghjkmnpqrstuvwxyz",j=64;function S(t,e,f,l){const a=[t.xmin,t.ymin,t.xmax,t.ymax],u=_geometry_Polygon_js__WEBPACK_IMPORTED_MODULE_3__["default"].fromExtent(_geometry_Extent_js__WEBPACK_IMPORTED_MODULE_2__["default"].fromBounds(a,l)),h=(0,_layers_graphics_data_projectionSupport_js__WEBPACK_IMPORTED_MODULE_8__.project)(u,l,_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_4__["default"].WGS84,{densificationStep:e*j});if(!h)return null;const m=(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_6__.convertFromPolygon)(new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_7__["default"],h,!1,!1),p=m.coords.filter(((t,o)=>!(o%2))),g=m.coords.filter(((t,o)=>o%2)),y=Math.min(...p),d=Math.min(...g),x=Math.max(...p),M=Math.max(...g),S=A(y,d,f,_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_4__["default"].WGS84),G=A(x,M,f,_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_4__["default"].WGS84);return S&&G?{bounds:a,geohashBounds:{xLL:S[0],yLL:S[1],xTR:G[0],yTR:G[1]},level:f}:null}function A(o,r,s,c){if(c.isWebMercator){const n=(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_1__.rad2deg)(o/_geometry_support_Ellipsoid_js__WEBPACK_IMPORTED_MODULE_5__.earth.radius),c=n-360*Math.floor((n+180)/360),i=[0,0];return Y(i,0,(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_1__.rad2deg)(Math.PI/2-2*Math.atan(Math.exp(-r/_geometry_support_Ellipsoid_js__WEBPACK_IMPORTED_MODULE_5__.earth.radius))),c,s),i}const f=(0,_layers_graphics_data_projectionSupport_js__WEBPACK_IMPORTED_MODULE_8__.project)({x:o,y:r},c,_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_4__["default"].WGS84);if(!f)return null;const l=[0,0];return Y(l,0,f.y,f.x,s),l}function G(t){return t<=57?t-48:t<=104?t-88:t<=107?t-89:t<=110?t-90:t-91}function W(t){return M[t]}function w(t){return(t[0]+t[1])/2}function C(t,o,r){return t[0]=o,t[1]=r,t}function L(t,o){const r=w(t),n=o,e=!o;t[0]=e*t[0]+n*r,t[1]=e*r+n*t[1]}function b(t,o){const r=o>w(t);return L(t,r),r}function v(t,o){const r=C(m,g,y),n=C(p,d,x);for(let e=0;e<o.length;e++){const t=G(o.charCodeAt(e));e%2==0?(L(n,!!(f&t)),L(n,!!(a&t)),L(n,!!(h&t)),L(r,!!(l&t)),L(r,!!(u&t))):(L(r,!!(f&t)),L(r,!!(a&t)),L(r,!!(h&t)),L(n,!!(l&t)),L(n,!!(u&t)))}return t[0]=w(r),t[1]=w(n),t}function E(t,o){let r=0,n=0,e=30,s=30;for(let c=0;c<o.length;c++){const t=G(o.charCodeAt(c)),i=c%2==0;e-=i?3:2,s-=i?2:3,r|=F(t,i)<<e,n|=P(t,i)<<s}return{geohashX:r,geohashY:n}}function R(t,o){let r=-90,n=90,e=-180,s=180;for(let c=0;c<o;c++){const o=Math.ceil((c+1)/2),i=Math.floor((c+1)/2),f=1-c%2,l=30-(3*o+2*i),a=30-(2*o+3*i),u=3*f+2*(1-f),h=2*f+3*(1-f),m=3*f+7*(1-f)<<a,p=(7*f+3*(1-f)<<l&t.geohashX)>>l,g=(m&t.geohashY)>>a;for(let t=u-1;t>=0;t--){const o=(e+s)/2,r=p&1<<t?1:0;e=(1-r)*e+r*o,s=(1-r)*o+r*s}for(let t=h-1;t>=0;t--){const o=(r+n)/2,e=g&1<<t?1:0;r=(1-e)*r+e*o,n=(1-e)*o+e*n}}return[e,r,s,n]}function X(t,o,r,n){n%2&&(n+=1);let e=0,s=0,c=-90,i=90,f=-180,l=180;for(let a=0;a<n/2;a++){for(let t=0;t<5;t++){const o=(f+l)/2,n=r>o?1:0;e|=n<<29-(t+5*a),f=(1-n)*f+n*o,l=(1-n)*o+n*l}for(let t=0;t<5;t++){const r=(c+i)/2,n=o>r?1:0;s|=n<<29-(t+5*a),c=(1-n)*c+n*r,i=(1-n)*r+n*i}}t.geohashX=e,t.geohashY=s}function Y(t,o,r,n,e){e%2&&(e+=1);let s=0,c=0,i=-90,f=90,l=-180,a=180;for(let u=0;u<e/2;u++){for(let t=0;t<5;t++){const o=(l+a)/2,r=n>o?1:0;s|=r<<29-(t+5*u),l=(1-r)*l+r*o,a=(1-r)*o+r*a}for(let t=0;t<5;t++){const o=(i+f)/2,n=r>o?1:0;c|=n<<29-(t+5*u),i=(1-n)*i+n*o,f=(1-n)*o+n*f}}t[2*o]=s,t[2*o+1]=c}function z(t,o,r){let n="";const e=C(m,-90,90),s=C(p,-180,180);for(let c=0;c<r;c++){let r=0;!(c%2)?(r|=b(s,o)<<4,r|=b(e,t)<<3,r|=b(s,o)<<2,r|=b(e,t)<<1,r|=b(s,o)|0):(r|=b(e,t)<<4,r|=b(s,o)<<3,r|=b(e,t)<<2,r|=b(s,o)<<1,r|=b(e,t)|0),n+=W(r)}return n}function B(t,o,r){return r?t&h|(o&h)<<1|(t&u)<<1|(o&u)<<2|(t&a)<<2:o&h|(t&h)<<1|(o&u)<<1|(t&u)<<2|(o&a)<<2}function F(t,o){return o?h&t|(a&t)>>1|(f&t)>>2:(u&t)>>1|(l&t)>>2}function P(t,o){return o?(u&t)>>1|(l&t)>>2:h&t|(a&t)>>1|(f&t)>>2}function T(t,o,r){const n=!((t.length-1)%2),e=t.slice(0,-1),s=G(t.charCodeAt(t.length-1));let c=0,i=0,m=0,p=0;n?(c=8,i=4,m=h&s|(a&s)>>1|(f&s)>>2,p=(u&s)>>1|(l&s)>>2):(c=4,i=8,p=h&s|(a&s)>>1|(f&s)>>2,m=(u&s)>>1|(l&s)>>2);const g=m+o,y=p+r,d=Math.floor(g/c),x=Math.floor(y/i),M=W(B(g-d*c,y-x*i,n));return t.length>1&&(d||x)?T(e,d,x)+M:e+M}


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/graphics/data/StreamFeatureManager.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/graphics/data/StreamFeatureManager.js ***!
  \********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   StreamFeatureManager: function() { return /* binding */ o; },
/* harmony export */   defaultStreamIdField: function() { return /* binding */ s; },
/* harmony export */   esriTimestamp: function() { return /* binding */ i; }
/* harmony export */ });
/* harmony import */ var _core_CircularArray_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../core/CircularArray.js */ "./node_modules/@arcgis/core/core/CircularArray.js");
/* harmony import */ var _core_mathUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/mathUtils.js */ "./node_modules/@arcgis/core/core/mathUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const s="__esri_stream_id__",i="__esri_timestamp__",r=1e3;class o{constructor(t,e,i,r,o=128){this._trackIdToObservations=new Map,this._idCounter=0,this._lastPurge=performance.now(),this._addOrUpdated=new Map,this._removed=[],this._maxAge=0,this._timeInfo=i,this._purgeOptions=r,this.store=t,this.objectIdField=e,this.purgeInterval=o,this._useGeneratedIds=this.objectIdField===s}removeById(t){this._removed.push(t)}removeByTrackId(t){const e=this._trackIdToObservations.get(t);if(e)for(const s of e.entries)this._removed.push(s)}add(s){if(this._useGeneratedIds){const t=this._nextId();s.attributes[this.objectIdField]=t,s.objectId=t}else s.objectId=s.attributes[this.objectIdField];const i=s.objectId;if(this._addOrUpdated.set(i,s),this._maxAge=Math.max(this._maxAge,s.attributes[this._timeInfo.startTimeField]),!this._timeInfo.trackIdField)return null==this._trackIdLessObservations&&(this._trackIdLessObservations=new _core_CircularArray_js__WEBPACK_IMPORTED_MODULE_0__["default"](1e5)),void this._trackIdLessObservations.enqueue(i);const o=s.attributes[this._timeInfo.trackIdField];if(!this._trackIdToObservations.has(o)){const s=null!=this._purgeOptions?.maxObservations?this._purgeOptions.maxObservations:r,i=(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_1__.clamp)(s,0,r);this._trackIdToObservations.set(o,new _core_CircularArray_js__WEBPACK_IMPORTED_MODULE_0__["default"](i))}const d=this._trackIdToObservations.get(o),a=d?.enqueue(i);null!=a&&(this._addOrUpdated.has(a)?this._addOrUpdated.delete(a):this._removed.push(a))}checkForUpdates(){const t=this._getToAdd(),e=this._getToRemove(),s=performance.now();s-this._lastPurge>=this.purgeInterval&&(this._purge(s),this._lastPurge=s);const r=[];if(null!=e)for(const i of e){const t=this.store.removeById(i);null!=t&&r.push(t)}const o=[];if(null!=t){const r=new Set(e??[]);for(const e of t)r.has(e.objectId)||(e.attributes[i]=s,this.store.add(e),o.push(e))}return!(!o.length&&!r?.length)&&(this.store.update(o,r),!0)}_getToAdd(){if(!this._addOrUpdated.size)return null;const t=new Array(this._addOrUpdated.size);let e=0;return this._addOrUpdated.forEach((s=>t[e++]=s)),this._addOrUpdated.clear(),t}_getToRemove(){const t=this._removed;return this._removed.length?(this._removed=[],t):null}_nextId(){const t=this._idCounter;return this._idCounter=(this._idCounter+1)%4294967294+1,t}_purge(t){const e=this._purgeOptions;null!=e&&(this._purgeSomeByDisplayCount(e),this._purgeByAge(e),this._purgeByAgeReceived(t,e),this._purgeTracks())}_purgeSomeByDisplayCount(t){if(!t.displayCount)return;let e=this.store.size;if(e>t.displayCount){if(this._timeInfo.trackIdField)for(const s of this._trackIdToObservations.values())if(e>t.displayCount&&s.size){const t=s.dequeue();this._removed.push(t),e--}if(null!=this._trackIdLessObservations){let s=e-t.displayCount;for(;s-- >0;){const t=this._trackIdLessObservations.dequeue();null!=t&&this._removed.push(t)}}}}_purgeByAge(t){const e=this._timeInfo?.startTimeField;if(!t.age||!e)return;const s=60*t.age*1e3,i=this._maxAge-s;this.store.forEach((t=>{t.attributes[e]<i&&this._removed.push(t.objectId)}))}_purgeByAgeReceived(t,e){if(!e.ageReceived)return;const s=t-60*e.ageReceived*1e3;this.store.forEach((t=>{t.attributes[i]<s&&this._removed.push(t.objectId)}))}_purgeTracks(){this._trackIdToObservations.forEach(((t,e)=>{0===t.size&&this._trackIdToObservations.delete(e)}))}}


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/graphics/data/optimizedFeatureQueryEngineAdapter.js":
/*!**********************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/graphics/data/optimizedFeatureQueryEngineAdapter.js ***!
  \**********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   optimizedFeatureQueryEngineAdapter: function() { return /* binding */ o; }
/* harmony export */ });
/* harmony import */ var _centroid_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../centroid.js */ "./node_modules/@arcgis/core/layers/graphics/centroid.js");
/* harmony import */ var _OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../OptimizedFeature.js */ "./node_modules/@arcgis/core/layers/graphics/OptimizedFeature.js");
/* harmony import */ var _OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../OptimizedGeometry.js */ "./node_modules/@arcgis/core/layers/graphics/OptimizedGeometry.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const o={getObjectId:t=>t.objectId,getAttributes:t=>t.attributes,getAttribute:(t,e)=>t.attributes[e],cloneWithGeometry:(t,r)=>new _OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_1__.OptimizedFeature(r,t.attributes,null,t.objectId),getGeometry:t=>t.geometry,getCentroid:(e,o)=>(null==e.centroid&&(e.centroid=(0,_centroid_js__WEBPACK_IMPORTED_MODULE_0__.getCentroidOptimizedGeometry)(new _OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_2__["default"],e.geometry,o.hasZ,o.hasM)),e.centroid)};


/***/ }),

/***/ "./node_modules/@arcgis/core/libs/parquet/parquet.js":
/*!***********************************************************!*\
  !*** ./node_modules/@arcgis/core/libs/parquet/parquet.js ***!
  \***********************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ParquetFile: function() { return /* binding */ ne; },
/* harmony export */   ParquetMetadata: function() { return /* binding */ te; }
/* harmony export */ });
/* harmony import */ var _assets_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../assets.js */ "./node_modules/@arcgis/core/assets.js");
/* harmony import */ var _request_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../request.js */ "./node_modules/@arcgis/core/request.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
let n;const r=new Array(128).fill(void 0);function _(e){return r[e]}r.push(void 0,null,!0,!1);let i=r.length;function a(e){e<132||(r[e]=i,i=e)}function o(e){const t=_(e);return a(e),t}function s(e){i===r.length&&r.push(r.length+1);const t=i;return i=r[t],r[t]=e,t}const u="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&u.decode();let c=null;function d(){return null!==c&&0!==c.byteLength||(c=new Uint8Array(n.memory.buffer)),c}function g(e,t){return e>>>=0,u.decode(d().subarray(e,e+t))}const l="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>{n.__wbindgen_export_0.get(e.dtor)(e.a,e.b)}));function b(e,t,r,_){const i={a:e,b:t,cnt:1,dtor:r},a=(...e)=>{i.cnt++;const t=i.a;i.a=0;try{return _(t,i.b,...e)}finally{0==--i.cnt?(n.__wbindgen_export_0.get(i.dtor)(t,i.b),l.unregister(i)):i.a=t}};return a.original=i,l.register(a,i,i),a}function w(e,t,r){n._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h7be72b1871260ae2(e,t,s(r))}function f(){n.enableTracing()}let p=0;const y="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},h="function"==typeof y.encodeInto?function(e,t){return y.encodeInto(e,t)}:function(e,t){const n=y.encode(e);return t.set(n),{read:e.length,written:n.length}};function m(e,t,n){if(void 0===n){const n=y.encode(e),r=t(n.length,1)>>>0;return d().subarray(r,r+n.length).set(n),p=n.length,r}let r=e.length,_=t(r,1)>>>0;const i=d();let a=0;for(;a<r;a++){const t=e.charCodeAt(a);if(t>127)break;i[_+a]=t}if(a!==r){0!==a&&(e=e.slice(a)),_=n(_,r,r=a+3*e.length,1)>>>0;const t=d().subarray(_+a,_+r);a+=h(e,t).written,_=n(_,r,a,1)>>>0}return p=a,_}let F=null;function I(){return(null===F||!0===F.buffer.detached||void 0===F.buffer.detached&&F.buffer!==n.memory.buffer)&&(F=new DataView(n.memory.buffer)),F}function x(e,t){try{return e.apply(this,t)}catch(r){n.__wbindgen_exn_store(s(r))}}function v(e,t,r,_){n.wasm_bindgen__convert__closures__invoke2_mut__h35729c14da098d24(e,t,s(r),s(_))}let k=null;function T(){return null!==k&&0!==k.byteLength||(k=new Uint16Array(n.memory.buffer)),k}function q(e,t){const n=t(2*e.length,2)>>>0;return T().set(e,n/2),p=e.length,n}function R(e,t,r){const _=m(e,n.__wbindgen_malloc,n.__wbindgen_realloc),i=p;return o(n.readMetadata(_,i,s(t),s(r)))}function O(e,t){if(!(e instanceof t))throw new Error(`expected instance of ${t.name}`);return e.ptr}function M(e,t,r,_,i){const a=m(e,n.__wbindgen_malloc,n.__wbindgen_realloc),u=p;O(_,S);var c=_.__destroy_into_raw();O(i,D);var d=i.__destroy_into_raw();return o(n.readFile(a,u,s(t),s(r),c,d))}function j(e){return null==e}const A="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>n.__wbg_fieldmetadata_free(e>>>0,1)));class z{static __wrap(e){e>>>=0;const t=Object.create(z.prototype);return t.__wbg_ptr=e,A.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,A.unregister(this),e}free(){const e=this.__destroy_into_raw();n.__wbg_fieldmetadata_free(e,0)}get name(){let e,t;try{const i=n.__wbindgen_add_to_stack_pointer(-16);n.fieldmetadata_name(i,this.__wbg_ptr);var r=I().getInt32(i+0,!0),_=I().getInt32(i+4,!0);return e=r,t=_,g(r,_)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(e,t,1)}}get index(){return n.fieldmetadata_index(this.__wbg_ptr)}get type(){return["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeBigInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"][n.fieldmetadata_esri_type(this.__wbg_ptr)]}}const C="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>n.__wbg_filemetadata_free(e>>>0,1)));class S{static __wrap(e){e>>>=0;const t=Object.create(S.prototype);return t.__wbg_ptr=e,C.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,C.unregister(this),e}free(){const e=this.__destroy_into_raw();n.__wbg_filemetadata_free(e,0)}version(){return n.filemetadata_version(this.__wbg_ptr)}numRows(){return n.filemetadata_numRows(this.__wbg_ptr)>>>0}numFields(){return n.filemetadata_numFields(this.__wbg_ptr)>>>0}keyValueMetadata(e){try{const _=n.__wbindgen_add_to_stack_pointer(-16),i=m(e,n.__wbindgen_malloc,n.__wbindgen_realloc),a=p;n.filemetadata_keyValueMetadata(_,this.__wbg_ptr,i,a);var t=I().getInt32(_+0,!0),r=I().getInt32(_+4,!0);let o;return 0!==t&&(o=g(t,r).slice(),n.__wbindgen_free(t,1*r,1)),o}finally{n.__wbindgen_add_to_stack_pointer(16)}}getFieldIndex(e){const t=m(e,n.__wbindgen_malloc,n.__wbindgen_realloc),r=p,_=n.filemetadata_getFieldIndex(this.__wbg_ptr,t,r);return 16777215===_?void 0:_}getFieldByIndex(e){const t=n.filemetadata_getFieldByIndex(this.__wbg_ptr,e);return 0===t?void 0:z.__wrap(t)}}const W="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>n.__wbg_geometryinfodescriptor_free(e>>>0,1)));class D{static __wrap(e){e>>>=0;const t=Object.create(D.prototype);return t.__wbg_ptr=e,W.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,W.unregister(this),e}free(){const e=this.__destroy_into_raw();n.__wbg_geometryinfodescriptor_free(e,0)}get wkbIndex(){const e=n.__wbg_get_geometryinfodescriptor_wkbIndex(this.__wbg_ptr);return 16777215===e?void 0:e}set wkbIndex(e){n.__wbg_set_geometryinfodescriptor_wkbIndex(this.__wbg_ptr,j(e)?16777215:e)}get lngIndex(){const e=n.__wbg_get_geometryinfodescriptor_lngIndex(this.__wbg_ptr);return 16777215===e?void 0:e}set lngIndex(e){n.__wbg_set_geometryinfodescriptor_lngIndex(this.__wbg_ptr,j(e)?16777215:e)}get latIndex(){const e=n.__wbg_get_geometryinfodescriptor_latIndex(this.__wbg_ptr);return 16777215===e?void 0:e}set latIndex(e){n.__wbg_set_geometryinfodescriptor_latIndex(this.__wbg_ptr,j(e)?16777215:e)}static new(){const e=n.geometryinfodescriptor_new();return D.__wrap(e)}}const P="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>n.__wbg_parquetchunk_free(e>>>0,1)));class E{static __wrap(e){e>>>=0;const t=Object.create(E.prototype);return t.__wbg_ptr=e,P.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,P.unregister(this),e}free(){const e=this.__destroy_into_raw();n.__wbg_parquetchunk_free(e,0)}size(){return n.parquetchunk_size(this.__wbg_ptr)>>>0}hasField(e){return 0!==n.parquetchunk_hasField(this.__wbg_ptr,e)}readX(e){return n.parquetchunk_readX(this.__wbg_ptr,e)}readY(e){return n.parquetchunk_readY(this.__wbg_ptr,e)}readAttributes(e){return o(n.parquetchunk_readAttributes(this.__wbg_ptr,e))}readAttribute(e,t){return o(n.parquetchunk_readAttribute(this.__wbg_ptr,e,t))}}const B="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>n.__wbg_parquetfile_free(e>>>0,1)));let L=class e{static __wrap(t){t>>>=0;const n=Object.create(e.prototype);return n.__wbg_ptr=t,B.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,B.unregister(this),e}free(){const e=this.__destroy_into_raw();n.__wbg_parquetfile_free(e,0)}metadata(){const e=n.parquetfile_metadata(this.__wbg_ptr);return S.__wrap(e)}readChunksWithCallback(e,t){const r=q(e,n.__wbindgen_malloc),_=p;return o(n.parquetfile_readChunksWithCallback(this.__wbg_ptr,r,_,s(t)))}updateChunks(e){const t=q(e,n.__wbindgen_malloc),r=p;return o(n.parquetfile_updateChunks(this.__wbg_ptr,t,r))}};const U="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>n.__wbg_rangeproviderjs_free(e>>>0,1)));class G{static __wrap(e){e>>>=0;const t=Object.create(G.prototype);return t.__wbg_ptr=e,U.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,U.unregister(this),e}free(){const e=this.__destroy_into_raw();n.__wbg_rangeproviderjs_free(e,0)}static new(e,t){const r=n.rangeproviderjs_new(s(e),s(t));return G.__wrap(r)}static withFetch(){const e=n.rangeproviderjs_withFetch();return G.__wrap(e)}}async function N(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(n){if("application/wasm"==e.headers.get("Content-Type"))throw n;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n)}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}function V(){const e={wbg:{}};return e.wbg.__wbg_new_abda76e883ba8a5f=function(){return s(new Error)},e.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const r=m(_(t).stack,n.__wbindgen_malloc,n.__wbindgen_realloc),i=p;I().setInt32(e+4,i,!0),I().setInt32(e+0,r,!0)},e.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let r,_;try{r=e,_=t,console.error(g(e,t))}finally{n.__wbindgen_free(r,_,1)}},e.wbg.__wbindgen_object_drop_ref=function(e){o(e)},e.wbg.__wbindgen_is_function=function(e){return"function"==typeof _(e)},e.wbg.__wbg_self_3093d5d1f7bcb682=function(){return x((function(){return s(self.self)}),arguments)},e.wbg.__wbg_window_3bcfc4d31bc012f8=function(){return x((function(){return s(window.window)}),arguments)},e.wbg.__wbg_globalThis_86b222e13bdf32ed=function(){return x((function(){return s(globalThis.globalThis)}),arguments)},e.wbg.__wbg_global_e5a3fe56f8be9485=function(){return x((function(){return s(global.global)}),arguments)},e.wbg.__wbindgen_is_undefined=function(e){return void 0===_(e)},e.wbg.__wbg_newnoargs_76313bd6ff35d0f2=function(e,t){return s(new Function(g(e,t)))},e.wbg.__wbindgen_object_clone_ref=function(e){return s(_(e))},e.wbg.__wbindgen_number_new=function(e){return s(e)},e.wbg.__wbg_new_525245e2b9901204=function(){return s(new Object)},e.wbg.__wbindgen_string_new=function(e,t){return s(g(e,t))},e.wbg.__wbg_call_1084a111329e68ce=function(){return x((function(e,t){return s(_(e).call(_(t)))}),arguments)},e.wbg.__wbg_call_89af060b4e1523f2=function(){return x((function(e,t,n){return s(_(e).call(_(t),_(n)))}),arguments)},e.wbg.__wbg_call_7de908392845a9a5=function(){return x((function(e,t,n,r,i){return s(_(e).call(_(t),_(n),_(r),_(i)))}),arguments)},e.wbg.__wbg_valueOf_563b3487b1b116aa=function(e){return _(e).valueOf()},e.wbg.__wbg_set_eacc7d73fefaafdf=function(){return x((function(e,t,n){return Reflect.set(_(e),_(t),_(n))}),arguments)},e.wbg.__wbg_buffer_b7b08af79b0b0974=function(e){return s(_(e).buffer)},e.wbg.__wbg_new_b85e72ed1bfd57f9=function(e,t){try{var n={a:e,b:t},r=(e,t)=>{const r=n.a;n.a=0;try{return v(r,n.b,e,t)}finally{n.a=r}};return s(new Promise(r))}finally{n.a=n.b=0}},e.wbg.__wbg_resolve_570458cb99d56a43=function(e){return s(Promise.resolve(_(e)))},e.wbg.__wbg_then_95e6edc0f89b73b1=function(e,t){return s(_(e).then(_(t)))},e.wbg.__wbg_then_876bb3c633745cc6=function(e,t,n){return s(_(e).then(_(t),_(n)))},e.wbg.__wbg_new_ea1883e1e5e86686=function(e){return s(new Uint8Array(_(e)))},e.wbg.__wbg_length_8339fcf5d8ecd12e=function(e){return _(e).length},e.wbg.__wbg_set_d1e79e2388520f18=function(e,t,n){_(e).set(_(t),n>>>0)},e.wbg.__wbindgen_throw=function(e,t){throw new Error(g(e,t))},e.wbg.__wbindgen_memory=function(){return s(n.memory)},e.wbg.__wbg_queueMicrotask_48421b3cc9052b68=function(e){return s(_(e).queueMicrotask)},e.wbg.__wbindgen_cb_drop=function(e){const t=o(e).original;if(1==t.cnt--)return t.a=0,!0;return!1},e.wbg.__wbg_queueMicrotask_12a30234db4045d3=function(e){queueMicrotask(_(e))},e.wbg.__wbg_parquetchunk_new=function(e){return s(E.__wrap(e))},e.wbg.__wbindgen_bigint_from_i64=function(e){return s(e)},e.wbg.__wbg_parquetfile_new=function(e){return s(L.__wrap(e))},e.wbg.__wbg_filemetadata_new=function(e){return s(S.__wrap(e))},e.wbg.__wbindgen_closure_wrapper1401=function(e,t,n){return s(b(e,t,74,w))},e}function X(e,t){return n=e.exports,J.__wbindgen_wasm_module=t,F=null,k=null,c=null,n}function $(e){if(void 0!==n)return n;void 0!==e&&Object.getPrototypeOf(e)===Object.prototype?({module:e}=e):console.warn("using deprecated parameters for `initSync()`; pass a single object instead");const t=V();e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e));return X(new WebAssembly.Instance(e,t),e)}async function J(e){if(void 0!==n)return n;void 0!==e&&Object.getPrototypeOf(e)===Object.prototype?({module_or_path:e}=e):console.warn("using deprecated parameters for the initialization function; pass a single object instead");const t=V();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:r,module:_}=await N(await e,t);return X(r,_)}const Y=Object.freeze(Object.defineProperty({__proto__:null,FieldMetadata:z,FileMetadata:S,GeometryInfoDescriptor:D,ParquetChunk:E,ParquetFile:L,RangeProviderJs:G,default:J,enableTracing:f,initSync:$,readFile:M,readMetadata:R},Symbol.toStringTag,{value:"Module"}));let H=null;async function K(){return H||(H=Q()),H}async function Q(){const t=await Promise.resolve().then((()=>Y));return await t.default({module_or_path:(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.getAssetUrl)("esri/libs/parquet/pkg/arcgis_parquet_bg.wasm")}),t.enableTracing(),t}const Z=e=>async function(n,r,_){const i=e(),{data:a}=await (0,_request_js__WEBPACK_IMPORTED_MODULE_1__["default"])(n,{responseType:"array-buffer",query:i,headers:{range:`bytes=${r}-${_}`}});return a},ee=e=>async function(n){const r=e(),{data:_}=await (0,_request_js__WEBPACK_IMPORTED_MODULE_1__["default"])(n,{responseType:"native",method:"head",query:r}),i=_.headers.get("Content-Length");if(null==i)throw new Error("Unable to parse content length");return parseInt(i,10)};class te{static async create(e,t){const n=await K(),r=await n.readMetadata(e,Z(t),ee(t));return te.fromFileMetadata(r)}static fromFileMetadata(e){const t=[];for(let n=0;n<e.numFields();n++){const r=e.getFieldByIndex(n);t.push({name:r.name,type:r.type,alias:r.name,index:r.index}),r.free()}return new te(e,t)}constructor(e,t){this._inner=e,this.fields=t}destroy(){this._inner.free()}[Symbol.dispose](){this.destroy()}get size(){return this._inner.numRows()}getFieldIndex(e){return this._inner.getFieldIndex(e)}tryReadGeoMetadata(){const e=this._inner.keyValueMetadata("geo");return null==e?null:JSON.parse(e)}}class ne{static async create(e,t){const n=await K(),r=Z(t.getCustomParameters),_=ee(t.getCustomParameters),i=await R(e,r,_),{geometryInfo:a}=t,o=D.new();"location"===a.type?(o.latIndex=i.getFieldIndex(a.latitudeFieldName),o.lngIndex=i.getFieldIndex(a.longitudeFieldName)):o.wkbIndex=i.getFieldIndex(a.primaryFieldName);const s=await n.readFile(e,r,_,i,o);return new ne(s,te.fromFileMetadata(s.metadata()))}constructor(e,t){this.inner=e,this.metadata=t}destroy(){this.inner.free(),this.metadata.destroy()}[Symbol.dispose](){this.destroy()}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/engine/webgl/mesh/MultiTileMeshData.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/engine/webgl/mesh/MultiTileMeshData.js ***!
  \***********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   MultiTileMeshData: function() { return /* binding */ g; }
/* harmony export */ });
/* harmony import */ var _tiling_TileInfoView_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../tiling/TileInfoView.js */ "./node_modules/@arcgis/core/views/2d/tiling/TileInfoView.js");
/* harmony import */ var _tiling_TileKey_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../tiling/TileKey.js */ "./node_modules/@arcgis/core/views/2d/tiling/TileKey.js");
/* harmony import */ var _tiling_TileQueue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../tiling/TileQueue.js */ "./node_modules/@arcgis/core/views/2d/tiling/TileQueue.js");
/* harmony import */ var _tiling_TileStrategy_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../tiling/TileStrategy.js */ "./node_modules/@arcgis/core/views/2d/tiling/TileStrategy.js");
/* harmony import */ var _definitions_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../definitions.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/definitions.js");
/* harmony import */ var _MeshData_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./MeshData.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/mesh/MeshData.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const i=1,r=2,n=4,h=8,o=16,c=32,a=64,l=128;function f(e){switch(e){case i:case h:case c:return-1;case r:case a:return 0;case n:case o:case l:return 1}}function u(e){switch(e){case i:case r:case n:return-1;case h:case o:return 0;case c:case a:case l:return 1}}const d=i|h|c,_=n|o|l,m=i|r|n,p=c|a|l;class g{constructor(e,s,i,r,n=0){this.tileKey=e,this._bufferingEnabled=s,this._sizeHint=n,this._meshes={self:new _MeshData_js__WEBPACK_IMPORTED_MODULE_5__.MeshData(this.id,this._sizeHint),neighbors:new Array},this._currentRecordOverlaps=0,this._currentEntityOverlaps=0;const h=r?1:0;this._copyBufferedDataIntoSelf=i&&this._bufferingEnabled&&e.level===h}get id(){return this.tileKey.id}vertexCount(){return this._meshes.self.vertexCount()}indexCount(){return this._meshes.self.indexCount()}indexEnsureSize(e){this._meshes.self.indexEnsureSize(e)}entityStart(e,s=e){this._currentEntityOverlaps=0,this._meshes.self.entityStart(e,s)}entityRecordCount(){return this._meshes.self.entityRecordCount()}entityEnd(){if(this._meshes.self.entityEnd(),this._bufferingEnabled){if(this._copyBufferedDataIntoSelf)return;for(let e=0;e<8;e++){const s=1<<e;!!(this._currentEntityOverlaps&s)&&this._meshes.neighbors[e].entityEnd()}}}recordStart(e,s,t){this._currentRecordOverlaps=0,this._meshes.self.recordStart(e,s,t)}recordEnd(e=0){const s=this._meshes.self.recordEnd(this._currentRecordOverlaps);return s&&0!==this._currentRecordOverlaps?(this._copyIntoNeighbors(),this._currentEntityOverlaps|=this._currentRecordOverlaps,!0):s}recordBounds(e,s,t,i){this._bufferingEnabled&&this._addOverlap(e,s,t,i)}recordCount(){return this._meshes.self.recordCount()}metricStart(e){this._meshes.self.metricStart(e)}metricBoxWrite(e){this._meshes.self.metricBoxWrite(e)}metricEnd(){this._meshes.self.metricEnd()}vertexWrite(e){this._meshes.self.vertexWrite(e)}vertexWriteF32(e){this._meshes.self.vertexWriteF32(e)}vertexWriteRegion(e){this._meshes.self.vertexWriteRegion(e)}indexWrite(e){this._meshes.self.indexWrite(e)}serialize(s){const t={message:[],transferList:[]},i=this._meshes.self.serialize();return t.message.push({tileId:this.tileKey.id,...i.message}),t.transferList.push(...i.transferList),this._meshes.neighbors.forEach(((i,r)=>{const n=i.serialize(),h=1<<r,o=f(h),c=u(h),a=new _tiling_TileKey_js__WEBPACK_IMPORTED_MODULE_1__["default"](this.tileKey).getNormalizedNeighbor(o,c,s);t.message.push({tileId:a.id,...n.message}),t.transferList.push(...n.transferList)})),t}_addOverlap(e,t,i,r){const n=Math.min(_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize/2,i),h=Math.min(_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize/2,r),o=255^((e<0+n?_:e>=_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize-n?d:_|d)|(t<0+h?p:t>=_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize-h?m:p|m));this._currentRecordOverlaps|=o}_copyIntoNeighbors(){for(let e=0;e<8;e++){const i=1<<e;if(!!(this._currentRecordOverlaps&i)){if(this._copyBufferedDataIntoSelf){const e=-f(i)*_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize,t=-u(i)*_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize;if(0!==t)continue;this._meshes.self.copyLast(e,t);continue}if(!this._meshes.neighbors[e]){const s=Math.floor(this._sizeHint/16);this._meshes.neighbors[e]=new _MeshData_js__WEBPACK_IMPORTED_MODULE_5__.MeshData(i,s)}const r=this._meshes.neighbors[e],n=-f(i)*_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize,h=-u(i)*_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize;r.copyLastFrom(this._meshes.self,n,h)}}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/engine/webgl/mesh/factories/FeatureMeshFactory.js":
/*!**********************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/engine/webgl/mesh/factories/FeatureMeshFactory.js ***!
  \**********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureMeshFactory: function() { return /* binding */ s; }
/* harmony export */ });
/* harmony import */ var _MeshFactory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MeshFactory.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/mesh/factories/MeshFactory.js");
/* harmony import */ var _util_createMatcher_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../util/createMatcher.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/createMatcher.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class s extends _MeshFactory_js__WEBPACK_IMPORTED_MODULE_0__.AMeshFactory{static async create(e,o){const r=await (0,_util_createMatcher_js__WEBPACK_IMPORTED_MODULE_1__.createMatcher)(e,o.symbology),c=o.labels?await (0,_util_createMatcher_js__WEBPACK_IMPORTED_MODULE_1__.createMatcher)(e,o.labels):null;return new s(r,c)}constructor(e,t){super(),this._symbology=e,this._labels=t}destroy(){}async enqueueMatcherRequests(e,t){await Promise.all([this._symbology.fetchResources(e,t),this._labels?.fetchResources(e,t)])}enqueueWriterRequests(e,t,s){const o=this._symbology.match(t,s);if(o){for(const r of o)r.enqueueRequest(e,t,s);if(this._labels){const o=this._labels.match(t,s);if(!o)return;for(const r of o)r.enqueueRequest(e,t,s)}}}write(e,t,s,o,r){const c=this._symbology.match(s,o);if(!c)return;for(const i of c)i.write(e,t,s,o,r);if(e.entityRecordCount()>=1&&this._labels){const i=this._labels.match(s,o);if(!i)return;for(const a of i)a.setReferences(c),a.write(e,t,s,o,r)}}getSortKey(e,t){return this._symbology.getSortKey(e,t)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/engine/webgl/mesh/factories/MeshFactory.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/engine/webgl/mesh/factories/MeshFactory.js ***!
  \***************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AMeshFactory: function() { return /* binding */ s; }
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class s{}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/DictionaryMatcher.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/engine/webgl/util/DictionaryMatcher.js ***!
  \***********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DictionaryMatcher: function() { return /* binding */ e; }
/* harmony export */ });
/* harmony import */ var _Matcher_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Matcher.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/Matcher.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class e extends _Matcher_js__WEBPACK_IMPORTED_MODULE_0__.FeatureMatcher{static async fromDictionaryRenderer(t,s){return new e(t,s)}constructor(t,e){super(),this._context=t,this._schema=e,this._hashToGroup=new Map}get fieldMap(){return this._schema.fieldMap}async fetchResources(t,e){const s=e.getCursor(),r=[];for(;s.next();)r.push(this._updateMeshWriterGroup(t,s));await Promise.all(r)}match(t,e){const s=t.getAttributeHash();return this._hashToGroup.get(s)}async _updateMeshWriterGroup(t,e){const s=e.readLegacyFeatureForDisplay(),r=e.getAttributeHash();if(this._hashToGroup.has(r))return;this._hashToGroup.set(r,null);const a=await t.fetchDictionaryResourceImmediate({type:"dictionary-request",feature:s});if(!a)return;const h=await this._context.createMeshWriters(a.meshes);this._hashToGroup.set(r,h)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/IntervalMatcher.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/engine/webgl/util/IntervalMatcher.js ***!
  \*********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   IntervalMatcher: function() { return /* binding */ e; }
/* harmony export */ });
/* harmony import */ var _Matcher_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Matcher.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/Matcher.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class e extends _Matcher_js__WEBPACK_IMPORTED_MODULE_0__.FeatureMatcher{constructor(t,e){super(),this._intervals=[],this._isMaxInclusive=e,this._field=t}static async fromIntervalSchema(t,s){const i=await t.storage.createComputedField(s),r=new e(i,s.isMaxInclusive);await Promise.all(s.intervals.map((async e=>{const s=await t.createMeshWriters(e.meshes);r.add(e,s)})));const a=await t.createMeshWriters(s.defaultSymbol);r.setDefault(a);const n=await t.createMeshWriters(s.backgroundFill);return r.setBackgroundFill(n),r}add(t,e){this._intervals.push({interval:t,result:e}),this._intervals.sort(((t,e)=>t.interval.min-e.interval.min))}size(){return super.size()+this._intervals.length}doMatch(t,e){const s=this._field?.read(t,e);if(null==s||isNaN(s)||s===1/0||s===-1/0)return null;for(let i=0;i<this._intervals.length;i++){const{interval:t,result:e}=this._intervals[i],r=s>=t.min,a=this._isMaxInclusive?s<=t.max:s<t.max;if(r&&a)return e}return null}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/LabelMatcher.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/engine/webgl/util/LabelMatcher.js ***!
  \******************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   LabelMatcher: function() { return /* binding */ a; }
/* harmony export */ });
/* harmony import */ var _Matcher_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Matcher.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/Matcher.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class a extends _Matcher_js__WEBPACK_IMPORTED_MODULE_0__.FeatureMatcher{static async fromLabelSchema(e,s){const r=s.classes.map((async a=>{const s=await e.createMeshWriters(a.meshes);return{minScale:a.minScale,maxScale:a.maxScale,meshes:s,expression:null,where:await e.storage.createWhereClause(a.where)}})),t=await Promise.all(r);return new a(t)}constructor(e){super(),this._labels=e}match(e,a){if(!this._labels.length)return null;const s=this._getLabels(a.$view.scale),r=[];for(const t of s)t.where&&!t.where(e)||r.push(...t.meshes);return r}_getLabels(e){return this._labels.filter((a=>this._validForTileScale(a,e)))}_validForTileScale(e,a){const s=a-a/4,r=a+a/2;return(!e.minScale||e.minScale>=s)&&(!e.maxScale||e.maxScale<=r)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/MapMatcher.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/engine/webgl/util/MapMatcher.js ***!
  \****************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   MapMatcher: function() { return /* binding */ t; }
/* harmony export */ });
/* harmony import */ var _Matcher_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Matcher.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/Matcher.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class t extends _Matcher_js__WEBPACK_IMPORTED_MODULE_0__.FeatureMatcher{constructor(e,t){super(),this._defaultSymbolSortKey=0,this._nullResult=null,this._resultsMap=new Map,this._fields=[],this._fields=e,this._separator=t||""}static async fromMatcherSchema(e,l){const s=l.expression?[e.storage.createComputedField({expression:l.expression})]:[l.field?e.storage.createComputedField({field:l.field}):null,l.field2?e.storage.createComputedField({field:l.field2}):null,l.field3?e.storage.createComputedField({field:l.field3}):null],r=(await Promise.all(s)).filter((e=>!!e)),i=new t(r,l.fieldDelimiter),a=await e.createMeshWriters(l.defaultSymbol);i.setDefault(a);const u=await e.createMeshWriters(l.backgroundFill);return i.setBackgroundFill(u),await Promise.all(l.map.map((async(t,l)=>{const s=await e.createMeshWriters(t.symbol);"<Null>"===t.value?i.setNullResult(s):i.add(t.value,s,l+1)}))),i}setNullResult(e){this._nullResult=e}getSortKey(e,t){const l=this._getValueFromFields(e,t);if(null==l||""===l||"<Null>"===l)return 0;const s=this._resultsMap.get(l.toString());return s?s.sortKey:this._defaultSymbolSortKey}add(e,t,l){this._resultsMap.set(e.toString(),{meshWriters:t,sortKey:l}),this._defaultSymbolSortKey=Math.max(this._defaultSymbolSortKey,l+1)}size(){return super.size()+this._resultsMap.size}doMatch(e,t){const l=this._getValueFromFields(e,t);if(null!==this._nullResult&&(null==l||""===l||"<Null>"===l))return this._nullResult;if(null==l)return null;const s=l.toString();return this._resultsMap.get(s)?.meshWriters}_getValueFromFields(e,t){const l=[];for(const s of this._fields){const r=s.read(e,t);null==r||""===r?l.push("<Null>"):l.push(r)}return l.join(this._separator)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/Matcher.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/engine/webgl/util/Matcher.js ***!
  \*************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureMatcher: function() { return /* binding */ t; }
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class t{constructor(){this._defaultResult=null,this._backgroundFillResult=null}static async from(e,s){const l=new t;return l.setDefault(await e.createMeshWriters(s.meshes)),l}size(){return 1}getDefault(){return this._defaultResult}setDefault(t){this._defaultResult=t}getBackgroundFill(){return this._backgroundFillResult}setBackgroundFill(t){this._backgroundFillResult=t}match(t,e){const s=this.doMatch(t,e)||this.getDefault();if(s&&s.length>0){const t=this.getBackgroundFill();if(t)return[...t,...s]}return s}getSortKey(t,e){return 0}doMatch(t,e){return null}async fetchResources(t,e){}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/MatcherContext.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/engine/webgl/util/MatcherContext.js ***!
  \********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   MatcherContext: function() { return /* binding */ s; }
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class s{constructor(s,r,t,e){this.storage=s,this.proxy=r,this.viewParams=t,this.registry=e}async createMeshWriters(s){const r=s.map((s=>this.registry.createMeshWriter(this.storage,this.proxy,this.viewParams,s)));return Promise.all(r)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/createMatcher.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/engine/webgl/util/createMatcher.js ***!
  \*******************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ClusterMatcher: function() { return /* binding */ o; },
/* harmony export */   SubtypeMatcher: function() { return /* binding */ n; },
/* harmony export */   createMatcher: function() { return /* binding */ c; }
/* harmony export */ });
/* harmony import */ var _DictionaryMatcher_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./DictionaryMatcher.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/DictionaryMatcher.js");
/* harmony import */ var _IntervalMatcher_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./IntervalMatcher.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/IntervalMatcher.js");
/* harmony import */ var _LabelMatcher_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./LabelMatcher.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/LabelMatcher.js");
/* harmony import */ var _MapMatcher_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./MapMatcher.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/MapMatcher.js");
/* harmony import */ var _Matcher_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Matcher.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/Matcher.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
async function c(c,u){switch(u.type){case"simple":case"heatmap":case"dot-density":case"pie-chart":return _Matcher_js__WEBPACK_IMPORTED_MODULE_4__.FeatureMatcher.from(c,u);case"interval":return _IntervalMatcher_js__WEBPACK_IMPORTED_MODULE_1__.IntervalMatcher.fromIntervalSchema(c,u);case"dictionary":return _DictionaryMatcher_js__WEBPACK_IMPORTED_MODULE_0__.DictionaryMatcher.fromDictionaryRenderer(c,u);case"label":return _LabelMatcher_js__WEBPACK_IMPORTED_MODULE_2__.LabelMatcher.fromLabelSchema(c,u);case"map":return _MapMatcher_js__WEBPACK_IMPORTED_MODULE_3__.MapMatcher.fromMatcherSchema(c,u);case"subtype":return n.fromSubtypes(c,u);case"cluster":return o.fromClusterSchema(c,u);default:throw new Error("Impl")}}class n extends _Matcher_js__WEBPACK_IMPORTED_MODULE_4__.FeatureMatcher{constructor(e,t){super(),this._subMatchers=e,this._subtypeField=t}static async fromSubtypes(e,t){const r=new Map,s=[];for(const a in t.renderers){const n=parseInt(a,10),o=c(e,t.renderers[a]).then((e=>r.set(n,e)));s.push(o)}return await Promise.all(s),new n(r,t.subtypeField)}match(e,t){const r=e.readAttribute(this._subtypeField),s=this._subMatchers.get(r);return s?s.match(e,t):null}}class o extends _Matcher_js__WEBPACK_IMPORTED_MODULE_4__.FeatureMatcher{static async fromClusterSchema(e,t){const[r,s]=await Promise.all([c(e,t.feature),c(e,t.cluster)]);return new o(r,s)}constructor(e,t){super(),this._featureMatcher=e,this._clusterMatcher=t}match(e,t){return 1===e.readAttribute("cluster_count")?this._featureMatcher.match(e,t):this._clusterMatcher.match(e,t)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/FeaturePipelineWorker.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/FeaturePipelineWorker.js ***!
  \*************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ y; }
/* harmony export */ });
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_handleUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../core/handleUtils.js */ "./node_modules/@arcgis/core/core/handleUtils.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_nextTick_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../core/nextTick.js */ "./node_modules/@arcgis/core/core/nextTick.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../core/RandomLCG.js */ "./node_modules/@arcgis/core/core/RandomLCG.js");
/* harmony import */ var _core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../core/reactiveUtils.js */ "./node_modules/@arcgis/core/core/reactiveUtils.js");
/* harmony import */ var _core_screenUtils_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../core/screenUtils.js */ "./node_modules/@arcgis/core/core/screenUtils.js");
/* harmony import */ var _core_workers_utils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../../core/workers/utils.js */ "./node_modules/@arcgis/core/core/workers/utils.js");
/* harmony import */ var _layers_support_TileInfo_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../../layers/support/TileInfo.js */ "./node_modules/@arcgis/core/layers/support/TileInfo.js");
/* harmony import */ var _tiling_TileInfoView_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../tiling/TileInfoView.js */ "./node_modules/@arcgis/core/views/2d/tiling/TileInfoView.js");
/* harmony import */ var _tiling_TileKey_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../tiling/TileKey.js */ "./node_modules/@arcgis/core/views/2d/tiling/TileKey.js");
/* harmony import */ var _tiling_TileQueue_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../tiling/TileQueue.js */ "./node_modules/@arcgis/core/views/2d/tiling/TileQueue.js");
/* harmony import */ var _tiling_TileStrategy_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../tiling/TileStrategy.js */ "./node_modules/@arcgis/core/views/2d/tiling/TileStrategy.js");
/* harmony import */ var _engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../engine/webgl/definitions.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/definitions.js");
/* harmony import */ var _PipelineConnectionHandlers_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./PipelineConnectionHandlers.js */ "./node_modules/@arcgis/core/views/2d/layers/features/PipelineConnectionHandlers.js");
/* harmony import */ var _Processor_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./Processor.js */ "./node_modules/@arcgis/core/views/2d/layers/features/Processor.js");
/* harmony import */ var _sources_FeatureSource_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./sources/FeatureSource.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/FeatureSource.js");
/* harmony import */ var _sources_FeatureTileSubscription_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./sources/FeatureTileSubscription.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/FeatureTileSubscription.js");
/* harmony import */ var _support_Tile_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./support/Tile.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/Tile.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class m{constructor(e){this.inner=e,this.resolver=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.createResolver)()}}class y{constructor(){this._aggregateAdapter={getFeatureObjectIds:e=>this._processor.getFeatureObjectIdsForAggregate(e)},this._subscriptions=new Map,this._updateRequested=!1,this._updateSubscriptionRequests=[],this._updateHighlightRequests=[]}destroy(){this._subscriptions.clear(),this._processor?.destroy(),this._source?.destroy(),this._handles?.remove(),this._updateLocalEditsRequest=null,this._tileInfoView=null}onAttach(e){(0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__["default"])("esri-2d-update-debug")&&console.debug("Pipeline.onAttach");const s=this._connection,i=_layers_support_TileInfo_js__WEBPACK_IMPORTED_MODULE_9__["default"].fromJSON(e.tileInfoJSON);this._tileInfoView=new _tiling_TileInfoView_js__WEBPACK_IMPORTED_MODULE_10__["default"](i),this._source=new _sources_FeatureSource_js__WEBPACK_IMPORTED_MODULE_17__.FeatureSource(e.service,this._aggregateAdapter,this._subscriptions,(()=>this._requestUpdate()),s),this._processor=new _Processor_js__WEBPACK_IMPORTED_MODULE_16__["default"](s,this._source),this._handles=(0,_core_handleUtils_js__WEBPACK_IMPORTED_MODULE_1__.handlesGroup)([(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_6__.watch)((()=>this._source.updateTracking.updating),(()=>{this._requestUpdate(),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.ignoreAbortErrors)(this._connection.layerView.setUpdating({data:this._source.updateTracking.updating,pipeline:!0}))}))])}onDetach(){(0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__["default"])("esri-2d-update-debug")&&console.debug("Pipeline.onDetach"),this.destroy()}set remoteClient(e){this._connection=new _PipelineConnectionHandlers_js__WEBPACK_IMPORTED_MODULE_15__.PipelineConnectionHandlers(e)}get features(){const t=this._source?.queryEngine;if(!t)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"]("no-queryEngine","No query engine defined");return t}get aggregates(){const t=this._processor?.aggregateQueryEngine;if(!t)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"]("no-queryEngine","No aggregate query engine defined");return t}get processor(){return this._processor}get streamMessenger(){return this._source.streamMessenger}getDisplayFeatures(e){return this._processor.getDisplayFeatures(e)}getDisplayIds(e){return this._processor.getDisplayIds(e)}async updateSchema(e,t){return (0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__["default"])("esri-2d-update-debug")&&this._updateSchemaRequest&&console.error("InternalError: Schema already updating"),this._updateSchemaRequest=new m({schema:e,version:t}),this._requestUpdate(),this._updateSchemaRequest.resolver.promise}updateSubscriptions(e){const t=new m(e);return this._updateSubscriptionRequests.push(t),this._requestUpdate(),t.resolver.promise}updateHighlight(e){const t=new m(e);return this._updateHighlightRequests.push(t),this._requestUpdate(),t.resolver.promise}async addParquetFile(e){return this._source.addParquetFile(e)}async onEdits(t){if(null!=this._updateLocalEditsRequest)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"]("InternalError - Already processing an edit");this._updateLocalEditsRequest=new m(t);const s=this._updateLocalEditsRequest.resolver.promise;return this._requestUpdate(),s}queryStatistics(){return this._source.statistics.toJSON()}async queryVisibleFeatures(e,t){return this.features.executeQuery(e,t)}async queryHeatmapStatistics(e){const t=Math.round((0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_7__.pt2px)(e.radius));let s=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const r="string"==typeof e.fieldOffset,o=e.fieldOffset??0,n=Array.from(this._subscriptions.values()),u=this._source.chunks(),d=t**2,c=3/(Math.PI*d),p=2*t,h=Math.ceil(_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_14__.tileSize/p);for(const a of n){const t=a.tile,n=new Float64Array(h*h);for(const s of u){const i=s.getTileReader(t);if(!i)continue;const u=i.getCursor();for(;u.next();){let t=1;if(null!=e.field){const s=u.readAttribute(e.field);t=r?-1*+s:+s+o}const s=u.readXForDisplay()/p,i=u.readYForDisplay()/p,a=Math.floor(s),l=Math.floor(i);if(a<0||l<0||a>=h||l>=h)continue;const g=((.5+a-s)*p)**2+((.5+l-i)*p)**2;if(g>d)continue;const _=t*(c*(1-g/d)**2);n[l+a*h]+=_}}for(let e=0;e<n.length;e++)s=Math.min(s,n[e]),i=Math.max(i,n[e])}return{max:i,min:s}}async getSampleFeatures(e){const t=this._source.chunks();if(t.reduce(((e,t)=>e+t.size()),0)<=e.minFeatureCount){if(!this._source.updateTracking.updating){const e=[];return this._source.store.forEachUnsafe((t=>e.push(t.readLegacyFeatureWorldSpace()))),e}return null}const s=new Set,i=[],r=t.map((e=>e.reader.getCursor())),o=new _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_5__["default"],u=3*e.sampleSize;for(let n=0;n<u&&i.length<e.sampleSize;n++){const e=r[o.getIntRange(0,t.length-1)];if(0===e.getSize())continue;const n=o.getIntRange(0,e.getSize()-1);e.setIndex(n);const u=e.getObjectId();s.has(u)||(s.add(u),i.push(e.readLegacyFeatureWorldSpace()))}return i.length>=e.sampleSize?i:null}_requestUpdate(){this._updateRequested||(this._updateRequested=!0,(0,_core_nextTick_js__WEBPACK_IMPORTED_MODULE_3__.nextTick)((()=>this._scheduleNextUpdate())))}_scheduleNextUpdate(){this._updateRequested&&(this._ongoingUpdate||(this._ongoingUpdate=(0,_core_workers_utils_js__WEBPACK_IMPORTED_MODULE_8__.ignoreConnectionErrors)(this._doUpdate()).finally((()=>{this._ongoingUpdate=null,this._scheduleNextUpdate()})),this._updateRequested=!1))}_subscribe(e){const t=e.tileId;if(this._subscriptions.has(t))return;(0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__["default"])("esri-2d-update-debug")&&console.debug(`Tile[${t}] Pipeline.subscribe`);const s=new _support_Tile_js__WEBPACK_IMPORTED_MODULE_19__.Tile(this._tileInfoView,t),i=new _sources_FeatureTileSubscription_js__WEBPACK_IMPORTED_MODULE_18__.FeatureTileSubscription(s,e.version);this._subscriptions.set(t,i),this._source.onSubscribe(i),this._processor.onSubscribe(i)}_unsubscribe(e){const t=this._subscriptions.get(e);t&&((0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__["default"])("esri-2d-update-debug")&&console.debug(`Tile[${e}] Pipeline.unsubscribe`),t.abort(),this._source.onUnsubscribe(t),this._processor.onUnsubscribe(t),this._subscriptions.delete(t.key.id))}async _doUpdate(){if((0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__["default"])("esri-2d-update-debug")&&console.debug("Pipeline._doUpdateStart"),await this._connection.layerView.setUpdating({data:this._source.updateTracking.updating,pipeline:!0}),this._updateSubscriptionRequests.length){const e=this._updateSubscriptionRequests;this._updateSubscriptionRequests=[];for(const t of e)this._doUpdateSubscriptions(t.inner),t.resolver.resolve()}const e=this._updateSchemaRequest;if(this._updateSchemaRequest=null,null!=e){const{schema:t,version:s}=e.inner;await this._doUpdateSchema(t,s)}const t=this._updateLocalEditsRequest;if(this._updateLocalEditsRequest=null,null!=t){(0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__["default"])("esri-2d-update-debug")&&console.debug("Pipeline.applyEditOverride",t.inner);const e=await this._source.getLocalEdit(t.inner);await this._processor.applyLocalEdit(e),this._source.applyLocalEdit(e),(0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__["default"])("esri-2d-update-debug")&&console.debug("Pipeline.endEditOverride",t.inner)}if(this._updateHighlightRequests.length){const e=this._updateHighlightRequests;this._updateHighlightRequests=[];for(const t of e)this._processor.updateHighlight(t.inner),t.resolver.resolve()}const s=this._source.cleanupRemovedChunks();this._processor.removeChunks(s);try{this._subscriptions.size&&((0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__["default"])("esri-2d-update-debug")&&console.debug("Pipeline.updateChunksStart"),await this._processor.updateChunks(),(0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__["default"])("esri-2d-update-debug")&&console.debug("Pipeline.updateChunksEnd"))}catch(r){(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.throwIfNotAbortError)(r)}null!=t&&t.resolver.resolve(),null!=e&&e.resolver.resolve(),this._updateRequested?((0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__["default"])("esri-2d-update-debug")&&console.debug("Pipeline._doUpdateEnd [updateRequested=true]"),await this._connection.layerView.setUpdating({data:this._source.updateTracking.updating,pipeline:!0})):((0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__["default"])("esri-2d-update-debug")&&console.debug("Pipeline._doUpdateEnd [updateRequested=false, After flush]"),await this._connection.layerView.setUpdating({data:this._source.updateTracking.updating,pipeline:this._updateRequested}))}async _doUpdateSchema(e,t){(0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__["default"])("esri-2d-update-debug")&&console.debug(`Version[${t}] Pipeline.updateStart`,{schema:e});const s={tileInfo:this._tileInfoView?.tileInfo},i=await this._source.update(e,t),r=Array.from(this._subscriptions.values());await this._processor.update(e,t,s,i,r),(0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__["default"])("esri-2d-update-debug")&&console.debug(`Version[${t}] Pipeline.updateEnd`)}_doUpdateSubscriptions(e){(0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__["default"])("esri-2d-update-debug")&&console.debug("Pipeline.updateSubscriptions",e);for(const t of e.subscribe)this._subscribe(t);for(const t of e.unsubscribe)this._unsubscribe(t)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/FeatureSpatialIndex.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/FeatureSpatialIndex.js ***!
  \***********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureSpatialIndex: function() { return /* binding */ t; }
/* harmony export */ });
/* harmony import */ var _chunks_rbush_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../chunks/rbush.js */ "./node_modules/@arcgis/core/chunks/rbush.js");
/* harmony import */ var _geometry_support_aaBoundingBox_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../geometry/support/aaBoundingBox.js */ "./node_modules/@arcgis/core/geometry/support/aaBoundingBox.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class t{static fromReader(o){const e=[],r=o.copy(),a=(0,_geometry_support_aaBoundingBox_js__WEBPACK_IMPORTED_MODULE_1__.create)();for(;r.next();){r.getBounds(a)&&e.push(r.getIndex())}const i=(0,_chunks_rbush_js__WEBPACK_IMPORTED_MODULE_0__.r)(9,(n=>(r.setIndex(n),{minX:r.getBoundsXMin(),minY:r.getBoundsYMin(),maxX:r.getBoundsXMax(),maxY:r.getBoundsYMax()})));return i.load(e),new t(i)}constructor(n){this._index=n}search(n){const s={minX:n[0],minY:n[1],maxX:n[2],maxY:n[3]};return this._index.search(s)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/FeatureStoreStatistics.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/FeatureStoreStatistics.js ***!
  \**************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureStoreStatistics: function() { return /* binding */ t; }
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class t{static from(e){let n=0,r=0,o=0;return e.forEach((t=>{const e=t._readGeometry();e&&(r+=e.isPoint?1:e.lengths.reduce(((t,e)=>t+e),0),o+=e.isPoint?1:e.lengths.length,n+=1)})),new t(n,r,o)}constructor(t,e,n){this.featureCount=t,this.vertexCount=e,this.ringCount=n}toJSON(){return{featureCount:this.featureCount,ringCount:this.featureCount,vertexCount:this.featureCount}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/PipelineConnectionHandlers.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/PipelineConnectionHandlers.js ***!
  \******************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   PipelineConnectionHandlers: function() { return /* binding */ t; }
/* harmony export */ });
/* harmony import */ var _core_workers_utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../core/workers/utils.js */ "./node_modules/@arcgis/core/core/workers/utils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class t{constructor(e){this._client=e,this.layerView=this._client.createInvokeProxy(""),this.container=this._client.createInvokeProxy("container"),this._eventLog=this._client.createInvokeProxy("eventLog")}onEvent(t){(0,_core_workers_utils_js__WEBPACK_IMPORTED_MODULE_0__.ignoreConnectionErrors)(this._eventLog.onEvent(t))}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/Processor.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/Processor.js ***!
  \*************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ m; }
/* harmony export */ });
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../core/maybe.js */ "./node_modules/@arcgis/core/core/maybe.js");
/* harmony import */ var _core_object_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../core/object.js */ "./node_modules/@arcgis/core/core/object.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../core/accessorSupport/diffUtils.js */ "./node_modules/@arcgis/core/core/accessorSupport/diffUtils.js");
/* harmony import */ var _core_workers_utils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../core/workers/utils.js */ "./node_modules/@arcgis/core/core/workers/utils.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/* harmony import */ var _engine_webgl_mesh_MultiTileMeshData_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../engine/webgl/mesh/MultiTileMeshData.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/mesh/MultiTileMeshData.js");
/* harmony import */ var _engine_webgl_mesh_factories_FeatureMeshFactory_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../engine/webgl/mesh/factories/FeatureMeshFactory.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/mesh/factories/FeatureMeshFactory.js");
/* harmony import */ var _engine_webgl_mesh_factories_ResourceProxy_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../engine/webgl/mesh/factories/ResourceProxy.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/mesh/factories/ResourceProxy.js");
/* harmony import */ var _engine_webgl_shaderGraph_techniques_mesh_MeshWriterRegistry_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../engine/webgl/shaderGraph/techniques/mesh/MeshWriterRegistry.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/mesh/MeshWriterRegistry.js");
/* harmony import */ var _engine_webgl_util_MatcherContext_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../engine/webgl/util/MatcherContext.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/MatcherContext.js");
/* harmony import */ var _ProcessorTileMessageQueue_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./ProcessorTileMessageQueue.js */ "./node_modules/@arcgis/core/views/2d/layers/features/ProcessorTileMessageQueue.js");
/* harmony import */ var _processor_BinningStrategy_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./processor/BinningStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/processor/BinningStrategy.js");
/* harmony import */ var _processor_ClusterStrategy_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./processor/ClusterStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/processor/ClusterStrategy.js");
/* harmony import */ var _processor_FeatureUpdateStrategy_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./processor/FeatureUpdateStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/processor/FeatureUpdateStrategy.js");
/* harmony import */ var _support_AttributeStore_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./support/AttributeStore.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/AttributeStore.js");
/* harmony import */ var _support_ComputedAttributeStorage_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./support/ComputedAttributeStorage.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/ComputedAttributeStorage.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class m{constructor(e,t){this._connection=e,this._source=t,this._version=1,this._registry=new _engine_webgl_shaderGraph_techniques_mesh_MeshWriterRegistry_js__WEBPACK_IMPORTED_MODULE_10__.MeshWriterRegistry,this._proxy=new _engine_webgl_mesh_factories_ResourceProxy_js__WEBPACK_IMPORTED_MODULE_9__.ResourceProxy({fetch:(e,t)=>this._connection.layerView.fetch(e,t),fetchDictionary:(e,t)=>this._connection.layerView.fetchDictionary(e,t)}),this._attributeStore=new _support_AttributeStore_js__WEBPACK_IMPORTED_MODULE_16__.AttributeStore({isLocal:!1,update:e=>(0,_core_workers_utils_js__WEBPACK_IMPORTED_MODULE_5__.ignoreConnectionErrors)(this._connection.container.updateAttributeView(e))})}destroy(){this._proxy.destroy(),this._strategy?.destroy(),this._attributeStore.destroy()}get aggregateQueryEngine(){return this._strategy?.aggregateQueryEngine}getDisplayFeatures(e){return this._strategy?this._strategy.getDisplayFeatures(e):{features:[],aggregates:[]}}getDisplayIds(e){const t={};return this._strategy?(this._strategy.displayMap(e,(e=>e),((e,s,r)=>{t[r]=e})),t):t}getFeatureObjectIdsForAggregate(e){return this._strategy?this._strategy.getFeatureObjectIdsForAggregate(e):[]}onSubscribe(e){this._strategy?.onSubscribe(e)}onUnsubscribe(e){this._strategy?.onUnsubscribe(e)}async update(e,s,r,a,n){const h=e.processor,u=(0,_core_object_js__WEBPACK_IMPORTED_MODULE_2__.notDeepEqual)(this._schema?.storage,h.storage),p=(0,_core_object_js__WEBPACK_IMPORTED_MODULE_2__.notDeepEqual)(this._schema?.mesh.properties,h.mesh.properties),d=(0,_core_object_js__WEBPACK_IMPORTED_MODULE_2__.notDeepEqual)(this._schema?.mesh.factory,h.mesh.factory),y=(0,_core_object_js__WEBPACK_IMPORTED_MODULE_2__.notDeepEqual)(this._schema?.mesh.strategy,h.mesh.strategy),_=p||d||y;if(!(u||_)&&!a)return;(0,_core_has_js__WEBPACK_IMPORTED_MODULE_0__["default"])("esri-2d-update-debug")&&console.debug(`Version[${this._version}] SymbolProcessor.update`,{changes:(0,_core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_4__.diff)(this._schema,h),schema:h}),this._schema=h;const l=_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_6__["default"].fromJSON(this._source.service.outSpatialReference),m=new _support_ComputedAttributeStorage_js__WEBPACK_IMPORTED_MODULE_17__.ComputedAttributeStorage({fields:this._source.metadata.fieldsIndex,spatialReference:l});if(await this._attributeStore.update(h.storage,m,this._source.metadata,l,s),this._strategy?.invalidateAttributeData(),!a&&!_)return;(y||p)&&await this._updateStrategy(h.mesh.strategy,l,n,h.mesh.properties.timeZone),this._updateSortKey(m,"sortKey"in h.mesh.properties?h.mesh.properties.sortKey:null);const b=new _engine_webgl_util_MatcherContext_js__WEBPACK_IMPORTED_MODULE_11__.MatcherContext(m,this._proxy,r,this._registry);return(d||"dictionary"===h.mesh.factory.symbology.type)&&(this._factory=await _engine_webgl_mesh_factories_FeatureMeshFactory_js__WEBPACK_IMPORTED_MODULE_8__.FeatureMeshFactory.create(b,h.mesh.factory)),this._invalidate(),this._version=s,this._connection.container.updateRenderState(this._version)}async applyLocalEdit(e){if(!this._strategy)return;const t=this._strategy.applyLocalEdit(e);for await(const r of t)try{await this._process(r)}catch(s){}}async updateChunks(){this._strategy?.beforeUpdateChunks(),await this._doUpdateChunks(),this._strategy?.afterUpdateChunks()}async removeChunks(e){this._strategy?.removeChunks(e),this._attributeStore.incrementDisplayIdGeneration()}updateHighlight({highlights:e}){if(!this._strategy)return void this._attributeStore.setHighlight(e.map((({objectId:e,highlightFlags:t})=>({objectId:e,highlightFlags:t,displayId:-1}))),e);const t=this._strategy.displayMap(e,(({objectId:e})=>e),((e,{highlightFlags:t},s)=>({objectId:s,displayId:e,highlightFlags:t})));this._attributeStore.setHighlight(t,e)}async _doUpdateChunks(){if(!this._strategy)return;const e=this._strategy.updateChunks(),t=[],r=new Map;for await(const a of e){let e=r.get(a.id);null==e&&(e=new _ProcessorTileMessageQueue_js__WEBPACK_IMPORTED_MODULE_12__.ProcessorTileMessageQueue({concurrency:16,process:e=>this._process(e)}),r.set(a.id,e));const i=e.push(a).catch((e=>(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.throwIfNotAbortError)(e)));t.push(i)}try{await Promise.all(t)}catch(i){}(0,_core_has_js__WEBPACK_IMPORTED_MODULE_0__["default"])("esri-2d-update-debug")&&console.log("SendUpdates"),this._attributeStore.sendUpdates(),(0,_core_has_js__WEBPACK_IMPORTED_MODULE_0__["default"])("esri-2d-update-debug")&&console.log("SendUpdates.await")}async _updateStrategy(e,t,s,r){switch(this._strategy?.destroy(),e.type){case"feature":this._strategy=new _processor_FeatureUpdateStrategy_js__WEBPACK_IMPORTED_MODULE_15__.FeatureUpdateStrategy(this._source,this._attributeStore,r);break;case"binning":this._strategy=await _processor_BinningStrategy_js__WEBPACK_IMPORTED_MODULE_13__.BinningStrategy.create(e,t,this._source,this._attributeStore,r);break;case"cluster":this._strategy=await _processor_ClusterStrategy_js__WEBPACK_IMPORTED_MODULE_14__.ClusterStrategy.create(this._connection,e,t,this._source,this._attributeStore,r)}for(const i of s)this._strategy.onSubscribe(i)}async _updateSortKey(t,s){if(this._sortInfo=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.destroyMaybe)(this._sortInfo?.computed),null!=s){const e=s.byRenderer?null:await t.createComputedField(s);this._sortInfo={...s,computed:e}}}_invalidate(){this._strategy&&this._strategy.invalidate()}async _process(e){const t=e.subscription;if((0,_core_has_js__WEBPACK_IMPORTED_MODULE_0__["default"])("esri-2d-update-debug")){const s=t.tile;console.debug(`Version[${this._version}] Tile[${s.key.id}, end=${e.end}] Processor._process`)}await this._fetchResources(e),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.throwIfAborted)(t.signal);const s=await this._write(e,t.tile.createArcadeEvaluationOptions(this._schema?.mesh.properties.timeZone)),i=t.tile.tileInfoView.getLODInfoAt(t.tile.key),{message:a,transferList:o}=s.serialize(i),n={objectIdMap:null,inner:e.createMessage(a,this._version,this._attributeStore.epoch)};if(this._schema?.mesh.properties.returnMeshObjectId){n.objectIdMap={};const t=e.reader?.getCursor();if(t)for(;t.next();)n.objectIdMap[t.getDisplayId()]=t.getObjectId()}if((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.throwIfAborted)(t.signal),await this._connection.container.onMessage(n,{signal:t.signal,transferList:o}),this._attributeStore.sendUpdates(),(0,_core_has_js__WEBPACK_IMPORTED_MODULE_0__["default"])("esri-2d-update-debug")){const s=t.tile;console.debug(`Version[${this._version}] Tile[${s.key.id}, end=${e.end}] Processor._process.await`)}}async _fetchResources(e){await this._fetchMatcherResources(e),await this._fetchWriterResources(e)}async _fetchMatcherResources(e){if(e.reader)return this._factory.enqueueMatcherRequests(this._proxy,e.reader)}async _fetchWriterResources(e){if(!e.reader)return;const t=e.reader.getCursor(),s=e.subscription.tile.createArcadeEvaluationOptions(this._schema.mesh.properties.timeZone);for(;t.next();)this._factory.enqueueWriterRequests(this._proxy,t,s);await this._proxy.fetchEnqueuedResources()}async _write(e,t){const s=e.subscription.tile,r=e.reader?.getCursor(),i=r?.getSize()??0,a=s.tileInfoView.tileInfo.isWrappable,o=s.tileInfoView.tileInfo.spatialReference.isWGS84,c=new _engine_webgl_mesh_MultiTileMeshData_js__WEBPACK_IMPORTED_MODULE_7__.MultiTileMeshData(s.key,this._strategy.enablePixelBuffering,a,o,i);if(!r)return c;const h=s.createArcadeEvaluationOptions(this._schema.mesh.properties.timeZone);for(;r.next();){const e=this._getSortKeyValue(r,t);c.entityStart(r.getDisplayId(),e),this._factory.write(c,this._proxy,r,h,s.level),c.entityEnd()}return c}_getSortKeyValue(e,t){if(!this._sortInfo)return 0;const{computed:s,order:r,byRenderer:i}=this._sortInfo,a=i?this._factory.getSortKey(e,t):s?.read(e,t);return null==a||isNaN(a)?0:a*("asc"===r?-1:1)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/ProcessorTileMessageQueue.js":
/*!*****************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/ProcessorTileMessageQueue.js ***!
  \*****************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ProcessorTileMessageQueue: function() { return /* binding */ e; }
/* harmony export */ });
/* harmony import */ var _support_QueueProcessor_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../support/QueueProcessor.js */ "./node_modules/@arcgis/core/views/support/QueueProcessor.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class e{constructor(e){this._outstandingMessages=[],this._queue=new _support_QueueProcessor_js__WEBPACK_IMPORTED_MODULE_0__.QueueProcessor({concurrency:e.concurrency,process:s=>e.process(s)})}async push(s){if(s.end)return await Promise.all(this._outstandingMessages),await this._queue.push(s),void(this._outstandingMessages=[]);const e=this._queue.push(s);return this._outstandingMessages.push(e),e}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/AAggregateCell.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/aggregation/AAggregateCell.js ***!
  \******************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AAggregateCell: function() { return /* binding */ t; }
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class t{constructor(t){this._statistics=t}get statistics(){return this._statistics}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/AAggregateSpatialIndex.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/aggregation/AAggregateSpatialIndex.js ***!
  \**************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AAggregateSpatialIndex: function() { return /* binding */ t; }
/* harmony export */ });
/* harmony import */ var _engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../engine/webgl/definitions.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/definitions.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class t{constructor(e){this._options=e}insert(e,t){const r=e.getCursor(),o={$view:{scale:this._options.scale,timeZone:this._options.timeZone}};for(;r.next();)this._insertFeature(r,o,t)}_insertFeature(t,r,o){const{featureFilter:i}=this._options;if(null!==i&&!i.check(t))return;let s=0,n=0;if("esriGeometryPoint"===t.geometryType)s=t.readXWorldSpace(),n=t.readYWorldSpace();else{if(o){const r=t.readCentroidForDisplay();if(null==r)return;const[o,i]=r.coords;if(o<0||o>_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_0__.tileSize||i<0||i>_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_0__.tileSize)return}const r=t.readCentroidWorldSpace();if(null==r)return;s=r.coords[0],n=r.coords[1]}this._insert(t,s,n,r)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/AccumulatedStatistics.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/aggregation/AccumulatedStatistics.js ***!
  \*************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AccumulatedStatistics: function() { return /* binding */ s; }
/* harmony export */ });
/* harmony import */ var _arcade_callExpressionWithCursor_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../arcade/callExpressionWithCursor.js */ "./node_modules/@arcgis/core/views/2d/arcade/callExpressionWithCursor.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const e=Math.PI/180;class s{static create(t){return new s(t.map((t=>i(t))))}constructor(t){this._statistics=t}values(){return this._statistics.values()}insert(t,e){for(const s of this._statistics)s.insert(t,e)}merge(t){for(let e=0;e<this._statistics.length;e++){const s=this._statistics[e],i=t._statistics[e];if(s.field.name!==i.field.name)throw new Error("InternalError: Tried to merge incompatible statistics");s.merge(i)}}clone(){return new s(this._statistics.map((t=>t.clone())))}}function i(t){switch(t.statisticType){case"min":return new r(t);case"max":return new u(t);case"avg":return new c(t);case"avg_angle":return new h(t);case"sum":case"count":return new a(t);case"mode":return new o(t)}}class n{constructor(t){this.field=t}insert(e,s){if(!this.field.computed)return;const i=this.field.computed.read(e,s);(0,_arcade_callExpressionWithCursor_js__WEBPACK_IMPORTED_MODULE_0__.isBadArcadeResult)(i)||this._insertValue(i)}}class r extends n{constructor(){super(...arguments),this.type="min",this.value=Number.MAX_VALUE}_insertValue(t){this.value=Math.min(this.value,t)}merge(t){this.value=Math.min(this.value,t.value)}clone(){const t=new r(this.field);return t.value=this.value,t}}class u extends n{constructor(){super(...arguments),this.type="max",this.value=Number.MIN_VALUE}_insertValue(t){this.value=Math.max(this.value,t)}merge(t){this.value=Math.max(this.value,t.value)}clone(){const t=new u(this.field);return t.value=this.value,t}}class a extends n{constructor(){super(...arguments),this.type="sum",this.value=0}_insertValue(t){this.value+=t}merge(t){this.value+=t.value}clone(){const t=new a(this.field);return t.value=this.value,t}}class c extends n{constructor(){super(...arguments),this.type="avg",this._total=0,this._count=0}get value(){return this._total/this._count}_insertValue(t){this._total+=t,this._count+=1}merge(t){this._total+=t._total,this._count+=t._count}clone(){const t=new c(this.field);return t._total=this._total,t._count=this._count,t}}class h extends n{constructor(){super(...arguments),this.type="avg_angle",this._x=0,this._y=0,this._count=0}get value(){const t=this._x/this._count,e=this._y/this._count,s=180/Math.PI;return Math.atan2(e,t)*s}_insertValue(t){this._x=this._x+Math.cos(t*e),this._y=this._y+Math.sin(t*e),this._count+=1}merge(t){this._x+=t._x,this._y+=t._y,this._count+=t._count}clone(){const t=new h(this.field);return t._x=this._x,t._y=this._y,t._count=this._count,t}}class o extends n{constructor(){super(...arguments),this._frequencies=new Map}get value(){let t,e=0;for(const[s,i]of this._frequencies.entries())i>e&&(e=i,t=s);return t}_insertValue(t){const e=this._frequencies.get(t);null!=e?this._frequencies.set(t,e+1):this._frequencies.set(t,1)}merge(t){for(const[e,s]of t._frequencies.entries()){const t=this._frequencies.get(e);null!=t?this._frequencies.set(e,t+s):this._frequencies.set(e,s)}}clone(){const t=new o(this.field);return t._frequencies=new Map(this._frequencies),t}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/ComputedAggregateField.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/aggregation/ComputedAggregateField.js ***!
  \**************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ComputedAggregateField: function() { return /* binding */ s; }
/* harmony export */ });
/* harmony import */ var _support_DictionaryValue_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../support/DictionaryValue.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/DictionaryValue.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class s{static async create(i,e){if("count"===e.statisticType){const i=new _support_DictionaryValue_js__WEBPACK_IMPORTED_MODULE_0__.DictionaryValue(1);return new s(e.name,e.alias,e.type,e.statisticType,i)}const a=await i.createComputedField({expression:e.onStatisticExpression?.expression,field:e.onStatisticField});return new s(e.name,e.alias,e.type,e.statisticType,a)}constructor(t,s,i,e,a){this.name=t,this.alias=s,this.type=i,this.statisticType=e,this.computed=a}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/GeohashSpatialIndex.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/aggregation/GeohashSpatialIndex.js ***!
  \***********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   GeohashSpatialIndex: function() { return /* binding */ r; }
/* harmony export */ });
/* harmony import */ var _geohash_GeohashTree_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../geohash/GeohashTree.js */ "./node_modules/@arcgis/core/geohash/GeohashTree.js");
/* harmony import */ var _geohash_geohashUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../geohash/geohashUtils.js */ "./node_modules/@arcgis/core/geohash/geohashUtils.js");
/* harmony import */ var _AAggregateSpatialIndex_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AAggregateSpatialIndex.js */ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/AAggregateSpatialIndex.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class r extends _AAggregateSpatialIndex_js__WEBPACK_IMPORTED_MODULE_2__.AAggregateSpatialIndex{constructor(t){super(t),this._tree=new _geohash_GeohashTree_js__WEBPACK_IMPORTED_MODULE_0__.GeohashTree(this._options.fields)}put(e){throw new Error("Geohash tree does not support put")}putBounded(e,s,o){const{geohashLevel:r,spatialReference:h}=this._options,i=(0,_geohash_geohashUtils_js__WEBPACK_IMPORTED_MODULE_1__.getGeohashBounds)(s,o,r,h);null!=i&&this._tree.putBins(e,i)}_insert(e,t,o,r){const{geohashLevel:h,spatialReference:i}=this._options,n=(0,_geohash_geohashUtils_js__WEBPACK_IMPORTED_MODULE_1__.getGeohash)(t,o,h,i);n&&this._tree.insert(e,t,o,n[0],n[1],h,r)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/GridCell.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/aggregation/GridCell.js ***!
  \************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   GridCell: function() { return /* binding */ l; }
/* harmony export */ });
/* harmony import */ var _layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../layers/graphics/featureConversionUtils.js */ "./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js");
/* harmony import */ var _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../layers/graphics/OptimizedGeometry.js */ "./node_modules/@arcgis/core/layers/graphics/OptimizedGeometry.js");
/* harmony import */ var _AAggregateCell_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AAggregateCell.js */ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/AAggregateCell.js");
/* harmony import */ var _AccumulatedStatistics_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AccumulatedStatistics.js */ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/AccumulatedStatistics.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class l extends _AAggregateCell_js__WEBPACK_IMPORTED_MODULE_2__.AAggregateCell{static createId(t,e){return`${t}.${e}`}static create(t,e,r,i){return new l(t,e,_AccumulatedStatistics_js__WEBPACK_IMPORTED_MODULE_3__.AccumulatedStatistics.create(r),i)}constructor(t,e,r,i){super(r),this.gridX=t,this.gridY=e,this._worldUnitsPerCell=i,this._count=0,this._xWorldTotal=0,this._yWorldTotal=0,this._objectIds=new Set}get id(){return l.createId(this.gridX,this.gridY)}get containedObjectIds(){return this._objectIds}get count(){return this._count}get firstObjectId(){return this._objectIds.values().next().value}get centroidXWorld(){return this._xWorldTotal/this._count}get centroidYWorld(){return this._yWorldTotal/this._count}clone(){const t=new l(this.gridX,this.gridY,this._statistics.clone(),this._worldUnitsPerCell);return t._count=this._count,t._xWorldTotal=this._xWorldTotal,t._yWorldTotal=this._yWorldTotal,t._firstFeatureAttributes=this._firstFeatureAttributes,t._objectIds=new Set(this._objectIds),t}insert(t,e,r,i){0===this._count?this._firstFeatureAttributes=t.readAttributes():this._firstFeatureAttributes=null,this._count+=1,this._xWorldTotal+=r,this._yWorldTotal+=i,this._statistics.insert(t,e),this._objectIds.add(t.getObjectId())}merge(t){if(0!==t._count){this._count+=t._count,this._firstFeatureAttributes=t._firstFeatureAttributes,this._xWorldTotal+=t._xWorldTotal,this._yWorldTotal+=t._yWorldTotal,this._statistics.merge(t._statistics);for(const e of t._objectIds.values())this._objectIds.add(e)}}getCentroidX(e){return null==e?this.centroidXWorld:(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__.quantizeX)(e,this.centroidXWorld)}getCentroidY(t){return null==t?this.centroidYWorld:(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__.quantizeY)(t,this.centroidYWorld)}getGeometry(t,e){const s=this.gridX*this._worldUnitsPerCell,o=this.gridY*this._worldUnitsPerCell,l=new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__["default"]([4],[s,o,s+this._worldUnitsPerCell,o,s+this._worldUnitsPerCell,o+this._worldUnitsPerCell,s,o+this._worldUnitsPerCell]);if(null!=e){const t=new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__["default"];return (0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__.quantizeOptimizedGeometry)(t,l,!1,!1,"esriGeometryPolygon",e)}return l}getCentroid(t){const e=new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__["default"]([],[this.centroidXWorld,this.centroidYWorld]);if(null!=t){const s=new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__["default"];return (0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__.quantizeOptimizedGeometry)(s,e,!1,!1,"esriGeometryPoint",t)}return e}getGeometricCentroid(t,e){const s=this.gridX*this._worldUnitsPerCell+.5*this._worldUnitsPerCell,o=this.gridY*this._worldUnitsPerCell+.5*this._worldUnitsPerCell,l=new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__["default"]([],[s,o]);if(null!=e){const t=new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__["default"];return (0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__.quantizeOptimizedGeometry)(t,l,!1,!1,"esriGeometryPoint",e)}return l}getAttributes(){const t={aggregateId:this.id};for(const e of this._statistics.values())t[e.field.name]=e.value;return null!=this._firstFeatureAttributes?{...t,...this._firstFeatureAttributes}:t}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/GridSpatialIndex.js":
/*!********************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/aggregation/GridSpatialIndex.js ***!
  \********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   GridSpatialIndex: function() { return /* binding */ n; },
/* harmony export */   pixelsPerMapUnit: function() { return /* binding */ o; }
/* harmony export */ });
/* harmony import */ var _core_unitUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../core/unitUtils.js */ "./node_modules/@arcgis/core/core/unitUtils.js");
/* harmony import */ var _AAggregateSpatialIndex_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AAggregateSpatialIndex.js */ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/AAggregateSpatialIndex.js");
/* harmony import */ var _GridCell_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./GridCell.js */ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/GridCell.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const l=96;function o(i,s){return (0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_0__.getMetersPerUnitForSR)(i)*_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_0__.inchesPerMeter*l/s}class n extends _AAggregateSpatialIndex_js__WEBPACK_IMPORTED_MODULE_1__.AAggregateSpatialIndex{constructor(t){super(t),this._cells=new Map,this._pixelsPerMapUnit=o(t.spatialReference,t.scale)}put(t){for(const e of this._cells.values()){const i=t.get(e.id);i?i.merge(e):t.set(e.id,e.clone())}}putBounded(t,e,i){const s=[e.xmin,e.ymin,e.xmax,e.ymax],[l,o,n,r]=s,c=Math.floor(l*this._pixelsPerMapUnit/this._options.cellSize),p=Math.floor(o*this._pixelsPerMapUnit/this._options.cellSize),a=Math.ceil(n*this._pixelsPerMapUnit/this._options.cellSize),h=Math.ceil(r*this._pixelsPerMapUnit/this._options.cellSize);for(let _=p;_<=h;_++)for(let e=c;e<=a;e++){const i=`${e}.${_}`,s=this._cells.get(i);if(!s)continue;const l=t.get(s.id);l?s&&!t.has(s.id)&&l.merge(s):t.set(s.id,s.clone())}}_insert(t,e,i,s){const l=e*this._pixelsPerMapUnit,o=i*this._pixelsPerMapUnit,n=Math.floor(l/this._options.cellSize),r=Math.floor(o/this._options.cellSize);this._getCellOrCreate(n,r).insert(t,s,e,i)}_getCellOrCreate(t,e){const i=_GridCell_js__WEBPACK_IMPORTED_MODULE_2__.GridCell.createId(t,e);let l=this._cells.get(i);if(!l){const o=1*this._options.cellSize/this._pixelsPerMapUnit;l=_GridCell_js__WEBPACK_IMPORTED_MODULE_2__.GridCell.create(t,e,this._options.fields,o),this._cells.set(i,l)}return l}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/processor/AAggregateStrategy.js":
/*!********************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/processor/AAggregateStrategy.js ***!
  \********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AAggregateStrategy: function() { return /* binding */ i; }
/* harmony export */ });
/* harmony import */ var _core_Evented_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../core/Evented.js */ "./node_modules/@arcgis/core/core/Evented.js");
/* harmony import */ var _geometry_support_aaBoundingBox_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../geometry/support/aaBoundingBox.js */ "./node_modules/@arcgis/core/geometry/support/aaBoundingBox.js");
/* harmony import */ var _layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../layers/graphics/featureConversionUtils.js */ "./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js");
/* harmony import */ var _layers_graphics_data_optimizedFeatureQueryEngineAdapter_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../layers/graphics/data/optimizedFeatureQueryEngineAdapter.js */ "./node_modules/@arcgis/core/layers/graphics/data/optimizedFeatureQueryEngineAdapter.js");
/* harmony import */ var _layers_graphics_data_QueryEngine_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../layers/graphics/data/QueryEngine.js */ "./node_modules/@arcgis/core/layers/graphics/data/QueryEngine.js");
/* harmony import */ var _AProcessorStrategy_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./AProcessorStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/processor/AProcessorStrategy.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class i extends _AProcessorStrategy_js__WEBPACK_IMPORTED_MODULE_5__.AProcessorStrategy{constructor(t,r,s,o){super(t,r),this.spatialReference=s,this.aggregateFields=o,this.events=new _core_Evented_js__WEBPACK_IMPORTED_MODULE_0__["default"],this.featureAdapter=_layers_graphics_data_optimizedFeatureQueryEngineAdapter_js__WEBPACK_IMPORTED_MODULE_3__.optimizedFeatureQueryEngineAdapter}get aggregateQueryEngine(){return this._aggregateQueryEngine||(this._aggregateQueryEngine=new _layers_graphics_data_QueryEngine_js__WEBPACK_IMPORTED_MODULE_4__.QueryEngine({featureStore:this,fieldsIndex:this._metadata.fieldsIndex,geometryType:this._metadata.geometryType,objectIdField:this._metadata.objectIdField,spatialReference:this.spatialReference})),this._aggregateQueryEngine}removeChunks(e){}forEach(e){return this.forEachAggregateWorldSpace(e)}forEachInBounds(e,t){}forEachBounds(e,a){const s=(0,_geometry_support_aaBoundingBox_js__WEBPACK_IMPORTED_MODULE_1__.create)();for(const t of e){const e=(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_2__.getBoundsOptimizedGeometry)(s,t.geometry,!1,!1);e&&a(e)}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/processor/AProcessorStrategy.js":
/*!********************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/processor/AProcessorStrategy.js ***!
  \********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AProcessorStrategy: function() { return /* binding */ e; },
/* harmony export */   ASendState: function() { return /* binding */ t; }
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class t{constructor(t){this.subscription=t,this.handledChunks=new Set}destroy(){}}class e{constructor(t,e){this._source=t,this._attributeStore=e,this._sendStates=new Map}destroy(){}get enablePixelBuffering(){return!0}onSubscribe(t){const e=this.createState(t);this._sendStates.set(t.key.id,e),this.updateChunks()}onUnsubscribe(t){this._sendStates.get(t.key.id)?.destroy(),this._sendStates.delete(t.key.id)}invalidate(){const t=Array.from(this._sendStates.values());this._sendStates.clear();for(const e of t)e.destroy(),this.onSubscribe(e.subscription)}invalidateAttributeData(){}getFeatureObjectIdsForAggregate(t){throw new Error("InternalError: AggregateId lookup not supported")}getDisplayIds(t){return this.displayMap(t,(t=>t),(t=>t))}getDisplayAndObjectIds(t){return this.displayMap(t,(t=>t),((t,e,s)=>[t,s]))}beforeUpdateChunks(){}afterUpdateChunks(){}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/processor/BinningStrategy.js":
/*!*****************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/processor/BinningStrategy.js ***!
  \*****************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BinningState: function() { return /* binding */ y; },
/* harmony export */   BinningStrategy: function() { return /* binding */ I; }
/* harmony export */ });
/* harmony import */ var _geometry_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../geometry.js */ "./node_modules/@arcgis/core/geometry.js");
/* harmony import */ var _layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../layers/graphics/featureConversionUtils.js */ "./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js");
/* harmony import */ var _layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../layers/graphics/OptimizedFeature.js */ "./node_modules/@arcgis/core/layers/graphics/OptimizedFeature.js");
/* harmony import */ var _layers_graphics_data_projectionSupport_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../layers/graphics/data/projectionSupport.js */ "./node_modules/@arcgis/core/layers/graphics/data/projectionSupport.js");
/* harmony import */ var _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../layers/support/FieldsIndex.js */ "./node_modules/@arcgis/core/layers/support/FieldsIndex.js");
/* harmony import */ var _aggregation_ComputedAggregateField_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../aggregation/ComputedAggregateField.js */ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/ComputedAggregateField.js");
/* harmony import */ var _AAggregateStrategy_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./AAggregateStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/processor/AAggregateStrategy.js");
/* harmony import */ var _AProcessorStrategy_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./AProcessorStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/processor/AProcessorStrategy.js");
/* harmony import */ var _sources_FeatureSourceMessage_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sources/FeatureSourceMessage.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/FeatureSourceMessage.js");
/* harmony import */ var _sources_strategies_chunks_OverrideChunk_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../sources/strategies/chunks/OverrideChunk.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/OverrideChunk.js");
/* harmony import */ var _support_ComputedAttributeStorage_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../support/ComputedAttributeStorage.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/ComputedAttributeStorage.js");
/* harmony import */ var _support_FeatureFilter_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../support/FeatureFilter.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureFilter.js");
/* harmony import */ var _support_FeatureMetadata_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../support/FeatureMetadata.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureMetadata.js");
/* harmony import */ var _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../support/FeatureSetReaderJSON.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderJSON.js");
/* harmony import */ var _tiling_TileKey_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../tiling/TileKey.js */ "./node_modules/@arcgis/core/views/2d/tiling/TileKey.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class y extends _AProcessorStrategy_js__WEBPACK_IMPORTED_MODULE_7__.ASendState{constructor(e,t){super(e),this.bins=new Map,this.featureCache=new Map,this.done=!1,this._store=t}reset(){this.destroy(),this.done=!1}invaldateForLocalEditDropped(){this.handledChunks.clear(),this.bins.clear()}destroy(){const e=this.subscription.tile.key.level;for(const t of this.featureCache.keys())this._store.releaseDisplayIdForObjectId(`${t}.${e}`);this.bins.clear(),this.featureCache.clear(),this.handledChunks.clear()}get tile(){return this.subscription.tile}*featuresWorldSpace(){for(const t of this.featureCache.values()){const s=t.clone();s.geometry&&(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_1__.unquantizeOptimizedGeometry)(s.geometry,s.geometry,!1,!1,this.subscription.tile.transform),yield s}}}class I extends _AAggregateStrategy_js__WEBPACK_IMPORTED_MODULE_6__.AAggregateStrategy{static async create(e,t,s,a,o){const n=new _support_ComputedAttributeStorage_js__WEBPACK_IMPORTED_MODULE_10__.ComputedAttributeStorage({spatialReference:t}),l=await Promise.all(e.fields.map((async e=>_aggregation_ComputedAggregateField_js__WEBPACK_IMPORTED_MODULE_5__.ComputedAggregateField.create(n,e)))),d=e.featureFilter?await _support_FeatureFilter_js__WEBPACK_IMPORTED_MODULE_11__["default"].create({geometryType:s.metadata.geometryType,hasM:!1,hasZ:!1,timeInfo:s.metadata.timeInfo,fieldsIndex:s.metadata.fieldsIndex,spatialReference:t,filterJSON:e.featureFilter}):null;return"geohash"===e.index.type&&await (0,_layers_graphics_data_projectionSupport_js__WEBPACK_IMPORTED_MODULE_3__.checkProjectionSupport)(t,_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_15__["default"].WGS84),new I(e,d,o,l,t,s,a)}constructor(e,t,s,r,i,o,n){super(o,n,i,r),this._schema=e,this._featureFilter=t,this._timeZone=s,this._metadata=_support_FeatureMetadata_js__WEBPACK_IMPORTED_MODULE_12__.FeatureMetadata.createFeature({geometryType:"esriGeometryPolygon",objectIdField:"aggregateId",fieldsIndex:new _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_4__["default"](e.fields).toJSON(),globalIdField:null,spatialReference:o.metadata.spatialReference,subtypeField:null,subtypes:null,timeInfo:null,timeReferenceUnknownClient:null,typeIdField:null,types:null})}createState(e){return new y(e,this._attributeStore)}async*applyLocalEdit(e){for(const t of this._sendStates.values()){t.reset();const e=new _sources_FeatureSourceMessage_js__WEBPACK_IMPORTED_MODULE_8__.FeatureTileAppendMessage(t.subscription,_support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_13__.FeatureSetReaderJSON.empty(this._source.metadata),!0,!1,{});yield e}}displayMap(e,t,s){const r=new Map(e.map((e=>[t(e),e]))),a=[];for(const i of this._sendStates.values())for(const e of i.featuresWorldSpace()){const{objectId:t,displayId:i}=e,o=r.get(t);if(null!=o){const e=s(i,o,t);a.push(e),r.delete(t)}}return a}getDisplayFeatures(e){const s=new Set(e),r=new Set,a=[];for(const i of this._sendStates.values())for(const e of i.featuresWorldSpace())s.has(e.displayId)&&!r.has(e.objectId)&&(e.geometry&&a.push({...(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_1__.convertToFeature)(e,this._metadata.geometryType,!1,!1),displayId:e.displayId}),r.add(e.objectId));return{features:[],aggregates:a}}getFeatureObjectIdsForAggregate(e){for(const t of this._sendStates.values())for(const s of t.bins.values())if(s.id===e)return Array.from(s.containedObjectIds);return[]}beforeUpdateChunks(){const e=this._source.chunks();if(!e.length)return;let t=!1;for(const s of e)(0,_sources_strategies_chunks_OverrideChunk_js__WEBPACK_IMPORTED_MODULE_9__.isLocalEditChunk)(s)&&s.lastLocalEditDropped!==this._lastHandledLocalEdit&&(this._lastHandledLocalEdit=s.lastLocalEditDropped,t=!0);if(t)for(const s of this._sendStates.values())s.invaldateForLocalEditDropped()}async*updateChunks(){for(const e of this._sendStates.values())yield*this._update(e,this._source)}forEachAggregateWorldSpace(e){const t=new Set;for(const s of this._sendStates.values())for(const r of s.featuresWorldSpace())t.has(r.objectId)||(e(r),t.add(r.objectId))}_createIndexOptions(e){switch(this._schema.index.type){case"geohash":return{type:"geohash",fields:this.aggregateFields,featureFilter:this._featureFilter,geohashLevel:this._schema.index.fixBinLevel,spatialReference:this.spatialReference,timeZone:this._timeZone,scale:e.scale};case"grid":{const t=this._schema.index.fixedBinLevel,s=null!=t?e.tileInfoView.getLODInfoAt(t).scale:e.scale;return{type:"grid",fields:this.aggregateFields,cellSize:this._schema.index.size,featureFilter:this._featureFilter,spatialReference:this.spatialReference,timeZone:this._timeZone,scale:s}}}}async*_update(e,t){const{handledChunks:r,subscription:a,bins:i,featureCache:o}=e,n=a.tile;if(e.done)return;for(const s of t.chunks()){if(r.has(s.chunkId))continue;r.add(s.chunkId);const t=s.queryInfo;if("tileId"in t){const e=new _tiling_TileKey_js__WEBPACK_IMPORTED_MODULE_14__["default"](t.tileId);if(e.level!==n.level||e.world!==n.key.world)continue}s.getAggregateIndex(this._createIndexOptions(e.tile)).putBounded(i,e.tile.extent,e.tile.resolution)}const l=[],c=a.tile.transform,u=a.tile.key.level;for(const d of i.values()){let e=o.get(d.id);if(e)e.attributes=d.getAttributes();else{const t=d.getGeometry(this.spatialReference,c);e=new _layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_2__.OptimizedFeature(t,d.getAttributes(),null),t||(e.centroid=d.getGeometricCentroid(this.spatialReference,c)),e.objectId=d.id,e.displayId=this._attributeStore.createDisplayIdForObjectId(`${e.objectId}.${u}`),o.set(d.id,e)}l.push(e)}this.events.emit("changed"),e.done=!t.updateTracking.updating;const p=_support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_13__.FeatureSetReaderJSON.fromOptimizedFeatures(l,this._metadata,c),f=p.getCursor(),g=e.subscription.tile.createArcadeEvaluationOptions(this._timeZone);for(;f.next();)this._attributeStore.setAttributeData(f.getDisplayId(),f,g);const y=new _sources_FeatureSourceMessage_js__WEBPACK_IMPORTED_MODULE_8__.FeatureTileUpdateMessage(e.subscription,p,[],e.done,{});yield y}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/processor/ClusterStrategy.js":
/*!*****************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/processor/ClusterStrategy.js ***!
  \*****************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ClusterState: function() { return /* binding */ S; },
/* harmony export */   ClusterStrategy: function() { return /* binding */ x; }
/* harmony export */ });
/* harmony import */ var _layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../layers/graphics/featureConversionUtils.js */ "./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js");
/* harmony import */ var _layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../layers/graphics/OptimizedFeature.js */ "./node_modules/@arcgis/core/layers/graphics/OptimizedFeature.js");
/* harmony import */ var _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../layers/graphics/OptimizedGeometry.js */ "./node_modules/@arcgis/core/layers/graphics/OptimizedGeometry.js");
/* harmony import */ var _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../layers/support/FieldsIndex.js */ "./node_modules/@arcgis/core/layers/support/FieldsIndex.js");
/* harmony import */ var _engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../engine/webgl/definitions.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/definitions.js");
/* harmony import */ var _aggregation_ComputedAggregateField_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../aggregation/ComputedAggregateField.js */ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/ComputedAggregateField.js");
/* harmony import */ var _aggregation_GridCell_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../aggregation/GridCell.js */ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/GridCell.js");
/* harmony import */ var _aggregation_GridSpatialIndex_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../aggregation/GridSpatialIndex.js */ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/GridSpatialIndex.js");
/* harmony import */ var _AAggregateStrategy_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./AAggregateStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/processor/AAggregateStrategy.js");
/* harmony import */ var _AProcessorStrategy_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./AProcessorStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/processor/AProcessorStrategy.js");
/* harmony import */ var _support_WithDisplayId_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./support/WithDisplayId.js */ "./node_modules/@arcgis/core/views/2d/layers/features/processor/support/WithDisplayId.js");
/* harmony import */ var _sources_FeatureSourceMessage_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../sources/FeatureSourceMessage.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/FeatureSourceMessage.js");
/* harmony import */ var _sources_strategies_chunks_OverrideChunk_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../sources/strategies/chunks/OverrideChunk.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/OverrideChunk.js");
/* harmony import */ var _support_ComputedAttributeStorage_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../support/ComputedAttributeStorage.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/ComputedAttributeStorage.js");
/* harmony import */ var _support_FeatureFilter_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../support/FeatureFilter.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureFilter.js");
/* harmony import */ var _support_FeatureMetadata_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../support/FeatureMetadata.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureMetadata.js");
/* harmony import */ var _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../support/FeatureSetReaderJSON.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderJSON.js");
/* harmony import */ var _tiling_TileKey_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../tiling/TileKey.js */ "./node_modules/@arcgis/core/views/2d/tiling/TileKey.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const y=128;class S extends _AProcessorStrategy_js__WEBPACK_IMPORTED_MODULE_9__.ASendState{constructor(e){super(e),this.didSend=!1,this.done=!1}}class I{constructor(e,t,s,i,r){this._level=e,this._scale=t,this._indexOptions=s,this._clusterRadius=i,this._store=r,this._cells=new Map,this._handledChunks=new Set,this._statistics=new Map,this._clusters=new Map}destroy(){this._clearClusters()}_clearClusters(){for(const e of this._clusters.values())this._store.releaseDisplayIdForObjectId(e.inner.id);this._clusters.clear()}*aggregatesWorldSpace(){for(const e of this._clusters.values()){const s=e.inner.getCentroid(null),i=new _layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_1__.OptimizedFeature(s,e.inner.getAttributes(),null);i.objectId=e.inner.id,i.displayId=e.displayId,yield i}}clusters(){return this._clusters.values()}updateChunks(e,t){let s=!1;for(const a of e){const e=a.queryInfo;if("tileId"in e){if(new _tiling_TileKey_js__WEBPACK_IMPORTED_MODULE_17__["default"](e.tileId).level!==this._level)continue}if(!this._handledChunks.has(a.normalizedChunkId)){this._handledChunks.add(a.normalizedChunkId),s=!0;a.getAggregateIndex({...this._indexOptions,scale:this._scale}).put(this._cells)}}const i={xMin:1/0,yMin:1/0,xMax:-1/0,yMax:-1/0},r=(0,_aggregation_GridSpatialIndex_js__WEBPACK_IMPORTED_MODULE_7__.pixelsPerMapUnit)(this._indexOptions.spatialReference,this._scale),n=this._indexOptions.cellSize;for(const{subscription:a}of t){const e=a.tile.bounds,t=Math.floor(e[0]*r/n),s=Math.floor(e[1]*r/n),l=Math.ceil(e[2]*r/n),o=Math.ceil(e[3]*r/n);i.xMin=Math.min(i.xMin,t),i.yMin=Math.min(i.yMin,s),i.xMax=Math.max(i.xMax,l),i.yMax=Math.max(i.yMax,o)}return null!=this._lastCellBounds&&i.xMin===this._lastCellBounds.xMin&&i.yMin===this._lastCellBounds.yMin&&i.yMin===this._lastCellBounds.yMin&&i.yMax===this._lastCellBounds.yMax||(s=!0,this._lastCellBounds=i),s&&this._clusterCells(i),s}async updateStatistics(e){let t=!1;for(const s of this._clusters.values())s.inner.count>1&&(t=this._updateAggregateStatistics(this._statistics,s.inner)||t);if(t){const t=Array.from(this._statistics.entries()).map((([e,t])=>({fieldName:e,minValue:t.minValue,maxValue:t.maxValue})));await e.container.updateStatistics(this._level,t)}}createAggregateFeatures(e,i){const n=e.subscription,a=[],l=n.tile.transform;for(const o of this._clusters.values()){let e=o.inner.getCentroidX(l);const i=o.inner.getCentroidY(l),d=n.tile.lod,c=d.wrap?d.worldSize[0]:null,u=1===o.inner.count?o.inner.firstObjectId:o.inner.id,h=o.displayId;if(null!=c)if(1===c){const n=new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_2__["default"]([],[e,i]),l=new _layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_1__.OptimizedFeature(n,o.inner.getAttributes(),null);l.geometry.coords[0]-=_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize,l.objectId=u,l.displayId=h,a.push(l);const d=new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_2__["default"]([],[e,i]),c=new _layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_1__.OptimizedFeature(d,o.inner.getAttributes(),null);c.geometry.coords[0]+=_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize,c.objectId=u,c.displayId=h,a.push(c)}else e>_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize+_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize/2?e-=c*_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize:e<-_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize/2&&(e+=c*_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize);if(e<_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize+y&&e>=-y&&i<_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_4__.tileSize+y&&i>=-y){const r=new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_2__["default"]([],[e,i]),n=new _layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_1__.OptimizedFeature(r,o.inner.getAttributes(),null);n.objectId=u,n.displayId=h,a.push(n)}}return _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_16__.FeatureSetReaderJSON.fromOptimizedFeatures(a,i,n.tile.transform)}_clusterCells(e){let t=Array.from(this._cells.values());t=t.sort(((e,t)=>t.count-e.count));const s=[];for(const a of this._clusters.values())s.push(a.inner.id);this._clusters.clear();const i=this._clusterRadius*(1/(0,_aggregation_GridSpatialIndex_js__WEBPACK_IMPORTED_MODULE_7__.pixelsPerMapUnit)(this._indexOptions.spatialReference,this._scale)),r=1+this._clusterRadius/this._indexOptions.cellSize,n=new Set;for(const l of t){if(n.has(l.id))continue;if(l.gridX<e.xMin||l.gridX>e.xMax||l.gridY<e.yMin||l.gridY>e.yMax)continue;const t=this._store.createDisplayIdForObjectId(l.id),s=new _support_WithDisplayId_js__WEBPACK_IMPORTED_MODULE_10__.WithDisplayId(l.clone(),t);n.add(l.id),this._clusters.set(l.id,s);const o=l.centroidXWorld,d=l.centroidYWorld;for(let e=l.gridY-r;e<=l.gridY+r;e++)for(let t=l.gridX-r;t<=l.gridX+r;t++){if(e===l.gridY&&t===l.gridX)continue;const r=this._cells.get(_aggregation_GridCell_js__WEBPACK_IMPORTED_MODULE_6__.GridCell.createId(t,e));if(!r||n.has(r.id))continue;const c=Math.abs(r.centroidXWorld-o),u=Math.abs(r.centroidYWorld-d);c<i&&u<i&&(s.inner.merge(r),n.add(r.id))}}for(const a of s)this._store.releaseDisplayIdForObjectId(a)}_updateAggregateStatistics(e,t){let s=!1;for(const i of t.statistics.values()){if("esriFieldTypeString"===i.field.type)continue;const t=i.value,r=i.field,n=e.get(r.name);if(n){const{minValue:e,maxValue:i}=n,r=Math.min(n.minValue,t),a=Math.max(n.maxValue,t);e===r&&i===a||(n.minValue=r,n.maxValue=a,s=!0)}else e.set(r.name,{minValue:t,maxValue:t}),s=!0}return s}}class x extends _AAggregateStrategy_js__WEBPACK_IMPORTED_MODULE_8__.AAggregateStrategy{static async create(e,t,s,i,r,a){const l=new _support_ComputedAttributeStorage_js__WEBPACK_IMPORTED_MODULE_13__.ComputedAttributeStorage({spatialReference:s}),o={type:"grid",fields:await Promise.all(t.fields.map((async e=>_aggregation_ComputedAggregateField_js__WEBPACK_IMPORTED_MODULE_5__.ComputedAggregateField.create(l,e)))),spatialReference:s,featureFilter:t.featureFilter?await _support_FeatureFilter_js__WEBPACK_IMPORTED_MODULE_14__["default"].create({geometryType:i.metadata.geometryType,hasM:!1,hasZ:!1,timeInfo:i.metadata.timeInfo,fieldsIndex:i.metadata.fieldsIndex,spatialReference:s,filterJSON:t.featureFilter}):null,cellSize:t.clusterRadius/4,timeZone:a};return new x(e,t.clusterRadius,o,t.fields,i,r)}constructor(e,t,s,r,n,a){super(n,a,s.spatialReference,s.fields),this._connection=e,this._clusterRadius=t,this._indexOptions=s,this._cellsPerScale=new Map,this._metadata=_support_FeatureMetadata_js__WEBPACK_IMPORTED_MODULE_15__.FeatureMetadata.createFeature({geometryType:"esriGeometryPoint",objectIdField:"aggregateId",fieldsIndex:new _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_3__["default"]([...r,...this._source.metadata.fieldsIndex.fields,{name:"aggregateId",alias:"aggregateId",type:"esriFieldTypeOID"}]).toJSON(),globalIdField:null,spatialReference:n.metadata.spatialReference,subtypeField:null,subtypes:null,timeInfo:null,timeReferenceUnknownClient:null,typeIdField:null,types:null})}get enablePixelBuffering(){return!1}invalidate(){super.invalidate();for(const e of this._cellsPerScale.values())e.destroy();this._cellsPerScale.clear()}onSubscribe(e){super.onSubscribe(e),this._requiredLevel=e.tile.level,this._requiredScale=e.tile.scale}createState(e){return new S(e)}async*applyLocalEdit(e){for(const t of this._cellsPerScale.values())t.destroy();this._cellsPerScale.clear();for(const t of this._sendStates.values())t.done=!1}displayMap(e,t,s){const i=new Map(e.map((e=>[t(e),e]))),r=[],n=this._getClusterState(this._requiredLevel,this._requiredScale);for(const a of n.clusters()){const e=i.get(a.inner.id);if(null==e){if(1===a.inner.count){const e=i.get(a.inner.firstObjectId);if(null!=e){const t=s(a.displayId,e,a.inner.firstObjectId);r.push(t),i.delete(a.inner.firstObjectId)}}}else{const t=s(a.displayId,e,a.inner.id);r.push(t),i.delete(a.inner.id)}}return r}getDisplayFeatures(t){const s=new Set(t),i=new Set,r=[],n=[],a=this._getClusterState(this._requiredLevel,this._requiredScale);for(const l of a.aggregatesWorldSpace())if(s.has(l.displayId)&&!i.has(l.displayId)){const t=(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__.convertToFeature)(l,this._metadata.geometryType,!1,!1);if(i.add(l.displayId),1===t.attributes.cluster_count){r.push({...t,displayId:l.displayId});continue}n.push({...t,displayId:l.displayId})}return{features:r,aggregates:n}}getFeatureObjectIdsForAggregate(e){const t=this._getClusterState(this._requiredLevel,this._requiredScale);for(const s of t.clusters())if(s.inner.id===e)return Array.from(s.inner.containedObjectIds);return[]}async*updateChunks(){const e=this._source.chunks();if(!e.length)return;for(const n of e)(0,_sources_strategies_chunks_OverrideChunk_js__WEBPACK_IMPORTED_MODULE_12__.isLocalEditChunk)(n)&&n.lastLocalEditDropped!==this._lastHandledLocalEdit&&(this.invalidate(),this._lastHandledLocalEdit=n.lastLocalEditDropped);const t=this._getClusterState(this._requiredLevel,this._requiredScale),s=Array.from(this._sendStates.values()).filter((e=>e.subscription.tile.level===this._requiredLevel));if(t.updateChunks(e,s)||!this._source.updateTracking.updating)for(const n of s)n.subscription.tile.level===this._requiredLevel&&(n.didSend=!1,n.done=!1);const i=Array.from(this._sendStates.values()).filter((e=>e.done)).map((e=>e.subscription.tile.key)),r=new Set(i);for(const n of this._sendStates.values()){if(this._source.updateTracking.updating){if(i.some((e=>e.containsChild(n.subscription.tile.key))))continue;if(n.subscription.tile.key.getChildKeys().every((e=>r.has(e))))continue}n.didSend||n.subscription.tile.level!==this._requiredLevel||(n.didSend=!0,yield*this._update(n,t,this._source))}await t.updateStatistics(this._connection)}forEachAggregateWorldSpace(e){if(null==this._requiredLevel||null==this._requiredScale)return;const t=this._getClusterState(this._requiredLevel,this._requiredScale);for(const s of t.aggregatesWorldSpace())e(s)}_getClusterState(e,t){if(null==e||null==t)throw new Error("InternalError: Level and scale must be defined");let s=this._cellsPerScale.get(t);return s||(s=new I(e,t,this._indexOptions,this._clusterRadius,this._attributeStore),this._cellsPerScale.set(t,s)),s}async*_update(e,t,s){if(e.done)return;const i=t.createAggregateFeatures(e,this._metadata);this.events.emit("changed"),e.done=!s.updateTracking.updating;const r=i.getCursor(),n=e.subscription.tile.createArcadeEvaluationOptions(this._indexOptions.timeZone);for(;r.next();)this._attributeStore.setAttributeData(r.getDisplayId(),r,n);const a=new _sources_FeatureSourceMessage_js__WEBPACK_IMPORTED_MODULE_11__.FeatureTileAppendMessage(e.subscription,i,!0,e.done,{});yield a}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/processor/FeatureUpdateStrategy.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/processor/FeatureUpdateStrategy.js ***!
  \***********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DefaultSendState: function() { return /* binding */ n; },
/* harmony export */   FeatureUpdateStrategy: function() { return /* binding */ o; }
/* harmony export */ });
/* harmony import */ var _AProcessorStrategy_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AProcessorStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/processor/AProcessorStrategy.js");
/* harmony import */ var _sources_FeatureSourceMessage_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sources/FeatureSourceMessage.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/FeatureSourceMessage.js");
/* harmony import */ var _sources_strategies_chunks_OverrideChunk_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sources/strategies/chunks/OverrideChunk.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/OverrideChunk.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class n extends _AProcessorStrategy_js__WEBPACK_IMPORTED_MODULE_0__.ASendState{}class o extends _AProcessorStrategy_js__WEBPACK_IMPORTED_MODULE_0__.AProcessorStrategy{constructor(e,t,s){super(e,t),this._timeZone=s,this.handledChunks=new Set,this.handledChunksForIdCreation=new Set,this.handledChunksForAttributeData=new Set,this._streamLayerDeferredObjectIdsToRemove=[]}destroy(){super.destroy();for(const e of this._source.chunks())this._cleanupChunkIds(e)}invalidateAttributeData(){this.handledChunksForAttributeData.clear()}onSubscribe(e){super.onSubscribe(e),this._evalOptions=e.tile.createArcadeEvaluationOptions(this._timeZone)}createState(e){return new n(e)}get aggregateQueryEngine(){return null}displayMap(e,t,s){const r=new Map(e.map((e=>[t(e),e]))),a=[];for(const n of this._source.chunks()){const e=n.reader.getCursor();for(;e.next();){const t=e.getObjectId(),n=e.getDisplayId(),o=r.get(t);if(null!=o){const e=s(n,o,t);a.push(e),r.delete(t)}}}return a}getDisplayFeatures(e){const t=new Set(e),s=new Set,r=[];for(const a of this._source.chunks()){const e=a.reader.getCursor();for(;e.next();){const a=e.getObjectId(),n=e.getDisplayId();t.has(n)&&!s.has(a)&&(r.push({...e.readLegacyFeatureWorldSpace(),displayId:n}),s.add(a))}}return{features:r,aggregates:[]}}async*applyLocalEdit(e){const t=[],r=e.reader.getCursor();for(;r.next();){const e=r.getObjectId();t.push(e);const s=this._attributeStore.createDisplayIdForObjectId(e);r.setDisplayId(s),this._attributeStore.setAttributeData(s,r,this._evalOptions)}const n=this.getDisplayIds(t),o=this.getDisplayIds(e.removed),d=new _sources_strategies_chunks_OverrideChunk_js__WEBPACK_IMPORTED_MODULE_2__.OverrideChunk(this._source.metadata,"localEdit");d.applyOverrides(e),this.handledChunks.add(d.chunkId),this.handledChunksForAttributeData.add(d.chunkId),this.handledChunksForIdCreation.add(d.chunkId);for(const a of this._sendStates.values())a.handledChunks.add(d.chunkId),yield new _sources_FeatureSourceMessage_js__WEBPACK_IMPORTED_MODULE_1__.FeatureTileUpdateMessage(a.subscription,null,n,!1,d.queryInfo);for(const a of this._sendStates.values()){const e=d.getTileReader(a.subscription.tile);yield new _sources_FeatureSourceMessage_js__WEBPACK_IMPORTED_MODULE_1__.FeatureTileUpdateMessage(a.subscription,e,o,!1,d.queryInfo)}for(const s of e.removed)this._attributeStore.releaseDisplayIdForObjectId(s)}async*updateChunks(){if(this._source.chunks().length){await this._updateAttributeData();for(const e of this._sendStates.values())yield*this._update(e)}}removeChunks(e){for(const t of e)this.handledChunks.delete(t.chunkId),this.handledChunksForAttributeData.delete(t.chunkId),this._cleanupChunkIds(t)}afterUpdateChunks(){for(const e of this._streamLayerDeferredObjectIdsToRemove)this._attributeStore.releaseDisplayIdForObjectId(e);this._streamLayerDeferredObjectIdsToRemove=[]}_cleanupChunkIds(e){if(this.handledChunksForIdCreation.has(e.chunkId)){const t=e.reader.getCursor();for(;t.next();){const e=t.getObjectId();this._source.isStream?this._streamLayerDeferredObjectIdsToRemove.push(e):this._attributeStore.releaseDisplayIdForObjectId(e)}this.handledChunksForIdCreation.delete(e.chunkId)}}async _updateAttributeData(){for(const e of this._source.chunks()){const{chunkId:t,reader:s}=e;if(!this.handledChunksForIdCreation.has(t)){this.handledChunksForIdCreation.add(t);const e=s.getCursor();for(;e.next();){const t=this._attributeStore.createDisplayIdForObjectId(e.getObjectId());e.setDisplayId(t)}}}for(const e of this._source.chunks())if(!this.handledChunksForAttributeData.has(e.chunkId)){this.handledChunksForAttributeData.add(e.chunkId);const t=e.reader.getCursor();for(;t.next();){const e=t.getDisplayId();this._attributeStore.setAttributeData(e,t,this._evalOptions)}}}*_update(e){const{subscription:t,handledChunks:s}=e;for(const a of this._source.chunks()){const{chunkId:n}=a;if(s.has(n))continue;s.add(n);const o=a.getTileReader(t.tile);o&&(yield new _sources_FeatureSourceMessage_js__WEBPACK_IMPORTED_MODULE_1__.FeatureTileAppendMessage(e.subscription,o,!1,a.end,a.queryInfo))}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/processor/support/WithDisplayId.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/processor/support/WithDisplayId.js ***!
  \***********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   WithDisplayId: function() { return /* binding */ s; }
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class s{constructor(s,t){this.inner=s,this.displayId=t}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/FeatureSource.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/FeatureSource.js ***!
  \*************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureSource: function() { return /* binding */ b; }
/* harmony export */ });
/* harmony import */ var _request_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../request.js */ "./node_modules/@arcgis/core/request.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../core/accessorSupport/diffUtils.js */ "./node_modules/@arcgis/core/core/accessorSupport/diffUtils.js");
/* harmony import */ var _layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../layers/graphics/OptimizedFeature.js */ "./node_modules/@arcgis/core/layers/graphics/OptimizedFeature.js");
/* harmony import */ var _layers_graphics_data_QueryEngine_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../layers/graphics/data/QueryEngine.js */ "./node_modules/@arcgis/core/layers/graphics/data/QueryEngine.js");
/* harmony import */ var _rest_query_operations_query_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../../rest/query/operations/query.js */ "./node_modules/@arcgis/core/rest/query/operations/query.js");
/* harmony import */ var _FeatureStoreStatistics_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../FeatureStoreStatistics.js */ "./node_modules/@arcgis/core/views/2d/layers/features/FeatureStoreStatistics.js");
/* harmony import */ var _FeatureSourceQueryInfo_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./FeatureSourceQueryInfo.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/FeatureSourceQueryInfo.js");
/* harmony import */ var _StreamMessenger_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./StreamMessenger.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/StreamMessenger.js");
/* harmony import */ var _strategies_DrillDownTileLoadStrategy_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./strategies/DrillDownTileLoadStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/DrillDownTileLoadStrategy.js");
/* harmony import */ var _strategies_PagedTileLoadStrategy_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./strategies/PagedTileLoadStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/PagedTileLoadStrategy.js");
/* harmony import */ var _strategies_ParquetLoadStrategy_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./strategies/ParquetLoadStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/ParquetLoadStrategy.js");
/* harmony import */ var _strategies_SnapshotLoadStrategy_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./strategies/SnapshotLoadStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/SnapshotLoadStrategy.js");
/* harmony import */ var _strategies_StreamLoadStrategy_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./strategies/StreamLoadStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/StreamLoadStrategy.js");
/* harmony import */ var _strategies_chunks_SourceChunkStore_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./strategies/chunks/SourceChunkStore.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/SourceChunkStore.js");
/* harmony import */ var _support_FeatureMetadata_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../support/FeatureMetadata.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureMetadata.js");
/* harmony import */ var _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../support/FeatureSetReaderJSON.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderJSON.js");
/* harmony import */ var _support_UpdateTracking2D_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../support/UpdateTracking2D.js */ "./node_modules/@arcgis/core/views/2d/layers/support/UpdateTracking2D.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class b{constructor(t,e,s,r,a){this.service=t,this._aggregateAdapter=e,this._subscriptions=s,this._onChange=r,this._connection=a,this._updateTracking=new _support_UpdateTracking2D_js__WEBPACK_IMPORTED_MODULE_18__.UpdateTracking2D({debugName:"FeatureSource"}),this._didInvalidateData=!1,this._store=new _strategies_chunks_SourceChunkStore_js__WEBPACK_IMPORTED_MODULE_15__.FeatureSourceChunkStore(this._onChange),this._metadata=_support_FeatureMetadata_js__WEBPACK_IMPORTED_MODULE_16__.FeatureMetadata.createFeature(t.metadata)}destroy(){this._strategy?.destroy(),this._store.destroy(),this._streamMessenger?.destroy(),"memory"===this.service.type&&this.service.source.map((t=>t.close()))}get metadata(){if(!this._metadata)throw new Error("InternalError: Metadata not defined. Was update called?");return this._metadata}get store(){return this._store}get streamMessenger(){return null==this._streamMessenger&&this._initStreamMessenger(),this._streamMessenger}get statistics(){return _FeatureStoreStatistics_js__WEBPACK_IMPORTED_MODULE_7__.FeatureStoreStatistics.from(this._store)}get updateTracking(){return this._updateTracking}get queryEngine(){if(!this._queryEngine){if(!this._schema)return null;const{dataFilter:t}=this._schema.mutable,e=this._schema.mutable.availableFields,s=this._metadata;this._queryEngine=new _layers_graphics_data_QueryEngine_js__WEBPACK_IMPORTED_MODULE_5__.QueryEngine({featureStore:this._store,fieldsIndex:s.fieldsIndex,geometryType:s.geometryType,objectIdField:s.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.service.outSpatialReference,aggregateAdapter:this._aggregateAdapter,timeInfo:s.timeInfo,definitionExpression:t.definitionExpression,availableFields:e})}return this._queryEngine}get isStream(){return"stream"===this._schema.type}chunks(){return Array.from(this._store.chunks())}cleanupRemovedChunks(){return this._store.cleanupRemovedChunks()}onSubscribe(t){this._connection.onEvent({type:"subscribe",tile:t.tile.id});const e=this._strategy?.load(t);e&&(e.then((()=>this._connection.onEvent({type:"loaded",tile:t.tile.id}))).catch((e=>this._connection.onEvent({type:"error",tile:t.tile.id,error:e}))),this._updateTracking.addPromise(e))}onResume(t){this._updateTracking.addPromise((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__.ignoreAbortErrors)(this._strategy?.load(t)))}onUnsubscribe(t){this._connection.onEvent({type:"unsubscribe",tile:t.tile.id}),this._strategy?.unload(t)}getLocalEdit(t){return this._updateTracking.addPromise(this._getGetLocalEdit(t))}applyLocalEdit(t){this._didInvalidateData=!0,this._store.applyLocalEdit(t,this.metadata)}async update(t,e){const s=t.source,o=(0,_core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_3__.diff)(this._schema?.mutable,s.mutable);if(!o)return!1;if((0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__["default"])("esri-2d-update-debug")&&console.debug(`Version[${e}] FeatureSource.update`,{changes:o}),this._schema=s,this._queryEngine?.destroy(),this._queryEngine=null,"feature-service"===this.service.type&&null!=this.service.queryMetadata.lastEditDate&&(this._lastEditDate=this.service.queryMetadata.lastEditDate),null==this._streamMessenger&&"stream"===this._schema.type&&this._initStreamMessenger(),(0,_core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_3__.hasRootDiffOnly)(o,"sourceRefreshVersion")&&this._strategy?.refresh)return await this._strategy.refresh(),!0;if(("feature"===s.type||"parquet"===s.type)&&(0,_core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_3__.hasRootDiffOnly)(o,"availableFields")){if(await this._queryLastEditDateChanged()||this._didInvalidateData)this._didInvalidateData=!1,await this._updateStrategy(e);else{this._connection.onEvent({type:"updateFieldsStart"});try{await this._strategy.updateFields(s.mutable.availableFields),this._connection.onEvent({type:"updateFieldsEnd"})}catch(n){this._connection.onEvent({type:"updateFieldsError",error:n})}}return!1}return!(!(0,_core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_3__.hasRootDiff)(o,"dataFilter")&&!(0,_core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_3__.hasRootDiff)(o,"sourceRefreshVersion"))&&(await this._updateStrategy(e),!0)}async addParquetFile(t){this._strategy.addParquetFile(t)}_initStreamMessenger(){null==this._streamMessenger&&(this._streamMessenger=new _StreamMessenger_js__WEBPACK_IMPORTED_MODULE_9__.StreamMessenger(this._connection))}async _getGetLocalEdit(t){if(t.historicMoment&&"feature"===this._schema.type&&(this._schema.mutable.dataFilter.historicMoment=t.historicMoment,this._strategy.unsafeSetQueryHistoricMoment(new Date(t.historicMoment))),"edit-by-feature"===t.type){const e=[...t.added,...t.updated].map((t=>_layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_4__.OptimizedFeature.fromJSON(t,this.metadata.objectIdField)));return{reader:_support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_17__.FeatureSetReaderJSON.fromOptimizedFeatures(e,this.metadata),removed:this._resolveIdentifiers(t.removed)}}const e=this._resolveIdentifiers(t.removed);if(!t.updated.length&&!t.added.length)return{reader:_support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_17__.FeatureSetReaderJSON.empty(this.metadata),removed:e};const s=this._resolveIdentifiers([...t.added,...t.updated]);return{reader:await this._strategy.queryByObjectId(s),removed:e}}_resolveIdentifiers(t){const e=[],s=[];for(const r of t)null!=r.objectId&&-1!==r.objectId?s.push(r.objectId):e.push(r.globalId);if(e.length){const t=new Set(e),r=this.metadata.globalIdField;if(null==r)throw new Error("InternalError: Recieved an edit with globalIds, but not supported by the service");this._store.forEachUnsafe((e=>{const a=e.readAttribute(r);t.has(a)&&s.push(e.getObjectId())}))}return s}async _queryLastEditDateChanged(){if(null==this._lastEditDate)return!1;const e=this.service.source,s={...e.query,f:"json"},r=(await (0,_request_js__WEBPACK_IMPORTED_MODULE_0__["default"])(e.path,{query:s,responseType:"json"})).data.editingInfo.lastEditDate;return r!==this._lastEditDate&&(this._lastEditDate=r,!0)}async _createStrategy(){const t="isSourceHosted"in this.service&&this.service.isSourceHosted,e=Array.isArray(this.service.source),s=this.service.source&&"collection"in this.service.source,r=t||e||s;if("stream"===this._schema.type){const t=new _strategies_StreamLoadStrategy_js__WEBPACK_IMPORTED_MODULE_14__.StreamLoadStrategy(this.service,this._schema.mutable.dataFilter,this._store,{outSR:this.service.outSpatialReference},this.metadata);return this._streamMessenger.strategy=t,t}if("parquet"===this._schema.type){const t=this.service;return new _strategies_ParquetLoadStrategy_js__WEBPACK_IMPORTED_MODULE_12__.ParquetLoadStrategy(t,this._metadata,this._schema,this._store)}const a=this.service,i=_FeatureSourceQueryInfo_js__WEBPACK_IMPORTED_MODULE_8__.FeatureSourceQueryInfo.fromSchema(a,this._schema,this._metadata),o=await this._supportSnapshotMode(a,i);return o?new _strategies_SnapshotLoadStrategy_js__WEBPACK_IMPORTED_MODULE_13__.SnapshotLoadStrategy(a,i,this._store,o.featureCount,this.metadata,this._connection):r?new _strategies_PagedTileLoadStrategy_js__WEBPACK_IMPORTED_MODULE_11__.PagedTileLoadStrategy(a,i,this._store,this.metadata,this._connection):new _strategies_DrillDownTileLoadStrategy_js__WEBPACK_IMPORTED_MODULE_10__.DrillDownTileLoadStrategy(a,i,this._store,this.metadata,this._connection)}async _updateStrategy(t){const e=await this._createStrategy();this._connection.onEvent({type:"updateStrategyStart",about:e.about});const r=!!this._strategy;this._store.clear(),this._strategy?.destroy(),this._strategy=e,(0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__["default"])("esri-2d-update-debug")&&console.debug(`Version[${t}] FeatureSource.updateStrategy`,{strategy:e});const a=Array.from(this._subscriptions.values());if(!a.length)return void this._connection.onEvent({type:"updateStrategyEnd"});const i=Promise.all(a.map((t=>this._strategy.load(t).then((()=>this._connection.onEvent({type:"loaded",tile:t.tile.id}))).catch((e=>this._connection.onEvent({type:"error",tile:t.tile.id,error:e}))))));this._updateTracking.addPromise(i);try{r&&await i}catch(o){(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__.throwIfNotAbortError)(o)}this._connection.onEvent({type:"updateStrategyEnd"}),(0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__["default"])("esri-2d-update-debug")&&console.debug(`Version[${t}] FeatureSource.updateStrategyEnd`,{strategy:e})}async _supportSnapshotMode(t,e){const{queryMetadata:s}=t,r=s.snapshotInfo;if(!r||!r.supportsSnapshotMinThreshold||!r.snapshotCountThresholds)return null;const a=t.source,i=e.createQuery();i.inner.orderByFields=[],i.inner.returnGeometry=!1;const o=(await (0,_rest_query_operations_query_js__WEBPACK_IMPORTED_MODULE_6__.executeQueryForCount)(a,i.inner,{query:i.customParameters})).data.count,{min:n,max:h}=r.snapshotCountThresholds;return o<=n||r.supportsSnapshotMaxThreshold&&o<h?{featureCount:o}:null}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/FeatureSourceMessage.js":
/*!********************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/FeatureSourceMessage.js ***!
  \********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureTileAppendMessage: function() { return /* binding */ e; },
/* harmony export */   FeatureTileUpdateMessage: function() { return /* binding */ i; }
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class e{constructor(e,i,t,s,r){this.subscription=e,this.reader=i,this.clear=t,this.end=s,this.debugInfo=r,this.type="append"}get id(){return this.subscription.tile.id}createMessage(e,i,t){return{type:"append",clear:this.clear,id:this.id,append:e,end:this.end,debugInfo:this.debugInfo,subscriptionVesrion:this.subscription.version,version:i,attributeEpoch:t}}}class i{constructor(e,i,t,s,r){this.subscription=e,this.reader=i,this.remove=t,this.end=s,this.debugInfo=r,this.type="update"}get id(){return this.subscription.tile.id}createMessage(e,i,t){return{type:"update",id:this.id,modify:e,debugInfo:this.debugInfo,remove:this.remove,version:i,subscriptionVesrion:this.subscription.version,end:this.end,attributeEpoch:t}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/FeatureSourceQueryInfo.js":
/*!**********************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/FeatureSourceQueryInfo.js ***!
  \**********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureSourceQueryInfo: function() { return /* binding */ n; }
/* harmony export */ });
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_sql_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../core/sql.js */ "./node_modules/@arcgis/core/core/sql.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/* harmony import */ var _layers_support_arcgisLayerUrl_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../layers/support/arcgisLayerUrl.js */ "./node_modules/@arcgis/core/layers/support/arcgisLayerUrl.js");
/* harmony import */ var _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../rest/support/Query.js */ "./node_modules/@arcgis/core/rest/support/Query.js");
/* harmony import */ var _time_TimeExtent_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../time/TimeExtent.js */ "./node_modules/@arcgis/core/time/TimeExtent.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const o=4;function s(e,a,o){const s=e.orderByFields??o.objectIdField+" ASC",n=e.source,u={returnCentroid:!(null!==n&&"object"==typeof n&&"path"in n&&(0,_layers_support_arcgisLayerUrl_js__WEBPACK_IMPORTED_MODULE_3__.isHostedAgolService)(n.path))&&"esriGeometryPolygon"===o.serviceGeometryType,returnGeometry:!0,timeReferenceUnknownClient:o.timeReferenceUnknownClient??void 0,outSpatialReference:_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_2__["default"].fromJSON(e.outSpatialReference),orderByFields:"memory"===e.type?[]:[s],where:a.mutable.dataFilter.definitionExpression??"1=1",outFields:a.mutable.availableFields,multipatchOption:"esriGeometryMultiPatch"===o.serviceGeometryType?"xyFootprint":null};if("feature"===a.type){const{gdbVersion:e,historicMoment:t,timeExtent:r}=a.mutable.dataFilter;return{...u,gdbVersion:e,historicMoment:t?new Date(t):null,timeExtent:r?_time_TimeExtent_js__WEBPACK_IMPORTED_MODULE_5__["default"].fromJSON(r):null,outFields:a.mutable.availableFields}}return u}class n{static fromSchema(e,t,r){const a="feature"===t.type?t.mutable.dataFilter.queryScaleRanges:[];return new n(s(e,t,r),a,r.subtypeField,t.mutable.dataFilter.customParameters,r.geometryType,e.queryMetadata)}constructor(e,t,r,a,i,o){this._queryParams=e,this._queryScaleRanges=t,this._subtypeField=r,this._customParameters=a,this._geometryType=i,this._queryMetadata=o}get pageSize(){if(null==this._queryMetadata)throw new Error("InternalError: Service does not support paged queries");const e=this._queryMetadata.supportsMaxRecordCountFactor?o:null,t=(this._queryMetadata.maxRecordCount??8e3)*(e??1);return Math.min(8e3,t)}updateHistoricMoment(e){this._queryParams.historicMoment=e}updateFields(e){this._queryParams.outFields=e}createPatchFieldsQuery(e,t){if(!t.getSize())return null;const r=e.clone();if("*"===this._queryParams.outFields[0]){if("*"===(r.outFields??[])[0])return null;r.outFields=this._queryParams.outFields}else{const e=new Set(this._queryParams.outFields),a=[];for(const r of e)t.hasField(r)||a.push(r);if(0===a.length)return null;r.outFields=a}return r.returnGeometry=!1,r.returnCentroid=!1,r.quantizationParameters=null,r.cacheHint=!0,{inner:r,customParameters:this._customParameters}}createQuery(e={}){if(!this._queryParams)throw new Error("InternalError: queryInfo should be defined");return{inner:new _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_4__["default"]({...this._queryParams,...e}),customParameters:this._customParameters}}createTileQuery(t,r){if(null==this._queryMetadata)throw new Error("InternalError: Service does not support tile queries");const a=this.createQuery(r),i=a.inner;if(this._queryScaleRanges.length){const r=this._queryScaleRanges.filter((e=>(!e.minScale||e.minScale>=t.maxScale)&&(!e.maxScale||e.maxScale<=t.minScale))).map((e=>e.subtypeCode));if(r.length){const t=`${this._subtypeField} IN (${r})`;i.where=(0,_core_sql_js__WEBPACK_IMPORTED_MODULE_1__.sqlAnd)(i.where,t)}}if(i.quantizationParameters=r.quantizationParameters??t.getQuantizationParameters(),i.resultType="tile",i.geometry=t.extent,this._queryMetadata.supportsQuantization?"esriGeometryPolyline"===this._geometryType&&(i.maxAllowableOffset=t.resolution*(0,_core_has_js__WEBPACK_IMPORTED_MODULE_0__["default"])("feature-polyline-generalization-factor")):"esriGeometryPolyline"!==this._geometryType&&"esriGeometryPolygon"!==this._geometryType||(i.maxAllowableOffset=t.resolution,"esriGeometryPolyline"===this._geometryType&&(i.maxAllowableOffset*=(0,_core_has_js__WEBPACK_IMPORTED_MODULE_0__["default"])("feature-polyline-generalization-factor"))),i.defaultSpatialReferenceEnabled=this._queryMetadata.supportsDefaultSpatialReference,i.compactGeometryEnabled=this._queryMetadata.supportsCompactGeometry,this._queryMetadata.supportsMaxRecordCountFactor&&(i.maxRecordCountFactor=o),(0,_core_has_js__WEBPACK_IMPORTED_MODULE_0__["default"])("esri-tiles-debug")){const e=t.id.replaceAll("/",".");a.customParameters=a.customParameters?{...a.customParameters,tileId:e}:{tileId:e}}return a}createPagedTileQuery(e,t){const r=this.pageSize;return this.createTileQuery(e,{start:r*t,num:r,returnExceededLimitFeatures:!0})}createPagedQuery(e){const t=this.pageSize;return this.createQuery({start:t*e,num:t,returnExceededLimitFeatures:!0,maxRecordCountFactor:o})}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/FeatureTileSubscription.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/FeatureTileSubscription.js ***!
  \***********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureTileSubscription: function() { return /* binding */ t; }
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class t{constructor(t,r){this.tile=t,this.version=r,this._abortController=new AbortController}get key(){return this.tile.key}get signal(){return this._abortController.signal}abort(){this._abortController.abort()}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/StreamConnectionState.js":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/StreamConnectionState.js ***!
  \*********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   StreamConnectionState: function() { return /* binding */ s; }
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../core/Accessor.js */ "./node_modules/@arcgis/core/core/Accessor.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
let s=class extends _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__["default"]{constructor(r){super(r)}get connectionStatus(){return this.connection?.connectionStatus}get errorString(){return this.connection?.errorString}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)()],s.prototype,"connection",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)()],s.prototype,"connectionStatus",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)()],s.prototype,"errorString",null),s=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_3__.subclass)("esri.views.2d.layers.features.sources.StreamConnectionState")],s);


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/StreamFeatureStore.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/StreamFeatureStore.js ***!
  \******************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   StreamFeatureStore: function() { return /* binding */ t; }
/* harmony export */ });
/* harmony import */ var _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../support/FeatureSetReaderJSON.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderJSON.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class t{constructor(e,t){this._metadata=e,this._onUpdate=t,this._objectIdToFeature=new Map}get size(){return this._objectIdToFeature.size}get reader(){return _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_0__.FeatureSetReaderJSON.fromFeatures([...this._objectIdToFeature.values()],this._metadata)}add(e){this._objectIdToFeature.set(e.objectId,e)}forEach(e){this._objectIdToFeature.forEach(e)}removeById(e){const t=this._objectIdToFeature.get(e);return t?(this._objectIdToFeature.delete(e),t):null}clear(){this._objectIdToFeature=new Map}update(e,t){this._onUpdate(e?.length??0)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/StreamMessenger.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/StreamMessenger.js ***!
  \***************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   StreamMessenger: function() { return /* binding */ o; }
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../core/Accessor.js */ "./node_modules/@arcgis/core/core/Accessor.js");
/* harmony import */ var _core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../core/reactiveUtils.js */ "./node_modules/@arcgis/core/core/reactiveUtils.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../../core/RandomLCG.js */ "./node_modules/@arcgis/core/core/RandomLCG.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const a=2500;let o=class extends _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__["default"]{constructor(e){super(),this._connection=e,this._enabledEventTypes=new Set,this._updateInfo={websocket:0,client:0},this._lastTime=performance.now(),this._queuedCommands=[],this.addHandles([(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_2__.watch)((()=>this._strategy?.connectionStatus??"disconnected"),(e=>{this._layerView.setProperty({propertyName:"pipelineConnectionStatus",value:e})}),{initial:!0}),(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_2__.watch)((()=>this._strategy?.errorString||null),(e=>this._layerView.setProperty({propertyName:"pipelineErrorString",value:e})),{initial:!0})])}destroy(){this._strategy=null,this.removeAllHandles()}get _layerView(){return this._connection.layerView}set strategy(e){null==this._strategy&&this._resetUpdateInfo(performance.now());const t="event-handles";this.removeHandles(t),null!=e&&(this.addHandles([e.events.on("data-received",(e=>this._onFeature(e))),e.events.on("message-received",(e=>this._onWebSocketMessage(e))),e.events.on("features-updated",(e=>this._onUpdate(e))),e.events.on("tick",(()=>this._onTick()))],t),this._queuedCommands.forEach((t=>t(e))),this._queuedCommands=[]),this._strategy=e}updateCustomParameters(e){null!=e&&this._callOrEnqueue((t=>t.updateCustomParameters(e)))}sendMessageToSocket(e){this._callOrEnqueue((t=>t.sendMessageToSocket(e)))}sendMessageToClient(e){this._callOrEnqueue((t=>t.sendMessageToClient(e)))}enableEvent(e,t){t?this._enabledEventTypes.add(e):this._enabledEventTypes.delete(e)}disconnect(){this._strategy?.disconnect()}connect(){this._strategy?.connect()}clear(){this._strategy?.clear()}_onWebSocketMessage(e){this._enabledEventTypes.has("message-received")&&this._layerView.emitEvent({name:"message-received",event:e})}_onFeature(e){this._updateInfo.websocket++,this._enabledEventTypes.has("data-received")&&this._layerView.emitEvent({name:"data-received",event:{attributes:e.attributes,centroid:e.centroid,geometry:e.geometry}})}_onUpdate(e){this._updateInfo.client+=e}_onTick(){const e=performance.now(),t=e-this._lastTime;if(t>a){const s=Math.round(this._updateInfo.client/(t/1e3)),n=Math.round(this._updateInfo.websocket/(t/1e3));this._resetUpdateInfo(e),this._layerView.emitEvent({name:"update-rate",event:{client:s,websocket:n}})}}_resetUpdateInfo(e){this._lastTime=e,this._updateInfo.client=0,this._updateInfo.websocket=0}_callOrEnqueue(e){null!=this._strategy?e(this._strategy):this._queuedCommands.push(e)}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.property)()],o.prototype,"_strategy",void 0),o=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__.subclass)("esri.views.2d.layers.features.sources.StreamMessenger")],o);


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/AFetchLoadStrategy.js":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/AFetchLoadStrategy.js ***!
  \*****************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AFetchLoadStrategy: function() { return /* binding */ i; }
/* harmony export */ });
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../../rest/support/Query.js */ "./node_modules/@arcgis/core/rest/support/Query.js");
/* harmony import */ var _ALoadStrategy_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ALoadStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/ALoadStrategy.js");
/* harmony import */ var _support_queryAdapters_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./support/queryAdapters.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/support/queryAdapters.js");
/* harmony import */ var _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../support/FeatureSetReaderJSON.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderJSON.js");
/* harmony import */ var _support_QueueProcessor_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../support/QueueProcessor.js */ "./node_modules/@arcgis/core/views/support/QueueProcessor.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class i extends _ALoadStrategy_js__WEBPACK_IMPORTED_MODULE_2__.ALoadStrategy{constructor(e,t,r,n,i){super(r),this._serviceInfo=e,this._queryInfo=t,this._metadata=n,this._connection=i,this._queue=new _support_QueueProcessor_js__WEBPACK_IMPORTED_MODULE_5__.QueueProcessor({concurrency:16,process:async e=>{const t={signal:e.options?.signal,query:e.query.customParameters};return this._adapter.executeQuery(e.query.inner,t)}}),this._adapter=(0,_support_queryAdapters_js__WEBPACK_IMPORTED_MODULE_3__.createQueryAdapter)(e,n)}unsafeSetQueryHistoricMoment(e){this._queryInfo.updateHistoricMoment(e)}async updateFields(r){this._queryInfo.updateFields(r);const s=Array.from(this._store.chunks()).map((async e=>{const r=_rest_support_Query_js__WEBPACK_IMPORTED_MODULE_1__["default"].fromJSON(e.queryInfo.queryJSON);if(r)try{return await this._tryUpdateFields(e.reader,r),null}catch(s){return s}})),n=(await Promise.all(s)).filter((e=>e));if(n.length)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"]("featurelayer-query","Encountered errors when downloading fields",{errors:n})}async queryByObjectId(e){if(0===e.length)return _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_4__.FeatureSetReaderJSON.empty(this._metadata);const t=this._queryInfo.createQuery({objectIds:e});return this._fetch(t)}async _fetch(e,t){const r=await this._enqueue(e,t);return await this._tryUpdateFields(r,e.inner),r}async _tryUpdateFields(e,t){const r=this._queryInfo.createPatchFieldsQuery(t,e);if(!r)return;const s=await this._enqueue(r,this._options);e.joinAttributes(s)}async _enqueue(e,t){return this._connection.onEvent({type:"fetchStart"}),this._queue.push({query:e,options:t}).finally((()=>{this._connection.onEvent({type:"fetchEnd",done:0===this._queue.length})}))}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/ALoadStrategy.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/ALoadStrategy.js ***!
  \************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ALoadStrategy: function() { return /* binding */ r; }
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class r{constructor(r){this._store=r,this._controller=new AbortController}destroy(){this._controller.abort()}get _options(){return{signal:this._controller.signal}}unsafeSetQueryHistoricMoment(r){throw new Error("InternalError: LoadStrategy does not support query info")}async queryOverride(r){throw new Error("InternalError: LoadStrategy does not support fetching")}async queryByObjectId(r){throw new Error("InternalError: LoadStrategy does not support fetching")}async addParquetFile(r){throw new Error("InternalError: LoadStrategy does not support loading blobs")}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/ATileLoadStrategy.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/ATileLoadStrategy.js ***!
  \****************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ATileLoadStrategy: function() { return /* binding */ s; }
/* harmony export */ });
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _AFetchLoadStrategy_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AFetchLoadStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/AFetchLoadStrategy.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class s extends _AFetchLoadStrategy_js__WEBPACK_IMPORTED_MODULE_1__.AFetchLoadStrategy{constructor(){super(...arguments),this._chunksById=new Map}unload(e){this._removeChunks(e.tile)}_addChunk(e){const s=e.tile.id;this._chunksById.has(s)||this._chunksById.set(s,[]);const t=e.size();(t||e.first||e.end)&&((0,_core_has_js__WEBPACK_IMPORTED_MODULE_0__["default"])("esri-2d-update-debug")&&console.debug(`Chunk[${e.chunkId}] ATileLoadStrategy.addChunk [count=${t}]`),this._chunksById.get(s).push(e),this._store.insert(e))}_removeChunks(e){const s=this._chunksById.get(e.key.id)??[];for(const t of s)(0,_core_has_js__WEBPACK_IMPORTED_MODULE_0__["default"])("esri-2d-update-debug")&&console.debug(`Tile[${e.key.id}] Chunk[${t.chunkId}] ATileLoadStrategy.removeChunk`),this._store.remove(t);this._chunksById.delete(e.key.id)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/DrillDownTileLoadStrategy.js":
/*!************************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/DrillDownTileLoadStrategy.js ***!
  \************************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrillDownTileLoadStrategy: function() { return /* binding */ a; }
/* harmony export */ });
/* harmony import */ var _core_handleUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../../core/handleUtils.js */ "./node_modules/@arcgis/core/core/handleUtils.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _ATileLoadStrategy_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ATileLoadStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/ATileLoadStrategy.js");
/* harmony import */ var _chunks_DrillDownTileSourceChunk_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunks/DrillDownTileSourceChunk.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/DrillDownTileSourceChunk.js");
/* harmony import */ var _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../support/FeatureSetReaderJSON.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderJSON.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class l{constructor(e,o){this.subscription=e,this._tileIdToResult=new Map,this._controller=new AbortController,this._handles=(0,_core_handleUtils_js__WEBPACK_IMPORTED_MODULE_0__.handlesGroup)([(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__.onAbort)(e.signal,(()=>this._controller.abort())),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__.onAbort)(o,(()=>this._controller.abort()))])}destroy(){this._controller.abort(),this._handles.remove()}get(t){return this._tileIdToResult.get(t)}set(t,e){this._tileIdToResult.set(t,e)}get options(){return{signal:this._controller.signal}}}class a extends _ATileLoadStrategy_js__WEBPACK_IMPORTED_MODULE_3__.ATileLoadStrategy{constructor(){super(...arguments),this._loadStates=new Map}destroy(){super.destroy();for(const t of this._loadStates.values())t.destroy();this._loadStates.clear()}get about(){return{willQueryAllFeatures:!1,willQueryFullResolutionGeometry:!1}}async load(t){this._loadStates.has(t.key.id)||this._loadStates.set(t.key.id,new l(t,this._options));const s=this._loadStates.get(t.key.id);let o;try{for await(const o of this._fetchChunkInfos(s,t.tile,0)){const{queryJSON:t,reader:i,sourceTile:l,sourceTileDepth:a,tile:n}=o,h=new _chunks_DrillDownTileSourceChunk_js__WEBPACK_IMPORTED_MODULE_4__.DrillDownTileSourceChunk(i,t,n,l,a,!1);(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__.throwIfAborted)(s.options),this._addChunk(h)}}catch(n){o=n}const a=new _chunks_DrillDownTileSourceChunk_js__WEBPACK_IMPORTED_MODULE_4__.DrillDownTileSourceChunk(_support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_5__.FeatureSetReaderJSON.empty(this._metadata),null,t.tile,null,-1,!0);if(this._addChunk(a),o)throw o}unload(t){super.unload(t),this._loadStates.get(t.key.id)?.destroy(),this._loadStates.delete(t.key.id)}async*_fetchChunkInfos(t,e,s){let o=t.get(e.id);const r=!!o;if(o||(o=await this._fetchChunkInfo(t,e,s),t.set(e.id,o)),o.reader.exceededTransferLimit&&s<(0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__["default"])("featurelayer-query-max-depth"))for(const i of e.createChildTiles())yield*this._fetchChunkInfos(t,i,s+1);else r||(yield o)}async _fetchChunkInfo(t,e,s){const o=t.subscription.tile.getQuantizationParameters(),r=this._queryInfo.createTileQuery(e,{returnExceededLimitFeatures:!1,quantizationParameters:o});return{reader:await this._fetch(r,t.options),queryJSON:r.inner.toJSON(),tile:t.subscription.tile,sourceTile:e,sourceTileDepth:s}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/PagedTileLoadStrategy.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/PagedTileLoadStrategy.js ***!
  \********************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   PagedTileLoadStrategy: function() { return /* binding */ l; }
/* harmony export */ });
/* harmony import */ var _core_handleUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../../core/handleUtils.js */ "./node_modules/@arcgis/core/core/handleUtils.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _ATileLoadStrategy_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ATileLoadStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/ATileLoadStrategy.js");
/* harmony import */ var _chunks_PagedTileSourceChunk_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunks/PagedTileSourceChunk.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/PagedTileSourceChunk.js");
/* harmony import */ var _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../support/FeatureSetReaderJSON.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderJSON.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class n{constructor(e,s){this.subscription=e,this._pages=new Set,this._controller=new AbortController,this._done=!1,this._handles=(0,_core_handleUtils_js__WEBPACK_IMPORTED_MODULE_0__.handlesGroup)([(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_1__.onAbort)(e.signal,(()=>this._controller.abort())),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_1__.onAbort)(s,(()=>this._controller.abort()))])}destroy(){this._controller.abort(),this._handles.remove()}get pageStart(){let t=-1;for(const e of this._pages.values())t=Math.max(t,e);return t+1}get done(){return this._done}get options(){return{signal:this._controller.signal}}add(t,e){this._pages.add(t),this._done=this._done||e}}class l extends _ATileLoadStrategy_js__WEBPACK_IMPORTED_MODULE_2__.ATileLoadStrategy{constructor(){super(...arguments),this._loadStates=new Map}destroy(){super.destroy();for(const t of this._loadStates.values())t.destroy();this._loadStates.clear()}get about(){return{willQueryAllFeatures:!1,willQueryFullResolutionGeometry:!1}}async load(t){this._loadStates.has(t.key.id)||this._loadStates.set(t.key.id,new n(t,this._options));const s=this._loadStates.get(t.key.id);let o;try{await this._fetchPages(s)}catch(l){o=l}const r=new _chunks_PagedTileSourceChunk_js__WEBPACK_IMPORTED_MODULE_3__.PagedTileSourceChunk(_support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_4__.FeatureSetReaderJSON.empty(this._metadata),null,t.tile,-1,!0);if((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_1__.isAborted)(s.options)||this._addChunk(r),o)throw o}unload(t){super.unload(t),this._loadStates.get(t.key.id)?.destroy(),this._loadStates.delete(t.key.id)}async _fetchPages(t){const e=4,o=20;let r=0,a=t.pageStart,i=1;for(;r<o&&!t.done;){const o=[];for(let e=0;e<i;e++)o.push(this._fetchChunk(t,a++));const n=await Promise.all(o);for(const e of n)(0!==e.size()||e.first)&&(t.add(e.page,!e.reader.exceededTransferLimit),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_1__.throwIfAborted)(t.options),this._addChunk(e));r++,i=Math.min(i+1,e)}}async _fetchChunk(t,e){const s=t.subscription.tile,o=this._queryInfo.createPagedTileQuery(s,e),r=await this._fetch(o,t.options);return new _chunks_PagedTileSourceChunk_js__WEBPACK_IMPORTED_MODULE_3__.PagedTileSourceChunk(r,o.inner.toJSON(),s,e,!1)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/ParquetLoadStrategy.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/ParquetLoadStrategy.js ***!
  \******************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ParquetLoadStrategy: function() { return /* binding */ d; }
/* harmony export */ });
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_SetUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../../core/SetUtils.js */ "./node_modules/@arcgis/core/core/SetUtils.js");
/* harmony import */ var _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../../layers/support/FieldsIndex.js */ "./node_modules/@arcgis/core/layers/support/FieldsIndex.js");
/* harmony import */ var _libs_parquet_parquet_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../../libs/parquet/parquet.js */ "./node_modules/@arcgis/core/libs/parquet/parquet.js");
/* harmony import */ var _ALoadStrategy_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ALoadStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/ALoadStrategy.js");
/* harmony import */ var _chunks_FeatureSnapshotSourceChunk_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./chunks/FeatureSnapshotSourceChunk.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/FeatureSnapshotSourceChunk.js");
/* harmony import */ var _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../support/FeatureSetReaderJSON.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderJSON.js");
/* harmony import */ var _support_FeatureSetReaderParquet_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../support/FeatureSetReaderParquet.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderParquet.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class d extends _ALoadStrategy_js__WEBPACK_IMPORTED_MODULE_4__.ALoadStrategy{constructor(e,t,s,a){super(a),this._service=e,this._metadata=t,this._schema=s,this._chunkId=0,this._files=[],this._availableFields=new Set(s.mutable.availableFields);const{geometryInfo:i}=this._service;"location"===i.type?(this._availableFields.add(i.latitudeFieldName),this._availableFields.add(i.longitudeFieldName)):this._availableFields.add(i.primaryFieldName)}destroy(){for(const e of this._files)e.destroy()}get about(){return{willQueryAllFeatures:!0,willQueryFullResolutionGeometry:!0}}async updateFields(e){await this._promise;const a=new Set(e),i=(0,_core_SetUtils_js__WEBPACK_IMPORTED_MODULE_1__.difference)(a,this._availableFields);this._availableFields=(0,_core_SetUtils_js__WEBPACK_IMPORTED_MODULE_1__.union)(i,this._availableFields),await Promise.all(this._files.map((e=>{const t=Array.from(i).map((t=>e.metadata.getFieldIndex(t)));return e.inner.updateChunks(new Uint16Array(t))})))}async load(e){return null==this._promise&&(this._promise=this._download()),this._promise}unload(e){}async addParquetFile(e){this._insert(e)}async _insert(t){const s=await _libs_parquet_parquet_js__WEBPACK_IMPORTED_MODULE_3__.ParquetFile.create(t,{geometryInfo:this._service.geometryInfo,outSpatialReference:this._service.outSpatialReference,getCustomParameters:()=>this._schema.mutable.dataFilter.customParameters}),{geometryInfo:r}=this._service;(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.throwIfAborted)(this._options);const{fields:o,timeZoneByFieldName:d}=this._service.metadata.fieldsIndex,m=o.map((e=>({...e,index:s.metadata.getFieldIndex(e.name)}))),h=_layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_2__["default"].fromJSON({fields:m,timeZoneByFieldName:d}),u=new Uint16Array(Array.from(this._availableFields.values()).map((e=>h.get(e)?.index)));await s.inner.readChunksWithCallback(u,(e=>{const t=this._chunkId++,s=new _support_FeatureSetReaderParquet_js__WEBPACK_IMPORTED_MODULE_7__.FeatureSetReaderParquet(this._metadata,h,r,e,t),a=new _chunks_FeatureSnapshotSourceChunk_js__WEBPACK_IMPORTED_MODULE_5__.FeatureSnapshotSourceChunk(s,null,t,!1);this._store.insert(a)})),this._files.push(s)}async _download(){try{await Promise.all(this._service.source.urls.map((e=>this._insert(e))));const e=new _chunks_FeatureSnapshotSourceChunk_js__WEBPACK_IMPORTED_MODULE_5__.FeatureSnapshotSourceChunk(_support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_6__.FeatureSetReaderJSON.empty(this._metadata),null,-1,!0);this._store.insert(e)}catch(e){throw console.error(e),e}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/SnapshotLoadStrategy.js":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/SnapshotLoadStrategy.js ***!
  \*******************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SnapshotLoadStrategy: function() { return /* binding */ a; }
/* harmony export */ });
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../../core/RandomLCG.js */ "./node_modules/@arcgis/core/core/RandomLCG.js");
/* harmony import */ var _AFetchLoadStrategy_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AFetchLoadStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/AFetchLoadStrategy.js");
/* harmony import */ var _chunks_FeatureSnapshotSourceChunk_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./chunks/FeatureSnapshotSourceChunk.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/FeatureSnapshotSourceChunk.js");
/* harmony import */ var _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../support/FeatureSetReaderJSON.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderJSON.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class a extends _AFetchLoadStrategy_js__WEBPACK_IMPORTED_MODULE_3__.AFetchLoadStrategy{constructor(t,e,o,s,n,a){super(t,e,o,n,a),this._random=new _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_2__["default"](1e3),this._featureCount=s}get about(){return{willQueryAllFeatures:!0,willQueryFullResolutionGeometry:!0}}load(t){return null==this._promise&&(this._promise=this._downloadPages(this._featureCount)),this._promise}unload(t){}async _downloadPages(e){const r=Math.ceil(e/this._queryInfo.pageSize),o=Array.from({length:r},((t,e)=>e)).sort(((t,e)=>this._random.getInt()-this._random.getInt())),a=await Promise.all(o.map((t=>this._downloadPage(t)))),i=new _chunks_FeatureSnapshotSourceChunk_js__WEBPACK_IMPORTED_MODULE_4__.FeatureSnapshotSourceChunk(_support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_5__.FeatureSetReaderJSON.empty(this._metadata),null,-1,!0);this._store.insert(i);const u=a.filter((t=>t));if(u.length)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"]("featurelayer-query","Encountered errors when downloading data",{errors:u})}async _downloadPage(t){try{const r=this._queryInfo.createPagedQuery(t),o=await this._fetch(r,this._options),n=new _chunks_FeatureSnapshotSourceChunk_js__WEBPACK_IMPORTED_MODULE_4__.FeatureSnapshotSourceChunk(o,r.inner.toJSON(),t,!1);return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_1__.throwIfAborted)(this._options),this._store.insert(n),null}catch(r){return r}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/StreamLoadStrategy.js":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/StreamLoadStrategy.js ***!
  \*****************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   StreamLoadStrategy: function() { return /* binding */ h; }
/* harmony export */ });
/* harmony import */ var _core_Evented_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../../core/Evented.js */ "./node_modules/@arcgis/core/core/Evented.js");
/* harmony import */ var _core_handleUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../../core/handleUtils.js */ "./node_modules/@arcgis/core/core/handleUtils.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../../core/maybe.js */ "./node_modules/@arcgis/core/core/maybe.js");
/* harmony import */ var _layers_graphics_data_StreamFeatureManager_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../../layers/graphics/data/StreamFeatureManager.js */ "./node_modules/@arcgis/core/layers/graphics/data/StreamFeatureManager.js");
/* harmony import */ var _layers_graphics_sources_connections_createConnection_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../../layers/graphics/sources/connections/createConnection.js */ "./node_modules/@arcgis/core/layers/graphics/sources/connections/createConnection.js");
/* harmony import */ var _StreamConnectionState_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../StreamConnectionState.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/StreamConnectionState.js");
/* harmony import */ var _StreamFeatureStore_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../StreamFeatureStore.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/StreamFeatureStore.js");
/* harmony import */ var _ALoadStrategy_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ALoadStrategy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/ALoadStrategy.js");
/* harmony import */ var _chunks_StreamSourceChunk_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./chunks/StreamSourceChunk.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/StreamSourceChunk.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class h extends _ALoadStrategy_js__WEBPACK_IMPORTED_MODULE_8__.ALoadStrategy{constructor(t,s,o,a,c){super(o),this._service=t,this._dataFilter=s,this._streamOptions=a,this._metadata=c,this._connectionState=new _StreamConnectionState_js__WEBPACK_IMPORTED_MODULE_6__.StreamConnectionState,this._forceRefresh=!1,this.events=new _core_Evented_js__WEBPACK_IMPORTED_MODULE_0__["default"];const{objectIdField:h,timeInfo:m}=this._metadata,{purgeOptions:d}=s;this._stagingStore=new _StreamFeatureStore_js__WEBPACK_IMPORTED_MODULE_7__.StreamFeatureStore(this._metadata,(e=>this.events.emit("features-updated",e))),this._manager=new _layers_graphics_data_StreamFeatureManager_js__WEBPACK_IMPORTED_MODULE_4__.StreamFeatureManager(this._stagingStore,h,m,d),this.connect()}destroy(){super.destroy(),this.disconnect()}get about(){return{willQueryAllFeatures:!1,willQueryFullResolutionGeometry:!1}}get connectionStatus(){return this._connectionState.connectionStatus}get errorString(){return this._connectionState?.errorString}async refresh(){const e=null!=this._chunk;this._manager.checkForUpdates()||!e||this._forceRefresh?(this._chunk&&this._store.remove(this._chunk),this._forceRefresh=!1,this._chunk=new _chunks_StreamSourceChunk_js__WEBPACK_IMPORTED_MODULE_9__.StreamSourceChunk(this._stagingStore.reader),this._store.insert(this._chunk),this.events.emit("tick")):this.events.emit("tick")}async updateFields(e){throw new Error("Updating available fields not supported for StreamLayer")}async load(e){}unload(e){}disconnect(){this._connection=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_3__.destroyMaybe)(this._connection),this._connectionState.connection=null,this._handlesGroup?.remove()}connect(){if(null!=this._connection)return;const{geometryType:e,spatialReference:s}=this._metadata,{maxReconnectionAttempts:n,maxReconnectionInterval:i,geometryDefinition:r,definitionExpression:a,customParameters:c}=this._dataFilter;this._connection=(0,_layers_graphics_sources_connections_createConnection_js__WEBPACK_IMPORTED_MODULE_5__.createConnection)(this._service.source,s,this._streamOptions.outSR,e,a,r,n,i,c),this._handlesGroup=(0,_core_handleUtils_js__WEBPACK_IMPORTED_MODULE_1__.handlesGroup)([this._connection.on("data-received",(e=>this._onFeature(e))),this._connection.on("message-received",(e=>this._onWebSocketMessage(e)))]),this._connectionState.connection=this._connection}clear(){this._manager.checkForUpdates(),this._stagingStore.clear(),this._forceRefresh=!0}updateCustomParameters(e){this._connection?.updateCustomParameters(e)}sendMessageToSocket(e){this._connection?.sendMessageToSocket(e)}sendMessageToClient(e){this._connection?.sendMessageToClient(e)}_onWebSocketMessage(e){if("type"in e)switch(e.type){case"delete":if(e.objectIds)for(const t of e.objectIds)this._manager.removeById(t);if(e.trackIds)for(const t of e.trackIds)this._manager.removeByTrackId(t);break;case"clear":this.clear()}this.events.emit("message-received",e)}_onFeature(e){try{this._manager.add(e),this.events.emit("data-received",e)}catch(t){}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/ASourceChunk.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/ASourceChunk.js ***!
  \******************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ASourceChunk: function() { return /* binding */ i; }
/* harmony export */ });
/* harmony import */ var _FeatureSpatialIndex_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../FeatureSpatialIndex.js */ "./node_modules/@arcgis/core/views/2d/layers/features/FeatureSpatialIndex.js");
/* harmony import */ var _aggregation_GeohashSpatialIndex_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../aggregation/GeohashSpatialIndex.js */ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/GeohashSpatialIndex.js");
/* harmony import */ var _aggregation_GridSpatialIndex_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../aggregation/GridSpatialIndex.js */ "./node_modules/@arcgis/core/views/2d/layers/features/aggregation/GridSpatialIndex.js");
/* harmony import */ var _support_FeatureSetReaderIndirect_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../support/FeatureSetReaderIndirect.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderIndirect.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class i{size(){return this.reader.getSize()}get fields(){return this.reader.fields}invalidate(){this._aggregateIndex=null,this._aggregateIndexHash=null,this._spatialIndex=null}queryFeaturesInBounds(e){const t=this._getSpatialIndex().search(e);return _support_FeatureSetReaderIndirect_js__WEBPACK_IMPORTED_MODULE_3__.FeatureSetReaderIndirect.from(this.reader,t)}getAggregateIndex(e){const r=JSON.stringify(e);if(r!==this._aggregateIndexHash){switch(this._aggregateIndexHash=r,e.type){case"grid":this._aggregateIndex=new _aggregation_GridSpatialIndex_js__WEBPACK_IMPORTED_MODULE_2__.GridSpatialIndex(e);break;case"geohash":this._aggregateIndex=new _aggregation_GeohashSpatialIndex_js__WEBPACK_IMPORTED_MODULE_1__.GeohashSpatialIndex(e)}this._aggregateIndex.insert(this.reader,this.isTiled)}return this._aggregateIndex}_getSpatialIndex(){return this._spatialIndex||(this._spatialIndex=_FeatureSpatialIndex_js__WEBPACK_IMPORTED_MODULE_0__.FeatureSpatialIndex.fromReader(this.reader)),this._spatialIndex}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/DrillDownTileSourceChunk.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/DrillDownTileSourceChunk.js ***!
  \******************************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrillDownTileSourceChunk: function() { return /* binding */ i; }
/* harmony export */ });
/* harmony import */ var _ASourceChunk_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ASourceChunk.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/ASourceChunk.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class i extends _ASourceChunk_js__WEBPACK_IMPORTED_MODULE_0__.ASourceChunk{constructor(e,i,t,r,s,h){super(),this._reader=e,this._queryJSON=i,this._tile=t,this._sourceTile=r,this._sourceTileDepth=s,this._end=h,this.chunkId=`${this._tile.key.id}.${this._sourceTile?.key.id}${this._end?"e":""}`,this.normalizedChunkId=`${this._tile.key.normalizedId}.${this._sourceTile?.key.normalizedId}${this._end?"e":""}`}get queryInfo(){return{type:"drill-down-tile",chunkId:this.chunkId,tileId:this._tile.key.id,queryJSON:this._queryJSON,sourceTileDepth:this._sourceTileDepth,sourceTileId:this._sourceTile?.key.id,size:this.size(),end:this.end}}get first(){return 0===this._sourceTileDepth}get reader(){return this._reader}get end(){return this._end}get tile(){return this._tile}get isTiled(){return!0}getTileReader(e){return this._tile.key.id===e.key.id?this.reader:null}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/FeatureSnapshotSourceChunk.js":
/*!********************************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/FeatureSnapshotSourceChunk.js ***!
  \********************************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureSnapshotSourceChunk: function() { return /* binding */ t; }
/* harmony export */ });
/* harmony import */ var _ASourceChunk_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ASourceChunk.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/ASourceChunk.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class t extends _ASourceChunk_js__WEBPACK_IMPORTED_MODULE_0__.ASourceChunk{constructor(e,t,r,s){super(),this._reader=e,this._queryJSON=t,this._page=r,this._end=s,this.chunkId=`${this._page}${this.end?"e":""}`,this.normalizedChunkId=this.chunkId}get reader(){return this._reader}get first(){return 0===this._page}get end(){return this._end}get queryInfo(){return{type:"snapshot",chunkId:this.chunkId,queryJSON:this._queryJSON,page:this._page,size:this.size(),end:this.end}}get isTiled(){return!1}getTileReader(e){const t=this.queryFeaturesInBounds(e.bounds);return t.setTransformForDisplay(e.transform),t}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/OverrideChunk.js":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/OverrideChunk.js ***!
  \*******************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   OverrideChunk: function() { return /* binding */ s; },
/* harmony export */   isLocalEditChunk: function() { return /* binding */ r; }
/* harmony export */ });
/* harmony import */ var _ASourceChunk_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ASourceChunk.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/ASourceChunk.js");
/* harmony import */ var _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../support/FeatureSetReaderJSON.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderJSON.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
function r(e){return"localEdit"===e.chunkId}class s extends _ASourceChunk_js__WEBPACK_IMPORTED_MODULE_0__.ASourceChunk{constructor(e,t){super(),this.metadata=e,this.removed=new Set,this.overriddenIds=new Set,this._features=[],this.chunkId=t,this.normalizedChunkId=t}get reader(){return _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_1__.FeatureSetReaderJSON.fromOptimizedFeatures(this._features,this.metadata)}get queryInfo(){return{}}get first(){return!1}get end(){return!1}get isTiled(){return!1}get lastLocalEditDropped(){return this._lastLocalEditDropped}applyOverrides(e){this._onChange();const{reader:t,removed:r}=e,s=[],d=new Set,o=t.getCursor(),n=new Set(r);for(this.overriddenIds.clear();o.next();){const e=o.readOptimizedFeatureWorldSpace(),t=e.objectId;s.push(e),d.add(t),this.overriddenIds.add(t),this.removed.delete(t)}for(const i of this._features){const e=i.objectId;n.has(e)||d.has(e)||(s.push(i),this.overriddenIds.add(e))}this._features=s;for(const i of d.values())this.removed.delete(i);for(const i of r)this.removed.add(i),this.overriddenIds.add(i)}removeOverrides(e){this._lastLocalEditDropped=performance.now(),this._onChange();const t=e.reader.getCursor(),r=new Set;for(;t.next();){const e=t.getObjectId();this.overriddenIds.has(e)&&(r.add(e),this.overriddenIds.delete(e))}this._features=this._features.filter((e=>!r.has(e.objectId)))}getTileReader(e){if(!this._features.length)return null;const t=this.queryFeaturesInBounds(e.bounds);return t.setTransformForDisplay(e.transform),t}_onChange(){this.invalidate()}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/PagedTileSourceChunk.js":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/PagedTileSourceChunk.js ***!
  \**************************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   PagedTileSourceChunk: function() { return /* binding */ t; }
/* harmony export */ });
/* harmony import */ var _ASourceChunk_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ASourceChunk.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/ASourceChunk.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class t extends _ASourceChunk_js__WEBPACK_IMPORTED_MODULE_0__.ASourceChunk{constructor(e,t,i,r,s){super(),this._reader=e,this._queryJSON=t,this._tile=i,this._page=r,this._end=s,this.chunkId=`${this._tile.key.id}.${this._page}${this.end?"e":""}`,this.normalizedChunkId=`${this._tile.key.normalizedId}.${this._page}${this.end?"e":""}`}get queryInfo(){return{type:"paged-tile",chunkId:this.chunkId,tileId:this._tile.key.id,queryJSON:this._queryJSON,page:this._page,size:this.size(),end:this.end}}get reader(){return this._reader}get first(){return 0===this._page}get end(){return this._end}get page(){return this._page}get tile(){return this._tile}get isTiled(){return!0}getTileReader(e){return this._tile.key.id===e.key.id?this.reader:null}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/SourceChunkStore.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/SourceChunkStore.js ***!
  \**********************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureSourceChunkStore: function() { return /* binding */ n; }
/* harmony export */ });
/* harmony import */ var _core_Evented_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../../../core/Evented.js */ "./node_modules/@arcgis/core/core/Evented.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _geometry_support_aaBoundingBox_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../../../geometry/support/aaBoundingBox.js */ "./node_modules/@arcgis/core/geometry/support/aaBoundingBox.js");
/* harmony import */ var _FeatureStoreQueryAdapter_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../FeatureStoreQueryAdapter.js */ "./node_modules/@arcgis/core/views/2d/layers/features/FeatureStoreQueryAdapter.js");
/* harmony import */ var _OverrideChunk_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./OverrideChunk.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/OverrideChunk.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class n{constructor(s){this._onChange=s,this._chunks=new Map,this._chunksToRemove=[],this.events=new _core_Evented_js__WEBPACK_IMPORTED_MODULE_0__["default"],this.featureAdapter=new _FeatureStoreQueryAdapter_js__WEBPACK_IMPORTED_MODULE_3__.FeatureStoreQueryAdapter}destroy(){this.clear()}clear(){for(const e of this._chunks.values())this._chunksToRemove.push(e);this._chunks.clear(),null!=this._localEditChunk&&this._chunksToRemove.push(this._localEditChunk),this._localEditChunk=null}*chunks(){this._localEditChunk&&(yield this._localEditChunk),this._localOverridesChunk&&(yield this._localOverridesChunk),yield*this._chunks.values()}dataChunks(){return this._chunks.values()}insert(e){(0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__["default"])("esri-2d-update-debug")&&console.debug(`Chunk[${e.chunkId}] SourceChunkStore.insert`),this._localOverridesChunk?.overriddenIds.size&&(e.reader.removeIds(this._localOverridesChunk.overriddenIds),e.invalidate()),this._localEditChunk?.overriddenIds.size&&this._localEditChunk.removeOverrides(e),this._chunks.set(e.chunkId,e),this.events.emit("changed"),this._onChange()}remove(e){(0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__["default"])("esri-2d-update-debug")&&console.debug(`Chunk[${e.chunkId}] SourceChunkStore.remove`),this._chunks.delete(e.chunkId),this._chunksToRemove.push(e)}cleanupRemovedChunks(){const e=this._chunksToRemove;return this._chunksToRemove=[],e}applyLocalOverrides(e,s){null==this._localOverridesChunk&&(this._localOverridesChunk=new _OverrideChunk_js__WEBPACK_IMPORTED_MODULE_4__.OverrideChunk(s,"localOverride")),this._localOverridesChunk.applyOverrides(e);for(const t of this._chunks.values())t.reader.removeIds(this._localOverridesChunk.overriddenIds),t.invalidate();this.events.emit("changed")}applyLocalEdit(e,s){null==this._localEditChunk&&(this._localEditChunk=new _OverrideChunk_js__WEBPACK_IMPORTED_MODULE_4__.OverrideChunk(s,"localEdit")),this._localEditChunk.applyOverrides(e);for(const t of this._chunks.values())t.reader.removeIds(this._localEditChunk.overriddenIds),t.invalidate();this.events.emit("changed")}forEach(e){const s=new Set;for(const t of this.chunks()){const o=t.reader.getCursor();for(;o.next();){const t=o.getObjectId();s.has(t)||(e(o.copy()),s.add(t))}}}forEachUnsafe(e){const s=new Set;for(const t of this.chunks()){const o=t.reader.getCursor();for(;o.next();){const t=o.getObjectId();s.has(t)||(e(o),s.add(t))}}}forEachInBounds(e,s){const t=new Set;for(const o of this.chunks()){const n=o.queryFeaturesInBounds(e);for(;n.next();){const e=n.getObjectId();t.has(e)||(s(n.copy()),t.add(e))}}}forEachBounds(e,t){const o=(0,_geometry_support_aaBoundingBox_js__WEBPACK_IMPORTED_MODULE_2__.create)();for(const s of e){s.getBounds(o)&&t(o)}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/StreamSourceChunk.js":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/StreamSourceChunk.js ***!
  \***********************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   StreamSourceChunk: function() { return /* binding */ r; }
/* harmony export */ });
/* harmony import */ var _ASourceChunk_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ASourceChunk.js */ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/chunks/ASourceChunk.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class r extends _ASourceChunk_js__WEBPACK_IMPORTED_MODULE_0__.ASourceChunk{constructor(e){super(),this._reader=e,this.chunkId="stream-chunk",this.normalizedChunkId="stream-chunk"}get reader(){return this._reader}get first(){return!0}get end(){return!0}get queryInfo(){return{type:"stream",chunkId:this.chunkId,size:this.size(),end:this.end}}get isTiled(){return!1}getTileReader(e){const r=this.queryFeaturesInBounds(e.bounds);return r.setTransformForDisplay(e.transform),r}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/support/queryAdapters.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/sources/strategies/support/queryAdapters.js ***!
  \********************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SourceAdapter: function() { return /* binding */ c; },
/* harmony export */   createQueryAdapter: function() { return /* binding */ m; }
/* harmony export */ });
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_workers_Connection_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../../../core/workers/Connection.js */ "./node_modules/@arcgis/core/core/workers/Connection.js");
/* harmony import */ var _geometry_support_quantizationUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../../../geometry/support/quantizationUtils.js */ "./node_modules/@arcgis/core/geometry/support/quantizationUtils.js");
/* harmony import */ var _layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../../../layers/graphics/featureConversionUtils.js */ "./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js");
/* harmony import */ var _layers_ogc_ogcFeatureUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../../../layers/ogc/ogcFeatureUtils.js */ "./node_modules/@arcgis/core/layers/ogc/ogcFeatureUtils.js");
/* harmony import */ var _rest_query_operations_query_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../../../rest/query/operations/query.js */ "./node_modules/@arcgis/core/rest/query/operations/query.js");
/* harmony import */ var _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../support/FeatureSetReaderJSON.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderJSON.js");
/* harmony import */ var _support_FeatureSetReaderPBF_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../support/FeatureSetReaderPBF.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderPBF.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class c{constructor(t,e){this.service=t,this._metadata=e}destroy(){}}function m(t,e){switch(t.type){case"memory":return new l(t,e);case"ogc":return new y(t,e);case"feature-service":return t.queryMetadata.supportsFormatPBF&&(0,_core_has_js__WEBPACK_IMPORTED_MODULE_0__["default"])("featurelayer-pbf")?new d(t,e):new f(t,e)}}async function p(e){const r=new _core_workers_Connection_js__WEBPACK_IMPORTED_MODULE_1__["default"];return await r.open(e,{}),r}class l extends c{constructor(t,e){super(t,e),this._portsOpen=p(t.source).then((t=>this.client=t))}destroy(){this.client.close(),this.client=null}async executeQuery(t,e){await this._portsOpen;const r=await this.client.invoke("queryFeatures",t.toJSON(),e);return _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_6__.FeatureSetReaderJSON.fromFeatureSet(r,this._metadata)}}class d extends c{async executeQuery(t,e){const{data:r}=await (0,_rest_query_operations_query_js__WEBPACK_IMPORTED_MODULE_5__.executeQueryPBFBuffer)(this.service.source,t,e),a=!t.quantizationParameters;return _support_FeatureSetReaderPBF_js__WEBPACK_IMPORTED_MODULE_7__.FeatureSetReaderPBF.fromBuffer(r,this._metadata,a)}}class f extends c{async executeQuery(t,s){const{source:i,queryMetadata:u}=this.service;if(null!=t.quantizationParameters&&!u.supportsQuantization){const u=t.clone(),c=(0,_geometry_support_quantizationUtils_js__WEBPACK_IMPORTED_MODULE_2__.toQuantizationTransform)(u.quantizationParameters);u.quantizationParameters=null;const{data:m}=await (0,_rest_query_operations_query_js__WEBPACK_IMPORTED_MODULE_5__.executeQuery)(i,u,this._metadata.spatialReference,s),p=(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_3__.convertFromFeatureSet)(m,this._metadata.objectIdField);return (0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_3__.quantizeOptimizedFeatureSet)(c,p),_support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_6__.FeatureSetReaderJSON.fromOptimizedFeatureSet(p,this._metadata)}const{data:c}=await (0,_rest_query_operations_query_js__WEBPACK_IMPORTED_MODULE_5__.executeQuery)(i,t,this._metadata.spatialReference,s);return"esriGeometryPoint"===this._metadata.geometryType&&(c.features=c.features?.filter((t=>{if(null!=t.geometry){const e=t.geometry;return Number.isFinite(e.x)&&Number.isFinite(e.y)}return!0}))),_support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_6__.FeatureSetReaderJSON.fromFeatureSet(c,this._metadata)}}class y extends c{async executeQuery(t,r){if(t.quantizationParameters&&!this.service.queryMetadata.supportsQuantization){const i=t.clone(),o=(0,_geometry_support_quantizationUtils_js__WEBPACK_IMPORTED_MODULE_2__.toQuantizationTransform)(i.quantizationParameters);i.quantizationParameters=null;const u=await (0,_layers_ogc_ogcFeatureUtils_js__WEBPACK_IMPORTED_MODULE_4__.queryOptimizedFeatureSet)(this.service.source,t,r);return (0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_3__.quantizeOptimizedFeatureSet)(o,u),_support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_6__.FeatureSetReaderJSON.fromOptimizedFeatureSet(u,this._metadata)}const i=await (0,_layers_ogc_ogcFeatureUtils_js__WEBPACK_IMPORTED_MODULE_4__.queryOptimizedFeatureSet)(this.service.source,t,r);return _support_FeatureSetReaderJSON_js__WEBPACK_IMPORTED_MODULE_6__.FeatureSetReaderJSON.fromOptimizedFeatureSet(i,this._metadata)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderIndirect.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderIndirect.js ***!
  \************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureSetReaderIndirect: function() { return /* binding */ a; }
/* harmony export */ });
/* harmony import */ var _layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../layers/graphics/featureConversionUtils.js */ "./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js");
/* harmony import */ var _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../layers/graphics/OptimizedGeometry.js */ "./node_modules/@arcgis/core/layers/graphics/OptimizedGeometry.js");
/* harmony import */ var _FeatureSetReader_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./FeatureSetReader.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReader.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class a extends _FeatureSetReader_js__WEBPACK_IMPORTED_MODULE_2__.FeatureSetReader{static from(e,r){return new a(e.copy(),r)}constructor(e,r){super(e.metadata),this._currentIndex=-1,this._displayTranslationX=0,this._displayTranslationY=0,this._displayScaleX=1,this._displayScaleY=1,this._reader=e,this._indices=r,this._isPoint="esriGeometryPoint"===e.geometryType}setTransformForDisplay(e){const r=this._reader.getInTransform();if(null==r){const[r,t]=e.scale,[s,a]=e.translate;return this._displayTranslationX=-s/r,this._displayScaleX=1/r,this._displayTranslationY=a/t,this._displayScaleY=1/-t,void(this._displayTransform=e)}const[t,s]=r.scale,[a,i]=r.translate,[d,n]=e.scale,[o,l]=e.translate;if(this._displayScaleX=t/d,this._displayTranslationX=(a-o)/d,this._displayScaleY=s/n,this._displayTranslationY=(-i+l)/n,!this._isPoint&&r)throw new Error("InternalError: Relative transformations not supported for non-point features");this._displayTransform=e}getInTransform(){return this._reader.getInTransform()}get fields(){return this._reader.fields}get hasNext(){return this._currentIndex+1<this._indices.length}getSize(){return this._indices.length}getCursor(){return this.copy()}copy(){const e=new a(this._reader.copy(),this._indices);return e._currentIndex=this._currentIndex,e._displayTransform=this._displayTransform,e._displayTranslationX=this._displayTranslationX,e._displayTranslationY=this._displayTranslationY,e._displayScaleX=this._displayScaleX,e._displayScaleY=this._displayScaleY,e}get contextTimeZone(){return this._reader.contextTimeZone}set contextTimeZone(e){this._reader.contextTimeZone=e}_nextIndex(){return++this._currentIndex<this._indices.length&&(this._reader.setIndex(this._indices[this._currentIndex]),!0)}next(){for(;this._nextIndex()&&!this._reader._getExists(););return this._currentIndex<this._indices.length}readXForDisplay(){return this._reader.readXForDisplay()*this._displayScaleX+this._displayTranslationX}readYForDisplay(){return this._reader.readYForDisplay()*this._displayScaleY+this._displayTranslationY}readGeometryForDisplay(){const r=this._reader.readGeometryForDisplay();if(!this._displayTransform)return r;const s=new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__["default"];return (0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__.quantizeOptimizedGeometry)(s,r,this.hasZ,this.hasM,this.geometryType,this._displayTransform),s.deltaDecode()}readCentroidForDisplay(){const e=this._reader.readCentroidForDisplay()?.clone();if(e){const[r,t]=e.coords;e.coords[0]=r*this._displayScaleX+this._displayTranslationX,e.coords[1]=t*this._displayScaleY+this._displayTranslationY}return e}get geometryType(){return this._reader.geometryType}get hasFeatures(){return this._reader.hasFeatures}get exceededTransferLimit(){return this._reader.exceededTransferLimit}get hasZ(){return this._reader.hasZ}get hasM(){return this._reader.hasM}readAttribute(e,r=!1){return this._reader.readAttribute(e,r)}readAttributes(){return this._reader.readAttributes()}joinAttributes(e){return this._reader.joinAttributes(e)}getBounds(e){return this._reader.getBounds(e)}getAttributeHash(){return this._reader.getAttributeHash()}getObjectId(){return this._reader.getObjectId()}getDisplayId(){return this._reader.getDisplayId()}setDisplayId(e){return this._reader.setDisplayId(e)}setIndex(e){return this._reader.setIndex(e)}getIndex(){return this._reader.getIndex()}readXWorldSpace(){return this._reader.readXWorldSpace()}readYWorldSpace(){return this._reader.readYWorldSpace()}_readX(){return this._reader.readXForDisplay()}_readY(){return this._reader.readYForDisplay()}_readServerCentroid(){return this._reader._readServerCentroid()}readLegacyFeatureForDisplay(){const e=this.readCentroidForDisplay();return{attributes:this.readAttributes(),geometry:this.readLegacyGeometryForDisplay(),centroid:(e&&{x:e.coords[0],y:e.coords[1]})??null}}readLegacyGeometryForDisplay(){const e=this.readGeometryForDisplay();return (0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__.convertToGeometry)(e,this.geometryType,!1,!1)}readGeometryArea(){return this._reader.readGeometryArea()}readGeometryWorldSpace(){return this._reader.readGeometryWorldSpace()}_readGeometry(){return this._reader._readGeometry()}_readAttribute(e,r){throw new Error("Error: Should not be called. Underlying _reader should be used instead")}_readAttributes(){throw new Error("Error: Should not be called. Underlying _reader should be used instead")}readArcadeFeature(){return this._reader.readArcadeFeature()}geometry(){return this._reader.geometry()}field(e){return this._reader.field(e)}hasField(e){return this._reader.hasField(e)}setField(e,r){return this._reader.setField(e,r)}keys(){return this._reader.keys()}castToText(e=!1){return this._reader.castToText(e)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderJSON.js":
/*!********************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderJSON.js ***!
  \********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureSetReaderJSON: function() { return /* binding */ u; }
/* harmony export */ });
/* harmony import */ var _layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../layers/graphics/featureConversionUtils.js */ "./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js");
/* harmony import */ var _layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../layers/graphics/OptimizedFeature.js */ "./node_modules/@arcgis/core/layers/graphics/OptimizedFeature.js");
/* harmony import */ var _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../layers/support/FieldsIndex.js */ "./node_modules/@arcgis/core/layers/support/FieldsIndex.js");
/* harmony import */ var _FeatureSetReader_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./FeatureSetReader.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReader.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class u extends _FeatureSetReader_js__WEBPACK_IMPORTED_MODULE_3__.FeatureSetReader{static fromFeatures(t,r){const{objectIdField:s,geometryType:i}=r,n=(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__.convertFromFeatures)([],t,i,!1,!1,s);for(let e=0;e<n.length;e++)n[e].displayId=t[e].displayId;return u.fromOptimizedFeatures(n,r)}static fromFeatureSet(e,r){const s=(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__.convertFromFeatureSet)(e,r.objectIdField);return u.fromOptimizedFeatureSet(s,r)}static fromOptimizedFeatureSet(e,t){const r=u.fromOptimizedFeatures(e.features,t);return r._exceededTransferLimit=e.exceededTransferLimit,r._transform=e.transform,r._fieldsIndex=new _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_2__["default"](e.fields),r}static fromOptimizedFeatures(e,t,r){const s=new u(e,t);return s._fieldsIndex=t.fieldsIndex,s._transform=r,s}static empty(e){return new u([],e)}constructor(e,t){super(t),this._exceededTransferLimit=!1,this._featureIndex=-1,this._fieldsIndex=null,this._geometryType=t.geometryType,this._features=e}get fields(){return this._fieldsIndex}get geometryType(){return this._geometryType}get hasFeatures(){return!!this._features.length}get hasNext(){return this._featureIndex+1<this._features.length}get exceededTransferLimit(){return this._exceededTransferLimit}get hasZ(){return!1}get hasM(){return!1}get _current(){return this._features[this._featureIndex]}removeIds(e){const t=new Set(e);this._features=this._features.filter((e=>!(null!=e.objectId&&t.has(e.objectId))))}getSize(){return this._features.length}getCursor(){return this.copy()}getInTransform(){return this._transform}getAttributeHash(){let e="";for(const t in this._current.attributes)e+=this._current.attributes[t];return e}getIndex(){return this._featureIndex}setIndex(e){this._featureIndex=e}getObjectId(){return this._current?.objectId}getDisplayId(){return this._current.displayId}setDisplayId(e){this._current.displayId=e}copy(){const e=new u(this._features,this.metadata);return this.copyInto(e),e}next(){for(;++this._featureIndex<this._features.length&&!this._getExists(););return this._featureIndex<this._features.length}readGeometryArea(){return (0,_layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_1__.hasGeometry)(this._current)?(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__.getQuantizedArea)(this._current.geometry,2):0}_readX(){return (0,_layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_1__.hasGeometry)(this._current)?this._current.geometry.coords[0]:0}_readY(){return (0,_layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_1__.hasGeometry)(this._current)?this._current.geometry.coords[1]:0}_readGeometry(){return (0,_layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_1__.hasGeometry)(this._current)?this._current.geometry??null:null}_readServerCentroid(){return this._current.centroid}_readAttribute(e,t){if(!this._fieldsIndex){const t=this._current.attributes[e];if(void 0!==t)return t;const r=e.toLowerCase();for(const e in this._current.attributes)if(e.toLowerCase()===r)return this._current.attributes[e];return}const r=this._fieldsIndex.get(e);if(!r)return;const s=this._current.attributes[r.name];return null==s?s:t&&this.fields.isDateField(e)?new Date(s):s}_readAttributes(){return this._current.attributes}copyInto(e){super.copyInto(e),e._featureIndex=this._featureIndex,e._transform=this._transform,e._fieldsIndex=this._fieldsIndex}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderPBF.js":
/*!*******************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderPBF.js ***!
  \*******************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureSetReaderPBF: function() { return /* binding */ m; }
/* harmony export */ });
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../core/maybe.js */ "./node_modules/@arcgis/core/core/maybe.js");
/* harmony import */ var _core_pbf_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../core/pbf.js */ "./node_modules/@arcgis/core/core/pbf.js");
/* harmony import */ var _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../layers/graphics/OptimizedGeometry.js */ "./node_modules/@arcgis/core/layers/graphics/OptimizedGeometry.js");
/* harmony import */ var _FeatureSetCache_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./FeatureSetCache.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetCache.js");
/* harmony import */ var _FeatureSetReader_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./FeatureSetReader.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReader.js");
/* harmony import */ var _FeatureSetReaderPBFHeader_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./FeatureSetReaderPBFHeader.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderPBFHeader.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const o=!0,u=268435455,d=128,c=128e3,g={small:{delta:new Int32Array(d),decoded:new Int32Array(d)},large:{delta:new Int32Array(c),decoded:new Int32Array(c)}};function _(e){return e<=g.small.delta.length?g.small:(e<=g.large.delta.length||(g.large.delta=new Int32Array(Math.round(1.25*e)),g.large.decoded=new Int32Array(Math.round(1.25*e))),g.large)}function l(r){try{const e=2,t=new _core_pbf_js__WEBPACK_IMPORTED_MODULE_4__["default"](new Uint8Array(r),new DataView(r));for(;t.next();){if(t.tag()===e)return f(t.getMessage());t.skip()}}catch(n){const r=new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"]("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:n});_core_Logger_js__WEBPACK_IMPORTED_MODULE_2__["default"].getLogger("esri.view.2d.layers.features.support.FeatureSetReaderPBF").error(r)}return null}function f(e){const t=1;for(;e.next();){if(e.tag()===t)return e.getMessage();e.skip()}return null}function I(e){const t=1,r=2,s=3,n=4,a=5,i=6,h=7,o=8,u=9,d=e.getLength(),c=e.pos()+d;for(;e.pos()<c&&e.next();)switch(e.tag()){case t:return e.getString();case r:return e.getFloat();case s:return e.getDouble();case n:return e.getSInt32();case a:return e.getUInt32();case i:return e.getInt64();case h:return e.getUInt64();case o:return e.getSInt64();case u:return e.getBool();default:return e.skip(),null}return null}function p(e,t,r,s,n,a){return.5*Math.abs(e*s+r*a+n*t-e*a-r*t-n*s)}function y(e,t,r,s,n){if(!e)return!1;return 0===t*n-s*r&&t*s+r*n>0}class m extends _FeatureSetReader_js__WEBPACK_IMPORTED_MODULE_7__.FeatureSetReader{static fromBuffer(e,t,r=!1){const s=t.geometryType,n=l(e),a=(0,_FeatureSetReaderPBFHeader_js__WEBPACK_IMPORTED_MODULE_8__.parseHeader)(n,"esriGeometryPoint"===s,r);return new m(n,a,t)}constructor(e,t,r){super(r),this._hasNext=!1,this._isPoints=!1,this._featureIndex=-1,this._featureOffset=0,this._cache={area:0,unquantGeometry:void 0,geometry:void 0,centroid:void 0,legacyFeature:void 0,optFeature:void 0},this._parseCaches=new Array,this._geometryType=r.geometryType,this._reader=e,this._header=t,this._hasNext=t.hasFeatures,this._isPoints="esriGeometryPoint"===r.geometryType}get _size(){return this._header.featureCount}get fields(){return this._header.fields}get geometryType(){return this._geometryType}get hasZ(){return!1}get hasM(){return!1}get hasFeatures(){return this._header.hasFeatures}get hasNext(){return this._hasNext}get exceededTransferLimit(){return this._header.exceededTransferLimit}getSize(){return this._size}getInTransform(){return this._header.transform}getCursor(){return this.copy()}getIndex(){return this._featureIndex}setIndex(e){this._cache.area=0,this._cache.unquantGeometry=void 0,this._cache.geometry=void 0,this._cache.centroid=void 0,this._cache.legacyFeature=void 0,this._cache.optFeature=void 0,this._featureIndex=e}getAttributeHash(){let e="";for(const t of this._header.fields.fields)e+=this._readAttributeAtIndex(t.index)+".";return e}getObjectId(){return this._readAttributeAtIndex(this._header.objectIdFieldIndex)}getDisplayId(){return this._header.displayIds[this._featureIndex]}setDisplayId(e){this._header.displayIds[this._featureIndex]=e}readGeometryArea(){return this._cache.area||this._readGeometry(!0),this._cache.area}copy(){const e=this._reader.clone(),t=new m(e,this._header,this.metadata);return this.copyInto(t),t}next(){for(this._cache.area=0,this._cache.unquantGeometry=void 0,this._cache.geometry=void 0,this._cache.centroid=void 0,this._cache.legacyFeature=void 0,this._cache.optFeature=void 0;++this._featureIndex<this._size&&!this._getExists(););return this._featureIndex<this._size}_readX(){return this._header.centroid[2*this._featureIndex]}_readY(){return this._header.centroid[2*this._featureIndex+1]}_readServerCentroid(){const e=this._header.centroid[2*this._featureIndex],t=this._header.centroid[2*this._featureIndex+1];return e===u?null:new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_5__["default"]([],[e,t])}_readGeometry(e=!1){if(void 0===this._cache.geometry){let r=null;if(this._isPoints){if(this._header.centroid[2*this._featureIndex]===u)return null;const e=this._header.centroid[2*this._featureIndex],t=this._header.centroid[2*this._featureIndex+1];r=new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_5__["default"]([],[e,t])}else{const s=this._header.offsets.geometry[this._featureIndex],n=this._reader;if(0===s)return null;n.move(s);try{r=e?this._parseGeometryForDisplay(n):this._parseGeometry(n)}catch(t){return null}}return 0===r?.coords.length&&(r=null),this._cache.geometry=r,r}return this._cache.geometry}_readAttribute(e,t){const r=this._header.fields.get(e);if(null==r)return;const s=this._readAttributeAtIndex(r.index),n=this._header.fields.isDateField(r.name);return t?null==s?s:n?new Date(s):s:s}_readAttributes(){const e={};for(const t of this._header.fields.fields)e[t.name]=this._readAttributeAtIndex(t.index);return e}copyInto(e){super.copyInto(e),e._featureIndex=this._featureIndex,e._featureOffset=this._featureOffset,e._hasNext=this._hasNext,e._parseCaches=this._parseCaches}_readAttributeAtIndex(e){let t=this._parseCaches[e];if(t||(t=new _FeatureSetCache_js__WEBPACK_IMPORTED_MODULE_6__.FeatureSetCache(this.getSize()),this._parseCaches[e]=t),t.has(this._featureIndex))return t.get(this._featureIndex);const r=this._header.offsets.attributes[this._featureIndex*this._header.fieldCount+e],s=this._reader;s.move(r);const n=I(s);return t.set(this._featureIndex,n),n}_readGeometryDeltaDecoded(e=!1){if(void 0===this._cache.unquantGeometry){const t=this._readGeometry(e);if(!t)return this._cache.unquantGeometry=void 0,null;if(!this.getInTransform())return this._cache.unquantGeometry=t,t;const r=_(t.coords.length).decoded,s=t.clone(r),n=s.coords;let a=0;for(const e of s.lengths){for(let t=1;t<e;t++){const e=2*(a+t),r=2*(a+t-1);n[e]+=n[r],n[e+1]+=n[r+1]}a+=e}return this._cache.unquantGeometry=s,s}return this._cache.unquantGeometry}_parseGeometry(e){const t=2,r=3,s=e.asUnsafe(),a=s.getLength(),i=s.pos()+a,h=[],o=[];for(;s.pos()<i&&s.next();)switch(s.tag()){case t:{const e=s.getUInt32(),t=s.pos()+e;for(;s.pos()<t;)o.push(s.getUInt32());break}case r:{const e=s.getUInt32(),t=s.pos()+e;for(h.push(s.getSInt64()),h.push(s.getSInt64()),this.hasZ&&s.getSInt64(),this.hasM&&s.getSInt64();s.pos()<t;)h.push(s.getSInt64()),h.push(s.getSInt64()),this.hasZ&&s.getSInt64(),this.hasM&&s.getSInt64();break}default:s.skip()}return new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_5__["default"](o,h)}_parseGeometryForDisplay(e){const t=2,s=3,a=e.asUnsafe(),i=a.getLength(),h=a.pos()+i,u=[],d=[];let c=0,g=0,l=null,f=0;const I="esriGeometryPolygon"===this.geometryType,m="esriGeometryPolyline"===this.geometryType,x=I||m;for(;a.pos()<h&&a.next();)switch(a.tag()){case t:{const e=a.getUInt32(),t=a.pos()+e;for(;a.pos()<t;){const e=a.getUInt32();u.push(e),c+=e}l=_(2*c).delta;break}case s:{a.getUInt32();const e=2+(this.hasZ?1:0)+(this.hasM?1:0);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_3__.assertIsSome)(l);for(const t of u)if(g+e*t>l.length)for(let e=0;e<t;e++)a.getSInt32(),a.getSInt32(),this.hasZ&&a.getSInt32(),this.hasM&&a.getSInt32();else if(I&&o){const e=this.getAreaSimplificationThreshold(t,this._header.vertexCount);let r=2,s=1;const n=!1;let i=a.getSInt32(),h=a.getSInt32();l[g++]=i,l[g++]=h,this.hasZ&&a.getSInt32(),this.hasM&&a.getSInt32();let o=a.getSInt32(),u=a.getSInt32();for(this.hasZ&&a.getSInt32(),this.hasM&&a.getSInt32();r<t;){let t=a.getSInt32(),n=a.getSInt32();this.hasZ&&a.getSInt32(),this.hasM&&a.getSInt32();const d=i+o,c=h+u;p(i,h,d,c,d+t,c+n)>=e?(f+=-.5*(d-i)*(c+h),s>1&&y(x,l[g-2],l[g-1],o,u)?(l[g-2]+=o,l[g-1]+=u):(l[g++]=o,l[g++]=u,s++),i=d,h=c):(t+=o,n+=u),o=t,u=n,r++}s<3||n?g-=2*s:(f+=-.5*(i+o-i)*(h+u+h),y(x,l[g-2],l[g-1],o,u)?(l[g-2]+=o,l[g-1]+=u,d.push(s)):(l[g++]=o,l[g++]=u,d.push(++s)))}else{let e=0,r=a.getSInt32(),s=a.getSInt32();this.hasZ&&a.getSInt32(),this.hasM&&a.getSInt32(),l[g++]=r,l[g++]=s,e+=1;for(let n=1;n<t;n++){const t=a.getSInt32(),i=a.getSInt32(),h=r+t,o=s+i;f+=-.5*(h-r)*(o+s),this.hasZ&&a.getSInt32(),this.hasM&&a.getSInt32(),n>2&&y(x,l[g-2],l[g-1],t,i)?(l[g-2]+=t,l[g-1]+=i):(l[g++]=t,l[g++]=i,e+=1),r=h,s=o}d.push(e)}break}default:a.skip()}return this._cache.area=f,d.length?new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_5__["default"](d,l):null!=l?this._createQuantizedExtrudedGeometry(l[0],l[1]):null}}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderPBFHeader.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderPBFHeader.js ***!
  \*************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureSetHeader: function() { return /* binding */ o; },
/* harmony export */   parseHeader: function() { return /* binding */ a; }
/* harmony export */ });
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../layers/support/FieldsIndex.js */ "./node_modules/@arcgis/core/layers/support/FieldsIndex.js");
/* harmony import */ var _rest_query_operations_pbfFeatureServiceParser_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../rest/query/operations/pbfFeatureServiceParser.js */ "./node_modules/@arcgis/core/rest/query/operations/pbfFeatureServiceParser.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const n=268435455;class o{constructor(){this.hasFeatures=!1,this.exceededTransferLimit=!1,this.fieldCount=0,this.featureCount=0,this.objectIdFieldIndex=0,this.vertexCount=0,this.offsets={attributes:new Array,geometry:new Array},this.centroid=new Array}}function a(a,i,c=!1){const f=1,d=3,u=9,g=12,l=13,p=15,h=a.asUnsafe(),b=h.pos(),w=new o;let m=0,y=0;const k=1,x=2,I=4,L=3;let A=null,F=null,C=null,S=!1;const j=[];for(;h.next();)switch(h.tag()){case f:A=h.getString();break;case d:F=h.getString();break;case g:C=h.processMessage(_rest_query_operations_pbfFeatureServiceParser_js__WEBPACK_IMPORTED_MODULE_2__.parseTransform);break;case u:if(w.exceededTransferLimit=h.getBool(),w.exceededTransferLimit){w.offsets.geometry=c?new Float64Array(8e3):new Int32Array(8e3),w.centroid=c?new Float64Array(16e3):new Int32Array(16e3);for(let e=0;e<w.centroid.length;e++)w.centroid[e]=n}break;case l:{const e=h.processMessage(_rest_query_operations_pbfFeatureServiceParser_js__WEBPACK_IMPORTED_MODULE_2__.parseField);e.index=m++,j.push(e);break}case p:{const e=h.getLength(),t=h.pos()+e;if(!w.exceededTransferLimit){const e=w.offsets.geometry,t=w.centroid;e.push(0),t.push(n),t.push(n)}!S&&w.exceededTransferLimit&&(S=!0,w.offsets.attributes=c?new Float64Array(8e3*m):new Uint32Array(8e3*m));let s=y*m;for(;h.pos()<t&&h.next();)switch(h.tag()){case k:{if(S)w.offsets.attributes[s++]=h.pos();else{w.offsets.attributes.push(h.pos())}const e=h.getLength();h.skipLen(e);break}case x:if(i){const e=h.getLength(),t=h.pos()+e;for(;h.pos()<t&&h.next();)switch(h.tag()){case L:{h.getUInt32();const e=h.getSInt64(),t=h.getSInt64();w.centroid[2*y]=e,w.centroid[2*y+1]=t;break}default:h.skip()}}else{w.offsets.geometry[y]=h.pos();const e=h.getLength();w.vertexCount+=e,h.skipLen(e)}break;case I:{const e=h.getLength(),t=h.pos()+e;for(;h.pos()<t&&h.next();)switch(h.tag()){case L:{h.getUInt32();const e=h.getSInt64(),t=h.getSInt64();w.centroid[2*y]=e,w.centroid[2*y+1]=t;break}default:h.skip()}break}default:h.skip()}y++,w.hasFeatures=!0;break}default:h.skip()}const U=A||F;if(!U)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"]("FeatureSet has no objectId or globalId field name");return w.fields=new _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_1__["default"](j),w.featureCount=y,w.fieldCount=m,w.objectIdFieldIndex=w.fields.get(U)?.index,w.transform=C,w.displayIds=new Uint32Array(w.featureCount),w.groupIds=new Uint16Array(w.featureCount),h.move(b),w}


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderParquet.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderParquet.js ***!
  \***********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureSetReaderParquet: function() { return /* binding */ r; }
/* harmony export */ });
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../geometry/support/webMercatorUtils.js */ "./node_modules/@arcgis/core/geometry/support/webMercatorUtils.js");
/* harmony import */ var _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../layers/graphics/OptimizedGeometry.js */ "./node_modules/@arcgis/core/layers/graphics/OptimizedGeometry.js");
/* harmony import */ var _FeatureSetReader_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./FeatureSetReader.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReader.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
class r extends _FeatureSetReader_js__WEBPACK_IMPORTED_MODULE_3__.FeatureSetReader{constructor(e,t,i,r,s,n=new Uint32Array(r.size())){super(e),this._fields=t,this._geometryInfo=i,this._inner=r,this._chunkId=s,this._displayIds=n,this._index=-1,this._size=this._inner.size(),"geometry"===this._geometryInfo.type&&(this._primaryGeometryIndex=this._fields.get(this._geometryInfo.primaryFieldName)?.index),null!=e.objectIdField&&(this._objectIdFieldIndex=this._fields.get(e.objectIdField)?.index),this._chunkId>65535&&console.error("Exceeded max allowed parquet reader size")}destroy(){super.destroy(),this._inner.free()}get fields(){return this._fields}get geometryType(){return"esriGeometryPoint"}get hasFeatures(){return!0}get hasNext(){throw new Error("Method not implemented.")}get exceededTransferLimit(){return!1}get hasZ(){return!1}get hasM(){return!1}getInTransform(){return null}getSize(){return this._size}getCursor(){return this.copy()}getAttributeHash(){let e="";for(const t of this.fields.fields)e+=this._readAttribute(t.name,!1)+".";return e}getObjectId(){return null!=this._objectIdFieldIndex?this._inner.readAttribute(this._index,this._objectIdFieldIndex):this._index<<16|this._chunkId}getDisplayId(){return this._displayIds[this._index]}setDisplayId(e){this._displayIds[this._index]=e}setIndex(e){this._index=e}getIndex(){return this._index}next(){for(;++this._index<this._size&&!this._getExists(););return this._index<this._size}readGeometryArea(){throw new Error("Method not implemented.")}copy(){const e=new r(this.metadata,this._fields,this._geometryInfo,this._inner,this._chunkId,this._displayIds);return this.copyInto(e),e}copyInto(e){super.copyInto(e),e._index=this._index}_readGeometry(i){const r=(0,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_1__.lngLatToXY)(this._inner.readX(this._index),this._inner.readY(this._index));return new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_2__["default"]([],r)}_readX(){return this._readGeometry()?.coords[0]}_readY(){return this._readGeometry()?.coords[1]}_readServerCentroid(){return null}_readAttribute(e,t){const i=this.fields.get(e);if(!i)return;const r=this._inner.readAttribute(this._index,i.index);if(null==r)return r;const s=this.fields.isDateField(i.name);return t?null==r?r:s?new Date(r):r:r}_readAttributes(){const e={};for(const t of this._fields.fields)this._inner.hasField(t.index)&&t.index!==this._primaryGeometryIndex&&(e[t.name]=this._readAttribute(t.name,!1));return null==this._objectIdFieldIndex&&(e.__OBJECTID=this.getObjectId()),e}}


/***/ })

}]);
//# sourceMappingURL=vendors-node_modules_arcgis_core_views_2d_layers_features_FeaturePipelineWorker_js.fa5020d827b52b08d3f7.js.map